function b_(i,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const n in r)if(n!=="default"&&!(n in i)){const s=Object.getOwnPropertyDescriptor(r,n);s&&Object.defineProperty(i,n,s.get?s:{enumerable:!0,get:()=>r[n]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();var gs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ec(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var vx={exports:{}},Kd={},wx={exports:{}},tt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tc=Symbol.for("react.element"),v_=Symbol.for("react.portal"),w_=Symbol.for("react.fragment"),S_=Symbol.for("react.strict_mode"),x_=Symbol.for("react.profiler"),k_=Symbol.for("react.provider"),T_=Symbol.for("react.context"),C_=Symbol.for("react.forward_ref"),N_=Symbol.for("react.suspense"),B_=Symbol.for("react.memo"),__=Symbol.for("react.lazy"),sb=Symbol.iterator;function P_(i){return i===null||typeof i!="object"?null:(i=sb&&i[sb]||i["@@iterator"],typeof i=="function"?i:null)}var Sx={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},xx=Object.assign,kx={};function ul(i,e,t){this.props=i,this.context=e,this.refs=kx,this.updater=t||Sx}ul.prototype.isReactComponent={};ul.prototype.setState=function(i,e){if(typeof i!="object"&&typeof i!="function"&&i!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,i,e,"setState")};ul.prototype.forceUpdate=function(i){this.updater.enqueueForceUpdate(this,i,"forceUpdate")};function Tx(){}Tx.prototype=ul.prototype;function N0(i,e,t){this.props=i,this.context=e,this.refs=kx,this.updater=t||Sx}var B0=N0.prototype=new Tx;B0.constructor=N0;xx(B0,ul.prototype);B0.isPureReactComponent=!0;var ab=Array.isArray,Cx=Object.prototype.hasOwnProperty,_0={current:null},Nx={key:!0,ref:!0,__self:!0,__source:!0};function Bx(i,e,t){var r,n={},s=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)Cx.call(e,r)&&!Nx.hasOwnProperty(r)&&(n[r]=e[r]);var o=arguments.length-2;if(o===1)n.children=t;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];n.children=l}if(i&&i.defaultProps)for(r in o=i.defaultProps,o)n[r]===void 0&&(n[r]=o[r]);return{$$typeof:tc,type:i,key:s,ref:a,props:n,_owner:_0.current}}function R_(i,e){return{$$typeof:tc,type:i.type,key:e,ref:i.ref,props:i.props,_owner:i._owner}}function P0(i){return typeof i=="object"&&i!==null&&i.$$typeof===tc}function E_(i){var e={"=":"=0",":":"=2"};return"$"+i.replace(/[=:]/g,function(t){return e[t]})}var ob=/\/+/g;function Sp(i,e){return typeof i=="object"&&i!==null&&i.key!=null?E_(""+i.key):e.toString(36)}function yh(i,e,t,r,n){var s=typeof i;(s==="undefined"||s==="boolean")&&(i=null);var a=!1;if(i===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(i.$$typeof){case tc:case v_:a=!0}}if(a)return a=i,n=n(a),i=r===""?"."+Sp(a,0):r,ab(n)?(t="",i!=null&&(t=i.replace(ob,"$&/")+"/"),yh(n,e,t,"",function(u){return u})):n!=null&&(P0(n)&&(n=R_(n,t+(!n.key||a&&a.key===n.key?"":(""+n.key).replace(ob,"$&/")+"/")+i)),e.push(n)),1;if(a=0,r=r===""?".":r+":",ab(i))for(var o=0;o<i.length;o++){s=i[o];var l=r+Sp(s,o);a+=yh(s,e,t,l,n)}else if(l=P_(i),typeof l=="function")for(i=l.call(i),o=0;!(s=i.next()).done;)s=s.value,l=r+Sp(s,o++),a+=yh(s,e,t,l,n);else if(s==="object")throw e=String(i),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Cc(i,e,t){if(i==null)return i;var r=[],n=0;return yh(i,r,"","",function(s){return e.call(t,s,n++)}),r}function M_(i){if(i._status===-1){var e=i._result;e=e(),e.then(function(t){(i._status===0||i._status===-1)&&(i._status=1,i._result=t)},function(t){(i._status===0||i._status===-1)&&(i._status=2,i._result=t)}),i._status===-1&&(i._status=0,i._result=e)}if(i._status===1)return i._result.default;throw i._result}var rr={current:null},bh={transition:null},O_={ReactCurrentDispatcher:rr,ReactCurrentBatchConfig:bh,ReactCurrentOwner:_0};tt.Children={map:Cc,forEach:function(i,e,t){Cc(i,function(){e.apply(this,arguments)},t)},count:function(i){var e=0;return Cc(i,function(){e++}),e},toArray:function(i){return Cc(i,function(e){return e})||[]},only:function(i){if(!P0(i))throw Error("React.Children.only expected to receive a single React element child.");return i}};tt.Component=ul;tt.Fragment=w_;tt.Profiler=x_;tt.PureComponent=N0;tt.StrictMode=S_;tt.Suspense=N_;tt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O_;tt.cloneElement=function(i,e,t){if(i==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+i+".");var r=xx({},i.props),n=i.key,s=i.ref,a=i._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=_0.current),e.key!==void 0&&(n=""+e.key),i.type&&i.type.defaultProps)var o=i.type.defaultProps;for(l in e)Cx.call(e,l)&&!Nx.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=t;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];r.children=o}return{$$typeof:tc,type:i.type,key:n,ref:s,props:r,_owner:a}};tt.createContext=function(i){return i={$$typeof:T_,_currentValue:i,_currentValue2:i,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},i.Provider={$$typeof:k_,_context:i},i.Consumer=i};tt.createElement=Bx;tt.createFactory=function(i){var e=Bx.bind(null,i);return e.type=i,e};tt.createRef=function(){return{current:null}};tt.forwardRef=function(i){return{$$typeof:C_,render:i}};tt.isValidElement=P0;tt.lazy=function(i){return{$$typeof:__,_payload:{_status:-1,_result:i},_init:M_}};tt.memo=function(i,e){return{$$typeof:B_,type:i,compare:e===void 0?null:e}};tt.startTransition=function(i){var e=bh.transition;bh.transition={};try{i()}finally{bh.transition=e}};tt.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};tt.useCallback=function(i,e){return rr.current.useCallback(i,e)};tt.useContext=function(i){return rr.current.useContext(i)};tt.useDebugValue=function(){};tt.useDeferredValue=function(i){return rr.current.useDeferredValue(i)};tt.useEffect=function(i,e){return rr.current.useEffect(i,e)};tt.useId=function(){return rr.current.useId()};tt.useImperativeHandle=function(i,e,t){return rr.current.useImperativeHandle(i,e,t)};tt.useInsertionEffect=function(i,e){return rr.current.useInsertionEffect(i,e)};tt.useLayoutEffect=function(i,e){return rr.current.useLayoutEffect(i,e)};tt.useMemo=function(i,e){return rr.current.useMemo(i,e)};tt.useReducer=function(i,e,t){return rr.current.useReducer(i,e,t)};tt.useRef=function(i){return rr.current.useRef(i)};tt.useState=function(i){return rr.current.useState(i)};tt.useSyncExternalStore=function(i,e,t){return rr.current.useSyncExternalStore(i,e,t)};tt.useTransition=function(){return rr.current.useTransition()};tt.version="18.2.0";wx.exports=tt;var S=wx.exports;const et=ec(S),cu=b_({__proto__:null,default:et},[S]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I_=S,L_=Symbol.for("react.element"),D_=Symbol.for("react.fragment"),F_=Object.prototype.hasOwnProperty,A_=I_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,V_={key:!0,ref:!0,__self:!0,__source:!0};function _x(i,e,t){var r,n={},s=null,a=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)F_.call(e,r)&&!V_.hasOwnProperty(r)&&(n[r]=e[r]);if(i&&i.defaultProps)for(r in e=i.defaultProps,e)n[r]===void 0&&(n[r]=e[r]);return{$$typeof:L_,type:i,key:s,ref:a,props:n,_owner:A_.current}}Kd.Fragment=D_;Kd.jsx=_x;Kd.jsxs=_x;vx.exports=Kd;var T=vx.exports,Px={exports:{}},Ur={},Rx={exports:{}},Ex={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(i){function e(U,Z){var re=U.length;U.push(Z);e:for(;0<re;){var ge=re-1>>>1,G=U[ge];if(0<n(G,Z))U[ge]=Z,U[re]=G,re=ge;else break e}}function t(U){return U.length===0?null:U[0]}function r(U){if(U.length===0)return null;var Z=U[0],re=U.pop();if(re!==Z){U[0]=re;e:for(var ge=0,G=U.length,q=G>>>1;ge<q;){var ie=2*(ge+1)-1,ae=U[ie],Re=ie+1,We=U[Re];if(0>n(ae,re))Re<G&&0>n(We,ae)?(U[ge]=We,U[Re]=re,ge=Re):(U[ge]=ae,U[ie]=re,ge=ie);else if(Re<G&&0>n(We,re))U[ge]=We,U[Re]=re,ge=Re;else break e}}return Z}function n(U,Z){var re=U.sortIndex-Z.sortIndex;return re!==0?re:U.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;i.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();i.unstable_now=function(){return a.now()-o}}var l=[],u=[],c=1,h=null,d=3,f=!1,p=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(U){for(var Z=t(u);Z!==null;){if(Z.callback===null)r(u);else if(Z.startTime<=U)r(u),Z.sortIndex=Z.expirationTime,e(l,Z);else break;Z=t(u)}}function k(U){if(g=!1,v(U),!p)if(t(l)!==null)p=!0,se(x);else{var Z=t(u);Z!==null&&K(k,Z.startTime-U)}}function x(U,Z){p=!1,g&&(g=!1,b(B),B=-1),f=!0;var re=d;try{for(v(Z),h=t(l);h!==null&&(!(h.expirationTime>Z)||U&&!z());){var ge=h.callback;if(typeof ge=="function"){h.callback=null,d=h.priorityLevel;var G=ge(h.expirationTime<=Z);Z=i.unstable_now(),typeof G=="function"?h.callback=G:h===t(l)&&r(l),v(Z)}else r(l);h=t(l)}if(h!==null)var q=!0;else{var ie=t(u);ie!==null&&K(k,ie.startTime-Z),q=!1}return q}finally{h=null,d=re,f=!1}}var C=!1,N=null,B=-1,E=5,O=-1;function z(){return!(i.unstable_now()-O<E)}function J(){if(N!==null){var U=i.unstable_now();O=U;var Z=!0;try{Z=N(!0,U)}finally{Z?he():(C=!1,N=null)}}else C=!1}var he;if(typeof m=="function")he=function(){m(J)};else if(typeof MessageChannel<"u"){var oe=new MessageChannel,ye=oe.port2;oe.port1.onmessage=J,he=function(){ye.postMessage(null)}}else he=function(){y(J,0)};function se(U){N=U,C||(C=!0,he())}function K(U,Z){B=y(function(){U(i.unstable_now())},Z)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(U){U.callback=null},i.unstable_continueExecution=function(){p||f||(p=!0,se(x))},i.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<U?Math.floor(1e3/U):5},i.unstable_getCurrentPriorityLevel=function(){return d},i.unstable_getFirstCallbackNode=function(){return t(l)},i.unstable_next=function(U){switch(d){case 1:case 2:case 3:var Z=3;break;default:Z=d}var re=d;d=Z;try{return U()}finally{d=re}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(U,Z){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var re=d;d=U;try{return Z()}finally{d=re}},i.unstable_scheduleCallback=function(U,Z,re){var ge=i.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?ge+re:ge):re=ge,U){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=re+G,U={id:c++,callback:Z,priorityLevel:U,startTime:re,expirationTime:G,sortIndex:-1},re>ge?(U.sortIndex=re,e(u,U),t(l)===null&&U===t(u)&&(g?(b(B),B=-1):g=!0,K(k,re-ge))):(U.sortIndex=G,e(l,U),p||f||(p=!0,se(x))),U},i.unstable_shouldYield=z,i.unstable_wrapCallback=function(U){var Z=d;return function(){var re=d;d=Z;try{return U.apply(this,arguments)}finally{d=re}}}})(Ex);Rx.exports=Ex;var H_=Rx.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mx=S,Ar=H_;function X(i){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+i,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+i+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ox=new Set,hu={};function Za(i,e){Go(i,e),Go(i+"Capture",e)}function Go(i,e){for(hu[i]=e,i=0;i<e.length;i++)Ox.add(e[i])}var ms=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Gg=Object.prototype.hasOwnProperty,z_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,lb={},ub={};function U_(i){return Gg.call(ub,i)?!0:Gg.call(lb,i)?!1:z_.test(i)?ub[i]=!0:(lb[i]=!0,!1)}function W_(i,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function G_(i,e,t,r){if(e===null||typeof e>"u"||W_(i,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function nr(i,e,t,r,n,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=n,this.mustUseProperty=t,this.propertyName=i,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var Ai={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){Ai[i]=new nr(i,0,!1,i,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var e=i[0];Ai[e]=new nr(e,1,!1,i[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(i){Ai[i]=new nr(i,2,!1,i.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){Ai[i]=new nr(i,2,!1,i,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){Ai[i]=new nr(i,3,!1,i.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(i){Ai[i]=new nr(i,3,!0,i,null,!1,!1)});["capture","download"].forEach(function(i){Ai[i]=new nr(i,4,!1,i,null,!1,!1)});["cols","rows","size","span"].forEach(function(i){Ai[i]=new nr(i,6,!1,i,null,!1,!1)});["rowSpan","start"].forEach(function(i){Ai[i]=new nr(i,5,!1,i.toLowerCase(),null,!1,!1)});var R0=/[\-:]([a-z])/g;function E0(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var e=i.replace(R0,E0);Ai[e]=new nr(e,1,!1,i,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var e=i.replace(R0,E0);Ai[e]=new nr(e,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(i){var e=i.replace(R0,E0);Ai[e]=new nr(e,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(i){Ai[i]=new nr(i,1,!1,i.toLowerCase(),null,!1,!1)});Ai.xlinkHref=new nr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(i){Ai[i]=new nr(i,1,!1,i.toLowerCase(),null,!0,!0)});function M0(i,e,t,r){var n=Ai.hasOwnProperty(e)?Ai[e]:null;(n!==null?n.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(G_(e,t,n,r)&&(t=null),r||n===null?U_(e)&&(t===null?i.removeAttribute(e):i.setAttribute(e,""+t)):n.mustUseProperty?i[n.propertyName]=t===null?n.type===3?!1:"":t:(e=n.attributeName,r=n.attributeNamespace,t===null?i.removeAttribute(e):(n=n.type,t=n===3||n===4&&t===!0?"":""+t,r?i.setAttributeNS(r,e,t):i.setAttribute(e,t))))}var Ns=Mx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Nc=Symbol.for("react.element"),yo=Symbol.for("react.portal"),bo=Symbol.for("react.fragment"),O0=Symbol.for("react.strict_mode"),$g=Symbol.for("react.profiler"),Ix=Symbol.for("react.provider"),Lx=Symbol.for("react.context"),I0=Symbol.for("react.forward_ref"),jg=Symbol.for("react.suspense"),Yg=Symbol.for("react.suspense_list"),L0=Symbol.for("react.memo"),As=Symbol.for("react.lazy"),Dx=Symbol.for("react.offscreen"),cb=Symbol.iterator;function kl(i){return i===null||typeof i!="object"?null:(i=cb&&i[cb]||i["@@iterator"],typeof i=="function"?i:null)}var Xt=Object.assign,xp;function Ll(i){if(xp===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);xp=e&&e[1]||""}return`
`+xp+i}var kp=!1;function Tp(i,e){if(!i||kp)return"";kp=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(i,[],e)}else{try{e.call()}catch(u){r=u}i.call(e.prototype)}else{try{throw Error()}catch(u){r=u}i()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var n=u.stack.split(`
`),s=r.stack.split(`
`),a=n.length-1,o=s.length-1;1<=a&&0<=o&&n[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(n[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||n[a]!==s[o]){var l=`
`+n[a].replace(" at new "," at ");return i.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",i.displayName)),l}while(1<=a&&0<=o);break}}}finally{kp=!1,Error.prepareStackTrace=t}return(i=i?i.displayName||i.name:"")?Ll(i):""}function $_(i){switch(i.tag){case 5:return Ll(i.type);case 16:return Ll("Lazy");case 13:return Ll("Suspense");case 19:return Ll("SuspenseList");case 0:case 2:case 15:return i=Tp(i.type,!1),i;case 11:return i=Tp(i.type.render,!1),i;case 1:return i=Tp(i.type,!0),i;default:return""}}function Xg(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case bo:return"Fragment";case yo:return"Portal";case $g:return"Profiler";case O0:return"StrictMode";case jg:return"Suspense";case Yg:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case Lx:return(i.displayName||"Context")+".Consumer";case Ix:return(i._context.displayName||"Context")+".Provider";case I0:var e=i.render;return i=i.displayName,i||(i=e.displayName||e.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case L0:return e=i.displayName||null,e!==null?e:Xg(i.type)||"Memo";case As:e=i._payload,i=i._init;try{return Xg(i(e))}catch{}}return null}function j_(i){var e=i.type;switch(i.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=e.render,i=i.displayName||i.name||"",e.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Xg(e);case 8:return e===O0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function sa(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Fx(i){var e=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Y_(i){var e=Fx(i)?"checked":"value",t=Object.getOwnPropertyDescriptor(i.constructor.prototype,e),r=""+i[e];if(!i.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var n=t.get,s=t.set;return Object.defineProperty(i,e,{configurable:!0,get:function(){return n.call(this)},set:function(a){r=""+a,s.call(this,a)}}),Object.defineProperty(i,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){i._valueTracker=null,delete i[e]}}}}function Bc(i){i._valueTracker||(i._valueTracker=Y_(i))}function Ax(i){if(!i)return!1;var e=i._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return i&&(r=Fx(i)?i.checked?"true":"false":i.value),i=r,i!==t?(e.setValue(i),!0):!1}function zh(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function Kg(i,e){var t=e.checked;return Xt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??i._wrapperState.initialChecked})}function hb(i,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=sa(e.value!=null?e.value:t),i._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Vx(i,e){e=e.checked,e!=null&&M0(i,"checked",e,!1)}function qg(i,e){Vx(i,e);var t=sa(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&i.value===""||i.value!=t)&&(i.value=""+t):i.value!==""+t&&(i.value=""+t);else if(r==="submit"||r==="reset"){i.removeAttribute("value");return}e.hasOwnProperty("value")?Jg(i,e.type,t):e.hasOwnProperty("defaultValue")&&Jg(i,e.type,sa(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(i.defaultChecked=!!e.defaultChecked)}function db(i,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+i._wrapperState.initialValue,t||e===i.value||(i.value=e),i.defaultValue=e}t=i.name,t!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,t!==""&&(i.name=t)}function Jg(i,e,t){(e!=="number"||zh(i.ownerDocument)!==i)&&(t==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+t&&(i.defaultValue=""+t))}var Dl=Array.isArray;function Io(i,e,t,r){if(i=i.options,e){e={};for(var n=0;n<t.length;n++)e["$"+t[n]]=!0;for(t=0;t<i.length;t++)n=e.hasOwnProperty("$"+i[t].value),i[t].selected!==n&&(i[t].selected=n),n&&r&&(i[t].defaultSelected=!0)}else{for(t=""+sa(t),e=null,n=0;n<i.length;n++){if(i[n].value===t){i[n].selected=!0,r&&(i[n].defaultSelected=!0);return}e!==null||i[n].disabled||(e=i[n])}e!==null&&(e.selected=!0)}}function Qg(i,e){if(e.dangerouslySetInnerHTML!=null)throw Error(X(91));return Xt({},e,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function fb(i,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(X(92));if(Dl(t)){if(1<t.length)throw Error(X(93));t=t[0]}e=t}e==null&&(e=""),t=e}i._wrapperState={initialValue:sa(t)}}function Hx(i,e){var t=sa(e.value),r=sa(e.defaultValue);t!=null&&(t=""+t,t!==i.value&&(i.value=t),e.defaultValue==null&&i.defaultValue!==t&&(i.defaultValue=t)),r!=null&&(i.defaultValue=""+r)}function pb(i){var e=i.textContent;e===i._wrapperState.initialValue&&e!==""&&e!==null&&(i.value=e)}function zx(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Zg(i,e){return i==null||i==="http://www.w3.org/1999/xhtml"?zx(e):i==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var _c,Ux=function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,n){MSApp.execUnsafeLocalFunction(function(){return i(e,t,r,n)})}:i}(function(i,e){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=e;else{for(_c=_c||document.createElement("div"),_c.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=_c.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;e.firstChild;)i.appendChild(e.firstChild)}});function du(i,e){if(e){var t=i.firstChild;if(t&&t===i.lastChild&&t.nodeType===3){t.nodeValue=e;return}}i.textContent=e}var Gl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},X_=["Webkit","ms","Moz","O"];Object.keys(Gl).forEach(function(i){X_.forEach(function(e){e=e+i.charAt(0).toUpperCase()+i.substring(1),Gl[e]=Gl[i]})});function Wx(i,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Gl.hasOwnProperty(i)&&Gl[i]?(""+e).trim():e+"px"}function Gx(i,e){i=i.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,n=Wx(t,e[t],r);t==="float"&&(t="cssFloat"),r?i.setProperty(t,n):i[t]=n}}var K_=Xt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function em(i,e){if(e){if(K_[i]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(X(137,i));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(X(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(X(61))}if(e.style!=null&&typeof e.style!="object")throw Error(X(62))}}function tm(i,e){if(i.indexOf("-")===-1)return typeof e.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var im=null;function D0(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var rm=null,Lo=null,Do=null;function gb(i){if(i=nc(i)){if(typeof rm!="function")throw Error(X(280));var e=i.stateNode;e&&(e=ef(e),rm(i.stateNode,i.type,e))}}function $x(i){Lo?Do?Do.push(i):Do=[i]:Lo=i}function jx(){if(Lo){var i=Lo,e=Do;if(Do=Lo=null,gb(i),e)for(i=0;i<e.length;i++)gb(e[i])}}function Yx(i,e){return i(e)}function Xx(){}var Cp=!1;function Kx(i,e,t){if(Cp)return i(e,t);Cp=!0;try{return Yx(i,e,t)}finally{Cp=!1,(Lo!==null||Do!==null)&&(Xx(),jx())}}function fu(i,e){var t=i.stateNode;if(t===null)return null;var r=ef(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(i=i.type,r=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!r;break e;default:i=!1}if(i)return null;if(t&&typeof t!="function")throw Error(X(231,e,typeof t));return t}var nm=!1;if(ms)try{var Tl={};Object.defineProperty(Tl,"passive",{get:function(){nm=!0}}),window.addEventListener("test",Tl,Tl),window.removeEventListener("test",Tl,Tl)}catch{nm=!1}function q_(i,e,t,r,n,s,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(c){this.onError(c)}}var $l=!1,Uh=null,Wh=!1,sm=null,J_={onError:function(i){$l=!0,Uh=i}};function Q_(i,e,t,r,n,s,a,o,l){$l=!1,Uh=null,q_.apply(J_,arguments)}function Z_(i,e,t,r,n,s,a,o,l){if(Q_.apply(this,arguments),$l){if($l){var u=Uh;$l=!1,Uh=null}else throw Error(X(198));Wh||(Wh=!0,sm=u)}}function eo(i){var e=i,t=i;if(i.alternate)for(;e.return;)e=e.return;else{i=e;do e=i,e.flags&4098&&(t=e.return),i=e.return;while(i)}return e.tag===3?t:null}function qx(i){if(i.tag===13){var e=i.memoizedState;if(e===null&&(i=i.alternate,i!==null&&(e=i.memoizedState)),e!==null)return e.dehydrated}return null}function mb(i){if(eo(i)!==i)throw Error(X(188))}function eP(i){var e=i.alternate;if(!e){if(e=eo(i),e===null)throw Error(X(188));return e!==i?null:i}for(var t=i,r=e;;){var n=t.return;if(n===null)break;var s=n.alternate;if(s===null){if(r=n.return,r!==null){t=r;continue}break}if(n.child===s.child){for(s=n.child;s;){if(s===t)return mb(n),i;if(s===r)return mb(n),e;s=s.sibling}throw Error(X(188))}if(t.return!==r.return)t=n,r=s;else{for(var a=!1,o=n.child;o;){if(o===t){a=!0,t=n,r=s;break}if(o===r){a=!0,r=n,t=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===t){a=!0,t=s,r=n;break}if(o===r){a=!0,r=s,t=n;break}o=o.sibling}if(!a)throw Error(X(189))}}if(t.alternate!==r)throw Error(X(190))}if(t.tag!==3)throw Error(X(188));return t.stateNode.current===t?i:e}function Jx(i){return i=eP(i),i!==null?Qx(i):null}function Qx(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var e=Qx(i);if(e!==null)return e;i=i.sibling}return null}var Zx=Ar.unstable_scheduleCallback,yb=Ar.unstable_cancelCallback,tP=Ar.unstable_shouldYield,iP=Ar.unstable_requestPaint,ii=Ar.unstable_now,rP=Ar.unstable_getCurrentPriorityLevel,F0=Ar.unstable_ImmediatePriority,ek=Ar.unstable_UserBlockingPriority,Gh=Ar.unstable_NormalPriority,nP=Ar.unstable_LowPriority,tk=Ar.unstable_IdlePriority,qd=null,Xn=null;function sP(i){if(Xn&&typeof Xn.onCommitFiberRoot=="function")try{Xn.onCommitFiberRoot(qd,i,void 0,(i.current.flags&128)===128)}catch{}}var Cn=Math.clz32?Math.clz32:lP,aP=Math.log,oP=Math.LN2;function lP(i){return i>>>=0,i===0?32:31-(aP(i)/oP|0)|0}var Pc=64,Rc=4194304;function Fl(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function $h(i,e){var t=i.pendingLanes;if(t===0)return 0;var r=0,n=i.suspendedLanes,s=i.pingedLanes,a=t&268435455;if(a!==0){var o=a&~n;o!==0?r=Fl(o):(s&=a,s!==0&&(r=Fl(s)))}else a=t&~n,a!==0?r=Fl(a):s!==0&&(r=Fl(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&n)&&(n=r&-r,s=e&-e,n>=s||n===16&&(s&4194240)!==0))return e;if(r&4&&(r|=t&16),e=i.entangledLanes,e!==0)for(i=i.entanglements,e&=r;0<e;)t=31-Cn(e),n=1<<t,r|=i[t],e&=~n;return r}function uP(i,e){switch(i){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function cP(i,e){for(var t=i.suspendedLanes,r=i.pingedLanes,n=i.expirationTimes,s=i.pendingLanes;0<s;){var a=31-Cn(s),o=1<<a,l=n[a];l===-1?(!(o&t)||o&r)&&(n[a]=uP(o,e)):l<=e&&(i.expiredLanes|=o),s&=~o}}function am(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function ik(){var i=Pc;return Pc<<=1,!(Pc&4194240)&&(Pc=64),i}function Np(i){for(var e=[],t=0;31>t;t++)e.push(i);return e}function ic(i,e,t){i.pendingLanes|=e,e!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,e=31-Cn(e),i[e]=t}function hP(i,e){var t=i.pendingLanes&~e;i.pendingLanes=e,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=e,i.mutableReadLanes&=e,i.entangledLanes&=e,e=i.entanglements;var r=i.eventTimes;for(i=i.expirationTimes;0<t;){var n=31-Cn(t),s=1<<n;e[n]=0,r[n]=-1,i[n]=-1,t&=~s}}function A0(i,e){var t=i.entangledLanes|=e;for(i=i.entanglements;t;){var r=31-Cn(t),n=1<<r;n&e|i[r]&e&&(i[r]|=e),t&=~n}}var mt=0;function rk(i){return i&=-i,1<i?4<i?i&268435455?16:536870912:4:1}var nk,V0,sk,ak,ok,om=!1,Ec=[],js=null,Ys=null,Xs=null,pu=new Map,gu=new Map,zs=[],dP="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function bb(i,e){switch(i){case"focusin":case"focusout":js=null;break;case"dragenter":case"dragleave":Ys=null;break;case"mouseover":case"mouseout":Xs=null;break;case"pointerover":case"pointerout":pu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":gu.delete(e.pointerId)}}function Cl(i,e,t,r,n,s){return i===null||i.nativeEvent!==s?(i={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:s,targetContainers:[n]},e!==null&&(e=nc(e),e!==null&&V0(e)),i):(i.eventSystemFlags|=r,e=i.targetContainers,n!==null&&e.indexOf(n)===-1&&e.push(n),i)}function fP(i,e,t,r,n){switch(e){case"focusin":return js=Cl(js,i,e,t,r,n),!0;case"dragenter":return Ys=Cl(Ys,i,e,t,r,n),!0;case"mouseover":return Xs=Cl(Xs,i,e,t,r,n),!0;case"pointerover":var s=n.pointerId;return pu.set(s,Cl(pu.get(s)||null,i,e,t,r,n)),!0;case"gotpointercapture":return s=n.pointerId,gu.set(s,Cl(gu.get(s)||null,i,e,t,r,n)),!0}return!1}function lk(i){var e=Ba(i.target);if(e!==null){var t=eo(e);if(t!==null){if(e=t.tag,e===13){if(e=qx(t),e!==null){i.blockedOn=e,ok(i.priority,function(){sk(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){i.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}i.blockedOn=null}function vh(i){if(i.blockedOn!==null)return!1;for(var e=i.targetContainers;0<e.length;){var t=lm(i.domEventName,i.eventSystemFlags,e[0],i.nativeEvent);if(t===null){t=i.nativeEvent;var r=new t.constructor(t.type,t);im=r,t.target.dispatchEvent(r),im=null}else return e=nc(t),e!==null&&V0(e),i.blockedOn=t,!1;e.shift()}return!0}function vb(i,e,t){vh(i)&&t.delete(e)}function pP(){om=!1,js!==null&&vh(js)&&(js=null),Ys!==null&&vh(Ys)&&(Ys=null),Xs!==null&&vh(Xs)&&(Xs=null),pu.forEach(vb),gu.forEach(vb)}function Nl(i,e){i.blockedOn===e&&(i.blockedOn=null,om||(om=!0,Ar.unstable_scheduleCallback(Ar.unstable_NormalPriority,pP)))}function mu(i){function e(n){return Nl(n,i)}if(0<Ec.length){Nl(Ec[0],i);for(var t=1;t<Ec.length;t++){var r=Ec[t];r.blockedOn===i&&(r.blockedOn=null)}}for(js!==null&&Nl(js,i),Ys!==null&&Nl(Ys,i),Xs!==null&&Nl(Xs,i),pu.forEach(e),gu.forEach(e),t=0;t<zs.length;t++)r=zs[t],r.blockedOn===i&&(r.blockedOn=null);for(;0<zs.length&&(t=zs[0],t.blockedOn===null);)lk(t),t.blockedOn===null&&zs.shift()}var Fo=Ns.ReactCurrentBatchConfig,jh=!0;function gP(i,e,t,r){var n=mt,s=Fo.transition;Fo.transition=null;try{mt=1,H0(i,e,t,r)}finally{mt=n,Fo.transition=s}}function mP(i,e,t,r){var n=mt,s=Fo.transition;Fo.transition=null;try{mt=4,H0(i,e,t,r)}finally{mt=n,Fo.transition=s}}function H0(i,e,t,r){if(jh){var n=lm(i,e,t,r);if(n===null)Dp(i,e,r,Yh,t),bb(i,r);else if(fP(n,i,e,t,r))r.stopPropagation();else if(bb(i,r),e&4&&-1<dP.indexOf(i)){for(;n!==null;){var s=nc(n);if(s!==null&&nk(s),s=lm(i,e,t,r),s===null&&Dp(i,e,r,Yh,t),s===n)break;n=s}n!==null&&r.stopPropagation()}else Dp(i,e,r,null,t)}}var Yh=null;function lm(i,e,t,r){if(Yh=null,i=D0(r),i=Ba(i),i!==null)if(e=eo(i),e===null)i=null;else if(t=e.tag,t===13){if(i=qx(e),i!==null)return i;i=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;i=null}else e!==i&&(i=null);return Yh=i,null}function uk(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(rP()){case F0:return 1;case ek:return 4;case Gh:case nP:return 16;case tk:return 536870912;default:return 16}default:return 16}}var Ws=null,z0=null,wh=null;function ck(){if(wh)return wh;var i,e=z0,t=e.length,r,n="value"in Ws?Ws.value:Ws.textContent,s=n.length;for(i=0;i<t&&e[i]===n[i];i++);var a=t-i;for(r=1;r<=a&&e[t-r]===n[s-r];r++);return wh=n.slice(i,1<r?1-r:void 0)}function Sh(i){var e=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&e===13&&(i=13)):i=e,i===10&&(i=13),32<=i||i===13?i:0}function Mc(){return!0}function wb(){return!1}function Wr(i){function e(t,r,n,s,a){this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in i)i.hasOwnProperty(o)&&(t=i[o],this[o]=t?t(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Mc:wb,this.isPropagationStopped=wb,this}return Xt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Mc)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Mc)},persist:function(){},isPersistent:Mc}),e}var cl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},U0=Wr(cl),rc=Xt({},cl,{view:0,detail:0}),yP=Wr(rc),Bp,_p,Bl,Jd=Xt({},rc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:W0,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Bl&&(Bl&&i.type==="mousemove"?(Bp=i.screenX-Bl.screenX,_p=i.screenY-Bl.screenY):_p=Bp=0,Bl=i),Bp)},movementY:function(i){return"movementY"in i?i.movementY:_p}}),Sb=Wr(Jd),bP=Xt({},Jd,{dataTransfer:0}),vP=Wr(bP),wP=Xt({},rc,{relatedTarget:0}),Pp=Wr(wP),SP=Xt({},cl,{animationName:0,elapsedTime:0,pseudoElement:0}),xP=Wr(SP),kP=Xt({},cl,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),TP=Wr(kP),CP=Xt({},cl,{data:0}),xb=Wr(CP),NP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},BP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_P={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function PP(i){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(i):(i=_P[i])?!!e[i]:!1}function W0(){return PP}var RP=Xt({},rc,{key:function(i){if(i.key){var e=NP[i.key]||i.key;if(e!=="Unidentified")return e}return i.type==="keypress"?(i=Sh(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?BP[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:W0,charCode:function(i){return i.type==="keypress"?Sh(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Sh(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),EP=Wr(RP),MP=Xt({},Jd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),kb=Wr(MP),OP=Xt({},rc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:W0}),IP=Wr(OP),LP=Xt({},cl,{propertyName:0,elapsedTime:0,pseudoElement:0}),DP=Wr(LP),FP=Xt({},Jd,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),AP=Wr(FP),VP=[9,13,27,32],G0=ms&&"CompositionEvent"in window,jl=null;ms&&"documentMode"in document&&(jl=document.documentMode);var HP=ms&&"TextEvent"in window&&!jl,hk=ms&&(!G0||jl&&8<jl&&11>=jl),Tb=" ",Cb=!1;function dk(i,e){switch(i){case"keyup":return VP.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fk(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var vo=!1;function zP(i,e){switch(i){case"compositionend":return fk(e);case"keypress":return e.which!==32?null:(Cb=!0,Tb);case"textInput":return i=e.data,i===Tb&&Cb?null:i;default:return null}}function UP(i,e){if(vo)return i==="compositionend"||!G0&&dk(i,e)?(i=ck(),wh=z0=Ws=null,vo=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return hk&&e.locale!=="ko"?null:e.data;default:return null}}var WP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Nb(i){var e=i&&i.nodeName&&i.nodeName.toLowerCase();return e==="input"?!!WP[i.type]:e==="textarea"}function pk(i,e,t,r){$x(r),e=Xh(e,"onChange"),0<e.length&&(t=new U0("onChange","change",null,t,r),i.push({event:t,listeners:e}))}var Yl=null,yu=null;function GP(i){Ck(i,0)}function Qd(i){var e=xo(i);if(Ax(e))return i}function $P(i,e){if(i==="change")return e}var gk=!1;if(ms){var Rp;if(ms){var Ep="oninput"in document;if(!Ep){var Bb=document.createElement("div");Bb.setAttribute("oninput","return;"),Ep=typeof Bb.oninput=="function"}Rp=Ep}else Rp=!1;gk=Rp&&(!document.documentMode||9<document.documentMode)}function _b(){Yl&&(Yl.detachEvent("onpropertychange",mk),yu=Yl=null)}function mk(i){if(i.propertyName==="value"&&Qd(yu)){var e=[];pk(e,yu,i,D0(i)),Kx(GP,e)}}function jP(i,e,t){i==="focusin"?(_b(),Yl=e,yu=t,Yl.attachEvent("onpropertychange",mk)):i==="focusout"&&_b()}function YP(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Qd(yu)}function XP(i,e){if(i==="click")return Qd(e)}function KP(i,e){if(i==="input"||i==="change")return Qd(e)}function qP(i,e){return i===e&&(i!==0||1/i===1/e)||i!==i&&e!==e}var _n=typeof Object.is=="function"?Object.is:qP;function bu(i,e){if(_n(i,e))return!0;if(typeof i!="object"||i===null||typeof e!="object"||e===null)return!1;var t=Object.keys(i),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var n=t[r];if(!Gg.call(e,n)||!_n(i[n],e[n]))return!1}return!0}function Pb(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Rb(i,e){var t=Pb(i);i=0;for(var r;t;){if(t.nodeType===3){if(r=i+t.textContent.length,i<=e&&r>=e)return{node:t,offset:e-i};i=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=Pb(t)}}function yk(i,e){return i&&e?i===e?!0:i&&i.nodeType===3?!1:e&&e.nodeType===3?yk(i,e.parentNode):"contains"in i?i.contains(e):i.compareDocumentPosition?!!(i.compareDocumentPosition(e)&16):!1:!1}function bk(){for(var i=window,e=zh();e instanceof i.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)i=e.contentWindow;else break;e=zh(i.document)}return e}function $0(i){var e=i&&i.nodeName&&i.nodeName.toLowerCase();return e&&(e==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||e==="textarea"||i.contentEditable==="true")}function JP(i){var e=bk(),t=i.focusedElem,r=i.selectionRange;if(e!==t&&t&&t.ownerDocument&&yk(t.ownerDocument.documentElement,t)){if(r!==null&&$0(t)){if(e=r.start,i=r.end,i===void 0&&(i=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(i,t.value.length);else if(i=(e=t.ownerDocument||document)&&e.defaultView||window,i.getSelection){i=i.getSelection();var n=t.textContent.length,s=Math.min(r.start,n);r=r.end===void 0?s:Math.min(r.end,n),!i.extend&&s>r&&(n=r,r=s,s=n),n=Rb(t,s);var a=Rb(t,r);n&&a&&(i.rangeCount!==1||i.anchorNode!==n.node||i.anchorOffset!==n.offset||i.focusNode!==a.node||i.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(n.node,n.offset),i.removeAllRanges(),s>r?(i.addRange(e),i.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),i.addRange(e)))}}for(e=[],i=t;i=i.parentNode;)i.nodeType===1&&e.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)i=e[t],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var QP=ms&&"documentMode"in document&&11>=document.documentMode,wo=null,um=null,Xl=null,cm=!1;function Eb(i,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;cm||wo==null||wo!==zh(r)||(r=wo,"selectionStart"in r&&$0(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Xl&&bu(Xl,r)||(Xl=r,r=Xh(um,"onSelect"),0<r.length&&(e=new U0("onSelect","select",null,e,t),i.push({event:e,listeners:r}),e.target=wo)))}function Oc(i,e){var t={};return t[i.toLowerCase()]=e.toLowerCase(),t["Webkit"+i]="webkit"+e,t["Moz"+i]="moz"+e,t}var So={animationend:Oc("Animation","AnimationEnd"),animationiteration:Oc("Animation","AnimationIteration"),animationstart:Oc("Animation","AnimationStart"),transitionend:Oc("Transition","TransitionEnd")},Mp={},vk={};ms&&(vk=document.createElement("div").style,"AnimationEvent"in window||(delete So.animationend.animation,delete So.animationiteration.animation,delete So.animationstart.animation),"TransitionEvent"in window||delete So.transitionend.transition);function Zd(i){if(Mp[i])return Mp[i];if(!So[i])return i;var e=So[i],t;for(t in e)if(e.hasOwnProperty(t)&&t in vk)return Mp[i]=e[t];return i}var wk=Zd("animationend"),Sk=Zd("animationiteration"),xk=Zd("animationstart"),kk=Zd("transitionend"),Tk=new Map,Mb="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function pa(i,e){Tk.set(i,e),Za(e,[i])}for(var Op=0;Op<Mb.length;Op++){var Ip=Mb[Op],ZP=Ip.toLowerCase(),eR=Ip[0].toUpperCase()+Ip.slice(1);pa(ZP,"on"+eR)}pa(wk,"onAnimationEnd");pa(Sk,"onAnimationIteration");pa(xk,"onAnimationStart");pa("dblclick","onDoubleClick");pa("focusin","onFocus");pa("focusout","onBlur");pa(kk,"onTransitionEnd");Go("onMouseEnter",["mouseout","mouseover"]);Go("onMouseLeave",["mouseout","mouseover"]);Go("onPointerEnter",["pointerout","pointerover"]);Go("onPointerLeave",["pointerout","pointerover"]);Za("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Za("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Za("onBeforeInput",["compositionend","keypress","textInput","paste"]);Za("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Za("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Za("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Al="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),tR=new Set("cancel close invalid load scroll toggle".split(" ").concat(Al));function Ob(i,e,t){var r=i.type||"unknown-event";i.currentTarget=t,Z_(r,e,void 0,i),i.currentTarget=null}function Ck(i,e){e=(e&4)!==0;for(var t=0;t<i.length;t++){var r=i[t],n=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var a=r.length-1;0<=a;a--){var o=r[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&n.isPropagationStopped())break e;Ob(n,o,u),s=l}else for(a=0;a<r.length;a++){if(o=r[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==s&&n.isPropagationStopped())break e;Ob(n,o,u),s=l}}}if(Wh)throw i=sm,Wh=!1,sm=null,i}function Pt(i,e){var t=e[gm];t===void 0&&(t=e[gm]=new Set);var r=i+"__bubble";t.has(r)||(Nk(e,i,2,!1),t.add(r))}function Lp(i,e,t){var r=0;e&&(r|=4),Nk(t,i,r,e)}var Ic="_reactListening"+Math.random().toString(36).slice(2);function vu(i){if(!i[Ic]){i[Ic]=!0,Ox.forEach(function(t){t!=="selectionchange"&&(tR.has(t)||Lp(t,!1,i),Lp(t,!0,i))});var e=i.nodeType===9?i:i.ownerDocument;e===null||e[Ic]||(e[Ic]=!0,Lp("selectionchange",!1,e))}}function Nk(i,e,t,r){switch(uk(e)){case 1:var n=gP;break;case 4:n=mP;break;default:n=H0}t=n.bind(null,e,t,i),n=void 0,!nm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(n=!0),r?n!==void 0?i.addEventListener(e,t,{capture:!0,passive:n}):i.addEventListener(e,t,!0):n!==void 0?i.addEventListener(e,t,{passive:n}):i.addEventListener(e,t,!1)}function Dp(i,e,t,r,n){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var o=r.stateNode.containerInfo;if(o===n||o.nodeType===8&&o.parentNode===n)break;if(a===4)for(a=r.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===n||l.nodeType===8&&l.parentNode===n))return;a=a.return}for(;o!==null;){if(a=Ba(o),a===null)return;if(l=a.tag,l===5||l===6){r=s=a;continue e}o=o.parentNode}}r=r.return}Kx(function(){var u=s,c=D0(t),h=[];e:{var d=Tk.get(i);if(d!==void 0){var f=U0,p=i;switch(i){case"keypress":if(Sh(t)===0)break e;case"keydown":case"keyup":f=EP;break;case"focusin":p="focus",f=Pp;break;case"focusout":p="blur",f=Pp;break;case"beforeblur":case"afterblur":f=Pp;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=Sb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=vP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=IP;break;case wk:case Sk:case xk:f=xP;break;case kk:f=DP;break;case"scroll":f=yP;break;case"wheel":f=AP;break;case"copy":case"cut":case"paste":f=TP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=kb}var g=(e&4)!==0,y=!g&&i==="scroll",b=g?d!==null?d+"Capture":null:d;g=[];for(var m=u,v;m!==null;){v=m;var k=v.stateNode;if(v.tag===5&&k!==null&&(v=k,b!==null&&(k=fu(m,b),k!=null&&g.push(wu(m,k,v)))),y)break;m=m.return}0<g.length&&(d=new f(d,p,null,t,c),h.push({event:d,listeners:g}))}}if(!(e&7)){e:{if(d=i==="mouseover"||i==="pointerover",f=i==="mouseout"||i==="pointerout",d&&t!==im&&(p=t.relatedTarget||t.fromElement)&&(Ba(p)||p[ys]))break e;if((f||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,f?(p=t.relatedTarget||t.toElement,f=u,p=p?Ba(p):null,p!==null&&(y=eo(p),p!==y||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=u),f!==p)){if(g=Sb,k="onMouseLeave",b="onMouseEnter",m="mouse",(i==="pointerout"||i==="pointerover")&&(g=kb,k="onPointerLeave",b="onPointerEnter",m="pointer"),y=f==null?d:xo(f),v=p==null?d:xo(p),d=new g(k,m+"leave",f,t,c),d.target=y,d.relatedTarget=v,k=null,Ba(c)===u&&(g=new g(b,m+"enter",p,t,c),g.target=v,g.relatedTarget=y,k=g),y=k,f&&p)t:{for(g=f,b=p,m=0,v=g;v;v=oo(v))m++;for(v=0,k=b;k;k=oo(k))v++;for(;0<m-v;)g=oo(g),m--;for(;0<v-m;)b=oo(b),v--;for(;m--;){if(g===b||b!==null&&g===b.alternate)break t;g=oo(g),b=oo(b)}g=null}else g=null;f!==null&&Ib(h,d,f,g,!1),p!==null&&y!==null&&Ib(h,y,p,g,!0)}}e:{if(d=u?xo(u):window,f=d.nodeName&&d.nodeName.toLowerCase(),f==="select"||f==="input"&&d.type==="file")var x=$P;else if(Nb(d))if(gk)x=KP;else{x=YP;var C=jP}else(f=d.nodeName)&&f.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(x=XP);if(x&&(x=x(i,u))){pk(h,x,t,c);break e}C&&C(i,d,u),i==="focusout"&&(C=d._wrapperState)&&C.controlled&&d.type==="number"&&Jg(d,"number",d.value)}switch(C=u?xo(u):window,i){case"focusin":(Nb(C)||C.contentEditable==="true")&&(wo=C,um=u,Xl=null);break;case"focusout":Xl=um=wo=null;break;case"mousedown":cm=!0;break;case"contextmenu":case"mouseup":case"dragend":cm=!1,Eb(h,t,c);break;case"selectionchange":if(QP)break;case"keydown":case"keyup":Eb(h,t,c)}var N;if(G0)e:{switch(i){case"compositionstart":var B="onCompositionStart";break e;case"compositionend":B="onCompositionEnd";break e;case"compositionupdate":B="onCompositionUpdate";break e}B=void 0}else vo?dk(i,t)&&(B="onCompositionEnd"):i==="keydown"&&t.keyCode===229&&(B="onCompositionStart");B&&(hk&&t.locale!=="ko"&&(vo||B!=="onCompositionStart"?B==="onCompositionEnd"&&vo&&(N=ck()):(Ws=c,z0="value"in Ws?Ws.value:Ws.textContent,vo=!0)),C=Xh(u,B),0<C.length&&(B=new xb(B,i,null,t,c),h.push({event:B,listeners:C}),N?B.data=N:(N=fk(t),N!==null&&(B.data=N)))),(N=HP?zP(i,t):UP(i,t))&&(u=Xh(u,"onBeforeInput"),0<u.length&&(c=new xb("onBeforeInput","beforeinput",null,t,c),h.push({event:c,listeners:u}),c.data=N))}Ck(h,e)})}function wu(i,e,t){return{instance:i,listener:e,currentTarget:t}}function Xh(i,e){for(var t=e+"Capture",r=[];i!==null;){var n=i,s=n.stateNode;n.tag===5&&s!==null&&(n=s,s=fu(i,t),s!=null&&r.unshift(wu(i,s,n)),s=fu(i,e),s!=null&&r.push(wu(i,s,n))),i=i.return}return r}function oo(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function Ib(i,e,t,r,n){for(var s=e._reactName,a=[];t!==null&&t!==r;){var o=t,l=o.alternate,u=o.stateNode;if(l!==null&&l===r)break;o.tag===5&&u!==null&&(o=u,n?(l=fu(t,s),l!=null&&a.unshift(wu(t,l,o))):n||(l=fu(t,s),l!=null&&a.push(wu(t,l,o)))),t=t.return}a.length!==0&&i.push({event:e,listeners:a})}var iR=/\r\n?/g,rR=/\u0000|\uFFFD/g;function Lb(i){return(typeof i=="string"?i:""+i).replace(iR,`
`).replace(rR,"")}function Lc(i,e,t){if(e=Lb(e),Lb(i)!==e&&t)throw Error(X(425))}function Kh(){}var hm=null,dm=null;function fm(i,e){return i==="textarea"||i==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var pm=typeof setTimeout=="function"?setTimeout:void 0,nR=typeof clearTimeout=="function"?clearTimeout:void 0,Db=typeof Promise=="function"?Promise:void 0,sR=typeof queueMicrotask=="function"?queueMicrotask:typeof Db<"u"?function(i){return Db.resolve(null).then(i).catch(aR)}:pm;function aR(i){setTimeout(function(){throw i})}function Fp(i,e){var t=e,r=0;do{var n=t.nextSibling;if(i.removeChild(t),n&&n.nodeType===8)if(t=n.data,t==="/$"){if(r===0){i.removeChild(n),mu(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=n}while(t);mu(e)}function Ks(i){for(;i!=null;i=i.nextSibling){var e=i.nodeType;if(e===1||e===3)break;if(e===8){if(e=i.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return i}function Fb(i){i=i.previousSibling;for(var e=0;i;){if(i.nodeType===8){var t=i.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return i;e--}else t==="/$"&&e++}i=i.previousSibling}return null}var hl=Math.random().toString(36).slice(2),Wn="__reactFiber$"+hl,Su="__reactProps$"+hl,ys="__reactContainer$"+hl,gm="__reactEvents$"+hl,oR="__reactListeners$"+hl,lR="__reactHandles$"+hl;function Ba(i){var e=i[Wn];if(e)return e;for(var t=i.parentNode;t;){if(e=t[ys]||t[Wn]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(i=Fb(i);i!==null;){if(t=i[Wn])return t;i=Fb(i)}return e}i=t,t=i.parentNode}return null}function nc(i){return i=i[Wn]||i[ys],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function xo(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(X(33))}function ef(i){return i[Su]||null}var mm=[],ko=-1;function ga(i){return{current:i}}function Et(i){0>ko||(i.current=mm[ko],mm[ko]=null,ko--)}function Bt(i,e){ko++,mm[ko]=i.current,i.current=e}var aa={},Yi=ga(aa),gr=ga(!1),za=aa;function $o(i,e){var t=i.type.contextTypes;if(!t)return aa;var r=i.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var n={},s;for(s in t)n[s]=e[s];return r&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=e,i.__reactInternalMemoizedMaskedChildContext=n),n}function mr(i){return i=i.childContextTypes,i!=null}function qh(){Et(gr),Et(Yi)}function Ab(i,e,t){if(Yi.current!==aa)throw Error(X(168));Bt(Yi,e),Bt(gr,t)}function Bk(i,e,t){var r=i.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var n in r)if(!(n in e))throw Error(X(108,j_(i)||"Unknown",n));return Xt({},t,r)}function Jh(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||aa,za=Yi.current,Bt(Yi,i),Bt(gr,gr.current),!0}function Vb(i,e,t){var r=i.stateNode;if(!r)throw Error(X(169));t?(i=Bk(i,e,za),r.__reactInternalMemoizedMergedChildContext=i,Et(gr),Et(Yi),Bt(Yi,i)):Et(gr),Bt(gr,t)}var rs=null,tf=!1,Ap=!1;function _k(i){rs===null?rs=[i]:rs.push(i)}function uR(i){tf=!0,_k(i)}function ma(){if(!Ap&&rs!==null){Ap=!0;var i=0,e=mt;try{var t=rs;for(mt=1;i<t.length;i++){var r=t[i];do r=r(!0);while(r!==null)}rs=null,tf=!1}catch(n){throw rs!==null&&(rs=rs.slice(i+1)),Zx(F0,ma),n}finally{mt=e,Ap=!1}}return null}var To=[],Co=0,Qh=null,Zh=0,qr=[],Jr=0,Ua=null,os=1,ls="";function Sa(i,e){To[Co++]=Zh,To[Co++]=Qh,Qh=i,Zh=e}function Pk(i,e,t){qr[Jr++]=os,qr[Jr++]=ls,qr[Jr++]=Ua,Ua=i;var r=os;i=ls;var n=32-Cn(r)-1;r&=~(1<<n),t+=1;var s=32-Cn(e)+n;if(30<s){var a=n-n%5;s=(r&(1<<a)-1).toString(32),r>>=a,n-=a,os=1<<32-Cn(e)+n|t<<n|r,ls=s+i}else os=1<<s|t<<n|r,ls=i}function j0(i){i.return!==null&&(Sa(i,1),Pk(i,1,0))}function Y0(i){for(;i===Qh;)Qh=To[--Co],To[Co]=null,Zh=To[--Co],To[Co]=null;for(;i===Ua;)Ua=qr[--Jr],qr[Jr]=null,ls=qr[--Jr],qr[Jr]=null,os=qr[--Jr],qr[Jr]=null}var Lr=null,Mr=null,Ht=!1,bn=null;function Rk(i,e){var t=en(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=i,e=i.deletions,e===null?(i.deletions=[t],i.flags|=16):e.push(t)}function Hb(i,e){switch(i.tag){case 5:var t=i.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(i.stateNode=e,Lr=i,Mr=Ks(e.firstChild),!0):!1;case 6:return e=i.pendingProps===""||e.nodeType!==3?null:e,e!==null?(i.stateNode=e,Lr=i,Mr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Ua!==null?{id:os,overflow:ls}:null,i.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=en(18,null,null,0),t.stateNode=e,t.return=i,i.child=t,Lr=i,Mr=null,!0):!1;default:return!1}}function ym(i){return(i.mode&1)!==0&&(i.flags&128)===0}function bm(i){if(Ht){var e=Mr;if(e){var t=e;if(!Hb(i,e)){if(ym(i))throw Error(X(418));e=Ks(t.nextSibling);var r=Lr;e&&Hb(i,e)?Rk(r,t):(i.flags=i.flags&-4097|2,Ht=!1,Lr=i)}}else{if(ym(i))throw Error(X(418));i.flags=i.flags&-4097|2,Ht=!1,Lr=i}}}function zb(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;Lr=i}function Dc(i){if(i!==Lr)return!1;if(!Ht)return zb(i),Ht=!0,!1;var e;if((e=i.tag!==3)&&!(e=i.tag!==5)&&(e=i.type,e=e!=="head"&&e!=="body"&&!fm(i.type,i.memoizedProps)),e&&(e=Mr)){if(ym(i))throw Ek(),Error(X(418));for(;e;)Rk(i,e),e=Ks(e.nextSibling)}if(zb(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(X(317));e:{for(i=i.nextSibling,e=0;i;){if(i.nodeType===8){var t=i.data;if(t==="/$"){if(e===0){Mr=Ks(i.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}i=i.nextSibling}Mr=null}}else Mr=Lr?Ks(i.stateNode.nextSibling):null;return!0}function Ek(){for(var i=Mr;i;)i=Ks(i.nextSibling)}function jo(){Mr=Lr=null,Ht=!1}function X0(i){bn===null?bn=[i]:bn.push(i)}var cR=Ns.ReactCurrentBatchConfig;function gn(i,e){if(i&&i.defaultProps){e=Xt({},e),i=i.defaultProps;for(var t in i)e[t]===void 0&&(e[t]=i[t]);return e}return e}var ed=ga(null),td=null,No=null,K0=null;function q0(){K0=No=td=null}function J0(i){var e=ed.current;Et(ed),i._currentValue=e}function vm(i,e,t){for(;i!==null;){var r=i.alternate;if((i.childLanes&e)!==e?(i.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),i===t)break;i=i.return}}function Ao(i,e){td=i,K0=No=null,i=i.dependencies,i!==null&&i.firstContext!==null&&(i.lanes&e&&(fr=!0),i.firstContext=null)}function sn(i){var e=i._currentValue;if(K0!==i)if(i={context:i,memoizedValue:e,next:null},No===null){if(td===null)throw Error(X(308));No=i,td.dependencies={lanes:0,firstContext:i}}else No=No.next=i;return e}var _a=null;function Q0(i){_a===null?_a=[i]:_a.push(i)}function Mk(i,e,t,r){var n=e.interleaved;return n===null?(t.next=t,Q0(e)):(t.next=n.next,n.next=t),e.interleaved=t,bs(i,r)}function bs(i,e){i.lanes|=e;var t=i.alternate;for(t!==null&&(t.lanes|=e),t=i,i=i.return;i!==null;)i.childLanes|=e,t=i.alternate,t!==null&&(t.childLanes|=e),t=i,i=i.return;return t.tag===3?t.stateNode:null}var Vs=!1;function Z0(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ok(i,e){i=i.updateQueue,e.updateQueue===i&&(e.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function ds(i,e){return{eventTime:i,lane:e,tag:0,payload:null,callback:null,next:null}}function qs(i,e,t){var r=i.updateQueue;if(r===null)return null;if(r=r.shared,at&2){var n=r.pending;return n===null?e.next=e:(e.next=n.next,n.next=e),r.pending=e,bs(i,t)}return n=r.interleaved,n===null?(e.next=e,Q0(r)):(e.next=n.next,n.next=e),r.interleaved=e,bs(i,t)}function xh(i,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=i.pendingLanes,t|=r,e.lanes=t,A0(i,t)}}function Ub(i,e){var t=i.updateQueue,r=i.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var n=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var a={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?n=s=a:s=s.next=a,t=t.next}while(t!==null);s===null?n=s=e:s=s.next=e}else n=s=e;t={baseState:r.baseState,firstBaseUpdate:n,lastBaseUpdate:s,shared:r.shared,effects:r.effects},i.updateQueue=t;return}i=t.lastBaseUpdate,i===null?t.firstBaseUpdate=e:i.next=e,t.lastBaseUpdate=e}function id(i,e,t,r){var n=i.updateQueue;Vs=!1;var s=n.firstBaseUpdate,a=n.lastBaseUpdate,o=n.shared.pending;if(o!==null){n.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?s=u:a.next=u,a=l;var c=i.alternate;c!==null&&(c=c.updateQueue,o=c.lastBaseUpdate,o!==a&&(o===null?c.firstBaseUpdate=u:o.next=u,c.lastBaseUpdate=l))}if(s!==null){var h=n.baseState;a=0,c=u=l=null,o=s;do{var d=o.lane,f=o.eventTime;if((r&d)===d){c!==null&&(c=c.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=i,g=o;switch(d=e,f=t,g.tag){case 1:if(p=g.payload,typeof p=="function"){h=p.call(f,h,d);break e}h=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=g.payload,d=typeof p=="function"?p.call(f,h,d):p,d==null)break e;h=Xt({},h,d);break e;case 2:Vs=!0}}o.callback!==null&&o.lane!==0&&(i.flags|=64,d=n.effects,d===null?n.effects=[o]:d.push(o))}else f={eventTime:f,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},c===null?(u=c=f,l=h):c=c.next=f,a|=d;if(o=o.next,o===null){if(o=n.shared.pending,o===null)break;d=o,o=d.next,d.next=null,n.lastBaseUpdate=d,n.shared.pending=null}}while(!0);if(c===null&&(l=h),n.baseState=l,n.firstBaseUpdate=u,n.lastBaseUpdate=c,e=n.shared.interleaved,e!==null){n=e;do a|=n.lane,n=n.next;while(n!==e)}else s===null&&(n.shared.lanes=0);Ga|=a,i.lanes=a,i.memoizedState=h}}function Wb(i,e,t){if(i=e.effects,e.effects=null,i!==null)for(e=0;e<i.length;e++){var r=i[e],n=r.callback;if(n!==null){if(r.callback=null,r=t,typeof n!="function")throw Error(X(191,n));n.call(r)}}}var Ik=new Mx.Component().refs;function wm(i,e,t,r){e=i.memoizedState,t=t(r,e),t=t==null?e:Xt({},e,t),i.memoizedState=t,i.lanes===0&&(i.updateQueue.baseState=t)}var rf={isMounted:function(i){return(i=i._reactInternals)?eo(i)===i:!1},enqueueSetState:function(i,e,t){i=i._reactInternals;var r=er(),n=Qs(i),s=ds(r,n);s.payload=e,t!=null&&(s.callback=t),e=qs(i,s,n),e!==null&&(Nn(e,i,n,r),xh(e,i,n))},enqueueReplaceState:function(i,e,t){i=i._reactInternals;var r=er(),n=Qs(i),s=ds(r,n);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=qs(i,s,n),e!==null&&(Nn(e,i,n,r),xh(e,i,n))},enqueueForceUpdate:function(i,e){i=i._reactInternals;var t=er(),r=Qs(i),n=ds(t,r);n.tag=2,e!=null&&(n.callback=e),e=qs(i,n,r),e!==null&&(Nn(e,i,r,t),xh(e,i,r))}};function Gb(i,e,t,r,n,s,a){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(r,s,a):e.prototype&&e.prototype.isPureReactComponent?!bu(t,r)||!bu(n,s):!0}function Lk(i,e,t){var r=!1,n=aa,s=e.contextType;return typeof s=="object"&&s!==null?s=sn(s):(n=mr(e)?za:Yi.current,r=e.contextTypes,s=(r=r!=null)?$o(i,n):aa),e=new e(t,s),i.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=rf,i.stateNode=e,e._reactInternals=i,r&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=n,i.__reactInternalMemoizedMaskedChildContext=s),e}function $b(i,e,t,r){i=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==i&&rf.enqueueReplaceState(e,e.state,null)}function Sm(i,e,t,r){var n=i.stateNode;n.props=t,n.state=i.memoizedState,n.refs=Ik,Z0(i);var s=e.contextType;typeof s=="object"&&s!==null?n.context=sn(s):(s=mr(e)?za:Yi.current,n.context=$o(i,s)),n.state=i.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(wm(i,e,s,t),n.state=i.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(e=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),e!==n.state&&rf.enqueueReplaceState(n,n.state,null),id(i,t,n,r),n.state=i.memoizedState),typeof n.componentDidMount=="function"&&(i.flags|=4194308)}function _l(i,e,t){if(i=t.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(X(309));var r=t.stateNode}if(!r)throw Error(X(147,i));var n=r,s=""+i;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=n.refs;o===Ik&&(o=n.refs={}),a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof i!="string")throw Error(X(284));if(!t._owner)throw Error(X(290,i))}return i}function Fc(i,e){throw i=Object.prototype.toString.call(e),Error(X(31,i==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":i))}function jb(i){var e=i._init;return e(i._payload)}function Dk(i){function e(b,m){if(i){var v=b.deletions;v===null?(b.deletions=[m],b.flags|=16):v.push(m)}}function t(b,m){if(!i)return null;for(;m!==null;)e(b,m),m=m.sibling;return null}function r(b,m){for(b=new Map;m!==null;)m.key!==null?b.set(m.key,m):b.set(m.index,m),m=m.sibling;return b}function n(b,m){return b=Zs(b,m),b.index=0,b.sibling=null,b}function s(b,m,v){return b.index=v,i?(v=b.alternate,v!==null?(v=v.index,v<m?(b.flags|=2,m):v):(b.flags|=2,m)):(b.flags|=1048576,m)}function a(b){return i&&b.alternate===null&&(b.flags|=2),b}function o(b,m,v,k){return m===null||m.tag!==6?(m=$p(v,b.mode,k),m.return=b,m):(m=n(m,v),m.return=b,m)}function l(b,m,v,k){var x=v.type;return x===bo?c(b,m,v.props.children,k,v.key):m!==null&&(m.elementType===x||typeof x=="object"&&x!==null&&x.$$typeof===As&&jb(x)===m.type)?(k=n(m,v.props),k.ref=_l(b,m,v),k.return=b,k):(k=_h(v.type,v.key,v.props,null,b.mode,k),k.ref=_l(b,m,v),k.return=b,k)}function u(b,m,v,k){return m===null||m.tag!==4||m.stateNode.containerInfo!==v.containerInfo||m.stateNode.implementation!==v.implementation?(m=jp(v,b.mode,k),m.return=b,m):(m=n(m,v.children||[]),m.return=b,m)}function c(b,m,v,k,x){return m===null||m.tag!==7?(m=Da(v,b.mode,k,x),m.return=b,m):(m=n(m,v),m.return=b,m)}function h(b,m,v){if(typeof m=="string"&&m!==""||typeof m=="number")return m=$p(""+m,b.mode,v),m.return=b,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Nc:return v=_h(m.type,m.key,m.props,null,b.mode,v),v.ref=_l(b,null,m),v.return=b,v;case yo:return m=jp(m,b.mode,v),m.return=b,m;case As:var k=m._init;return h(b,k(m._payload),v)}if(Dl(m)||kl(m))return m=Da(m,b.mode,v,null),m.return=b,m;Fc(b,m)}return null}function d(b,m,v,k){var x=m!==null?m.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return x!==null?null:o(b,m,""+v,k);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Nc:return v.key===x?l(b,m,v,k):null;case yo:return v.key===x?u(b,m,v,k):null;case As:return x=v._init,d(b,m,x(v._payload),k)}if(Dl(v)||kl(v))return x!==null?null:c(b,m,v,k,null);Fc(b,v)}return null}function f(b,m,v,k,x){if(typeof k=="string"&&k!==""||typeof k=="number")return b=b.get(v)||null,o(m,b,""+k,x);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Nc:return b=b.get(k.key===null?v:k.key)||null,l(m,b,k,x);case yo:return b=b.get(k.key===null?v:k.key)||null,u(m,b,k,x);case As:var C=k._init;return f(b,m,v,C(k._payload),x)}if(Dl(k)||kl(k))return b=b.get(v)||null,c(m,b,k,x,null);Fc(m,k)}return null}function p(b,m,v,k){for(var x=null,C=null,N=m,B=m=0,E=null;N!==null&&B<v.length;B++){N.index>B?(E=N,N=null):E=N.sibling;var O=d(b,N,v[B],k);if(O===null){N===null&&(N=E);break}i&&N&&O.alternate===null&&e(b,N),m=s(O,m,B),C===null?x=O:C.sibling=O,C=O,N=E}if(B===v.length)return t(b,N),Ht&&Sa(b,B),x;if(N===null){for(;B<v.length;B++)N=h(b,v[B],k),N!==null&&(m=s(N,m,B),C===null?x=N:C.sibling=N,C=N);return Ht&&Sa(b,B),x}for(N=r(b,N);B<v.length;B++)E=f(N,b,B,v[B],k),E!==null&&(i&&E.alternate!==null&&N.delete(E.key===null?B:E.key),m=s(E,m,B),C===null?x=E:C.sibling=E,C=E);return i&&N.forEach(function(z){return e(b,z)}),Ht&&Sa(b,B),x}function g(b,m,v,k){var x=kl(v);if(typeof x!="function")throw Error(X(150));if(v=x.call(v),v==null)throw Error(X(151));for(var C=x=null,N=m,B=m=0,E=null,O=v.next();N!==null&&!O.done;B++,O=v.next()){N.index>B?(E=N,N=null):E=N.sibling;var z=d(b,N,O.value,k);if(z===null){N===null&&(N=E);break}i&&N&&z.alternate===null&&e(b,N),m=s(z,m,B),C===null?x=z:C.sibling=z,C=z,N=E}if(O.done)return t(b,N),Ht&&Sa(b,B),x;if(N===null){for(;!O.done;B++,O=v.next())O=h(b,O.value,k),O!==null&&(m=s(O,m,B),C===null?x=O:C.sibling=O,C=O);return Ht&&Sa(b,B),x}for(N=r(b,N);!O.done;B++,O=v.next())O=f(N,b,B,O.value,k),O!==null&&(i&&O.alternate!==null&&N.delete(O.key===null?B:O.key),m=s(O,m,B),C===null?x=O:C.sibling=O,C=O);return i&&N.forEach(function(J){return e(b,J)}),Ht&&Sa(b,B),x}function y(b,m,v,k){if(typeof v=="object"&&v!==null&&v.type===bo&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case Nc:e:{for(var x=v.key,C=m;C!==null;){if(C.key===x){if(x=v.type,x===bo){if(C.tag===7){t(b,C.sibling),m=n(C,v.props.children),m.return=b,b=m;break e}}else if(C.elementType===x||typeof x=="object"&&x!==null&&x.$$typeof===As&&jb(x)===C.type){t(b,C.sibling),m=n(C,v.props),m.ref=_l(b,C,v),m.return=b,b=m;break e}t(b,C);break}else e(b,C);C=C.sibling}v.type===bo?(m=Da(v.props.children,b.mode,k,v.key),m.return=b,b=m):(k=_h(v.type,v.key,v.props,null,b.mode,k),k.ref=_l(b,m,v),k.return=b,b=k)}return a(b);case yo:e:{for(C=v.key;m!==null;){if(m.key===C)if(m.tag===4&&m.stateNode.containerInfo===v.containerInfo&&m.stateNode.implementation===v.implementation){t(b,m.sibling),m=n(m,v.children||[]),m.return=b,b=m;break e}else{t(b,m);break}else e(b,m);m=m.sibling}m=jp(v,b.mode,k),m.return=b,b=m}return a(b);case As:return C=v._init,y(b,m,C(v._payload),k)}if(Dl(v))return p(b,m,v,k);if(kl(v))return g(b,m,v,k);Fc(b,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,m!==null&&m.tag===6?(t(b,m.sibling),m=n(m,v),m.return=b,b=m):(t(b,m),m=$p(v,b.mode,k),m.return=b,b=m),a(b)):t(b,m)}return y}var Yo=Dk(!0),Fk=Dk(!1),sc={},Kn=ga(sc),xu=ga(sc),ku=ga(sc);function Pa(i){if(i===sc)throw Error(X(174));return i}function ey(i,e){switch(Bt(ku,e),Bt(xu,i),Bt(Kn,sc),i=e.nodeType,i){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Zg(null,"");break;default:i=i===8?e.parentNode:e,e=i.namespaceURI||null,i=i.tagName,e=Zg(e,i)}Et(Kn),Bt(Kn,e)}function Xo(){Et(Kn),Et(xu),Et(ku)}function Ak(i){Pa(ku.current);var e=Pa(Kn.current),t=Zg(e,i.type);e!==t&&(Bt(xu,i),Bt(Kn,t))}function ty(i){xu.current===i&&(Et(Kn),Et(xu))}var Gt=ga(0);function rd(i){for(var e=i;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===i)break;for(;e.sibling===null;){if(e.return===null||e.return===i)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Vp=[];function iy(){for(var i=0;i<Vp.length;i++)Vp[i]._workInProgressVersionPrimary=null;Vp.length=0}var kh=Ns.ReactCurrentDispatcher,Hp=Ns.ReactCurrentBatchConfig,Wa=0,Yt=null,bi=null,Ni=null,nd=!1,Kl=!1,Tu=0,hR=0;function Ui(){throw Error(X(321))}function ry(i,e){if(e===null)return!1;for(var t=0;t<e.length&&t<i.length;t++)if(!_n(i[t],e[t]))return!1;return!0}function ny(i,e,t,r,n,s){if(Wa=s,Yt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,kh.current=i===null||i.memoizedState===null?gR:mR,i=t(r,n),Kl){s=0;do{if(Kl=!1,Tu=0,25<=s)throw Error(X(301));s+=1,Ni=bi=null,e.updateQueue=null,kh.current=yR,i=t(r,n)}while(Kl)}if(kh.current=sd,e=bi!==null&&bi.next!==null,Wa=0,Ni=bi=Yt=null,nd=!1,e)throw Error(X(300));return i}function sy(){var i=Tu!==0;return Tu=0,i}function An(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ni===null?Yt.memoizedState=Ni=i:Ni=Ni.next=i,Ni}function an(){if(bi===null){var i=Yt.alternate;i=i!==null?i.memoizedState:null}else i=bi.next;var e=Ni===null?Yt.memoizedState:Ni.next;if(e!==null)Ni=e,bi=i;else{if(i===null)throw Error(X(310));bi=i,i={memoizedState:bi.memoizedState,baseState:bi.baseState,baseQueue:bi.baseQueue,queue:bi.queue,next:null},Ni===null?Yt.memoizedState=Ni=i:Ni=Ni.next=i}return Ni}function Cu(i,e){return typeof e=="function"?e(i):e}function zp(i){var e=an(),t=e.queue;if(t===null)throw Error(X(311));t.lastRenderedReducer=i;var r=bi,n=r.baseQueue,s=t.pending;if(s!==null){if(n!==null){var a=n.next;n.next=s.next,s.next=a}r.baseQueue=n=s,t.pending=null}if(n!==null){s=n.next,r=r.baseState;var o=a=null,l=null,u=s;do{var c=u.lane;if((Wa&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:i(r,u.action);else{var h={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=h,a=r):l=l.next=h,Yt.lanes|=c,Ga|=c}u=u.next}while(u!==null&&u!==s);l===null?a=r:l.next=o,_n(r,e.memoizedState)||(fr=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=l,t.lastRenderedState=r}if(i=t.interleaved,i!==null){n=i;do s=n.lane,Yt.lanes|=s,Ga|=s,n=n.next;while(n!==i)}else n===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function Up(i){var e=an(),t=e.queue;if(t===null)throw Error(X(311));t.lastRenderedReducer=i;var r=t.dispatch,n=t.pending,s=e.memoizedState;if(n!==null){t.pending=null;var a=n=n.next;do s=i(s,a.action),a=a.next;while(a!==n);_n(s,e.memoizedState)||(fr=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,r]}function Vk(){}function Hk(i,e){var t=Yt,r=an(),n=e(),s=!_n(r.memoizedState,n);if(s&&(r.memoizedState=n,fr=!0),r=r.queue,ay(Wk.bind(null,t,r,i),[i]),r.getSnapshot!==e||s||Ni!==null&&Ni.memoizedState.tag&1){if(t.flags|=2048,Nu(9,Uk.bind(null,t,r,n,e),void 0,null),Pi===null)throw Error(X(349));Wa&30||zk(t,e,n)}return n}function zk(i,e,t){i.flags|=16384,i={getSnapshot:e,value:t},e=Yt.updateQueue,e===null?(e={lastEffect:null,stores:null},Yt.updateQueue=e,e.stores=[i]):(t=e.stores,t===null?e.stores=[i]:t.push(i))}function Uk(i,e,t,r){e.value=t,e.getSnapshot=r,Gk(e)&&$k(i)}function Wk(i,e,t){return t(function(){Gk(e)&&$k(i)})}function Gk(i){var e=i.getSnapshot;i=i.value;try{var t=e();return!_n(i,t)}catch{return!0}}function $k(i){var e=bs(i,1);e!==null&&Nn(e,i,1,-1)}function Yb(i){var e=An();return typeof i=="function"&&(i=i()),e.memoizedState=e.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Cu,lastRenderedState:i},e.queue=i,i=i.dispatch=pR.bind(null,Yt,i),[e.memoizedState,i]}function Nu(i,e,t,r){return i={tag:i,create:e,destroy:t,deps:r,next:null},e=Yt.updateQueue,e===null?(e={lastEffect:null,stores:null},Yt.updateQueue=e,e.lastEffect=i.next=i):(t=e.lastEffect,t===null?e.lastEffect=i.next=i:(r=t.next,t.next=i,i.next=r,e.lastEffect=i)),i}function jk(){return an().memoizedState}function Th(i,e,t,r){var n=An();Yt.flags|=i,n.memoizedState=Nu(1|e,t,void 0,r===void 0?null:r)}function nf(i,e,t,r){var n=an();r=r===void 0?null:r;var s=void 0;if(bi!==null){var a=bi.memoizedState;if(s=a.destroy,r!==null&&ry(r,a.deps)){n.memoizedState=Nu(e,t,s,r);return}}Yt.flags|=i,n.memoizedState=Nu(1|e,t,s,r)}function Xb(i,e){return Th(8390656,8,i,e)}function ay(i,e){return nf(2048,8,i,e)}function Yk(i,e){return nf(4,2,i,e)}function Xk(i,e){return nf(4,4,i,e)}function Kk(i,e){if(typeof e=="function")return i=i(),e(i),function(){e(null)};if(e!=null)return i=i(),e.current=i,function(){e.current=null}}function qk(i,e,t){return t=t!=null?t.concat([i]):null,nf(4,4,Kk.bind(null,e,i),t)}function oy(){}function Jk(i,e){var t=an();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&ry(e,r[1])?r[0]:(t.memoizedState=[i,e],i)}function Qk(i,e){var t=an();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&ry(e,r[1])?r[0]:(i=i(),t.memoizedState=[i,e],i)}function Zk(i,e,t){return Wa&21?(_n(t,e)||(t=ik(),Yt.lanes|=t,Ga|=t,i.baseState=!0),e):(i.baseState&&(i.baseState=!1,fr=!0),i.memoizedState=t)}function dR(i,e){var t=mt;mt=t!==0&&4>t?t:4,i(!0);var r=Hp.transition;Hp.transition={};try{i(!1),e()}finally{mt=t,Hp.transition=r}}function eT(){return an().memoizedState}function fR(i,e,t){var r=Qs(i);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},tT(i))iT(e,t);else if(t=Mk(i,e,t,r),t!==null){var n=er();Nn(t,i,r,n),rT(t,e,r)}}function pR(i,e,t){var r=Qs(i),n={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(tT(i))iT(e,n);else{var s=i.alternate;if(i.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,t);if(n.hasEagerState=!0,n.eagerState=o,_n(o,a)){var l=e.interleaved;l===null?(n.next=n,Q0(e)):(n.next=l.next,l.next=n),e.interleaved=n;return}}catch{}finally{}t=Mk(i,e,n,r),t!==null&&(n=er(),Nn(t,i,r,n),rT(t,e,r))}}function tT(i){var e=i.alternate;return i===Yt||e!==null&&e===Yt}function iT(i,e){Kl=nd=!0;var t=i.pending;t===null?e.next=e:(e.next=t.next,t.next=e),i.pending=e}function rT(i,e,t){if(t&4194240){var r=e.lanes;r&=i.pendingLanes,t|=r,e.lanes=t,A0(i,t)}}var sd={readContext:sn,useCallback:Ui,useContext:Ui,useEffect:Ui,useImperativeHandle:Ui,useInsertionEffect:Ui,useLayoutEffect:Ui,useMemo:Ui,useReducer:Ui,useRef:Ui,useState:Ui,useDebugValue:Ui,useDeferredValue:Ui,useTransition:Ui,useMutableSource:Ui,useSyncExternalStore:Ui,useId:Ui,unstable_isNewReconciler:!1},gR={readContext:sn,useCallback:function(i,e){return An().memoizedState=[i,e===void 0?null:e],i},useContext:sn,useEffect:Xb,useImperativeHandle:function(i,e,t){return t=t!=null?t.concat([i]):null,Th(4194308,4,Kk.bind(null,e,i),t)},useLayoutEffect:function(i,e){return Th(4194308,4,i,e)},useInsertionEffect:function(i,e){return Th(4,2,i,e)},useMemo:function(i,e){var t=An();return e=e===void 0?null:e,i=i(),t.memoizedState=[i,e],i},useReducer:function(i,e,t){var r=An();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:e},r.queue=i,i=i.dispatch=fR.bind(null,Yt,i),[r.memoizedState,i]},useRef:function(i){var e=An();return i={current:i},e.memoizedState=i},useState:Yb,useDebugValue:oy,useDeferredValue:function(i){return An().memoizedState=i},useTransition:function(){var i=Yb(!1),e=i[0];return i=dR.bind(null,i[1]),An().memoizedState=i,[e,i]},useMutableSource:function(){},useSyncExternalStore:function(i,e,t){var r=Yt,n=An();if(Ht){if(t===void 0)throw Error(X(407));t=t()}else{if(t=e(),Pi===null)throw Error(X(349));Wa&30||zk(r,e,t)}n.memoizedState=t;var s={value:t,getSnapshot:e};return n.queue=s,Xb(Wk.bind(null,r,s,i),[i]),r.flags|=2048,Nu(9,Uk.bind(null,r,s,t,e),void 0,null),t},useId:function(){var i=An(),e=Pi.identifierPrefix;if(Ht){var t=ls,r=os;t=(r&~(1<<32-Cn(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=Tu++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=hR++,e=":"+e+"r"+t.toString(32)+":";return i.memoizedState=e},unstable_isNewReconciler:!1},mR={readContext:sn,useCallback:Jk,useContext:sn,useEffect:ay,useImperativeHandle:qk,useInsertionEffect:Yk,useLayoutEffect:Xk,useMemo:Qk,useReducer:zp,useRef:jk,useState:function(){return zp(Cu)},useDebugValue:oy,useDeferredValue:function(i){var e=an();return Zk(e,bi.memoizedState,i)},useTransition:function(){var i=zp(Cu)[0],e=an().memoizedState;return[i,e]},useMutableSource:Vk,useSyncExternalStore:Hk,useId:eT,unstable_isNewReconciler:!1},yR={readContext:sn,useCallback:Jk,useContext:sn,useEffect:ay,useImperativeHandle:qk,useInsertionEffect:Yk,useLayoutEffect:Xk,useMemo:Qk,useReducer:Up,useRef:jk,useState:function(){return Up(Cu)},useDebugValue:oy,useDeferredValue:function(i){var e=an();return bi===null?e.memoizedState=i:Zk(e,bi.memoizedState,i)},useTransition:function(){var i=Up(Cu)[0],e=an().memoizedState;return[i,e]},useMutableSource:Vk,useSyncExternalStore:Hk,useId:eT,unstable_isNewReconciler:!1};function Ko(i,e){try{var t="",r=e;do t+=$_(r),r=r.return;while(r);var n=t}catch(s){n=`
Error generating stack: `+s.message+`
`+s.stack}return{value:i,source:e,stack:n,digest:null}}function Wp(i,e,t){return{value:i,source:null,stack:t??null,digest:e??null}}function xm(i,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var bR=typeof WeakMap=="function"?WeakMap:Map;function nT(i,e,t){t=ds(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){od||(od=!0,Mm=r),xm(i,e)},t}function sT(i,e,t){t=ds(-1,t),t.tag=3;var r=i.type.getDerivedStateFromError;if(typeof r=="function"){var n=e.value;t.payload=function(){return r(n)},t.callback=function(){xm(i,e)}}var s=i.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){xm(i,e),typeof r!="function"&&(Js===null?Js=new Set([this]):Js.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),t}function Kb(i,e,t){var r=i.pingCache;if(r===null){r=i.pingCache=new bR;var n=new Set;r.set(e,n)}else n=r.get(e),n===void 0&&(n=new Set,r.set(e,n));n.has(t)||(n.add(t),i=MR.bind(null,i,e,t),e.then(i,i))}function qb(i){do{var e;if((e=i.tag===13)&&(e=i.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return i;i=i.return}while(i!==null);return null}function Jb(i,e,t,r,n){return i.mode&1?(i.flags|=65536,i.lanes=n,i):(i===e?i.flags|=65536:(i.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=ds(-1,1),e.tag=2,qs(t,e,1))),t.lanes|=1),i)}var vR=Ns.ReactCurrentOwner,fr=!1;function qi(i,e,t,r){e.child=i===null?Fk(e,null,t,r):Yo(e,i.child,t,r)}function Qb(i,e,t,r,n){t=t.render;var s=e.ref;return Ao(e,n),r=ny(i,e,t,r,s,n),t=sy(),i!==null&&!fr?(e.updateQueue=i.updateQueue,e.flags&=-2053,i.lanes&=~n,vs(i,e,n)):(Ht&&t&&j0(e),e.flags|=1,qi(i,e,r,n),e.child)}function Zb(i,e,t,r,n){if(i===null){var s=t.type;return typeof s=="function"&&!gy(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,aT(i,e,s,r,n)):(i=_h(t.type,null,r,e,e.mode,n),i.ref=e.ref,i.return=e,e.child=i)}if(s=i.child,!(i.lanes&n)){var a=s.memoizedProps;if(t=t.compare,t=t!==null?t:bu,t(a,r)&&i.ref===e.ref)return vs(i,e,n)}return e.flags|=1,i=Zs(s,r),i.ref=e.ref,i.return=e,e.child=i}function aT(i,e,t,r,n){if(i!==null){var s=i.memoizedProps;if(bu(s,r)&&i.ref===e.ref)if(fr=!1,e.pendingProps=r=s,(i.lanes&n)!==0)i.flags&131072&&(fr=!0);else return e.lanes=i.lanes,vs(i,e,n)}return km(i,e,t,r,n)}function oT(i,e,t){var r=e.pendingProps,n=r.children,s=i!==null?i.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Bt(_o,Br),Br|=t;else{if(!(t&1073741824))return i=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:i,cachePool:null,transitions:null},e.updateQueue=null,Bt(_o,Br),Br|=i,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:t,Bt(_o,Br),Br|=r}else s!==null?(r=s.baseLanes|t,e.memoizedState=null):r=t,Bt(_o,Br),Br|=r;return qi(i,e,n,t),e.child}function lT(i,e){var t=e.ref;(i===null&&t!==null||i!==null&&i.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function km(i,e,t,r,n){var s=mr(t)?za:Yi.current;return s=$o(e,s),Ao(e,n),t=ny(i,e,t,r,s,n),r=sy(),i!==null&&!fr?(e.updateQueue=i.updateQueue,e.flags&=-2053,i.lanes&=~n,vs(i,e,n)):(Ht&&r&&j0(e),e.flags|=1,qi(i,e,t,n),e.child)}function ev(i,e,t,r,n){if(mr(t)){var s=!0;Jh(e)}else s=!1;if(Ao(e,n),e.stateNode===null)Ch(i,e),Lk(e,t,r),Sm(e,t,r,n),r=!0;else if(i===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,u=t.contextType;typeof u=="object"&&u!==null?u=sn(u):(u=mr(t)?za:Yi.current,u=$o(e,u));var c=t.getDerivedStateFromProps,h=typeof c=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==r||l!==u)&&$b(e,a,r,u),Vs=!1;var d=e.memoizedState;a.state=d,id(e,r,a,n),l=e.memoizedState,o!==r||d!==l||gr.current||Vs?(typeof c=="function"&&(wm(e,t,c,r),l=e.memoizedState),(o=Vs||Gb(e,t,o,r,d,l,u))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),a.props=r,a.state=l,a.context=u,r=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,Ok(i,e),o=e.memoizedProps,u=e.type===e.elementType?o:gn(e.type,o),a.props=u,h=e.pendingProps,d=a.context,l=t.contextType,typeof l=="object"&&l!==null?l=sn(l):(l=mr(t)?za:Yi.current,l=$o(e,l));var f=t.getDerivedStateFromProps;(c=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||d!==l)&&$b(e,a,r,l),Vs=!1,d=e.memoizedState,a.state=d,id(e,r,a,n);var p=e.memoizedState;o!==h||d!==p||gr.current||Vs?(typeof f=="function"&&(wm(e,t,f,r),p=e.memoizedState),(u=Vs||Gb(e,t,u,r,d,p,l)||!1)?(c||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,p,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,p,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===i.memoizedProps&&d===i.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===i.memoizedProps&&d===i.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),a.props=r,a.state=p,a.context=l,r=u):(typeof a.componentDidUpdate!="function"||o===i.memoizedProps&&d===i.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===i.memoizedProps&&d===i.memoizedState||(e.flags|=1024),r=!1)}return Tm(i,e,t,r,s,n)}function Tm(i,e,t,r,n,s){lT(i,e);var a=(e.flags&128)!==0;if(!r&&!a)return n&&Vb(e,t,!1),vs(i,e,s);r=e.stateNode,vR.current=e;var o=a&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,i!==null&&a?(e.child=Yo(e,i.child,null,s),e.child=Yo(e,null,o,s)):qi(i,e,o,s),e.memoizedState=r.state,n&&Vb(e,t,!0),e.child}function uT(i){var e=i.stateNode;e.pendingContext?Ab(i,e.pendingContext,e.pendingContext!==e.context):e.context&&Ab(i,e.context,!1),ey(i,e.containerInfo)}function tv(i,e,t,r,n){return jo(),X0(n),e.flags|=256,qi(i,e,t,r),e.child}var Cm={dehydrated:null,treeContext:null,retryLane:0};function Nm(i){return{baseLanes:i,cachePool:null,transitions:null}}function cT(i,e,t){var r=e.pendingProps,n=Gt.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=i!==null&&i.memoizedState===null?!1:(n&2)!==0),o?(s=!0,e.flags&=-129):(i===null||i.memoizedState!==null)&&(n|=1),Bt(Gt,n&1),i===null)return bm(e),i=e.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?(e.mode&1?i.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,i=r.fallback,s?(r=e.mode,s=e.child,a={mode:"hidden",children:a},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=of(a,r,0,null),i=Da(i,r,t,null),s.return=e,i.return=e,s.sibling=i,e.child=s,e.child.memoizedState=Nm(t),e.memoizedState=Cm,i):ly(e,a));if(n=i.memoizedState,n!==null&&(o=n.dehydrated,o!==null))return wR(i,e,a,r,o,n,t);if(s){s=r.fallback,a=e.mode,n=i.child,o=n.sibling;var l={mode:"hidden",children:r.children};return!(a&1)&&e.child!==n?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Zs(n,l),r.subtreeFlags=n.subtreeFlags&14680064),o!==null?s=Zs(o,s):(s=Da(s,a,t,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,a=i.child.memoizedState,a=a===null?Nm(t):{baseLanes:a.baseLanes|t,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=i.childLanes&~t,e.memoizedState=Cm,r}return s=i.child,i=s.sibling,r=Zs(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,i!==null&&(t=e.deletions,t===null?(e.deletions=[i],e.flags|=16):t.push(i)),e.child=r,e.memoizedState=null,r}function ly(i,e){return e=of({mode:"visible",children:e},i.mode,0,null),e.return=i,i.child=e}function Ac(i,e,t,r){return r!==null&&X0(r),Yo(e,i.child,null,t),i=ly(e,e.pendingProps.children),i.flags|=2,e.memoizedState=null,i}function wR(i,e,t,r,n,s,a){if(t)return e.flags&256?(e.flags&=-257,r=Wp(Error(X(422))),Ac(i,e,a,r)):e.memoizedState!==null?(e.child=i.child,e.flags|=128,null):(s=r.fallback,n=e.mode,r=of({mode:"visible",children:r.children},n,0,null),s=Da(s,n,a,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Yo(e,i.child,null,a),e.child.memoizedState=Nm(a),e.memoizedState=Cm,s);if(!(e.mode&1))return Ac(i,e,a,null);if(n.data==="$!"){if(r=n.nextSibling&&n.nextSibling.dataset,r)var o=r.dgst;return r=o,s=Error(X(419)),r=Wp(s,r,void 0),Ac(i,e,a,r)}if(o=(a&i.childLanes)!==0,fr||o){if(r=Pi,r!==null){switch(a&-a){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(r.suspendedLanes|a)?0:n,n!==0&&n!==s.retryLane&&(s.retryLane=n,bs(i,n),Nn(r,i,n,-1))}return py(),r=Wp(Error(X(421))),Ac(i,e,a,r)}return n.data==="$?"?(e.flags|=128,e.child=i.child,e=OR.bind(null,i),n._reactRetry=e,null):(i=s.treeContext,Mr=Ks(n.nextSibling),Lr=e,Ht=!0,bn=null,i!==null&&(qr[Jr++]=os,qr[Jr++]=ls,qr[Jr++]=Ua,os=i.id,ls=i.overflow,Ua=e),e=ly(e,r.children),e.flags|=4096,e)}function iv(i,e,t){i.lanes|=e;var r=i.alternate;r!==null&&(r.lanes|=e),vm(i.return,e,t)}function Gp(i,e,t,r,n){var s=i.memoizedState;s===null?i.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:n}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=t,s.tailMode=n)}function hT(i,e,t){var r=e.pendingProps,n=r.revealOrder,s=r.tail;if(qi(i,e,r.children,t),r=Gt.current,r&2)r=r&1|2,e.flags|=128;else{if(i!==null&&i.flags&128)e:for(i=e.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&iv(i,t,e);else if(i.tag===19)iv(i,t,e);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break e;for(;i.sibling===null;){if(i.return===null||i.return===e)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}r&=1}if(Bt(Gt,r),!(e.mode&1))e.memoizedState=null;else switch(n){case"forwards":for(t=e.child,n=null;t!==null;)i=t.alternate,i!==null&&rd(i)===null&&(n=t),t=t.sibling;t=n,t===null?(n=e.child,e.child=null):(n=t.sibling,t.sibling=null),Gp(e,!1,n,t,s);break;case"backwards":for(t=null,n=e.child,e.child=null;n!==null;){if(i=n.alternate,i!==null&&rd(i)===null){e.child=n;break}i=n.sibling,n.sibling=t,t=n,n=i}Gp(e,!0,t,null,s);break;case"together":Gp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ch(i,e){!(e.mode&1)&&i!==null&&(i.alternate=null,e.alternate=null,e.flags|=2)}function vs(i,e,t){if(i!==null&&(e.dependencies=i.dependencies),Ga|=e.lanes,!(t&e.childLanes))return null;if(i!==null&&e.child!==i.child)throw Error(X(153));if(e.child!==null){for(i=e.child,t=Zs(i,i.pendingProps),e.child=t,t.return=e;i.sibling!==null;)i=i.sibling,t=t.sibling=Zs(i,i.pendingProps),t.return=e;t.sibling=null}return e.child}function SR(i,e,t){switch(e.tag){case 3:uT(e),jo();break;case 5:Ak(e);break;case 1:mr(e.type)&&Jh(e);break;case 4:ey(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,n=e.memoizedProps.value;Bt(ed,r._currentValue),r._currentValue=n;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Bt(Gt,Gt.current&1),e.flags|=128,null):t&e.child.childLanes?cT(i,e,t):(Bt(Gt,Gt.current&1),i=vs(i,e,t),i!==null?i.sibling:null);Bt(Gt,Gt.current&1);break;case 19:if(r=(t&e.childLanes)!==0,i.flags&128){if(r)return hT(i,e,t);e.flags|=128}if(n=e.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),Bt(Gt,Gt.current),r)break;return null;case 22:case 23:return e.lanes=0,oT(i,e,t)}return vs(i,e,t)}var dT,Bm,fT,pT;dT=function(i,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)i.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};Bm=function(){};fT=function(i,e,t,r){var n=i.memoizedProps;if(n!==r){i=e.stateNode,Pa(Kn.current);var s=null;switch(t){case"input":n=Kg(i,n),r=Kg(i,r),s=[];break;case"select":n=Xt({},n,{value:void 0}),r=Xt({},r,{value:void 0}),s=[];break;case"textarea":n=Qg(i,n),r=Qg(i,r),s=[];break;default:typeof n.onClick!="function"&&typeof r.onClick=="function"&&(i.onclick=Kh)}em(t,r);var a;t=null;for(u in n)if(!r.hasOwnProperty(u)&&n.hasOwnProperty(u)&&n[u]!=null)if(u==="style"){var o=n[u];for(a in o)o.hasOwnProperty(a)&&(t||(t={}),t[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(hu.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(o=n!=null?n[u]:void 0,r.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(t||(t={}),t[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(t||(t={}),t[a]=l[a])}else t||(s||(s=[]),s.push(u,t)),t=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(hu.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Pt("scroll",i),s||o===l||(s=[])):(s=s||[]).push(u,l))}t&&(s=s||[]).push("style",t);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};pT=function(i,e,t,r){t!==r&&(e.flags|=4)};function Pl(i,e){if(!Ht)switch(i.tailMode){case"hidden":e=i.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?i.tail=null:t.sibling=null;break;case"collapsed":t=i.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||i.tail===null?i.tail=null:i.tail.sibling=null:r.sibling=null}}function Wi(i){var e=i.alternate!==null&&i.alternate.child===i.child,t=0,r=0;if(e)for(var n=i.child;n!==null;)t|=n.lanes|n.childLanes,r|=n.subtreeFlags&14680064,r|=n.flags&14680064,n.return=i,n=n.sibling;else for(n=i.child;n!==null;)t|=n.lanes|n.childLanes,r|=n.subtreeFlags,r|=n.flags,n.return=i,n=n.sibling;return i.subtreeFlags|=r,i.childLanes=t,e}function xR(i,e,t){var r=e.pendingProps;switch(Y0(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wi(e),null;case 1:return mr(e.type)&&qh(),Wi(e),null;case 3:return r=e.stateNode,Xo(),Et(gr),Et(Yi),iy(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(i===null||i.child===null)&&(Dc(e)?e.flags|=4:i===null||i.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,bn!==null&&(Lm(bn),bn=null))),Bm(i,e),Wi(e),null;case 5:ty(e);var n=Pa(ku.current);if(t=e.type,i!==null&&e.stateNode!=null)fT(i,e,t,r,n),i.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(X(166));return Wi(e),null}if(i=Pa(Kn.current),Dc(e)){r=e.stateNode,t=e.type;var s=e.memoizedProps;switch(r[Wn]=e,r[Su]=s,i=(e.mode&1)!==0,t){case"dialog":Pt("cancel",r),Pt("close",r);break;case"iframe":case"object":case"embed":Pt("load",r);break;case"video":case"audio":for(n=0;n<Al.length;n++)Pt(Al[n],r);break;case"source":Pt("error",r);break;case"img":case"image":case"link":Pt("error",r),Pt("load",r);break;case"details":Pt("toggle",r);break;case"input":hb(r,s),Pt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Pt("invalid",r);break;case"textarea":fb(r,s),Pt("invalid",r)}em(t,s),n=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?r.textContent!==o&&(s.suppressHydrationWarning!==!0&&Lc(r.textContent,o,i),n=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&Lc(r.textContent,o,i),n=["children",""+o]):hu.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Pt("scroll",r)}switch(t){case"input":Bc(r),db(r,s,!0);break;case"textarea":Bc(r),pb(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Kh)}r=n,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=n.nodeType===9?n:n.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=zx(t)),i==="http://www.w3.org/1999/xhtml"?t==="script"?(i=a.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof r.is=="string"?i=a.createElement(t,{is:r.is}):(i=a.createElement(t),t==="select"&&(a=i,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):i=a.createElementNS(i,t),i[Wn]=e,i[Su]=r,dT(i,e,!1,!1),e.stateNode=i;e:{switch(a=tm(t,r),t){case"dialog":Pt("cancel",i),Pt("close",i),n=r;break;case"iframe":case"object":case"embed":Pt("load",i),n=r;break;case"video":case"audio":for(n=0;n<Al.length;n++)Pt(Al[n],i);n=r;break;case"source":Pt("error",i),n=r;break;case"img":case"image":case"link":Pt("error",i),Pt("load",i),n=r;break;case"details":Pt("toggle",i),n=r;break;case"input":hb(i,r),n=Kg(i,r),Pt("invalid",i);break;case"option":n=r;break;case"select":i._wrapperState={wasMultiple:!!r.multiple},n=Xt({},r,{value:void 0}),Pt("invalid",i);break;case"textarea":fb(i,r),n=Qg(i,r),Pt("invalid",i);break;default:n=r}em(t,n),o=n;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?Gx(i,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Ux(i,l)):s==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&du(i,l):typeof l=="number"&&du(i,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(hu.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Pt("scroll",i):l!=null&&M0(i,s,l,a))}switch(t){case"input":Bc(i),db(i,r,!1);break;case"textarea":Bc(i),pb(i);break;case"option":r.value!=null&&i.setAttribute("value",""+sa(r.value));break;case"select":i.multiple=!!r.multiple,s=r.value,s!=null?Io(i,!!r.multiple,s,!1):r.defaultValue!=null&&Io(i,!!r.multiple,r.defaultValue,!0);break;default:typeof n.onClick=="function"&&(i.onclick=Kh)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Wi(e),null;case 6:if(i&&e.stateNode!=null)pT(i,e,i.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(X(166));if(t=Pa(ku.current),Pa(Kn.current),Dc(e)){if(r=e.stateNode,t=e.memoizedProps,r[Wn]=e,(s=r.nodeValue!==t)&&(i=Lr,i!==null))switch(i.tag){case 3:Lc(r.nodeValue,t,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Lc(r.nodeValue,t,(i.mode&1)!==0)}s&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[Wn]=e,e.stateNode=r}return Wi(e),null;case 13:if(Et(Gt),r=e.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(Ht&&Mr!==null&&e.mode&1&&!(e.flags&128))Ek(),jo(),e.flags|=98560,s=!1;else if(s=Dc(e),r!==null&&r.dehydrated!==null){if(i===null){if(!s)throw Error(X(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(X(317));s[Wn]=e}else jo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Wi(e),s=!1}else bn!==null&&(Lm(bn),bn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(i!==null&&i.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(i===null||Gt.current&1?Si===0&&(Si=3):py())),e.updateQueue!==null&&(e.flags|=4),Wi(e),null);case 4:return Xo(),Bm(i,e),i===null&&vu(e.stateNode.containerInfo),Wi(e),null;case 10:return J0(e.type._context),Wi(e),null;case 17:return mr(e.type)&&qh(),Wi(e),null;case 19:if(Et(Gt),s=e.memoizedState,s===null)return Wi(e),null;if(r=(e.flags&128)!==0,a=s.rendering,a===null)if(r)Pl(s,!1);else{if(Si!==0||i!==null&&i.flags&128)for(i=e.child;i!==null;){if(a=rd(i),a!==null){for(e.flags|=128,Pl(s,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)s=t,i=r,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=i,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,i=a.dependencies,s.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),t=t.sibling;return Bt(Gt,Gt.current&1|2),e.child}i=i.sibling}s.tail!==null&&ii()>qo&&(e.flags|=128,r=!0,Pl(s,!1),e.lanes=4194304)}else{if(!r)if(i=rd(a),i!==null){if(e.flags|=128,r=!0,t=i.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Pl(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!Ht)return Wi(e),null}else 2*ii()-s.renderingStartTime>qo&&t!==1073741824&&(e.flags|=128,r=!0,Pl(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(t=s.last,t!==null?t.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=ii(),e.sibling=null,t=Gt.current,Bt(Gt,r?t&1|2:t&1),e):(Wi(e),null);case 22:case 23:return fy(),r=e.memoizedState!==null,i!==null&&i.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Br&1073741824&&(Wi(e),e.subtreeFlags&6&&(e.flags|=8192)):Wi(e),null;case 24:return null;case 25:return null}throw Error(X(156,e.tag))}function kR(i,e){switch(Y0(e),e.tag){case 1:return mr(e.type)&&qh(),i=e.flags,i&65536?(e.flags=i&-65537|128,e):null;case 3:return Xo(),Et(gr),Et(Yi),iy(),i=e.flags,i&65536&&!(i&128)?(e.flags=i&-65537|128,e):null;case 5:return ty(e),null;case 13:if(Et(Gt),i=e.memoizedState,i!==null&&i.dehydrated!==null){if(e.alternate===null)throw Error(X(340));jo()}return i=e.flags,i&65536?(e.flags=i&-65537|128,e):null;case 19:return Et(Gt),null;case 4:return Xo(),null;case 10:return J0(e.type._context),null;case 22:case 23:return fy(),null;case 24:return null;default:return null}}var Vc=!1,$i=!1,TR=typeof WeakSet=="function"?WeakSet:Set,fe=null;function Bo(i,e){var t=i.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){Jt(i,e,r)}else t.current=null}function _m(i,e,t){try{t()}catch(r){Jt(i,e,r)}}var rv=!1;function CR(i,e){if(hm=jh,i=bk(),$0(i)){if("selectionStart"in i)var t={start:i.selectionStart,end:i.selectionEnd};else e:{t=(t=i.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var n=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var a=0,o=-1,l=-1,u=0,c=0,h=i,d=null;t:for(;;){for(var f;h!==t||n!==0&&h.nodeType!==3||(o=a+n),h!==s||r!==0&&h.nodeType!==3||(l=a+r),h.nodeType===3&&(a+=h.nodeValue.length),(f=h.firstChild)!==null;)d=h,h=f;for(;;){if(h===i)break t;if(d===t&&++u===n&&(o=a),d===s&&++c===r&&(l=a),(f=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=f}t=o===-1||l===-1?null:{start:o,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(dm={focusedElem:i,selectionRange:t},jh=!1,fe=e;fe!==null;)if(e=fe,i=e.child,(e.subtreeFlags&1028)!==0&&i!==null)i.return=e,fe=i;else for(;fe!==null;){e=fe;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var g=p.memoizedProps,y=p.memoizedState,b=e.stateNode,m=b.getSnapshotBeforeUpdate(e.elementType===e.type?g:gn(e.type,g),y);b.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var v=e.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(X(163))}}catch(k){Jt(e,e.return,k)}if(i=e.sibling,i!==null){i.return=e.return,fe=i;break}fe=e.return}return p=rv,rv=!1,p}function ql(i,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var n=r=r.next;do{if((n.tag&i)===i){var s=n.destroy;n.destroy=void 0,s!==void 0&&_m(e,t,s)}n=n.next}while(n!==r)}}function sf(i,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&i)===i){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function Pm(i){var e=i.ref;if(e!==null){var t=i.stateNode;switch(i.tag){case 5:i=t;break;default:i=t}typeof e=="function"?e(i):e.current=i}}function gT(i){var e=i.alternate;e!==null&&(i.alternate=null,gT(e)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(e=i.stateNode,e!==null&&(delete e[Wn],delete e[Su],delete e[gm],delete e[oR],delete e[lR])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function mT(i){return i.tag===5||i.tag===3||i.tag===4}function nv(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||mT(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Rm(i,e,t){var r=i.tag;if(r===5||r===6)i=i.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(i,e):t.insertBefore(i,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(i,t)):(e=t,e.appendChild(i)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=Kh));else if(r!==4&&(i=i.child,i!==null))for(Rm(i,e,t),i=i.sibling;i!==null;)Rm(i,e,t),i=i.sibling}function Em(i,e,t){var r=i.tag;if(r===5||r===6)i=i.stateNode,e?t.insertBefore(i,e):t.appendChild(i);else if(r!==4&&(i=i.child,i!==null))for(Em(i,e,t),i=i.sibling;i!==null;)Em(i,e,t),i=i.sibling}var Oi=null,mn=!1;function Ds(i,e,t){for(t=t.child;t!==null;)yT(i,e,t),t=t.sibling}function yT(i,e,t){if(Xn&&typeof Xn.onCommitFiberUnmount=="function")try{Xn.onCommitFiberUnmount(qd,t)}catch{}switch(t.tag){case 5:$i||Bo(t,e);case 6:var r=Oi,n=mn;Oi=null,Ds(i,e,t),Oi=r,mn=n,Oi!==null&&(mn?(i=Oi,t=t.stateNode,i.nodeType===8?i.parentNode.removeChild(t):i.removeChild(t)):Oi.removeChild(t.stateNode));break;case 18:Oi!==null&&(mn?(i=Oi,t=t.stateNode,i.nodeType===8?Fp(i.parentNode,t):i.nodeType===1&&Fp(i,t),mu(i)):Fp(Oi,t.stateNode));break;case 4:r=Oi,n=mn,Oi=t.stateNode.containerInfo,mn=!0,Ds(i,e,t),Oi=r,mn=n;break;case 0:case 11:case 14:case 15:if(!$i&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){n=r=r.next;do{var s=n,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&_m(t,e,a),n=n.next}while(n!==r)}Ds(i,e,t);break;case 1:if(!$i&&(Bo(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(o){Jt(t,e,o)}Ds(i,e,t);break;case 21:Ds(i,e,t);break;case 22:t.mode&1?($i=(r=$i)||t.memoizedState!==null,Ds(i,e,t),$i=r):Ds(i,e,t);break;default:Ds(i,e,t)}}function sv(i){var e=i.updateQueue;if(e!==null){i.updateQueue=null;var t=i.stateNode;t===null&&(t=i.stateNode=new TR),e.forEach(function(r){var n=IR.bind(null,i,r);t.has(r)||(t.add(r),r.then(n,n))})}}function dn(i,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var n=t[r];try{var s=i,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:Oi=o.stateNode,mn=!1;break e;case 3:Oi=o.stateNode.containerInfo,mn=!0;break e;case 4:Oi=o.stateNode.containerInfo,mn=!0;break e}o=o.return}if(Oi===null)throw Error(X(160));yT(s,a,n),Oi=null,mn=!1;var l=n.alternate;l!==null&&(l.return=null),n.return=null}catch(u){Jt(n,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)bT(e,i),e=e.sibling}function bT(i,e){var t=i.alternate,r=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(dn(e,i),Dn(i),r&4){try{ql(3,i,i.return),sf(3,i)}catch(g){Jt(i,i.return,g)}try{ql(5,i,i.return)}catch(g){Jt(i,i.return,g)}}break;case 1:dn(e,i),Dn(i),r&512&&t!==null&&Bo(t,t.return);break;case 5:if(dn(e,i),Dn(i),r&512&&t!==null&&Bo(t,t.return),i.flags&32){var n=i.stateNode;try{du(n,"")}catch(g){Jt(i,i.return,g)}}if(r&4&&(n=i.stateNode,n!=null)){var s=i.memoizedProps,a=t!==null?t.memoizedProps:s,o=i.type,l=i.updateQueue;if(i.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&Vx(n,s),tm(o,a);var u=tm(o,s);for(a=0;a<l.length;a+=2){var c=l[a],h=l[a+1];c==="style"?Gx(n,h):c==="dangerouslySetInnerHTML"?Ux(n,h):c==="children"?du(n,h):M0(n,c,h,u)}switch(o){case"input":qg(n,s);break;case"textarea":Hx(n,s);break;case"select":var d=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?Io(n,!!s.multiple,f,!1):d!==!!s.multiple&&(s.defaultValue!=null?Io(n,!!s.multiple,s.defaultValue,!0):Io(n,!!s.multiple,s.multiple?[]:"",!1))}n[Su]=s}catch(g){Jt(i,i.return,g)}}break;case 6:if(dn(e,i),Dn(i),r&4){if(i.stateNode===null)throw Error(X(162));n=i.stateNode,s=i.memoizedProps;try{n.nodeValue=s}catch(g){Jt(i,i.return,g)}}break;case 3:if(dn(e,i),Dn(i),r&4&&t!==null&&t.memoizedState.isDehydrated)try{mu(e.containerInfo)}catch(g){Jt(i,i.return,g)}break;case 4:dn(e,i),Dn(i);break;case 13:dn(e,i),Dn(i),n=i.child,n.flags&8192&&(s=n.memoizedState!==null,n.stateNode.isHidden=s,!s||n.alternate!==null&&n.alternate.memoizedState!==null||(hy=ii())),r&4&&sv(i);break;case 22:if(c=t!==null&&t.memoizedState!==null,i.mode&1?($i=(u=$i)||c,dn(e,i),$i=u):dn(e,i),Dn(i),r&8192){if(u=i.memoizedState!==null,(i.stateNode.isHidden=u)&&!c&&i.mode&1)for(fe=i,c=i.child;c!==null;){for(h=fe=c;fe!==null;){switch(d=fe,f=d.child,d.tag){case 0:case 11:case 14:case 15:ql(4,d,d.return);break;case 1:Bo(d,d.return);var p=d.stateNode;if(typeof p.componentWillUnmount=="function"){r=d,t=d.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(g){Jt(r,t,g)}}break;case 5:Bo(d,d.return);break;case 22:if(d.memoizedState!==null){ov(h);continue}}f!==null?(f.return=d,fe=f):ov(h)}c=c.sibling}e:for(c=null,h=i;;){if(h.tag===5){if(c===null){c=h;try{n=h.stateNode,u?(s=n.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,l=h.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=Wx("display",a))}catch(g){Jt(i,i.return,g)}}}else if(h.tag===6){if(c===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){Jt(i,i.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===i)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===i)break e;for(;h.sibling===null;){if(h.return===null||h.return===i)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:dn(e,i),Dn(i),r&4&&sv(i);break;case 21:break;default:dn(e,i),Dn(i)}}function Dn(i){var e=i.flags;if(e&2){try{e:{for(var t=i.return;t!==null;){if(mT(t)){var r=t;break e}t=t.return}throw Error(X(160))}switch(r.tag){case 5:var n=r.stateNode;r.flags&32&&(du(n,""),r.flags&=-33);var s=nv(i);Em(i,s,n);break;case 3:case 4:var a=r.stateNode.containerInfo,o=nv(i);Rm(i,o,a);break;default:throw Error(X(161))}}catch(l){Jt(i,i.return,l)}i.flags&=-3}e&4096&&(i.flags&=-4097)}function NR(i,e,t){fe=i,vT(i)}function vT(i,e,t){for(var r=(i.mode&1)!==0;fe!==null;){var n=fe,s=n.child;if(n.tag===22&&r){var a=n.memoizedState!==null||Vc;if(!a){var o=n.alternate,l=o!==null&&o.memoizedState!==null||$i;o=Vc;var u=$i;if(Vc=a,($i=l)&&!u)for(fe=n;fe!==null;)a=fe,l=a.child,a.tag===22&&a.memoizedState!==null?lv(n):l!==null?(l.return=a,fe=l):lv(n);for(;s!==null;)fe=s,vT(s),s=s.sibling;fe=n,Vc=o,$i=u}av(i)}else n.subtreeFlags&8772&&s!==null?(s.return=n,fe=s):av(i)}}function av(i){for(;fe!==null;){var e=fe;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:$i||sf(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!$i)if(t===null)r.componentDidMount();else{var n=e.elementType===e.type?t.memoizedProps:gn(e.type,t.memoizedProps);r.componentDidUpdate(n,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Wb(e,s,r);break;case 3:var a=e.updateQueue;if(a!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}Wb(e,a,t)}break;case 5:var o=e.stateNode;if(t===null&&e.flags&4){t=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var h=c.dehydrated;h!==null&&mu(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(X(163))}$i||e.flags&512&&Pm(e)}catch(d){Jt(e,e.return,d)}}if(e===i){fe=null;break}if(t=e.sibling,t!==null){t.return=e.return,fe=t;break}fe=e.return}}function ov(i){for(;fe!==null;){var e=fe;if(e===i){fe=null;break}var t=e.sibling;if(t!==null){t.return=e.return,fe=t;break}fe=e.return}}function lv(i){for(;fe!==null;){var e=fe;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{sf(4,e)}catch(l){Jt(e,t,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var n=e.return;try{r.componentDidMount()}catch(l){Jt(e,n,l)}}var s=e.return;try{Pm(e)}catch(l){Jt(e,s,l)}break;case 5:var a=e.return;try{Pm(e)}catch(l){Jt(e,a,l)}}}catch(l){Jt(e,e.return,l)}if(e===i){fe=null;break}var o=e.sibling;if(o!==null){o.return=e.return,fe=o;break}fe=e.return}}var BR=Math.ceil,ad=Ns.ReactCurrentDispatcher,uy=Ns.ReactCurrentOwner,rn=Ns.ReactCurrentBatchConfig,at=0,Pi=null,pi=null,Di=0,Br=0,_o=ga(0),Si=0,Bu=null,Ga=0,af=0,cy=0,Jl=null,lr=null,hy=0,qo=1/0,is=null,od=!1,Mm=null,Js=null,Hc=!1,Gs=null,ld=0,Ql=0,Om=null,Nh=-1,Bh=0;function er(){return at&6?ii():Nh!==-1?Nh:Nh=ii()}function Qs(i){return i.mode&1?at&2&&Di!==0?Di&-Di:cR.transition!==null?(Bh===0&&(Bh=ik()),Bh):(i=mt,i!==0||(i=window.event,i=i===void 0?16:uk(i.type)),i):1}function Nn(i,e,t,r){if(50<Ql)throw Ql=0,Om=null,Error(X(185));ic(i,t,r),(!(at&2)||i!==Pi)&&(i===Pi&&(!(at&2)&&(af|=t),Si===4&&Us(i,Di)),yr(i,r),t===1&&at===0&&!(e.mode&1)&&(qo=ii()+500,tf&&ma()))}function yr(i,e){var t=i.callbackNode;cP(i,e);var r=$h(i,i===Pi?Di:0);if(r===0)t!==null&&yb(t),i.callbackNode=null,i.callbackPriority=0;else if(e=r&-r,i.callbackPriority!==e){if(t!=null&&yb(t),e===1)i.tag===0?uR(uv.bind(null,i)):_k(uv.bind(null,i)),sR(function(){!(at&6)&&ma()}),t=null;else{switch(rk(r)){case 1:t=F0;break;case 4:t=ek;break;case 16:t=Gh;break;case 536870912:t=tk;break;default:t=Gh}t=BT(t,wT.bind(null,i))}i.callbackPriority=e,i.callbackNode=t}}function wT(i,e){if(Nh=-1,Bh=0,at&6)throw Error(X(327));var t=i.callbackNode;if(Vo()&&i.callbackNode!==t)return null;var r=$h(i,i===Pi?Di:0);if(r===0)return null;if(r&30||r&i.expiredLanes||e)e=ud(i,r);else{e=r;var n=at;at|=2;var s=xT();(Pi!==i||Di!==e)&&(is=null,qo=ii()+500,La(i,e));do try{RR();break}catch(o){ST(i,o)}while(!0);q0(),ad.current=s,at=n,pi!==null?e=0:(Pi=null,Di=0,e=Si)}if(e!==0){if(e===2&&(n=am(i),n!==0&&(r=n,e=Im(i,n))),e===1)throw t=Bu,La(i,0),Us(i,r),yr(i,ii()),t;if(e===6)Us(i,r);else{if(n=i.current.alternate,!(r&30)&&!_R(n)&&(e=ud(i,r),e===2&&(s=am(i),s!==0&&(r=s,e=Im(i,s))),e===1))throw t=Bu,La(i,0),Us(i,r),yr(i,ii()),t;switch(i.finishedWork=n,i.finishedLanes=r,e){case 0:case 1:throw Error(X(345));case 2:xa(i,lr,is);break;case 3:if(Us(i,r),(r&130023424)===r&&(e=hy+500-ii(),10<e)){if($h(i,0)!==0)break;if(n=i.suspendedLanes,(n&r)!==r){er(),i.pingedLanes|=i.suspendedLanes&n;break}i.timeoutHandle=pm(xa.bind(null,i,lr,is),e);break}xa(i,lr,is);break;case 4:if(Us(i,r),(r&4194240)===r)break;for(e=i.eventTimes,n=-1;0<r;){var a=31-Cn(r);s=1<<a,a=e[a],a>n&&(n=a),r&=~s}if(r=n,r=ii()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*BR(r/1960))-r,10<r){i.timeoutHandle=pm(xa.bind(null,i,lr,is),r);break}xa(i,lr,is);break;case 5:xa(i,lr,is);break;default:throw Error(X(329))}}}return yr(i,ii()),i.callbackNode===t?wT.bind(null,i):null}function Im(i,e){var t=Jl;return i.current.memoizedState.isDehydrated&&(La(i,e).flags|=256),i=ud(i,e),i!==2&&(e=lr,lr=t,e!==null&&Lm(e)),i}function Lm(i){lr===null?lr=i:lr.push.apply(lr,i)}function _R(i){for(var e=i;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var n=t[r],s=n.getSnapshot;n=n.value;try{if(!_n(s(),n))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===i)break;for(;e.sibling===null;){if(e.return===null||e.return===i)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Us(i,e){for(e&=~cy,e&=~af,i.suspendedLanes|=e,i.pingedLanes&=~e,i=i.expirationTimes;0<e;){var t=31-Cn(e),r=1<<t;i[t]=-1,e&=~r}}function uv(i){if(at&6)throw Error(X(327));Vo();var e=$h(i,0);if(!(e&1))return yr(i,ii()),null;var t=ud(i,e);if(i.tag!==0&&t===2){var r=am(i);r!==0&&(e=r,t=Im(i,r))}if(t===1)throw t=Bu,La(i,0),Us(i,e),yr(i,ii()),t;if(t===6)throw Error(X(345));return i.finishedWork=i.current.alternate,i.finishedLanes=e,xa(i,lr,is),yr(i,ii()),null}function dy(i,e){var t=at;at|=1;try{return i(e)}finally{at=t,at===0&&(qo=ii()+500,tf&&ma())}}function $a(i){Gs!==null&&Gs.tag===0&&!(at&6)&&Vo();var e=at;at|=1;var t=rn.transition,r=mt;try{if(rn.transition=null,mt=1,i)return i()}finally{mt=r,rn.transition=t,at=e,!(at&6)&&ma()}}function fy(){Br=_o.current,Et(_o)}function La(i,e){i.finishedWork=null,i.finishedLanes=0;var t=i.timeoutHandle;if(t!==-1&&(i.timeoutHandle=-1,nR(t)),pi!==null)for(t=pi.return;t!==null;){var r=t;switch(Y0(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&qh();break;case 3:Xo(),Et(gr),Et(Yi),iy();break;case 5:ty(r);break;case 4:Xo();break;case 13:Et(Gt);break;case 19:Et(Gt);break;case 10:J0(r.type._context);break;case 22:case 23:fy()}t=t.return}if(Pi=i,pi=i=Zs(i.current,null),Di=Br=e,Si=0,Bu=null,cy=af=Ga=0,lr=Jl=null,_a!==null){for(e=0;e<_a.length;e++)if(t=_a[e],r=t.interleaved,r!==null){t.interleaved=null;var n=r.next,s=t.pending;if(s!==null){var a=s.next;s.next=n,r.next=a}t.pending=r}_a=null}return i}function ST(i,e){do{var t=pi;try{if(q0(),kh.current=sd,nd){for(var r=Yt.memoizedState;r!==null;){var n=r.queue;n!==null&&(n.pending=null),r=r.next}nd=!1}if(Wa=0,Ni=bi=Yt=null,Kl=!1,Tu=0,uy.current=null,t===null||t.return===null){Si=1,Bu=e,pi=null;break}e:{var s=i,a=t.return,o=t,l=e;if(e=Di,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=o,h=c.tag;if(!(c.mode&1)&&(h===0||h===11||h===15)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var f=qb(a);if(f!==null){f.flags&=-257,Jb(f,a,o,s,e),f.mode&1&&Kb(s,u,e),e=f,l=u;var p=e.updateQueue;if(p===null){var g=new Set;g.add(l),e.updateQueue=g}else p.add(l);break e}else{if(!(e&1)){Kb(s,u,e),py();break e}l=Error(X(426))}}else if(Ht&&o.mode&1){var y=qb(a);if(y!==null){!(y.flags&65536)&&(y.flags|=256),Jb(y,a,o,s,e),X0(Ko(l,o));break e}}s=l=Ko(l,o),Si!==4&&(Si=2),Jl===null?Jl=[s]:Jl.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var b=nT(s,l,e);Ub(s,b);break e;case 1:o=l;var m=s.type,v=s.stateNode;if(!(s.flags&128)&&(typeof m.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Js===null||!Js.has(v)))){s.flags|=65536,e&=-e,s.lanes|=e;var k=sT(s,o,e);Ub(s,k);break e}}s=s.return}while(s!==null)}TT(t)}catch(x){e=x,pi===t&&t!==null&&(pi=t=t.return);continue}break}while(!0)}function xT(){var i=ad.current;return ad.current=sd,i===null?sd:i}function py(){(Si===0||Si===3||Si===2)&&(Si=4),Pi===null||!(Ga&268435455)&&!(af&268435455)||Us(Pi,Di)}function ud(i,e){var t=at;at|=2;var r=xT();(Pi!==i||Di!==e)&&(is=null,La(i,e));do try{PR();break}catch(n){ST(i,n)}while(!0);if(q0(),at=t,ad.current=r,pi!==null)throw Error(X(261));return Pi=null,Di=0,Si}function PR(){for(;pi!==null;)kT(pi)}function RR(){for(;pi!==null&&!tP();)kT(pi)}function kT(i){var e=NT(i.alternate,i,Br);i.memoizedProps=i.pendingProps,e===null?TT(i):pi=e,uy.current=null}function TT(i){var e=i;do{var t=e.alternate;if(i=e.return,e.flags&32768){if(t=kR(t,e),t!==null){t.flags&=32767,pi=t;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Si=6,pi=null;return}}else if(t=xR(t,e,Br),t!==null){pi=t;return}if(e=e.sibling,e!==null){pi=e;return}pi=e=i}while(e!==null);Si===0&&(Si=5)}function xa(i,e,t){var r=mt,n=rn.transition;try{rn.transition=null,mt=1,ER(i,e,t,r)}finally{rn.transition=n,mt=r}return null}function ER(i,e,t,r){do Vo();while(Gs!==null);if(at&6)throw Error(X(327));t=i.finishedWork;var n=i.finishedLanes;if(t===null)return null;if(i.finishedWork=null,i.finishedLanes=0,t===i.current)throw Error(X(177));i.callbackNode=null,i.callbackPriority=0;var s=t.lanes|t.childLanes;if(hP(i,s),i===Pi&&(pi=Pi=null,Di=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Hc||(Hc=!0,BT(Gh,function(){return Vo(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=rn.transition,rn.transition=null;var a=mt;mt=1;var o=at;at|=4,uy.current=null,CR(i,t),bT(t,i),JP(dm),jh=!!hm,dm=hm=null,i.current=t,NR(t),iP(),at=o,mt=a,rn.transition=s}else i.current=t;if(Hc&&(Hc=!1,Gs=i,ld=n),s=i.pendingLanes,s===0&&(Js=null),sP(t.stateNode),yr(i,ii()),e!==null)for(r=i.onRecoverableError,t=0;t<e.length;t++)n=e[t],r(n.value,{componentStack:n.stack,digest:n.digest});if(od)throw od=!1,i=Mm,Mm=null,i;return ld&1&&i.tag!==0&&Vo(),s=i.pendingLanes,s&1?i===Om?Ql++:(Ql=0,Om=i):Ql=0,ma(),null}function Vo(){if(Gs!==null){var i=rk(ld),e=rn.transition,t=mt;try{if(rn.transition=null,mt=16>i?16:i,Gs===null)var r=!1;else{if(i=Gs,Gs=null,ld=0,at&6)throw Error(X(331));var n=at;for(at|=4,fe=i.current;fe!==null;){var s=fe,a=s.child;if(fe.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(fe=u;fe!==null;){var c=fe;switch(c.tag){case 0:case 11:case 15:ql(8,c,s)}var h=c.child;if(h!==null)h.return=c,fe=h;else for(;fe!==null;){c=fe;var d=c.sibling,f=c.return;if(gT(c),c===u){fe=null;break}if(d!==null){d.return=f,fe=d;break}fe=f}}}var p=s.alternate;if(p!==null){var g=p.child;if(g!==null){p.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}fe=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,fe=a;else e:for(;fe!==null;){if(s=fe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:ql(9,s,s.return)}var b=s.sibling;if(b!==null){b.return=s.return,fe=b;break e}fe=s.return}}var m=i.current;for(fe=m;fe!==null;){a=fe;var v=a.child;if(a.subtreeFlags&2064&&v!==null)v.return=a,fe=v;else e:for(a=m;fe!==null;){if(o=fe,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:sf(9,o)}}catch(x){Jt(o,o.return,x)}if(o===a){fe=null;break e}var k=o.sibling;if(k!==null){k.return=o.return,fe=k;break e}fe=o.return}}if(at=n,ma(),Xn&&typeof Xn.onPostCommitFiberRoot=="function")try{Xn.onPostCommitFiberRoot(qd,i)}catch{}r=!0}return r}finally{mt=t,rn.transition=e}}return!1}function cv(i,e,t){e=Ko(t,e),e=nT(i,e,1),i=qs(i,e,1),e=er(),i!==null&&(ic(i,1,e),yr(i,e))}function Jt(i,e,t){if(i.tag===3)cv(i,i,t);else for(;e!==null;){if(e.tag===3){cv(e,i,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Js===null||!Js.has(r))){i=Ko(t,i),i=sT(e,i,1),e=qs(e,i,1),i=er(),e!==null&&(ic(e,1,i),yr(e,i));break}}e=e.return}}function MR(i,e,t){var r=i.pingCache;r!==null&&r.delete(e),e=er(),i.pingedLanes|=i.suspendedLanes&t,Pi===i&&(Di&t)===t&&(Si===4||Si===3&&(Di&130023424)===Di&&500>ii()-hy?La(i,0):cy|=t),yr(i,e)}function CT(i,e){e===0&&(i.mode&1?(e=Rc,Rc<<=1,!(Rc&130023424)&&(Rc=4194304)):e=1);var t=er();i=bs(i,e),i!==null&&(ic(i,e,t),yr(i,t))}function OR(i){var e=i.memoizedState,t=0;e!==null&&(t=e.retryLane),CT(i,t)}function IR(i,e){var t=0;switch(i.tag){case 13:var r=i.stateNode,n=i.memoizedState;n!==null&&(t=n.retryLane);break;case 19:r=i.stateNode;break;default:throw Error(X(314))}r!==null&&r.delete(e),CT(i,t)}var NT;NT=function(i,e,t){if(i!==null)if(i.memoizedProps!==e.pendingProps||gr.current)fr=!0;else{if(!(i.lanes&t)&&!(e.flags&128))return fr=!1,SR(i,e,t);fr=!!(i.flags&131072)}else fr=!1,Ht&&e.flags&1048576&&Pk(e,Zh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Ch(i,e),i=e.pendingProps;var n=$o(e,Yi.current);Ao(e,t),n=ny(null,e,r,i,n,t);var s=sy();return e.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,mr(r)?(s=!0,Jh(e)):s=!1,e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,Z0(e),n.updater=rf,e.stateNode=n,n._reactInternals=e,Sm(e,r,i,t),e=Tm(null,e,r,!0,s,t)):(e.tag=0,Ht&&s&&j0(e),qi(null,e,n,t),e=e.child),e;case 16:r=e.elementType;e:{switch(Ch(i,e),i=e.pendingProps,n=r._init,r=n(r._payload),e.type=r,n=e.tag=DR(r),i=gn(r,i),n){case 0:e=km(null,e,r,i,t);break e;case 1:e=ev(null,e,r,i,t);break e;case 11:e=Qb(null,e,r,i,t);break e;case 14:e=Zb(null,e,r,gn(r.type,i),t);break e}throw Error(X(306,r,""))}return e;case 0:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:gn(r,n),km(i,e,r,n,t);case 1:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:gn(r,n),ev(i,e,r,n,t);case 3:e:{if(uT(e),i===null)throw Error(X(387));r=e.pendingProps,s=e.memoizedState,n=s.element,Ok(i,e),id(e,r,null,t);var a=e.memoizedState;if(r=a.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){n=Ko(Error(X(423)),e),e=tv(i,e,r,t,n);break e}else if(r!==n){n=Ko(Error(X(424)),e),e=tv(i,e,r,t,n);break e}else for(Mr=Ks(e.stateNode.containerInfo.firstChild),Lr=e,Ht=!0,bn=null,t=Fk(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(jo(),r===n){e=vs(i,e,t);break e}qi(i,e,r,t)}e=e.child}return e;case 5:return Ak(e),i===null&&bm(e),r=e.type,n=e.pendingProps,s=i!==null?i.memoizedProps:null,a=n.children,fm(r,n)?a=null:s!==null&&fm(r,s)&&(e.flags|=32),lT(i,e),qi(i,e,a,t),e.child;case 6:return i===null&&bm(e),null;case 13:return cT(i,e,t);case 4:return ey(e,e.stateNode.containerInfo),r=e.pendingProps,i===null?e.child=Yo(e,null,r,t):qi(i,e,r,t),e.child;case 11:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:gn(r,n),Qb(i,e,r,n,t);case 7:return qi(i,e,e.pendingProps,t),e.child;case 8:return qi(i,e,e.pendingProps.children,t),e.child;case 12:return qi(i,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,n=e.pendingProps,s=e.memoizedProps,a=n.value,Bt(ed,r._currentValue),r._currentValue=a,s!==null)if(_n(s.value,a)){if(s.children===n.children&&!gr.current){e=vs(i,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=ds(-1,t&-t),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=t,l=s.alternate,l!==null&&(l.lanes|=t),vm(s.return,t,e),o.lanes|=t;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(X(341));a.lanes|=t,o=a.alternate,o!==null&&(o.lanes|=t),vm(a,t,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}qi(i,e,n.children,t),e=e.child}return e;case 9:return n=e.type,r=e.pendingProps.children,Ao(e,t),n=sn(n),r=r(n),e.flags|=1,qi(i,e,r,t),e.child;case 14:return r=e.type,n=gn(r,e.pendingProps),n=gn(r.type,n),Zb(i,e,r,n,t);case 15:return aT(i,e,e.type,e.pendingProps,t);case 17:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:gn(r,n),Ch(i,e),e.tag=1,mr(r)?(i=!0,Jh(e)):i=!1,Ao(e,t),Lk(e,r,n),Sm(e,r,n,t),Tm(null,e,r,!0,i,t);case 19:return hT(i,e,t);case 22:return oT(i,e,t)}throw Error(X(156,e.tag))};function BT(i,e){return Zx(i,e)}function LR(i,e,t,r){this.tag=i,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function en(i,e,t,r){return new LR(i,e,t,r)}function gy(i){return i=i.prototype,!(!i||!i.isReactComponent)}function DR(i){if(typeof i=="function")return gy(i)?1:0;if(i!=null){if(i=i.$$typeof,i===I0)return 11;if(i===L0)return 14}return 2}function Zs(i,e){var t=i.alternate;return t===null?(t=en(i.tag,e,i.key,i.mode),t.elementType=i.elementType,t.type=i.type,t.stateNode=i.stateNode,t.alternate=i,i.alternate=t):(t.pendingProps=e,t.type=i.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=i.flags&14680064,t.childLanes=i.childLanes,t.lanes=i.lanes,t.child=i.child,t.memoizedProps=i.memoizedProps,t.memoizedState=i.memoizedState,t.updateQueue=i.updateQueue,e=i.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=i.sibling,t.index=i.index,t.ref=i.ref,t}function _h(i,e,t,r,n,s){var a=2;if(r=i,typeof i=="function")gy(i)&&(a=1);else if(typeof i=="string")a=5;else e:switch(i){case bo:return Da(t.children,n,s,e);case O0:a=8,n|=8;break;case $g:return i=en(12,t,e,n|2),i.elementType=$g,i.lanes=s,i;case jg:return i=en(13,t,e,n),i.elementType=jg,i.lanes=s,i;case Yg:return i=en(19,t,e,n),i.elementType=Yg,i.lanes=s,i;case Dx:return of(t,n,s,e);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case Ix:a=10;break e;case Lx:a=9;break e;case I0:a=11;break e;case L0:a=14;break e;case As:a=16,r=null;break e}throw Error(X(130,i==null?i:typeof i,""))}return e=en(a,t,e,n),e.elementType=i,e.type=r,e.lanes=s,e}function Da(i,e,t,r){return i=en(7,i,r,e),i.lanes=t,i}function of(i,e,t,r){return i=en(22,i,r,e),i.elementType=Dx,i.lanes=t,i.stateNode={isHidden:!1},i}function $p(i,e,t){return i=en(6,i,null,e),i.lanes=t,i}function jp(i,e,t){return e=en(4,i.children!==null?i.children:[],i.key,e),e.lanes=t,e.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},e}function FR(i,e,t,r,n){this.tag=e,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Np(0),this.expirationTimes=Np(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Np(0),this.identifierPrefix=r,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function my(i,e,t,r,n,s,a,o,l){return i=new FR(i,e,t,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=en(3,null,null,e),i.current=s,s.stateNode=i,s.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Z0(s),i}function AR(i,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:yo,key:r==null?null:""+r,children:i,containerInfo:e,implementation:t}}function _T(i){if(!i)return aa;i=i._reactInternals;e:{if(eo(i)!==i||i.tag!==1)throw Error(X(170));var e=i;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(mr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(X(171))}if(i.tag===1){var t=i.type;if(mr(t))return Bk(i,t,e)}return e}function PT(i,e,t,r,n,s,a,o,l){return i=my(t,r,!0,i,n,s,a,o,l),i.context=_T(null),t=i.current,r=er(),n=Qs(t),s=ds(r,n),s.callback=e??null,qs(t,s,n),i.current.lanes=n,ic(i,n,r),yr(i,r),i}function lf(i,e,t,r){var n=e.current,s=er(),a=Qs(n);return t=_T(t),e.context===null?e.context=t:e.pendingContext=t,e=ds(s,a),e.payload={element:i},r=r===void 0?null:r,r!==null&&(e.callback=r),i=qs(n,e,a),i!==null&&(Nn(i,n,a,s),xh(i,n,a)),a}function cd(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function hv(i,e){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var t=i.retryLane;i.retryLane=t!==0&&t<e?t:e}}function yy(i,e){hv(i,e),(i=i.alternate)&&hv(i,e)}function VR(){return null}var RT=typeof reportError=="function"?reportError:function(i){console.error(i)};function by(i){this._internalRoot=i}uf.prototype.render=by.prototype.render=function(i){var e=this._internalRoot;if(e===null)throw Error(X(409));lf(i,e,null,null)};uf.prototype.unmount=by.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var e=i.containerInfo;$a(function(){lf(null,i,null,null)}),e[ys]=null}};function uf(i){this._internalRoot=i}uf.prototype.unstable_scheduleHydration=function(i){if(i){var e=ak();i={blockedOn:null,target:i,priority:e};for(var t=0;t<zs.length&&e!==0&&e<zs[t].priority;t++);zs.splice(t,0,i),t===0&&lk(i)}};function vy(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function cf(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function dv(){}function HR(i,e,t,r,n){if(n){if(typeof r=="function"){var s=r;r=function(){var u=cd(a);s.call(u)}}var a=PT(e,r,i,0,null,!1,!1,"",dv);return i._reactRootContainer=a,i[ys]=a.current,vu(i.nodeType===8?i.parentNode:i),$a(),a}for(;n=i.lastChild;)i.removeChild(n);if(typeof r=="function"){var o=r;r=function(){var u=cd(l);o.call(u)}}var l=my(i,0,!1,null,null,!1,!1,"",dv);return i._reactRootContainer=l,i[ys]=l.current,vu(i.nodeType===8?i.parentNode:i),$a(function(){lf(e,l,t,r)}),l}function hf(i,e,t,r,n){var s=t._reactRootContainer;if(s){var a=s;if(typeof n=="function"){var o=n;n=function(){var l=cd(a);o.call(l)}}lf(e,a,i,n)}else a=HR(t,e,i,n,r);return cd(a)}nk=function(i){switch(i.tag){case 3:var e=i.stateNode;if(e.current.memoizedState.isDehydrated){var t=Fl(e.pendingLanes);t!==0&&(A0(e,t|1),yr(e,ii()),!(at&6)&&(qo=ii()+500,ma()))}break;case 13:$a(function(){var r=bs(i,1);if(r!==null){var n=er();Nn(r,i,1,n)}}),yy(i,1)}};V0=function(i){if(i.tag===13){var e=bs(i,134217728);if(e!==null){var t=er();Nn(e,i,134217728,t)}yy(i,134217728)}};sk=function(i){if(i.tag===13){var e=Qs(i),t=bs(i,e);if(t!==null){var r=er();Nn(t,i,e,r)}yy(i,e)}};ak=function(){return mt};ok=function(i,e){var t=mt;try{return mt=i,e()}finally{mt=t}};rm=function(i,e,t){switch(e){case"input":if(qg(i,t),e=t.name,t.type==="radio"&&e!=null){for(t=i;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==i&&r.form===i.form){var n=ef(r);if(!n)throw Error(X(90));Ax(r),qg(r,n)}}}break;case"textarea":Hx(i,t);break;case"select":e=t.value,e!=null&&Io(i,!!t.multiple,e,!1)}};Yx=dy;Xx=$a;var zR={usingClientEntryPoint:!1,Events:[nc,xo,ef,$x,jx,dy]},Rl={findFiberByHostInstance:Ba,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},UR={bundleType:Rl.bundleType,version:Rl.version,rendererPackageName:Rl.rendererPackageName,rendererConfig:Rl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ns.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=Jx(i),i===null?null:i.stateNode},findFiberByHostInstance:Rl.findFiberByHostInstance||VR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zc.isDisabled&&zc.supportsFiber)try{qd=zc.inject(UR),Xn=zc}catch{}}Ur.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zR;Ur.createPortal=function(i,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!vy(e))throw Error(X(200));return AR(i,e,null,t)};Ur.createRoot=function(i,e){if(!vy(i))throw Error(X(299));var t=!1,r="",n=RT;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(n=e.onRecoverableError)),e=my(i,1,!1,null,null,t,!1,r,n),i[ys]=e.current,vu(i.nodeType===8?i.parentNode:i),new by(e)};Ur.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var e=i._reactInternals;if(e===void 0)throw typeof i.render=="function"?Error(X(188)):(i=Object.keys(i).join(","),Error(X(268,i)));return i=Jx(e),i=i===null?null:i.stateNode,i};Ur.flushSync=function(i){return $a(i)};Ur.hydrate=function(i,e,t){if(!cf(e))throw Error(X(200));return hf(null,i,e,!0,t)};Ur.hydrateRoot=function(i,e,t){if(!vy(i))throw Error(X(405));var r=t!=null&&t.hydratedSources||null,n=!1,s="",a=RT;if(t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),e=PT(e,null,i,1,t??null,n,!1,s,a),i[ys]=e.current,vu(i),r)for(i=0;i<r.length;i++)t=r[i],n=t._getVersion,n=n(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,n]:e.mutableSourceEagerHydrationData.push(t,n);return new uf(e)};Ur.render=function(i,e,t){if(!cf(e))throw Error(X(200));return hf(null,i,e,!1,t)};Ur.unmountComponentAtNode=function(i){if(!cf(i))throw Error(X(40));return i._reactRootContainer?($a(function(){hf(null,null,i,!1,function(){i._reactRootContainer=null,i[ys]=null})}),!0):!1};Ur.unstable_batchedUpdates=dy;Ur.unstable_renderSubtreeIntoContainer=function(i,e,t,r){if(!cf(t))throw Error(X(200));if(i==null||i._reactInternals===void 0)throw Error(X(38));return hf(i,e,t,!1,r)};Ur.version="18.2.0-next-9e3b772b8-20220608";function ET(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(ET)}catch(i){console.error(i)}}ET(),Px.exports=Ur;var wn=Px.exports,MT,fv=wn;MT=fv.createRoot,fv.hydrateRoot;var OT={exports:{}},IT={};/**
 * @license React
 * use-sync-external-store-with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ac=S;function WR(i,e){return i===e&&(i!==0||1/i===1/e)||i!==i&&e!==e}var GR=typeof Object.is=="function"?Object.is:WR,$R=ac.useSyncExternalStore,jR=ac.useRef,YR=ac.useEffect,XR=ac.useMemo,KR=ac.useDebugValue;IT.useSyncExternalStoreWithSelector=function(i,e,t,r,n){var s=jR(null);if(s.current===null){var a={hasValue:!1,value:null};s.current=a}else a=s.current;s=XR(function(){function l(f){if(!u){if(u=!0,c=f,f=r(f),n!==void 0&&a.hasValue){var p=a.value;if(n(p,f))return h=p}return h=f}if(p=h,GR(c,f))return p;var g=r(f);return n!==void 0&&n(p,g)?p:(c=f,h=g)}var u=!1,c,h,d=t===void 0?null:t;return[function(){return l(e())},d===null?void 0:function(){return l(d())}]},[e,t,r,n]);var o=$R(i,s[0],s[1]);return YR(function(){a.hasValue=!0,a.value=o},[o]),KR(o),o};OT.exports=IT;var qR=OT.exports,Or="default"in cu?et:cu,pv=Symbol.for("react-redux-context"),gv=typeof globalThis<"u"?globalThis:{};function JR(){if(!Or.createContext)return{};const i=gv[pv]??(gv[pv]=new Map);let e=i.get(Or.createContext);return e||(e=Or.createContext(null),i.set(Or.createContext,e)),e}var oa=JR(),QR=()=>{throw new Error("uSES not initialized!")};function wy(i=oa){return function(){return Or.useContext(i)}}var LT=wy(),DT=QR,ZR=i=>{DT=i},eE=(i,e)=>i===e;function tE(i=oa){const e=i===oa?LT:wy(i),t=(r,n={})=>{const{equalityFn:s=eE,devModeChecks:a={}}=typeof n=="function"?{equalityFn:n}:n,{store:o,subscription:l,getServerState:u,stabilityCheck:c,identityFunctionCheck:h}=e();Or.useRef(!0);const d=Or.useCallback({[r.name](p){return r(p)}}[r.name],[r,c,a.stabilityCheck]),f=DT(l.addNestedSub,o.getState,u||o.getState,d,s);return Or.useDebugValue(f),f};return Object.assign(t,{withTypes:()=>t}),t}var Vr=tE();function iE(i){i()}function rE(){let i=null,e=null;return{clear(){i=null,e=null},notify(){iE(()=>{let t=i;for(;t;)t.callback(),t=t.next})},get(){const t=[];let r=i;for(;r;)t.push(r),r=r.next;return t},subscribe(t){let r=!0;const n=e={callback:t,next:null,prev:e};return n.prev?n.prev.next=n:i=n,function(){!r||i===null||(r=!1,n.next?n.next.prev=n.prev:e=n.prev,n.prev?n.prev.next=n.next:i=n.next)}}}}var mv={notify(){},get:()=>[]};function nE(i,e){let t,r=mv,n=0,s=!1;function a(g){c();const y=r.subscribe(g);let b=!1;return()=>{b||(b=!0,y(),h())}}function o(){r.notify()}function l(){p.onStateChange&&p.onStateChange()}function u(){return s}function c(){n++,t||(t=i.subscribe(l),r=rE())}function h(){n--,t&&n===0&&(t(),t=void 0,r.clear(),r=mv)}function d(){s||(s=!0,c())}function f(){s&&(s=!1,h())}const p={addNestedSub:a,notifyNestedSubs:o,handleChangeWrapper:l,isSubscribed:u,trySubscribe:d,tryUnsubscribe:f,getListeners:()=>r};return p}var sE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",aE=typeof navigator<"u"&&navigator.product==="ReactNative",oE=sE||aE?Or.useLayoutEffect:Or.useEffect;function lE({store:i,context:e,children:t,serverState:r,stabilityCheck:n="once",identityFunctionCheck:s="once"}){const a=Or.useMemo(()=>{const u=nE(i);return{store:i,subscription:u,getServerState:r?()=>r:void 0,stabilityCheck:n,identityFunctionCheck:s}},[i,r,n,s]),o=Or.useMemo(()=>i.getState(),[i]);oE(()=>{const{subscription:u}=a;return u.onStateChange=u.notifyNestedSubs,u.trySubscribe(),o!==i.getState()&&u.notifyNestedSubs(),()=>{u.tryUnsubscribe(),u.onStateChange=void 0}},[a,o]);const l=e||oa;return Or.createElement(l.Provider,{value:a},t)}var uE=lE;function FT(i=oa){const e=i===oa?LT:wy(i),t=()=>{const{store:r}=e();return r};return Object.assign(t,{withTypes:()=>t}),t}var cE=FT();function hE(i=oa){const e=i===oa?cE:FT(i),t=()=>e().dispatch;return Object.assign(t,{withTypes:()=>t}),t}var On=hE();ZR(qR.useSyncExternalStoreWithSelector);function Mi(i){return`Minified Redux error #${i}; visit https://redux.js.org/Errors?code=${i} for the full message or use the non-minified dev environment for full errors. `}var dE=typeof Symbol=="function"&&Symbol.observable||"@@observable",yv=dE,Yp=()=>Math.random().toString(36).substring(7).split("").join("."),fE={INIT:`@@redux/INIT${Yp()}`,REPLACE:`@@redux/REPLACE${Yp()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Yp()}`},hd=fE;function Sy(i){if(typeof i!="object"||i===null)return!1;let e=i;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(i)===e||Object.getPrototypeOf(i)===null}function AT(i,e,t){if(typeof i!="function")throw new Error(Mi(2));if(typeof e=="function"&&typeof t=="function"||typeof t=="function"&&typeof arguments[3]=="function")throw new Error(Mi(0));if(typeof e=="function"&&typeof t>"u"&&(t=e,e=void 0),typeof t<"u"){if(typeof t!="function")throw new Error(Mi(1));return t(AT)(i,e)}let r=i,n=e,s=new Map,a=s,o=0,l=!1;function u(){a===s&&(a=new Map,s.forEach((y,b)=>{a.set(b,y)}))}function c(){if(l)throw new Error(Mi(3));return n}function h(y){if(typeof y!="function")throw new Error(Mi(4));if(l)throw new Error(Mi(5));let b=!0;u();const m=o++;return a.set(m,y),function(){if(b){if(l)throw new Error(Mi(6));b=!1,u(),a.delete(m),s=null}}}function d(y){if(!Sy(y))throw new Error(Mi(7));if(typeof y.type>"u")throw new Error(Mi(8));if(typeof y.type!="string")throw new Error(Mi(17));if(l)throw new Error(Mi(9));try{l=!0,n=r(n,y)}finally{l=!1}return(s=a).forEach(m=>{m()}),y}function f(y){if(typeof y!="function")throw new Error(Mi(10));r=y,d({type:hd.REPLACE})}function p(){const y=h;return{subscribe(b){if(typeof b!="object"||b===null)throw new Error(Mi(11));function m(){const k=b;k.next&&k.next(c())}return m(),{unsubscribe:y(m)}},[yv](){return this}}}return d({type:hd.INIT}),{dispatch:d,subscribe:h,getState:c,replaceReducer:f,[yv]:p}}function pE(i){Object.keys(i).forEach(e=>{const t=i[e];if(typeof t(void 0,{type:hd.INIT})>"u")throw new Error(Mi(12));if(typeof t(void 0,{type:hd.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Mi(13))})}function VT(i){const e=Object.keys(i),t={};for(let s=0;s<e.length;s++){const a=e[s];typeof i[a]=="function"&&(t[a]=i[a])}const r=Object.keys(t);let n;try{pE(t)}catch(s){n=s}return function(a={},o){if(n)throw n;let l=!1;const u={};for(let c=0;c<r.length;c++){const h=r[c],d=t[h],f=a[h],p=d(f,o);if(typeof p>"u")throw o&&o.type,new Error(Mi(14));u[h]=p,l=l||p!==f}return l=l||r.length!==Object.keys(a).length,l?u:a}}function dd(...i){return i.length===0?e=>e:i.length===1?i[0]:i.reduce((e,t)=>(...r)=>e(t(...r)))}function gE(...i){return e=>(t,r)=>{const n=e(t,r);let s=()=>{throw new Error(Mi(15))};const a={getState:n.getState,dispatch:(l,...u)=>s(l,...u)},o=i.map(l=>l(a));return s=dd(...o)(n.dispatch),{...n,dispatch:s}}}function mE(i){return Sy(i)&&"type"in i&&typeof i.type=="string"}var HT=Symbol.for("immer-nothing"),bv=Symbol.for("immer-draftable"),Hr=Symbol.for("immer-state");function Sn(i,...e){throw new Error(`[Immer] minified error nr: ${i}. Full error at: https://bit.ly/3cXEKWf`)}var Jo=Object.getPrototypeOf;function la(i){return!!i&&!!i[Hr]}function ws(i){var e;return i?zT(i)||Array.isArray(i)||!!i[bv]||!!((e=i.constructor)!=null&&e[bv])||ff(i)||pf(i):!1}var yE=Object.prototype.constructor.toString();function zT(i){if(!i||typeof i!="object")return!1;const e=Jo(i);if(e===null)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return t===Object?!0:typeof t=="function"&&Function.toString.call(t)===yE}function fd(i,e){df(i)===0?Reflect.ownKeys(i).forEach(t=>{e(t,i[t],i)}):i.forEach((t,r)=>e(r,t,i))}function df(i){const e=i[Hr];return e?e.type_:Array.isArray(i)?1:ff(i)?2:pf(i)?3:0}function Dm(i,e){return df(i)===2?i.has(e):Object.prototype.hasOwnProperty.call(i,e)}function UT(i,e,t){const r=df(i);r===2?i.set(e,t):r===3?i.add(t):i[e]=t}function bE(i,e){return i===e?i!==0||1/i===1/e:i!==i&&e!==e}function ff(i){return i instanceof Map}function pf(i){return i instanceof Set}function ka(i){return i.copy_||i.base_}function Fm(i,e){if(ff(i))return new Map(i);if(pf(i))return new Set(i);if(Array.isArray(i))return Array.prototype.slice.call(i);const t=zT(i);if(e===!0||e==="class_only"&&!t){const r=Object.getOwnPropertyDescriptors(i);delete r[Hr];let n=Reflect.ownKeys(r);for(let s=0;s<n.length;s++){const a=n[s],o=r[a];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(r[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:i[a]})}return Object.create(Jo(i),r)}else{const r=Jo(i);if(r!==null&&t)return{...i};const n=Object.create(r);return Object.assign(n,i)}}function xy(i,e=!1){return gf(i)||la(i)||!ws(i)||(df(i)>1&&(i.set=i.add=i.clear=i.delete=vE),Object.freeze(i),e&&Object.entries(i).forEach(([t,r])=>xy(r,!0))),i}function vE(){Sn(2)}function gf(i){return Object.isFrozen(i)}var wE={};function ja(i){const e=wE[i];return e||Sn(0,i),e}var _u;function WT(){return _u}function SE(i,e){return{drafts_:[],parent_:i,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function vv(i,e){e&&(ja("Patches"),i.patches_=[],i.inversePatches_=[],i.patchListener_=e)}function Am(i){Vm(i),i.drafts_.forEach(xE),i.drafts_=null}function Vm(i){i===_u&&(_u=i.parent_)}function wv(i){return _u=SE(_u,i)}function xE(i){const e=i[Hr];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function Sv(i,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return i!==void 0&&i!==t?(t[Hr].modified_&&(Am(e),Sn(4)),ws(i)&&(i=pd(e,i),e.parent_||gd(e,i)),e.patches_&&ja("Patches").generateReplacementPatches_(t[Hr].base_,i,e.patches_,e.inversePatches_)):i=pd(e,t,[]),Am(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),i!==HT?i:void 0}function pd(i,e,t){if(gf(e))return e;const r=e[Hr];if(!r)return fd(e,(n,s)=>xv(i,r,e,n,s,t)),e;if(r.scope_!==i)return e;if(!r.modified_)return gd(i,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const n=r.copy_;let s=n,a=!1;r.type_===3&&(s=new Set(n),n.clear(),a=!0),fd(s,(o,l)=>xv(i,r,n,o,l,t,a)),gd(i,n,!1),t&&i.patches_&&ja("Patches").generatePatches_(r,t,i.patches_,i.inversePatches_)}return r.copy_}function xv(i,e,t,r,n,s,a){if(la(n)){const o=s&&e&&e.type_!==3&&!Dm(e.assigned_,r)?s.concat(r):void 0,l=pd(i,n,o);if(UT(t,r,l),la(l))i.canAutoFreeze_=!1;else return}else a&&t.add(n);if(ws(n)&&!gf(n)){if(!i.immer_.autoFreeze_&&i.unfinalizedDrafts_<1)return;pd(i,n),(!e||!e.scope_.parent_)&&typeof r!="symbol"&&Object.prototype.propertyIsEnumerable.call(t,r)&&gd(i,n)}}function gd(i,e,t=!1){!i.parent_&&i.immer_.autoFreeze_&&i.canAutoFreeze_&&xy(e,t)}function kE(i,e){const t=Array.isArray(i),r={type_:t?1:0,scope_:e?e.scope_:WT(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:i,draft_:null,copy_:null,revoke_:null,isManual_:!1};let n=r,s=ky;t&&(n=[r],s=Pu);const{revoke:a,proxy:o}=Proxy.revocable(n,s);return r.draft_=o,r.revoke_=a,o}var ky={get(i,e){if(e===Hr)return i;const t=ka(i);if(!Dm(t,e))return TE(i,t,e);const r=t[e];return i.finalized_||!ws(r)?r:r===Xp(i.base_,e)?(Kp(i),i.copy_[e]=zm(r,i)):r},has(i,e){return e in ka(i)},ownKeys(i){return Reflect.ownKeys(ka(i))},set(i,e,t){const r=GT(ka(i),e);if(r!=null&&r.set)return r.set.call(i.draft_,t),!0;if(!i.modified_){const n=Xp(ka(i),e),s=n==null?void 0:n[Hr];if(s&&s.base_===t)return i.copy_[e]=t,i.assigned_[e]=!1,!0;if(bE(t,n)&&(t!==void 0||Dm(i.base_,e)))return!0;Kp(i),Hm(i)}return i.copy_[e]===t&&(t!==void 0||e in i.copy_)||Number.isNaN(t)&&Number.isNaN(i.copy_[e])||(i.copy_[e]=t,i.assigned_[e]=!0),!0},deleteProperty(i,e){return Xp(i.base_,e)!==void 0||e in i.base_?(i.assigned_[e]=!1,Kp(i),Hm(i)):delete i.assigned_[e],i.copy_&&delete i.copy_[e],!0},getOwnPropertyDescriptor(i,e){const t=ka(i),r=Reflect.getOwnPropertyDescriptor(t,e);return r&&{writable:!0,configurable:i.type_!==1||e!=="length",enumerable:r.enumerable,value:t[e]}},defineProperty(){Sn(11)},getPrototypeOf(i){return Jo(i.base_)},setPrototypeOf(){Sn(12)}},Pu={};fd(ky,(i,e)=>{Pu[i]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Pu.deleteProperty=function(i,e){return Pu.set.call(this,i,e,void 0)};Pu.set=function(i,e,t){return ky.set.call(this,i[0],e,t,i[0])};function Xp(i,e){const t=i[Hr];return(t?ka(t):i)[e]}function TE(i,e,t){var n;const r=GT(e,t);return r?"value"in r?r.value:(n=r.get)==null?void 0:n.call(i.draft_):void 0}function GT(i,e){if(!(e in i))return;let t=Jo(i);for(;t;){const r=Object.getOwnPropertyDescriptor(t,e);if(r)return r;t=Jo(t)}}function Hm(i){i.modified_||(i.modified_=!0,i.parent_&&Hm(i.parent_))}function Kp(i){i.copy_||(i.copy_=Fm(i.base_,i.scope_.immer_.useStrictShallowCopy_))}var CE=class{constructor(i){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,r)=>{if(typeof e=="function"&&typeof t!="function"){const s=t;t=e;const a=this;return function(l=s,...u){return a.produce(l,c=>t.call(this,c,...u))}}typeof t!="function"&&Sn(6),r!==void 0&&typeof r!="function"&&Sn(7);let n;if(ws(e)){const s=wv(this),a=zm(e,void 0);let o=!0;try{n=t(a),o=!1}finally{o?Am(s):Vm(s)}return vv(s,r),Sv(n,s)}else if(!e||typeof e!="object"){if(n=t(e),n===void 0&&(n=e),n===HT&&(n=void 0),this.autoFreeze_&&xy(n,!0),r){const s=[],a=[];ja("Patches").generateReplacementPatches_(e,n,s,a),r(s,a)}return n}else Sn(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(a,...o)=>this.produceWithPatches(a,l=>e(l,...o));let r,n;return[this.produce(e,t,(a,o)=>{r=a,n=o}),r,n]},typeof(i==null?void 0:i.autoFreeze)=="boolean"&&this.setAutoFreeze(i.autoFreeze),typeof(i==null?void 0:i.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(i.useStrictShallowCopy)}createDraft(i){ws(i)||Sn(8),la(i)&&(i=$T(i));const e=wv(this),t=zm(i,void 0);return t[Hr].isManual_=!0,Vm(e),t}finishDraft(i,e){const t=i&&i[Hr];(!t||!t.isManual_)&&Sn(9);const{scope_:r}=t;return vv(r,e),Sv(void 0,r)}setAutoFreeze(i){this.autoFreeze_=i}setUseStrictShallowCopy(i){this.useStrictShallowCopy_=i}applyPatches(i,e){let t;for(t=e.length-1;t>=0;t--){const n=e[t];if(n.path.length===0&&n.op==="replace"){i=n.value;break}}t>-1&&(e=e.slice(t+1));const r=ja("Patches").applyPatches_;return la(i)?r(i,e):this.produce(i,n=>r(n,e))}};function zm(i,e){const t=ff(i)?ja("MapSet").proxyMap_(i,e):pf(i)?ja("MapSet").proxySet_(i,e):kE(i,e);return(e?e.scope_:WT()).drafts_.push(t),t}function $T(i){return la(i)||Sn(10,i),jT(i)}function jT(i){if(!ws(i)||gf(i))return i;const e=i[Hr];let t;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=Fm(i,e.scope_.immer_.useStrictShallowCopy_)}else t=Fm(i,!0);return fd(t,(r,n)=>{UT(t,r,jT(n))}),e&&(e.finalized_=!1),t}var zr=new CE,YT=zr.produce;zr.produceWithPatches.bind(zr);zr.setAutoFreeze.bind(zr);zr.setUseStrictShallowCopy.bind(zr);zr.applyPatches.bind(zr);zr.createDraft.bind(zr);zr.finishDraft.bind(zr);function NE(i,e=`expected a function, instead received ${typeof i}`){if(typeof i!="function")throw new TypeError(e)}function BE(i,e=`expected an object, instead received ${typeof i}`){if(typeof i!="object")throw new TypeError(e)}function _E(i,e="expected all items to be functions, instead received the following types: "){if(!i.every(t=>typeof t=="function")){const t=i.map(r=>typeof r=="function"?`function ${r.name||"unnamed"}()`:typeof r).join(", ");throw new TypeError(`${e}[${t}]`)}}var kv=i=>Array.isArray(i)?i:[i];function PE(i){const e=Array.isArray(i[0])?i[0]:i;return _E(e,"createSelector expects all input-selectors to be functions, but received the following types: "),e}function RE(i,e){const t=[],{length:r}=i;for(let n=0;n<r;n++)t.push(i[n].apply(null,e));return t}var EE=class{constructor(i){this.value=i}deref(){return this.value}},ME=typeof WeakRef<"u"?WeakRef:EE,OE=0,Tv=1;function Uc(){return{s:OE,v:void 0,o:null,p:null}}function Ty(i,e={}){let t=Uc();const{resultEqualityCheck:r}=e;let n,s=0;function a(){var h;let o=t;const{length:l}=arguments;for(let d=0,f=l;d<f;d++){const p=arguments[d];if(typeof p=="function"||typeof p=="object"&&p!==null){let g=o.o;g===null&&(o.o=g=new WeakMap);const y=g.get(p);y===void 0?(o=Uc(),g.set(p,o)):o=y}else{let g=o.p;g===null&&(o.p=g=new Map);const y=g.get(p);y===void 0?(o=Uc(),g.set(p,o)):o=y}}const u=o;let c;if(o.s===Tv)c=o.v;else if(c=i.apply(null,arguments),s++,r){const d=((h=n==null?void 0:n.deref)==null?void 0:h.call(n))??n;d!=null&&r(d,c)&&(c=d,s!==0&&s--),n=typeof c=="object"&&c!==null||typeof c=="function"?new ME(c):c}return u.s=Tv,u.v=c,c}return a.clearCache=()=>{t=Uc(),a.resetResultsCount()},a.resultsCount=()=>s,a.resetResultsCount=()=>{s=0},a}function XT(i,...e){const t=typeof i=="function"?{memoize:i,memoizeOptions:e}:i,r=(...n)=>{let s=0,a=0,o,l={},u=n.pop();typeof u=="object"&&(l=u,u=n.pop()),NE(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const c={...t,...l},{memoize:h,memoizeOptions:d=[],argsMemoize:f=Ty,argsMemoizeOptions:p=[],devModeChecks:g={}}=c,y=kv(d),b=kv(p),m=PE(n),v=h(function(){return s++,u.apply(null,arguments)},...y),k=f(function(){a++;const C=RE(m,arguments);return o=v.apply(null,C),o},...b);return Object.assign(k,{resultFunc:u,memoizedResultFunc:v,dependencies:m,dependencyRecomputations:()=>a,resetDependencyRecomputations:()=>{a=0},lastResult:()=>o,recomputations:()=>s,resetRecomputations:()=>{s=0},memoize:h,argsMemoize:f})};return Object.assign(r,{withTypes:()=>r}),r}var IE=XT(Ty),LE=Object.assign((i,e=IE)=>{BE(i,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof i}`);const t=Object.keys(i),r=t.map(s=>i[s]);return e(r,(...s)=>s.reduce((a,o,l)=>(a[t[l]]=o,a),{}))},{withTypes:()=>LE});function KT(i){return({dispatch:t,getState:r})=>n=>s=>typeof s=="function"?s(t,r,i):n(s)}var DE=KT(),FE=KT,AE=(...i)=>{const e=XT(...i),t=Object.assign((...r)=>{const n=e(...r),s=(a,...o)=>n(la(a)?$T(a):a,...o);return Object.assign(s,n),s},{withTypes:()=>t});return t};AE(Ty);var VE=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?dd:dd.apply(null,arguments)};function Qo(i,e){function t(...r){if(e){let n=e(...r);if(!n)throw new Error(br(0));return{type:i,payload:n.payload,..."meta"in n&&{meta:n.meta},..."error"in n&&{error:n.error}}}return{type:i,payload:r[0]}}return t.toString=()=>`${i}`,t.type=i,t.match=r=>mE(r)&&r.type===i,t}var qT=class Vl extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,Vl.prototype)}static get[Symbol.species](){return Vl}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new Vl(...e[0].concat(this)):new Vl(...e.concat(this))}};function Cv(i){return ws(i)?YT(i,()=>{}):i}function Nv(i,e,t){if(i.has(e)){let n=i.get(e);return t.update&&(n=t.update(n,e,i),i.set(e,n)),n}if(!t.insert)throw new Error(br(10));const r=t.insert(e,i);return i.set(e,r),r}function HE(i){return typeof i=="boolean"}var zE=()=>function(e){const{thunk:t=!0,immutableCheck:r=!0,serializableCheck:n=!0,actionCreatorCheck:s=!0}=e??{};let a=new qT;return t&&(HE(t)?a.push(DE):a.push(FE(t.extraArgument))),a},UE="RTK_autoBatch",JT=i=>e=>{setTimeout(e,i)},WE=typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:JT(10),GE=(i={type:"raf"})=>e=>(...t)=>{const r=e(...t);let n=!0,s=!1,a=!1;const o=new Set,l=i.type==="tick"?queueMicrotask:i.type==="raf"?WE:i.type==="callback"?i.queueNotification:JT(i.timeout),u=()=>{a=!1,s&&(s=!1,o.forEach(c=>c()))};return Object.assign({},r,{subscribe(c){const h=()=>n&&c(),d=r.subscribe(h);return o.add(c),()=>{d(),o.delete(c)}},dispatch(c){var h;try{return n=!((h=c==null?void 0:c.meta)!=null&&h[UE]),s=!n,s&&(a||(a=!0,l(u))),r.dispatch(c)}finally{n=!0}}})},$E=i=>function(t){const{autoBatch:r=!0}=t??{};let n=new qT(i);return r&&n.push(GE(typeof r=="object"?r:void 0)),n},jE=!0;function YE(i){const e=zE(),{reducer:t=void 0,middleware:r,devTools:n=!0,preloadedState:s=void 0,enhancers:a=void 0}=i||{};let o;if(typeof t=="function")o=t;else if(Sy(t))o=VT(t);else throw new Error(br(1));let l;typeof r=="function"?l=r(e):l=e();let u=dd;n&&(u=VE({trace:!jE,...typeof n=="object"&&n}));const c=gE(...l),h=$E(c);let d=typeof a=="function"?a(h):h();const f=u(...d);return AT(o,s,f)}function QT(i){const e={},t=[];let r;const n={addCase(s,a){const o=typeof s=="string"?s:s.type;if(!o)throw new Error(br(28));if(o in e)throw new Error(br(29));return e[o]=a,n},addMatcher(s,a){return t.push({matcher:s,reducer:a}),n},addDefaultCase(s){return r=s,n}};return i(n),[e,t,r]}function XE(i){return typeof i=="function"}function KE(i,e){let[t,r,n]=QT(e),s;if(XE(i))s=()=>Cv(i());else{const o=Cv(i);s=()=>o}function a(o=s(),l){let u=[t[l.type],...r.filter(({matcher:c})=>c(l)).map(({reducer:c})=>c)];return u.filter(c=>!!c).length===0&&(u=[n]),u.reduce((c,h)=>{if(h)if(la(c)){const f=h(c,l);return f===void 0?c:f}else{if(ws(c))return YT(c,d=>h(d,l));{const d=h(c,l);if(d===void 0){if(c===null)return c;throw new Error(br(9))}return d}}return c},o)}return a.getInitialState=s,a}var qE="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",JE=(i=21)=>{let e="",t=i;for(;t--;)e+=qE[Math.random()*64|0];return e},QE=Symbol.for("rtk-slice-createasyncthunk");function ZE(i,e){return`${i}/${e}`}function eM({creators:i}={}){var t;const e=(t=i==null?void 0:i.asyncThunk)==null?void 0:t[QE];return function(n){const{name:s,reducerPath:a=s}=n;if(!s)throw new Error(br(11));typeof process<"u";const o=(typeof n.reducers=="function"?n.reducers(iM()):n.reducers)||{},l=Object.keys(o),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},c={addCase(v,k){const x=typeof v=="string"?v:v.type;if(!x)throw new Error(br(12));if(x in u.sliceCaseReducersByType)throw new Error(br(13));return u.sliceCaseReducersByType[x]=k,c},addMatcher(v,k){return u.sliceMatchers.push({matcher:v,reducer:k}),c},exposeAction(v,k){return u.actionCreators[v]=k,c},exposeCaseReducer(v,k){return u.sliceCaseReducersByName[v]=k,c}};l.forEach(v=>{const k=o[v],x={reducerName:v,type:ZE(s,v),createNotation:typeof n.reducers=="function"};nM(k)?aM(x,k,c,e):rM(x,k,c)});function h(){const[v={},k=[],x=void 0]=typeof n.extraReducers=="function"?QT(n.extraReducers):[n.extraReducers],C={...v,...u.sliceCaseReducersByType};return KE(n.initialState,N=>{for(let B in C)N.addCase(B,C[B]);for(let B of u.sliceMatchers)N.addMatcher(B.matcher,B.reducer);for(let B of k)N.addMatcher(B.matcher,B.reducer);x&&N.addDefaultCase(x)})}const d=v=>v,f=new Map;let p;function g(v,k){return p||(p=h()),p(v,k)}function y(){return p||(p=h()),p.getInitialState()}function b(v,k=!1){function x(N){let B=N[v];return typeof B>"u"&&k&&(B=y()),B}function C(N=d){const B=Nv(f,k,{insert:()=>new WeakMap});return Nv(B,N,{insert:()=>{const E={};for(const[O,z]of Object.entries(n.selectors??{}))E[O]=tM(z,N,y,k);return E}})}return{reducerPath:v,getSelectors:C,get selectors(){return C(x)},selectSlice:x}}const m={name:s,reducer:g,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:y,...b(a),injectInto(v,{reducerPath:k,...x}={}){const C=k??a;return v.inject({reducerPath:C,reducer:g},x),{...m,...b(C,!0)}}};return m}}function tM(i,e,t,r){function n(s,...a){let o=e(s);return typeof o>"u"&&r&&(o=t()),i(o,...a)}return n.unwrapped=i,n}var mf=eM();function iM(){function i(e,t){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...t}}return i.withTypes=()=>i,{reducer(e){return Object.assign({[e.name](...t){return e(...t)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,t){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:t}},asyncThunk:i}}function rM({type:i,reducerName:e,createNotation:t},r,n){let s,a;if("reducer"in r){if(t&&!sM(r))throw new Error(br(17));s=r.reducer,a=r.prepare}else s=r;n.addCase(i,s).exposeCaseReducer(e,s).exposeAction(e,a?Qo(i,a):Qo(i))}function nM(i){return i._reducerDefinitionType==="asyncThunk"}function sM(i){return i._reducerDefinitionType==="reducerWithPrepare"}function aM({type:i,reducerName:e},t,r,n){if(!n)throw new Error(br(18));const{payloadCreator:s,fulfilled:a,pending:o,rejected:l,settled:u,options:c}=t,h=n(i,s,c);r.exposeAction(e,h),a&&r.addCase(h.fulfilled,a),o&&r.addCase(h.pending,o),l&&r.addCase(h.rejected,l),u&&r.addMatcher(h.settled,u),r.exposeCaseReducer(e,{fulfilled:a||Wc,pending:o||Wc,rejected:l||Wc,settled:u||Wc})}function Wc(){}var oM=(i,e)=>{if(typeof i!="function")throw new Error(br(32))},Cy="listenerMiddleware",lM=i=>{let{type:e,actionCreator:t,matcher:r,predicate:n,effect:s}=i;if(e)n=Qo(e).match;else if(t)e=t.type,n=t.match;else if(r)n=r;else if(!n)throw new Error(br(21));return oM(s),{predicate:n,type:e,effect:s}},uM=Object.assign(i=>{const{type:e,predicate:t,effect:r}=lM(i);return{id:JE(),effect:r,type:e,predicate:t,pending:new Set,unsubscribe:()=>{throw new Error(br(22))}}},{withTypes:()=>uM}),cM=Object.assign(Qo(`${Cy}/add`),{withTypes:()=>cM});Qo(`${Cy}/removeAll`);var hM=Object.assign(Qo(`${Cy}/remove`),{withTypes:()=>hM});function br(i){return`Minified Redux Toolkit error #${i}; visit https://redux-toolkit.js.org/Errors?code=${i} for the full message or use the non-minified dev environment for full errors. `}const yf={bars:{jywxjNyYIMZeJdAN8NzzE:{id:"jywxjNyYIMZeJdAN8NzzE",chords:["56g913ZHvhA94K3K06aEK"]},"1lSOLUu0-qLrsAOnsTHAH":{id:"1lSOLUu0-qLrsAOnsTHAH",chords:["c_H_aiu6Y3xZ9FZ8myRVm"]},LIz2iFSV8DuhmaTzXPAMG:{id:"LIz2iFSV8DuhmaTzXPAMG",chords:["fY2252W_noaipy7BE4qZb"]}},chords:{"56g913ZHvhA94K3K06aEK":{id:"56g913ZHvhA94K3K06aEK",name:"D",type:"MINOR",root:"D2",transitionId:"S?;T?;C,R->C,T,U->C,F,U->N,R-1;"},c_H_aiu6Y3xZ9FZ8myRVm:{id:"c_H_aiu6Y3xZ9FZ8myRVm",name:"A",type:"DOMINANT-SEVENTH",root:"A1",transitionId:"S?;T?;C,R->C,T,U->C,F,U->N,R-1;"},fY2252W_noaipy7BE4qZb:{id:"fY2252W_noaipy7BE4qZb",name:"D",type:"MINOR",root:"D2"}},config:{isLooping:!1,masterVolume:1,bassVolume:.5,metronomeVolume:0,chordsVolume:0},progressions:{default:{id:"default",noteCount:4,tuning:["G2","D2","A1","E1"],name:"default",bars:["jywxjNyYIMZeJdAN8NzzE","1lSOLUu0-qLrsAOnsTHAH","LIz2iFSV8DuhmaTzXPAMG"]}}};function A(i){return i==null}function ZT(i){return i!==null||i!==void 0}function eC(i){return i!==null&&typeof i=="object"&&"name"in i&&typeof i.name=="string"}function tC(i){return i!==null&&typeof i=="object"&&"step"in i&&typeof i.step=="number"&&"alt"in i&&typeof i.alt=="number"&&!isNaN(i.step)&&!isNaN(i.alt)}var iC=[0,2,4,-1,1,3,5],rC=iC.map(i=>Math.floor(i*7/12));function nC(i){const{step:e,alt:t,oct:r,dir:n=1}=i,s=iC[e]+7*t;if(r===void 0)return[n*s];const a=r-rC[e]-4*t;return[n*s,n*a]}var dM=[3,0,4,1,5,2,6];function sC(i){const[e,t,r]=i,n=dM[fM(e)],s=Math.floor((e+1)/7);if(t===void 0)return{step:n,alt:s,dir:r};const a=t+4*s+rC[n];return{step:n,alt:s,oct:a,dir:r}}function fM(i){const e=(i+1)%7;return e<0?7+e:e}var Bv=(i,e)=>Array(Math.abs(e)+1).join(i),Um=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),pM="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",gM="(AA|A|P|M|m|d|dd)([-+]?\\d+)",mM=new RegExp("^"+pM+"|"+gM+"$");function yM(i){const e=mM.exec(`${i}`);return e===null?["",""]:e[1]?[e[1],e[2]]:[e[4],e[3]]}var _v={};function ir(i){return typeof i=="string"?_v[i]||(_v[i]=bM(i)):tC(i)?ir(wM(i)):eC(i)?ir(i.name):Um}var Pv=[0,2,4,5,7,9,11],aC="PMMPPMM";function bM(i){const e=yM(i);if(e[0]==="")return Um;const t=+e[0],r=e[1],n=(Math.abs(t)-1)%7,s=aC[n];if(s==="M"&&r==="P")return Um;const a=s==="M"?"majorable":"perfectable",o=""+t+r,l=t<0?-1:1,u=t===8||t===-8?t:l*(n+1),c=vM(a,r),h=Math.floor((Math.abs(t)-1)/7),d=l*(Pv[n]+c+12*h),f=(l*(Pv[n]+c)%12+12)%12,p=nC({step:n,alt:c,oct:h,dir:l});return{empty:!1,name:o,num:t,q:r,step:n,alt:c,dir:l,type:a,simple:u,semitones:d,chroma:f,coord:p,oct:h}}function Ny(i,e){const[t,r=0]=i,n=t*7+r*12<0,s=e||n?[-t,-r,-1]:[t,r,1];return ir(sC(s))}function vM(i,e){return e==="M"&&i==="majorable"||e==="P"&&i==="perfectable"?0:e==="m"&&i==="majorable"?-1:/^A+$/.test(e)?e.length:/^d+$/.test(e)?-1*(i==="perfectable"?e.length:e.length+1):0}function wM(i){const{step:e,alt:t,oct:r=0,dir:n}=i;if(!n)return"";const s=e+1+7*r,a=s===0?e+1:s,o=n<0?"-":"",l=aC[e]==="M"?"majorable":"perfectable";return o+a+SM(l,t)}function SM(i,e){return e===0?i==="majorable"?"M":"P":e===-1&&i==="majorable"?"m":e>0?Bv("A",e):Bv("d",i==="perfectable"?e:e+1)}var Rv=(i,e)=>Array(Math.abs(e)+1).join(i),oC=Object.freeze({empty:!0,name:"",letter:"",acc:"",pc:"",step:NaN,alt:NaN,chroma:NaN,height:NaN,coord:[],midi:null,freq:null}),Ev=new Map,xM=i=>"CDEFGAB".charAt(i),kM=i=>i<0?Rv("b",-i):Rv("#",i),TM=i=>i[0]==="b"?-i.length:i.length;function Fi(i){const e=JSON.stringify(i),t=Ev.get(e);if(t)return t;const r=typeof i=="string"?_M(i):tC(i)?Fi(PM(i)):eC(i)?Fi(i.name):oC;return Ev.set(e,r),r}var CM=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function By(i){const e=CM.exec(i);return e?[e[1].toUpperCase(),e[2].replace(/x/g,"##"),e[3],e[4]]:["","","",""]}function NM(i){return Fi(sC(i))}var BM=(i,e)=>(i%e+e)%e,qp=[0,2,4,5,7,9,11];function _M(i){const e=By(i);if(e[0]===""||e[3]!=="")return oC;const t=e[0],r=e[1],n=e[2],s=(t.charCodeAt(0)+3)%7,a=TM(r),o=n.length?+n:void 0,l=nC({step:s,alt:a,oct:o}),u=t+r+n,c=t+r,h=(qp[s]+a+120)%12,d=o===void 0?BM(qp[s]+a,12)-12*99:qp[s]+a+12*(o+1),f=d>=0&&d<=127?d:null,p=o===void 0?null:Math.pow(2,(d-69)/12)*440;return{empty:!1,acc:r,alt:a,chroma:h,coord:l,freq:p,height:d,letter:t,midi:f,name:u,oct:o,pc:c,step:s}}function PM(i){const{step:e,alt:t,oct:r}=i,n=xM(e);if(!n)return"";const s=n+kM(t);return r||r===0?s+r:s}function vr(i,e){const t=Fi(i),r=Array.isArray(e)?e:ir(e).coord;if(t.empty||!r||r.length<2)return"";const n=t.coord,s=n.length===1?[n[0]+r[0]]:[n[0]+r[0],n[1]+r[1]];return NM(s).name}function lC(i,e){const t=i.length;return r=>{if(!e)return"";const n=r<0?(t- -r%t)%t:r%t,s=Math.floor(r/t),a=vr(e,[0,s]);return vr(a,i[n])}}function Zo(i,e){const t=Fi(i),r=Fi(e);if(t.empty||r.empty)return"";const n=t.coord,s=r.coord,a=s[0]-n[0],o=n.length===2&&s.length===2?s[1]-n[1]:-Math.floor(a*7/12),l=r.height===t.height&&r.midi!==null&&t.midi!==null&&t.step>r.step;return Ny([a,o],l).name}function _y(i,e){const t=e.length,r=(i%t+t)%t;return e.slice(r,t).concat(e.slice(0,r))}function RM(i){return i.filter(e=>e===0||e)}var Ya={empty:!0,name:"",setNum:0,chroma:"000000000000",normalized:"000000000000",intervals:[]},uC=i=>Number(i).toString(2).padStart(12,"0"),Mv=i=>parseInt(i,2),EM=/^[01]{12}$/;function cC(i){return EM.test(i)}var MM=i=>typeof i=="number"&&i>=0&&i<=4095,OM=i=>i&&cC(i.chroma),Ov={[Ya.chroma]:Ya};function Xa(i){const e=cC(i)?i:MM(i)?uC(i):Array.isArray(i)?HM(i):OM(i)?i.chroma:Ya.chroma;return Ov[e]=Ov[e]||VM(e)}var IM=["1P","2m","2M","3m","3M","4P","5d","5P","6m","6M","7m","7M"];function LM(i){const e=[];for(let t=0;t<12;t++)i.charAt(t)==="1"&&e.push(IM[t]);return e}function DM(i,e=!0){const r=Xa(i).chroma.split("");return RM(r.map((n,s)=>{const a=_y(s,r);return e&&a[0]==="0"?null:a.join("")}))}function FM(i){const e=Xa(i).setNum;return t=>{const r=Xa(t).setNum;return e&&e!==r&&(r&e)===r}}function hC(i){const e=Xa(i).setNum;return t=>{const r=Xa(t).setNum;return e&&e!==r&&(r|e)===r}}function AM(i){const e=i.split("");return e.map((t,r)=>_y(r,e).join(""))}function VM(i){const e=Mv(i),t=AM(i).map(Mv).filter(s=>s>=2048).sort()[0],r=uC(t),n=LM(i);return{empty:!1,name:"",setNum:e,chroma:i,normalized:r,intervals:n}}function HM(i){if(i.length===0)return Ya.chroma;let e;const t=[0,0,0,0,0,0,0,0,0,0,0,0];for(let r=0;r<i.length;r++)e=Fi(i[r]),e.empty&&(e=ir(i[r])),e.empty||(t[e.chroma]=1);return t.join("")}var zM=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7 Δ ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 Δ9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 Δ#4 Δ#11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -Δ7 mΔ -^7 -maj7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim ° o"],["1P 3m 5d 7d","diminished seventh","dim7 °7 o7"],["1P 3m 5d 7m","half-diminished","m7b5 ø -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 Δ9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],UM=zM,WM={...Ya,name:"",quality:"Unknown",intervals:[],aliases:[]},Py=[],Zl={};function GM(i){return Zl[i]||WM}function Ry(){return Py.slice()}function $M(i,e,t){const r=YM(i),n={...Xa(i),name:t||"",quality:r,intervals:i,aliases:e};Py.push(n),n.name&&(Zl[n.name]=n),Zl[n.setNum]=n,Zl[n.chroma]=n,n.aliases.forEach(s=>jM(n,s))}function jM(i,e){Zl[e]=i}function YM(i){const e=t=>i.indexOf(t)!==-1;return e("5A")?"Augmented":e("3M")?"Major":e("5d")?"Diminished":e("3m")?"Minor":"Unknown"}UM.forEach(([i,e,t])=>$M(i.split(" "),t.split(" "),e));Py.sort((i,e)=>i.setNum-e.setNum);var XM=i=>{const e=i.reduce((t,r)=>{const n=Fi(r).chroma;return n!==void 0&&(t[n]=t[n]||Fi(r).name),t},{});return t=>e[t]};function KM(i,e={}){const t=i.map(n=>Fi(n).pc).filter(n=>n);return Fi.length===0?[]:iO(t,1,e).filter(n=>n.weight).sort((n,s)=>s.weight-n.weight).map(n=>n.name)}var bf={anyThirds:384,perfectFifth:16,nonPerfectFifths:40,anySeventh:3},vf=i=>e=>!!(e&i),qM=vf(bf.anyThirds),JM=vf(bf.perfectFifth),QM=vf(bf.anySeventh),ZM=vf(bf.nonPerfectFifths);function eO(i){const e=parseInt(i.chroma,2);return qM(e)&&JM(e)&&QM(e)}function tO(i){const e=parseInt(i,2);return ZM(e)?i:(e|16).toString(2)}function iO(i,e,t){const r=i[0],n=Fi(r).chroma,s=XM(i),a=DM(i,!1),o=[];return a.forEach((l,u)=>{const c=t.assumePerfectFifth&&tO(l);Ry().filter(d=>t.assumePerfectFifth&&eO(d)?d.chroma===c:d.chroma===l).forEach(d=>{const f=d.aliases[0],p=s(u);u!==n?o.push({weight:.5*e,name:`${p}${f}/${r}`}):o.push({weight:1*e,name:`${p}${f}`})})}),o}function rO(){return"1P 2M 3M 4P 5P 6m 7m".split(" ")}var dC=ir,nO=i=>ir(i).name,sO=i=>ir(i).semitones,aO=i=>ir(i).q,oO=i=>ir(i).num;function lO(i){const e=ir(i);return e.empty?"":e.simple+e.q}function uO(i){const e=ir(i);if(e.empty)return"";const t=(7-e.step)%7,r=e.type==="perfectable"?-e.alt:-(e.alt+1);return ir({step:t,alt:r,oct:e.oct,dir:e.dir}).name}var cO=[1,2,2,3,3,4,5,5,6,6,7,7],hO="P m M m M P d P m M m M".split(" ");function dO(i){const e=i<0?-1:1,t=Math.abs(i),r=t%12,n=Math.floor(t/12);return e*(cO[r]+7*n)+hO[r]}var fO=Zo,fC=gC((i,e)=>[i[0]+e[0],i[1]+e[1]]),pO=i=>e=>fC(i,e),pC=gC((i,e)=>[i[0]-e[0],i[1]-e[1]]);function gO(i,e){const t=dC(i);if(t.empty)return"";const[r,n,s]=t.coord;return Ny([r+e,n,s]).name}var Bs={names:rO,get:dC,name:nO,num:oO,semitones:sO,quality:aO,fromSemitones:dO,distance:fO,invert:uO,simplify:lO,add:fC,addTo:pO,subtract:pC,transposeFifths:gO};function gC(i){return(e,t)=>{const r=ir(e).coord,n=ir(t).coord;if(r&&n){const s=i(r,n);return Ny(s).name}}}var mO=[["1P 2M 3M 5P 6M","major pentatonic","pentatonic"],["1P 2M 3M 4P 5P 6M 7M","major","ionian"],["1P 2M 3m 4P 5P 6m 7m","minor","aeolian"],["1P 2M 3m 3M 5P 6M","major blues"],["1P 3m 4P 5d 5P 7m","minor blues","blues"],["1P 2M 3m 4P 5P 6M 7M","melodic minor"],["1P 2M 3m 4P 5P 6m 7M","harmonic minor"],["1P 2M 3M 4P 5P 6M 7m 7M","bebop"],["1P 2M 3m 4P 5d 6m 6M 7M","diminished","whole-half diminished"],["1P 2M 3m 4P 5P 6M 7m","dorian"],["1P 2M 3M 4A 5P 6M 7M","lydian"],["1P 2M 3M 4P 5P 6M 7m","mixolydian","dominant"],["1P 2m 3m 4P 5P 6m 7m","phrygian"],["1P 2m 3m 4P 5d 6m 7m","locrian"],["1P 3M 4P 5P 7M","ionian pentatonic"],["1P 3M 4P 5P 7m","mixolydian pentatonic","indian"],["1P 2M 4P 5P 6M","ritusen"],["1P 2M 4P 5P 7m","egyptian"],["1P 3M 4P 5d 7m","neopolitan major pentatonic"],["1P 3m 4P 5P 6m","vietnamese 1"],["1P 2m 3m 5P 6m","pelog"],["1P 2m 4P 5P 6m","kumoijoshi"],["1P 2M 3m 5P 6m","hirajoshi"],["1P 2m 4P 5d 7m","iwato"],["1P 2m 4P 5P 7m","in-sen"],["1P 3M 4A 5P 7M","lydian pentatonic","chinese"],["1P 3m 4P 6m 7m","malkos raga"],["1P 3m 4P 5d 7m","locrian pentatonic","minor seven flat five pentatonic"],["1P 3m 4P 5P 7m","minor pentatonic","vietnamese 2"],["1P 3m 4P 5P 6M","minor six pentatonic"],["1P 2M 3m 5P 6M","flat three pentatonic","kumoi"],["1P 2M 3M 5P 6m","flat six pentatonic"],["1P 2m 3M 5P 6M","scriabin"],["1P 3M 5d 6m 7m","whole tone pentatonic"],["1P 3M 4A 5A 7M","lydian #5P pentatonic"],["1P 3M 4A 5P 7m","lydian dominant pentatonic"],["1P 3m 4P 5P 7M","minor #7M pentatonic"],["1P 3m 4d 5d 7m","super locrian pentatonic"],["1P 2M 3m 4P 5P 7M","minor hexatonic"],["1P 2A 3M 5P 5A 7M","augmented"],["1P 2M 4P 5P 6M 7m","piongio"],["1P 2m 3M 4A 6M 7m","prometheus neopolitan"],["1P 2M 3M 4A 6M 7m","prometheus"],["1P 2m 3M 5d 6m 7m","mystery #1"],["1P 2m 3M 4P 5A 6M","six tone symmetric"],["1P 2M 3M 4A 5A 6A","whole tone","messiaen's mode #1"],["1P 2m 4P 4A 5P 7M","messiaen's mode #5"],["1P 2M 3M 4P 5d 6m 7m","locrian major","arabian"],["1P 2m 3M 4A 5P 6m 7M","double harmonic lydian"],["1P 2m 2A 3M 4A 6m 7m","altered","super locrian","diminished whole tone","pomeroy"],["1P 2M 3m 4P 5d 6m 7m","locrian #2","half-diminished","aeolian b5"],["1P 2M 3M 4P 5P 6m 7m","mixolydian b6","melodic minor fifth mode","hindu"],["1P 2M 3M 4A 5P 6M 7m","lydian dominant","lydian b7","overtone"],["1P 2M 3M 4A 5A 6M 7M","lydian augmented"],["1P 2m 3m 4P 5P 6M 7m","dorian b2","phrygian #6","melodic minor second mode"],["1P 2m 3m 4d 5d 6m 7d","ultralocrian","superlocrian bb7","superlocrian diminished"],["1P 2m 3m 4P 5d 6M 7m","locrian 6","locrian natural 6","locrian sharp 6"],["1P 2A 3M 4P 5P 5A 7M","augmented heptatonic"],["1P 2M 3m 4A 5P 6M 7m","dorian #4","ukrainian dorian","romanian minor","altered dorian"],["1P 2M 3m 4A 5P 6M 7M","lydian diminished"],["1P 2M 3M 4A 5A 7m 7M","leading whole tone"],["1P 2M 3M 4A 5P 6m 7m","lydian minor"],["1P 2m 3M 4P 5P 6m 7m","phrygian dominant","spanish","phrygian major"],["1P 2m 3m 4P 5P 6m 7M","balinese"],["1P 2m 3m 4P 5P 6M 7M","neopolitan major"],["1P 2M 3M 4P 5P 6m 7M","harmonic major"],["1P 2m 3M 4P 5P 6m 7M","double harmonic major","gypsy"],["1P 2M 3m 4A 5P 6m 7M","hungarian minor"],["1P 2A 3M 4A 5P 6M 7m","hungarian major"],["1P 2m 3M 4P 5d 6M 7m","oriental"],["1P 2m 3m 3M 4A 5P 7m","flamenco"],["1P 2m 3m 4A 5P 6m 7M","todi raga"],["1P 2m 3M 4P 5d 6m 7M","persian"],["1P 2m 3M 5d 6m 7m 7M","enigmatic"],["1P 2M 3M 4P 5A 6M 7M","major augmented","major #5","ionian augmented","ionian #5"],["1P 2A 3M 4A 5P 6M 7M","lydian #9"],["1P 2m 2M 4P 4A 5P 6m 7M","messiaen's mode #4"],["1P 2m 3M 4P 4A 5P 6m 7M","purvi raga"],["1P 2m 3m 3M 4P 5P 6m 7m","spanish heptatonic"],["1P 2M 3m 3M 4P 5P 6M 7m","bebop minor"],["1P 2M 3M 4P 5P 5A 6M 7M","bebop major"],["1P 2m 3m 4P 5d 5P 6m 7m","bebop locrian"],["1P 2M 3m 4P 5P 6m 7m 7M","minor bebop"],["1P 2M 3M 4P 5d 5P 6M 7M","ichikosucho"],["1P 2M 3m 4P 5P 6m 6M 7M","minor six diminished"],["1P 2m 3m 3M 4A 5P 6M 7m","half-whole diminished","dominant diminished","messiaen's mode #2"],["1P 3m 3M 4P 5P 6M 7m 7M","kafi raga"],["1P 2M 3M 4P 4A 5A 6A 7M","messiaen's mode #6"],["1P 2M 3m 3M 4P 5d 5P 6M 7m","composite blues"],["1P 2M 3m 3M 4A 5P 6m 7m 7M","messiaen's mode #3"],["1P 2m 2M 3m 4P 4A 5P 6m 6M 7M","messiaen's mode #7"],["1P 2m 2M 3m 3M 4P 5d 5P 6m 6M 7m 7M","chromatic"]],yO=mO,bO={...Ya,intervals:[],aliases:[]},mC=[],eu={};function vO(i){return eu[i]||bO}function wO(){return mC.slice()}function SO(i,e,t=[]){const r={...Xa(i),name:e,intervals:i,aliases:t};return mC.push(r),eu[r.name]=r,eu[r.setNum]=r,eu[r.chroma]=r,r.aliases.forEach(n=>xO(r,n)),r}function xO(i,e){eu[e]=i}yO.forEach(([i,e,...t])=>SO(i.split(" "),e,t));var yC={empty:!0,name:"",symbol:"",root:"",bass:"",rootDegree:0,type:"",tonic:null,setNum:NaN,quality:"Unknown",chroma:"",normalized:"",aliases:[],notes:[],intervals:[]};function Ey(i){const[e,t,r,n]=By(i);return e===""?Jp("",i):e==="A"&&n==="ug"?Jp("","aug"):Jp(e+t,r+n)}function Jp(i,e){const t=e.split("/");if(t.length===1)return[i,t[0],""];const[r,n,s,a]=By(t[1]);return r!==""&&s===""&&a===""?[i,t[0],r+n]:[i,e,""]}function ya(i){if(Array.isArray(i))return Ph(i[1]||"",i[0],i[2]);if(i==="")return yC;{const[e,t,r]=Ey(i),n=Ph(t,e,r);return n.empty?Ph(i):n}}function Ph(i,e,t){const r=GM(i),n=Fi(e||""),s=Fi(t||"");if(r.empty||e&&n.empty||t&&s.empty)return yC;const a=Zo(n.pc,s.pc),o=r.intervals.indexOf(a),l=o>=0,u=l?s:Fi(""),c=o===-1?NaN:o+1,h=s.pc&&s.pc!==n.pc,d=Array.from(r.intervals);if(l)for(let y=1;y<c;y++){const b=d[0][0],m=d[0][1],v=parseInt(b,10)+7;d.push(`${v}${m}`),d.shift()}else if(h){const y=pC(Zo(n.pc,s.pc),"8P");y&&d.unshift(y)}const f=n.empty?[]:d.map(y=>vr(n.pc,y));i=r.aliases.indexOf(i)!==-1?i:r.aliases[0];const p=`${n.empty?"":n.pc}${i}${l&&c>1?"/"+u.pc:h?"/"+s.pc:""}`,g=`${e?n.pc+" ":""}${r.name}${l&&c>1?" over "+u.pc:h?" over "+s.pc:""}`;return{...r,name:g,symbol:p,tonic:n.pc,type:r.name,root:u.pc,bass:h?s.pc:"",intervals:d,rootDegree:c,notes:f}}var kO=ya;function TO(i,e){const[t,r,n]=Ey(i);if(!t)return i;const s=vr(n,e),a=s?"/"+s:"";return vr(t,e)+r+a}function CO(i){const e=ya(i),t=hC(e.chroma);return wO().filter(r=>t(r.chroma)).map(r=>r.name)}function NO(i){const e=ya(i),t=hC(e.chroma);return Ry().filter(r=>t(r.chroma)).map(r=>e.tonic+r.aliases[0])}function BO(i){const e=ya(i),t=FM(e.chroma);return Ry().filter(r=>t(r.chroma)).map(r=>e.tonic+r.aliases[0])}function _O(i,e){const t=ya(i),r=e||t.tonic;return!r||t.empty?[]:t.intervals.map(n=>vr(r,n))}function PO(i,e){const t=ya(i),r=e||t.tonic,n=lC(t.intervals,r);return s=>s?n(s>0?s-1:s):""}function RO(i,e){const t=ya(i),r=e||t.tonic;return lC(t.intervals,r)}var bC={getChord:Ph,get:ya,detect:KM,chordScales:CO,extended:NO,reduced:BO,tokenize:Ey,transpose:TO,degrees:PO,steps:RO,notes:_O,chord:kO},EO=Math.log(2),MO=Math.log(440);function vC(i){const e=12*(Math.log(i)-MO)/EO+69;return Math.round(e*100)/100}var OO="C C# D D# E F F# G G# A A# B".split(" "),IO="C Db D Eb E F Gb G Ab A Bb B".split(" ");function dl(i,e={}){if(isNaN(i)||i===-1/0||i===1/0)return"";i=Math.round(i);const r=(e.sharps===!0?OO:IO)[i%12];if(e.pitchClass)return r;const n=Math.floor(i/12)-1;return r+n}var LO=["C","D","E","F","G","A","B"],wC=i=>i.name,SC=i=>i.map(Fi).filter(e=>!e.empty);function DO(i){return i===void 0?LO.slice():Array.isArray(i)?SC(i).map(wC):[]}var Pn=Fi,FO=i=>Pn(i).name,AO=i=>Pn(i).pc,VO=i=>Pn(i).acc,HO=i=>Pn(i).oct,zO=i=>Pn(i).midi,UO=i=>Pn(i).freq,WO=i=>Pn(i).chroma;function GO(i){return dl(i)}function $O(i){return dl(vC(i))}function jO(i){return dl(vC(i),{sharps:!0})}function YO(i){return dl(i,{sharps:!0})}var oc=vr,XO=vr,xC=i=>e=>oc(e,i),KO=xC,kC=i=>e=>oc(i,e),qO=kC;function TC(i,e){return oc(i,[e,0])}var JO=TC;function QO(i,e){return oc(i,[0,e])}var My=(i,e)=>i.height-e.height,ZO=(i,e)=>e.height-i.height;function CC(i,e){return e=e||My,SC(i).sort(e).map(wC)}function eI(i){return CC(i,My).filter((e,t,r)=>t===0||e!==r[t-1])}var tI=i=>{const e=Pn(i);return e.empty?"":dl(e.midi||e.chroma,{sharps:e.alt>0,pitchClass:e.midi===null})};function iI(i,e){const t=Pn(i);if(t.empty)return"";const r=Pn(e||dl(t.midi||t.chroma,{sharps:t.alt<0,pitchClass:!0}));if(r.empty||r.chroma!==t.chroma)return"";if(t.oct===void 0)return r.pc;const n=t.chroma-t.alt,s=r.chroma-r.alt,a=n>11||s<0?-1:n<0||s>11?1:0,o=t.oct+a;return r.pc+o}var el={names:DO,get:Pn,name:FO,pitchClass:AO,accidentals:VO,octave:HO,midi:zO,ascending:My,descending:ZO,sortedNames:CC,sortedUniqNames:eI,fromMidi:GO,fromMidiSharps:YO,freq:UO,fromFreq:$O,fromFreqSharps:jO,chroma:WO,transpose:oc,tr:XO,transposeBy:xC,trBy:KO,transposeFrom:kC,trFrom:qO,transposeFifths:TC,transposeOctaves:QO,trFifths:JO,simplify:tI,enharmonic:iI},Oy=[[0,2773,0,"ionian","","Maj7","major"],[1,2902,2,"dorian","m","m7"],[2,3418,4,"phrygian","m","m7"],[3,2741,-1,"lydian","","Maj7"],[4,2774,1,"mixolydian","","7"],[5,2906,3,"aeolian","m","m7","minor"],[6,3434,5,"locrian","dim","m7b5"]],Iv={...Ya,name:"",alt:0,modeNum:NaN,triad:"",seventh:"",aliases:[]},rI=Oy.map(nI),Wm={};rI.forEach(i=>{Wm[i.name]=i,i.aliases.forEach(e=>{Wm[e]=i})});function NC(i){return typeof i=="string"?Wm[i.toLowerCase()]||Iv:i&&i.name?NC(i.name):Iv}function nI(i){const[e,t,r,n,s,a,o]=i,l=o?[o]:[],u=Number(t).toString(2);return{empty:!1,intervals:vO(n).intervals,modeNum:e,chroma:u,normalized:u,name:n,setNum:t,alt:r,triad:s,seventh:a,aliases:l}}function BC(i){return(e,t)=>{const r=NC(e);if(r.empty)return[];const n=_y(r.modeNum,i),s=r.intervals.map(a=>vr(t,a));return n.map((a,o)=>s[o]+a)}}BC(Oy.map(i=>i[4]));BC(Oy.map(i=>i[5]));function Ru(i){if(A(i))throw new TypeError("note must be a valid note");const e=i.replace(/[0-9]+/g,""),t=parseInt(i.replace(/[^0-9]+/g,""));return[e,t]}const sI={id:"S?;T?;C,R->C,T,U->C,F,U->N,R-1;",name:"R 3↑ 5↑ NR-1",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"THIRD"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"FIFTH"},{chordRef:"NEXT",dir:"NONE",interval:-1,tone:"ROOT"}],tags:["CHROMATIC_APPROACH"]},aI={id:"S?;T?;C,R->C,T,U->C,F,U->N,R+1;",name:"R 3↑ 5↑ NR+1",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"THIRD"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"FIFTH"},{chordRef:"NEXT",dir:"NONE",interval:1,tone:"ROOT"}],tags:["CHROMATIC_APPROACH"]},oI={id:"S?;T?;C,R->C,T,D->C,F,D->N,R-1;",name:"R 3↓ 5↓ NR-1",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"DOWN",interval:0,tone:"THIRD"},{chordRef:"CURRENT",dir:"DOWN",interval:0,tone:"FIFTH"},{chordRef:"NEXT",dir:"NONE",interval:-1,tone:"ROOT"}],tags:["CHROMATIC_APPROACH"]},lI={id:"S?;T?;C,R->C,T,D->C,F,D->N,R+1;",name:"R 3↓ 5↓ NR+1",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"DOWN",interval:0,tone:"THIRD"},{chordRef:"CURRENT",dir:"DOWN",interval:0,tone:"FIFTH"},{chordRef:"NEXT",dir:"NONE",interval:1,tone:"ROOT"}],tags:["CHROMATIC_APPROACH"]},uI={id:"S?;T?;C,R->C,T,U->C,F,D->N,R-1;",name:"R 3↑ 5↓ NR-1",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"THIRD"},{chordRef:"CURRENT",dir:"DOWN",interval:0,tone:"FIFTH"},{chordRef:"NEXT",dir:"NONE",interval:-1,tone:"ROOT"}],tags:["CHROMATIC_APPROACH"]},cI={id:"S?;T?;C,R->C,T,U->C,F,D->N,R+1;",name:"R 3↑ 5↓ NR+1",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"THIRD"},{chordRef:"CURRENT",dir:"DOWN",interval:0,tone:"FIFTH"},{chordRef:"NEXT",dir:"NONE",interval:1,tone:"ROOT"}],tags:["CHROMATIC_APPROACH"]},hI={id:"S?;T?;C,R->C,T,D->C,F,U->N,R-1;",name:"R 3↓ 5↑ NR-1",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"DOWN",interval:0,tone:"THIRD"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"FIFTH"},{chordRef:"NEXT",dir:"NONE",interval:-1,tone:"ROOT"}],tags:["CHROMATIC_APPROACH"]},dI={id:"S?;T?;C,R->C,T,D->C,F,U->N,R+1;",name:"R 3↓ 5↑ NR+1",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"DOWN",interval:0,tone:"THIRD"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"FIFTH"},{chordRef:"NEXT",dir:"NONE",interval:1,tone:"ROOT"}],tags:["CHROMATIC_APPROACH"]},fI={id:"chordTonesWithChromaticLeadingTone",description:"Universal transitions between any 2 chords, using only chord tones and a chromatic passing note before the change",name:"Chord tones + chromatic",tags:["CHROMATIC_APPROACH"],transitions:[sI,aI,oI,lI,uI,cI,hI,dI]},pI={id:"S?;T?;C,R;",name:"R",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"}],tags:["CHORD_TONE_ONLY"]},gI={id:"S?;T?;C,T,U;",name:"3↑",steps:[{chordRef:"CURRENT",dir:"UP",interval:0,tone:"THIRD"}],tags:["CHORD_TONE_ONLY"]},mI={id:"S?;T?;C,T,D;",name:"3↓",steps:[{chordRef:"CURRENT",dir:"DOWN",interval:0,tone:"THIRD"}],tags:["CHORD_TONE_ONLY"]},yI={id:"S?;T?;C,F,U;",name:"5↑",steps:[{chordRef:"CURRENT",dir:"UP",interval:0,tone:"FIFTH"}],tags:["CHORD_TONE_ONLY"]},bI={id:"S?;T?;C,F,D;",name:"5↓",steps:[{chordRef:"CURRENT",dir:"DOWN",interval:0,tone:"FIFTH"}],tags:["CHORD_TONE_ONLY"]},vI={id:"oneNote",description:"Single note transition",name:"Single note",tags:["CHORD_TONE_ONLY"],transitions:[pI,gI,mI,yI,bI]},wI={id:"SM,dom7,m,m7;T+7;C,R->C,T,U->C,F-2,U->C,F-1,D;",name:"R 3↑ 5-2↑ 5-1↓",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"THIRD"},{chordRef:"CURRENT",dir:"UP",interval:-2,tone:"FIFTH"},{chordRef:"CURRENT",dir:"DOWN",interval:-1,tone:"FIFTH"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MINOR","MINOR-SEVENTH"],target:7},SI={id:"SM,dom7,m,m7;T+7;C,R->C,T,U->C,F+2,U->C,F+1,U;",name:"R 3↑ 5+2↑ 5+1↑",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"THIRD"},{chordRef:"CURRENT",dir:"UP",interval:2,tone:"FIFTH"},{chordRef:"CURRENT",dir:"UP",interval:1,tone:"FIFTH"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MINOR","MINOR-SEVENTH"],target:7},xI={id:"SM,dom7,m,m7;T+7;C,R->C,R+2->C,T,U->C,F-2,U;",name:"R R+2 3↑ 5-2↑",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"NONE",interval:2,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"THIRD"},{chordRef:"CURRENT",dir:"UP",interval:-2,tone:"FIFTH"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MINOR","MINOR-SEVENTH"],target:7},kI={id:"SM,dom7,m,m7;T-5;C,R->C,R-2->C,F+2,D->C,F+1,D;",name:"R R-2 5+2↓ 5+1↓",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"NONE",interval:-2,tone:"ROOT"},{chordRef:"CURRENT",dir:"DOWN",interval:2,tone:"FIFTH"},{chordRef:"CURRENT",dir:"DOWN",interval:1,tone:"FIFTH"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MINOR","MINOR-SEVENTH"],target:-5},TI={id:"SM,dom7,m,m7;T-5;C,R->C,R-2->C,F+2,D->C,R+2,D;",name:"R R-2 5+2↓ R+2↓",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"NONE",interval:-2,tone:"ROOT"},{chordRef:"CURRENT",dir:"DOWN",interval:2,tone:"FIFTH"},{chordRef:"CURRENT",dir:"DOWN",interval:2,tone:"ROOT"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MINOR","MINOR-SEVENTH"],target:-5},CI={id:"oneToFive",description:"Transitioning from I to V chord",name:"I to V chord",tags:[],transitions:[wI,SI,xI,kI,TI]},NI={id:"SM,dom7,m,m7;T+5;C,R->C,R->C,T,U->C,F,U;",name:"R R 3↑ 5↑",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"THIRD"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"FIFTH"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MINOR","MINOR-SEVENTH"],target:5},BI={id:"SM,dom7,m,m7;T+5;C,R->C,F,U->C,R,U->C,F,U;",name:"R 5↑ R↑ 5↑",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"FIFTH"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"FIFTH"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MINOR","MINOR-SEVENTH"],target:5},_I={id:"SM,dom7,m,m7;T+5;C,R->C,R,U->C,R-2,U->C,F,U;",name:"R R↑ R-2↑ 5↑",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:-2,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"FIFTH"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MINOR","MINOR-SEVENTH"],target:5},PI={id:"SM,dom7,m,m7;T+5;C,R->C,R->C,F,U->C,T,U;",name:"R R 5↑ 3↑",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"FIFTH"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"THIRD"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MINOR","MINOR-SEVENTH"],target:5},RI={id:"SM,dom7,m,m7;T+5;C,R->C,T,U->C,F,U->C,T,U;",name:"R 3↑ 5↑ 3↑",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"THIRD"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"FIFTH"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"THIRD"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MINOR","MINOR-SEVENTH"],target:5},EI={id:"SM,dom7,m,m7;T+5;C,R->C,F,U->C,R,U->C,T,U;",name:"R 5↑ R↑ 3↑",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"FIFTH"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"THIRD"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MINOR","MINOR-SEVENTH"],target:5},MI={id:"SM,dom7,m,m7;T+5;C,R->C,R->C,F,U->C,R;",name:"R R 5↑ R",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"FIFTH"},{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MINOR","MINOR-SEVENTH"],target:5},OI={id:"SM,dom7,m,m7;T+5;C,R->C,T,U->C,F,U->C,R;",name:"R 3↑ 5↑ R",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"THIRD"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"FIFTH"},{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MINOR","MINOR-SEVENTH"],target:5},II={id:"SM,dom7,m,m7;T-7;C,R->C,R-2->C,T,D->C,F,D;",name:"R R-2 3↓ 5↓",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"NONE",interval:-2,tone:"ROOT"},{chordRef:"CURRENT",dir:"DOWN",interval:0,tone:"THIRD"},{chordRef:"CURRENT",dir:"DOWN",interval:0,tone:"FIFTH"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MINOR","MINOR-SEVENTH"],target:-7},LI={id:"SM,dom7,m,m7;T-7;C,R->C,R-2->C,F,D->C,T,D;",name:"R R-2 5↓ 3↓",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"NONE",interval:-2,tone:"ROOT"},{chordRef:"CURRENT",dir:"DOWN",interval:0,tone:"FIFTH"},{chordRef:"CURRENT",dir:"DOWN",interval:0,tone:"THIRD"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MINOR","MINOR-SEVENTH"],target:-7},DI={id:"SM,dom7,m,m7;T-7;C,R->C,F,D->C,T,D->C,F,D;",name:"R 5↓ 3↓ 5↓",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"DOWN",interval:0,tone:"FIFTH"},{chordRef:"CURRENT",dir:"DOWN",interval:0,tone:"THIRD"},{chordRef:"CURRENT",dir:"DOWN",interval:0,tone:"FIFTH"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MINOR","MINOR-SEVENTH"],target:-7},FI={id:"SM,dom7,m,m7;T-7;C,R->C,T,D->C,F,D->C,R,D;",name:"R 3↓ 5↓ R↓",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"DOWN",interval:0,tone:"THIRD"},{chordRef:"CURRENT",dir:"DOWN",interval:0,tone:"FIFTH"},{chordRef:"CURRENT",dir:"DOWN",interval:0,tone:"ROOT"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MINOR","MINOR-SEVENTH"],target:-7},AI={id:"SM,dom7,m,m7;T-7;C,R->C,R-2->C,F,D->C,R,D;",name:"R R-2 5↓ R↓",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"NONE",interval:-2,tone:"ROOT"},{chordRef:"CURRENT",dir:"DOWN",interval:0,tone:"FIFTH"},{chordRef:"CURRENT",dir:"DOWN",interval:0,tone:"ROOT"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MINOR","MINOR-SEVENTH"],target:-7},VI={id:"oneToFour",description:"Transitioning from I to IV chord",name:"I to IV chord",tags:[],transitions:[NI,BI,_I,PI,RI,EI,MI,OI,II,LI,DI,FI,AI]},HI={id:"SM,dom7,m,m7;T+9;C,R->C,T,U->C,F,U->C,F+1,U;",name:"R 3↑ 5↑ 5+1↑",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"THIRD"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"FIFTH"},{chordRef:"CURRENT",dir:"UP",interval:1,tone:"FIFTH"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MINOR","MINOR-SEVENTH"],target:9},zI={id:"SM,dom7,m,m7;T-3;C,R->C,R->C,R-1->C,R-2;",name:"R R R-1 R-2",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"NONE",interval:-1,tone:"ROOT"},{chordRef:"CURRENT",dir:"NONE",interval:-2,tone:"ROOT"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MINOR","MINOR-SEVENTH"],target:-3},UI={id:"SM,dom7,m,m7;T-3;C,R->C,R+2->C,R+3->C,R+4;",name:"R R+2 R+3 R+4",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"NONE",interval:2,tone:"ROOT"},{chordRef:"CURRENT",dir:"NONE",interval:3,tone:"ROOT"},{chordRef:"CURRENT",dir:"NONE",interval:4,tone:"ROOT"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MINOR","MINOR-SEVENTH"],target:-3},WI={id:"SM,dom7,m,m7;T+9;C,R->C,R+2->C,T,U->C,F,U;",name:"R R+2 3↑ 5↑",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"NONE",interval:2,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"THIRD"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"FIFTH"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MINOR","MINOR-SEVENTH"],target:9},GI={id:"oneToSix",description:"Transitioning from I to VI chord",name:"I to VI chord",tags:[],transitions:[HI,zI,UI,WI]},$I={id:"SM,dom7,m,m7;T+4;C,R->C,R->C,R+2->N,R-1;",name:"R R R+2 NR-1",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"NONE",interval:2,tone:"ROOT"},{chordRef:"NEXT",dir:"NONE",interval:-1,tone:"ROOT"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MINOR","MINOR-SEVENTH"],target:4},jI={id:"SM,dom7,m,m7;T+4;C,R->C,R+2->C,F,U->N,R+1;",name:"R R+2 5↑ NR+1",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"NONE",interval:2,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"FIFTH"},{chordRef:"NEXT",dir:"NONE",interval:1,tone:"ROOT"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MINOR","MINOR-SEVENTH"],target:4},YI={id:"SM,dom7,m,m7;T+4;C,R->C,T,U->C,F,U->N,R+1;",name:"R 3↑ 5↑ NR+1",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"THIRD"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"FIFTH"},{chordRef:"NEXT",dir:"NONE",interval:1,tone:"ROOT"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MINOR","MINOR-SEVENTH"],target:4},XI={id:"SM,dom7,m,m7;T+4;C,R->C,R+1->C,R+2->C,R+3;",name:"R R+1 R+2 R+3",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"NONE",interval:1,tone:"ROOT"},{chordRef:"CURRENT",dir:"NONE",interval:2,tone:"ROOT"},{chordRef:"CURRENT",dir:"NONE",interval:3,tone:"ROOT"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MINOR","MINOR-SEVENTH"],target:4},KI={id:"oneToThree",description:"Transitioning from I to III chord",name:"I to III chord",tags:[],transitions:[$I,jI,YI,XI]},qI={id:"SM,dom7,maj7;T+2;C,R->C,F,U->C,T,U->C,T-1,U;",name:"R 5↑ 3↑ 3-1↑",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"FIFTH"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"THIRD"},{chordRef:"CURRENT",dir:"UP",interval:-1,tone:"THIRD"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MAJOR-SEVENTH"],target:2},JI={id:"SM,dom7,m,m7;T+2;C,R->C,R-2->C,R->C,R+1;",name:"R R-2 R R+1",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"NONE",interval:-2,tone:"ROOT"},{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"NONE",interval:1,tone:"ROOT"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MINOR","MINOR-SEVENTH"],target:2},QI={id:"oneToTwo",description:"Transitioning from I to III chord",name:"I to II chord",tags:[],transitions:[qI,JI]},ZI={id:"S?;T?;C,R->C,T,U;",name:"R 3↑",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"THIRD"}],tags:["CHORD_TONE_ONLY"]},eL={id:"S?;T?;C,R->C,T,D;",name:"R 3↓",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"DOWN",interval:0,tone:"THIRD"}],tags:["CHORD_TONE_ONLY"]},tL={id:"S?;T?;C,R->C,F,U;",name:"R 5↑",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"FIFTH"}],tags:["CHORD_TONE_ONLY"]},iL={id:"S?;T?;C,R->C,F,D;",name:"R 5↓",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"DOWN",interval:0,tone:"FIFTH"}],tags:["CHORD_TONE_ONLY"]},rL={id:"rootAndChordTone",description:"Root and another chord tone passing to the next chord.",name:"Root + chord tone",tags:["CHORD_TONE_ONLY"],transitions:[ZI,eL,tL,iL]},nL={id:"S?;T?;C,R->N,R-1;",name:"R NR-1",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"NEXT",dir:"NONE",interval:-1,tone:"ROOT"}],tags:["CHROMATIC_APPROACH"]},sL={id:"S?;T?;C,R->N,R+1;",name:"R NR+1",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"NEXT",dir:"NONE",interval:1,tone:"ROOT"}],tags:["CHROMATIC_APPROACH"]},aL={id:"rootToChromaticPassingTone",description:"Root and chromatic note moving to the next chord.",name:"Root + chromatic",tags:["CHROMATIC_APPROACH"],transitions:[nL,sL]},oL={id:"S?;T+0;C,R->C,T,U->C,R->C,F,D;",name:"R 3↑ R 5↓",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"THIRD"},{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"DOWN",interval:0,tone:"FIFTH"}],tags:[],target:0},lL={id:"S?;T+0;C,R->C,F,D->C,R->C,T,U;",name:"R 5↓ R 3↑",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"DOWN",interval:0,tone:"FIFTH"},{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"THIRD"}],tags:[],target:0},uL={id:"S?;T+0;C,R->C,R-2->C,R-3->C,R-2;",name:"R R-2 R-3 R-2",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"NONE",interval:-2,tone:"ROOT"},{chordRef:"CURRENT",dir:"NONE",interval:-3,tone:"ROOT"},{chordRef:"CURRENT",dir:"NONE",interval:-2,tone:"ROOT"}],tags:[],target:0},cL={id:"S?;T+0;C,R->C,F,D->C,R-2->C,R-1;",name:"R 5↓ R-2 R-1",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"DOWN",interval:0,tone:"FIFTH"},{chordRef:"CURRENT",dir:"NONE",interval:-2,tone:"ROOT"},{chordRef:"CURRENT",dir:"NONE",interval:-1,tone:"ROOT"}],tags:[],target:0},hL={id:"stationary",description:"Transition for when staying on the same chord",name:"Stationary transitions",tags:[],transitions:[oL,lL,uL,cL]},dL={id:"SM,dom7,m,m7;T-2;C,R->C,F,D->C,R->C,R-1;",name:"R 5↓ R R-1",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"DOWN",interval:0,tone:"FIFTH"},{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"NONE",interval:-1,tone:"ROOT"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MINOR","MINOR-SEVENTH"],target:-2},fL={id:"SM,dom7,m,m7;T-2;C,R->C,T,U->C,R->C,R-1;",name:"R 3↑ R R-1",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"THIRD"},{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"NONE",interval:-1,tone:"ROOT"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MINOR","MINOR-SEVENTH"],target:-2},pL={id:"SM,dom7,m,m7;T+10;C,R->C,T,U->C,F,U->C,F+2,U;",name:"R 3↑ 5↑ 5+2↑",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"THIRD"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"FIFTH"},{chordRef:"CURRENT",dir:"UP",interval:2,tone:"FIFTH"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MINOR","MINOR-SEVENTH"],target:10},gL={id:"SM,dom7,m,m7;T+10;C,R->C,T,U->C,F,U->C,R,U;",name:"R 3↑ 5↑ R↑",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"THIRD"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"FIFTH"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"ROOT"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MINOR","MINOR-SEVENTH"],target:10},mL={id:"SM,dom7,m,m7;T+10;C,R->C,R+2,U->C,T,U->C,F-2,U;",name:"R R+2↑ 3↑ 5-2↑",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:2,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"THIRD"},{chordRef:"CURRENT",dir:"UP",interval:-2,tone:"FIFTH"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MINOR","MINOR-SEVENTH"],target:10},yL={id:"SM,dom7,m,m7;T+10;C,R->C,F,U->C,R,U->C,F+2,U;",name:"R 5↑ R↑ 5+2↑",steps:[{chordRef:"CURRENT",dir:"NONE",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"FIFTH"},{chordRef:"CURRENT",dir:"UP",interval:0,tone:"ROOT"},{chordRef:"CURRENT",dir:"UP",interval:2,tone:"FIFTH"}],tags:[],source:["MAJOR","DOMINANT-SEVENTH","MINOR","MINOR-SEVENTH"],target:10},bL={id:"twoToOne",description:"Transitioning from I to II chord",name:"II to I chord",tags:[],transitions:[dL,fL,pL,gL,mL,yL]},_C=[fI,vI,CI,VI,GI,KI,QI,rL,aL,hL,bL],vL=["G2","D2","A1","E1"],wL=["G2","D2","A1","E1","B0"],PC=["E5","B4","G4","D4","A3","E3"],SL={C:0,"C#":1,Db:1,D:2,"D#":3,Eb:3,E:4,F:5,"F#":6,Gb:6,G:7,"G#":8,Ab:8,A:9,"A#":10,Bb:10,B:11},RC=Object.keys(SL),xL={0:["C"],1:["C#","Db"],2:["D"],3:["D#","Eb"],4:["E"],5:["F"],6:["F#","Gb"],7:["G"],8:["G#","Ab"],9:["A"],10:["A#","Bb"],11:["B"]},kL=[0,1,2,3,4,5,6,7,8],EC=kL.flatMap(i=>RC.map(e=>`${e}${i}`));EC.reduce((i,e)=>{const[t]=Ru(e);return Array.isArray(i[t])||(i[t]=[]),i[t].push(e),i},{});const TL={MAJOR:!0,"DOMINANT-SEVENTH":!0,"MAJOR-SEVENTH":!0,MINOR:!0,"MINOR-SEVENTH":!0,DIMINISHED:!0,"HALF-DIMINISHED":!0,"DIMINISHED-SEVENTH":!0,AUGMENTED:!0,"AUGMENTED-SEVENTH":!0},CL=Object.keys(TL),wf=12,NL=Bs.fromSemitones(wf),BL=Bs.fromSemitones(wf*2),_L=Bs.fromSemitones(-wf);Bs.fromSemitones(-wf*2);const PL=[0,1,2,3,4,5,6,7,8,9,10,11,12].map(Bs.fromSemitones),Sf=_C.flatMap(({transitions:i})=>i).reduce((i,e)=>Object.assign(i,{[e.id]:e}),{}),RL=Object.values(Sf);function Ho(i,e){return Object.entries(e??{}).filter(([t])=>!i.includes(t)).reduce((t,[r,n])=>({...t,[r]:n}),{})}function MC(i,e){return Object.entries(i??{}).map(([t,r],n)=>[t,e(r,n,t,i)]).reduce((t,[r,n])=>({...t,[r]:n}),{})}function Fa(i,e){if(e.length===0)return i;const t={...i};for(let r of e)t[r.id]=r;return t}function Iy(i,e,t){const r=i[e];return A(r)?i:{...i,[e]:{...r,...t}}}function EL(i,e,t){return[...i.slice(0,t),e,...i.slice(t)]}function OC(i,e){return A(i)||A(e)?[]:e.filter(t=>{const[r]=Ru(t);return r===i}).sort()}function ML(i,e,t){return Math.floor((1-t)*i+t*e)}function OL(i,e){if(e<=0||e>=i.length)return[...i];const t=[...i],r=t[e];return t[e]=t[e-1],t[e-1]=r,t}function IL(i,e){return i.slice(0,e).concat(i.slice(e+1))}function LL(i,e,t){const r=Array.from(i);return r.splice(t<0?r.length+t:t,0,r.splice(e,1)[0]),r}function DL(i,e){if(e<0||e>=i.length-1)return[...i];const t=[...i],r=t[e];return t[e]=t[e+1],t[e+1]=r,t}function IC(i,e,t="-"){let r=i,n=1;for(;e.has(r);)r=`${i}${t}${n++}`;return r}function FL(i){const e=i.reduce((n,s)=>n+s[1],0),t=Math.random()*e;let r=0;for(const[n,s]of i)if(r+=s,t<r)return n;throw new Error("Should never reach here if input is valid")}function LC(){}const on=mf({name:"bars",initialState:yf.bars,reducers:{createBar:(i,{payload:e})=>({...i,[e.bar.id]:e.bar}),updateBar:(i,e)=>Iy(i,e.payload.barId,e.payload.updates)},selectors:{getBar:(i,e)=>{if(!A(e))return i[e]}}}),tr=mf({name:"chords",initialState:yf.chords,reducers:{createChord:(i,{payload:e})=>({...i,[e.chord.id]:e.chord}),updateChord:(i,e)=>Iy(i,e.payload.chordId,e.payload.updates)},selectors:{getChord:(i,e)=>{if(!A(e))return i[e]}}}),Ra=mf({name:"config",initialState:yf.config,reducers:{updateConfig:(i,{payload:e})=>({...i,...e})},selectors:{}}),Vi=mf({name:"progressions",initialState:yf.progressions,reducers:{createProgression:(i,{payload:e})=>({...i,[e.progression.id]:e.progression}),updateProgression:(i,e)=>Iy(i,e.payload.progressionId,e.payload.updates)},selectors:{getProgressions:i=>Array.from(Object.values(i)),getProgression:(i,e)=>A(e)?void 0:i[e],getDefaultProgression:i=>i.default}});function AL(i){if(i.length===0)return console.error(`Needs at least one note, was: ${i}`),[-1,-1];const e=i.map(n=>[n,el.freq(n)]);let t=e[0],r=e[0];for(let n=1;n<e.length;n++){const s=e[n];s[1]<t[1]&&(t=s),s[1]>r[1]&&(r=s)}return[t[1],el.freq(vr(r[0],BL))]}function Ly(i,e=!0){switch(i){case"MAJOR":return e?"":"maj";case"DOMINANT-SEVENTH":return"7";case"MAJOR-SEVENTH":return"maj7";case"MINOR":return"m";case"MINOR-SEVENTH":return"m7";case"DIMINISHED":return"dim";case"HALF-DIMINISHED":return"m7b5";case"DIMINISHED-SEVENTH":return"dim7";case"AUGMENTED":return"aug";case"AUGMENTED-SEVENTH":return"aug7"}}function VL(i,e){const t=Ly(i.type,!1),r=bC.notes(t,i.root);switch(e){case"ROOT":return r[0];case"THIRD":return r[1];case"FIFTH":return r[2]}}function HL(i,e,t){const r=VL(i,e);switch(t){case"NONE":{if(e!=="ROOT")throw new TypeError('cannot be "NONE" unless referring a root');return r}case"UP":return e==="ROOT"?vr(r,NL):r;case"DOWN":return vr(r,_L)}}function zL(i,e,t){const r=t.chordRef==="CURRENT"?i:e,n=HL(r,t.tone,t.dir),s=Bs.fromSemitones(t.interval);return vr(n,s)}function DC(i,e,t){return t.steps.map(r=>zL(i,e,r))}function Dy(i,e,t,r,n=4){if(A(i)||A(e)||A(t)||A(r))return!1;const s=DC(i,e,r),[a,o]=AL(t);if(!s.every(c=>{const h=el.freq(c);return h>=a&&h<=o})||!A(r.source)&&!r.source.includes(i.type))return!1;const u=Bs.semitones(Zo(i.root,e.root));return!(!A(r.target)&&![r.target].includes(u)||r.steps.length!==n)}const UL={allowEmptyProgression:!1,allowEmptyBars:!1};function*FC(i,e,t={}){const r={...UL,...t},n=Vi.selectors.getProgression(i,e);if(A(n))throw new Error(`Progression with id "${e}" doesn't exist.`);if(!r.allowEmptyProgression&&n.bars.length===0)throw new TypeError(`Progression "${e}" has no bars.`);for(let s=0;s<n.bars.length;s+=1){const a=n.bars[s],o=on.selectors.getBar(i,a);if(A(o))throw new Error(`Bar with id "${a}" doesn't exist.`);if(!r.allowEmptyBars&&o.chords.length===0&&s!==n.bars.length-1)throw new Error(`Bar "${a}" has no chords.`);for(let l=0;l<o.chords.length;l+=1){const u=o.chords[l],c=tr.selectors.getChord(i,u);if(A(c))throw new Error(`Chord with id "${u}" doesn't exist.`);yield[c,o]}}}function WL(i,e){try{const t=Vi.selectors.getProgression(i,e.payload.progressionId),r=t==null?void 0:t.tuning;if(A(t)||A(r))return i;const n=[],s=FC(i,e.payload.progressionId),a=Array.from(s);for(let l=0;l<a.length;l+=1){const[u]=a[l];if(!A(u.transitionId)||l===a.length-1)continue;const[c]=a[l+1],h=u.noteCount??t.noteCount??4,d=Array.from(new Set([...t.tags??[],...u.tags??[]])),f=RL.filter(g=>Dy(u,c,r,g,h)).filter(g=>d.every(y=>g.tags.includes(y))).map(g=>{const y=(A(g.source)?0:10)+(A(g.target)?0:10)+1;return[g,y]});if(f.length===0)continue;const p=FL(f);n.push({...u,transitionId:p.id})}const o={...i.chords};for(let l of n)o[l.id]=l;return{...i,chords:o}}catch(t){return console.error(t),i}}function GL(i,e){try{const t={...i.chords},r=FC(i,e.payload.progressionId,{allowEmptyBars:!0,allowEmptyProgression:!0});for(let[{transitionId:n,...s}]of r)t[s.id]=s;return{...i,chords:t}}catch(t){return console.error(t),i}}function $L(i,e){const t=e.payload.template;return{...i,bars:{...i.bars,...t.bars},chords:{...i.chords,...t.chords},progressions:{...i.progressions,[t.progression.id]:t.progression}}}function xf(i,e){const{progressions:t,chords:r,bars:n}=i,s=[],a=A(e)?Object.values(t):[t[e]];for(let l=0;l<a.length;l++){const u=a[l];if(!A(u))for(let c=0;c<u.bars.length;c++){const h=u.bars[c],d=n[h];if(A(d))continue;const f=u.bars[c+1],p=A(f)?void 0:n[f];if((A(p)||p.chords.length===0)&&d.chords.length>0){const y=d.chords[d.chords.length-1],b=r[y];A(b)||s.push(b)}}}const o=s.filter(l=>!A(l.transitionId)).map(l=>({...l,transitionId:void 0}));return{...i,chords:Fa(r,o)}}function jL(i,e){const{chordIds:t,progressionId:r}=e.payload,n=A(r)?void 0:i.progressions[r],s=((n==null?void 0:n.bars)??[]).flatMap(u=>{var c;return((c=i.bars[u])==null?void 0:c.chords)??[]}),a=A(n)?t:t.filter(u=>s.includes(u)),o=Ho(a,i.chords),l=MC(i.bars,u=>{if(u.chords.some(c=>a.includes(c))){const c=u.chords.filter(h=>!a.includes(h));return{...u,chords:c}}return u});return xf({...i,chords:o,bars:l},r)}function YL(i,e){const{barIds:t,progressionId:r}=e.payload,n=A(r)?void 0:i.progressions[r],s=A(n)?t:t.filter(c=>n.bars.includes(c)),a=s.map(c=>i.bars[c]).filter(c=>!A(c)).flatMap(c=>c.chords),o=Ho(s,i.bars),l=Ho(a,i.chords),u=MC(i.progressions,c=>{if(c.bars.some(h=>s.includes(h))){const h=c.bars.filter(d=>!s.includes(d));return{...c,bars:h}}return c});return xf({...i,bars:o,chords:l,progressions:u},r)}function XL(i,e){const{progressionIds:t}=e.payload,r=t.map(s=>i.progressions[s]).filter(s=>!A(s)).flatMap(s=>s.bars),n=r.map(s=>i.bars[s]).filter(s=>!A(s)).flatMap(s=>s.chords);return{...i,progressions:Ho(t,i.progressions),bars:Ho(r,i.bars),chords:Ho(n,i.chords)}}const KL="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let Ir=(i=21)=>{let e="",t=crypto.getRandomValues(new Uint8Array(i));for(;i--;)e+=KL[t[i]&63];return e};function qL(i,e){const{barId:t,progressionId:r}=e.payload,n=i.bars[t],s=i.progressions[r],a=((n==null?void 0:n.chords)??[]).map(h=>i.chords[h]).filter(ZT);if(A(n)||A(s))return i;const o=s.bars.indexOf(t);if(o<0)return i;const l=a.map(h=>({...h,id:Ir()})),u={...n,id:Ir(),chords:l.map(h=>h.id)},c={...s,bars:EL(s.bars,u.id,o)};return{...i,progressions:Fa(i.progressions,[c]),bars:Fa(i.bars,[u]),chords:Fa(i.chords,l)}}function JL(i,e){const{barId:t,overId:r,progressionId:n}=e.payload,s=i.progressions[n];if(A(s))return i;const a=s.bars.indexOf(t),o=s.bars.indexOf(r);if(o<0||a<0)return i;const l={...s,bars:LL(s.bars,a,o)};return xf({...i,progressions:Fa(i.progressions,[l])},n)}function QL(i,e){const{progressionId:t,noteCount:r}=e.payload,n=i.progressions[t];if(A(n))return i;const s=n.bars.map(o=>i.bars[o]).flatMap(o=>(o==null?void 0:o.chords)??[]).map(o=>i.chords[o]).filter(ZT).map(o=>{if(A(o.transitionId)||!A(o.noteCount))return o;const l=Sf[o.transitionId];return A(l)||l.steps.length!==r?{...o,transitionId:void 0}:o}),a={...n,noteCount:r};return xf({...i,progressions:Fa(i.progressions,[a]),chords:Fa(i.chords,s)},t)}const ZL=VT({bars:on.reducer,chords:tr.reducer,config:Ra.reducer,progressions:Vi.reducer});function e3(i,e){switch(e.type){case"global/fillTransitions":return WL(i,e);case"global/clearTransitions":return GL(i,e);case"global/createProgressionFromTemplate":return $L(i,e);case"global/deleteChords":return jL(i,e);case"global/deleteBars":return YL(i,e);case"global/deleteProgressions":return XL(i,e);case"global/cloneBar":return qL(i,e);case"global/moveBar":return JL(i,e);case"global/setNoteCount":return QL(i,e);default:return ZL(i,e)}}const Lv={config:{isLooping:!1,masterVolume:1,bassVolume:.5,metronomeVolume:0,chordsVolume:0},progressions:{},bars:{},chords:{}},AC="stick-app-data";function t3(i){try{localStorage.setItem(AC,JSON.stringify(i))}catch(e){console.error("Could not save state",e)}}function i3(){try{const i=localStorage.getItem(AC);return i===null?Lv:JSON.parse(i)}catch(i){return console.error("Could not load state",i),Lv}}const r3=i=>e=>t=>{const r=e(t);return t3(i.getState()),r},Na=YE({reducer:e3,middleware:i=>i().concat(r3),preloadedState:i3()});function n3(i){if(i.sheet)return i.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===i)return document.styleSheets[e]}function s3(i){var e=document.createElement("style");return e.setAttribute("data-emotion",i.key),i.nonce!==void 0&&e.setAttribute("nonce",i.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var a3=function(){function i(t){var r=this;this._insertTag=function(n){var s;r.tags.length===0?r.insertionPoint?s=r.insertionPoint.nextSibling:r.prepend?s=r.container.firstChild:s=r.before:s=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(n,s),r.tags.push(n)},this.isSpeedy=t.speedy===void 0?!0:t.speedy,this.tags=[],this.ctr=0,this.nonce=t.nonce,this.key=t.key,this.container=t.container,this.prepend=t.prepend,this.insertionPoint=t.insertionPoint,this.before=null}var e=i.prototype;return e.hydrate=function(r){r.forEach(this._insertTag)},e.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(s3(this));var n=this.tags[this.tags.length-1];if(this.isSpeedy){var s=n3(n);try{s.insertRule(r,s.cssRules.length)}catch{}}else n.appendChild(document.createTextNode(r));this.ctr++},e.flush=function(){this.tags.forEach(function(r){return r.parentNode&&r.parentNode.removeChild(r)}),this.tags=[],this.ctr=0},i}(),Gi="-ms-",md="-moz-",ht="-webkit-",VC="comm",Fy="rule",Ay="decl",o3="@import",HC="@keyframes",l3="@layer",u3=Math.abs,kf=String.fromCharCode,c3=Object.assign;function h3(i,e){return Li(i,0)^45?(((e<<2^Li(i,0))<<2^Li(i,1))<<2^Li(i,2))<<2^Li(i,3):0}function zC(i){return i.trim()}function d3(i,e){return(i=e.exec(i))?i[0]:i}function dt(i,e,t){return i.replace(e,t)}function Gm(i,e){return i.indexOf(e)}function Li(i,e){return i.charCodeAt(e)|0}function Eu(i,e,t){return i.slice(e,t)}function Hn(i){return i.length}function Vy(i){return i.length}function Gc(i,e){return e.push(i),i}function f3(i,e){return i.map(e).join("")}var Tf=1,tl=1,UC=0,wr=0,fi=0,fl="";function Cf(i,e,t,r,n,s,a){return{value:i,root:e,parent:t,type:r,props:n,children:s,line:Tf,column:tl,length:a,return:""}}function El(i,e){return c3(Cf("",null,null,"",null,null,0),i,{length:-i.length},e)}function p3(){return fi}function g3(){return fi=wr>0?Li(fl,--wr):0,tl--,fi===10&&(tl=1,Tf--),fi}function Dr(){return fi=wr<UC?Li(fl,wr++):0,tl++,fi===10&&(tl=1,Tf++),fi}function qn(){return Li(fl,wr)}function Rh(){return wr}function lc(i,e){return Eu(fl,i,e)}function Mu(i){switch(i){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function WC(i){return Tf=tl=1,UC=Hn(fl=i),wr=0,[]}function GC(i){return fl="",i}function Eh(i){return zC(lc(wr-1,$m(i===91?i+2:i===40?i+1:i)))}function m3(i){for(;(fi=qn())&&fi<33;)Dr();return Mu(i)>2||Mu(fi)>3?"":" "}function y3(i,e){for(;--e&&Dr()&&!(fi<48||fi>102||fi>57&&fi<65||fi>70&&fi<97););return lc(i,Rh()+(e<6&&qn()==32&&Dr()==32))}function $m(i){for(;Dr();)switch(fi){case i:return wr;case 34:case 39:i!==34&&i!==39&&$m(fi);break;case 40:i===41&&$m(i);break;case 92:Dr();break}return wr}function b3(i,e){for(;Dr()&&i+fi!==57;)if(i+fi===84&&qn()===47)break;return"/*"+lc(e,wr-1)+"*"+kf(i===47?i:Dr())}function v3(i){for(;!Mu(qn());)Dr();return lc(i,wr)}function w3(i){return GC(Mh("",null,null,null,[""],i=WC(i),0,[0],i))}function Mh(i,e,t,r,n,s,a,o,l){for(var u=0,c=0,h=a,d=0,f=0,p=0,g=1,y=1,b=1,m=0,v="",k=n,x=s,C=r,N=v;y;)switch(p=m,m=Dr()){case 40:if(p!=108&&Li(N,h-1)==58){Gm(N+=dt(Eh(m),"&","&\f"),"&\f")!=-1&&(b=-1);break}case 34:case 39:case 91:N+=Eh(m);break;case 9:case 10:case 13:case 32:N+=m3(p);break;case 92:N+=y3(Rh()-1,7);continue;case 47:switch(qn()){case 42:case 47:Gc(S3(b3(Dr(),Rh()),e,t),l);break;default:N+="/"}break;case 123*g:o[u++]=Hn(N)*b;case 125*g:case 59:case 0:switch(m){case 0:case 125:y=0;case 59+c:b==-1&&(N=dt(N,/\f/g,"")),f>0&&Hn(N)-h&&Gc(f>32?Fv(N+";",r,t,h-1):Fv(dt(N," ","")+";",r,t,h-2),l);break;case 59:N+=";";default:if(Gc(C=Dv(N,e,t,u,c,n,o,v,k=[],x=[],h),s),m===123)if(c===0)Mh(N,e,C,C,k,s,h,o,x);else switch(d===99&&Li(N,3)===110?100:d){case 100:case 108:case 109:case 115:Mh(i,C,C,r&&Gc(Dv(i,C,C,0,0,n,o,v,n,k=[],h),x),n,x,h,o,r?k:x);break;default:Mh(N,C,C,C,[""],x,0,o,x)}}u=c=f=0,g=b=1,v=N="",h=a;break;case 58:h=1+Hn(N),f=p;default:if(g<1){if(m==123)--g;else if(m==125&&g++==0&&g3()==125)continue}switch(N+=kf(m),m*g){case 38:b=c>0?1:(N+="\f",-1);break;case 44:o[u++]=(Hn(N)-1)*b,b=1;break;case 64:qn()===45&&(N+=Eh(Dr())),d=qn(),c=h=Hn(v=N+=v3(Rh())),m++;break;case 45:p===45&&Hn(N)==2&&(g=0)}}return s}function Dv(i,e,t,r,n,s,a,o,l,u,c){for(var h=n-1,d=n===0?s:[""],f=Vy(d),p=0,g=0,y=0;p<r;++p)for(var b=0,m=Eu(i,h+1,h=u3(g=a[p])),v=i;b<f;++b)(v=zC(g>0?d[b]+" "+m:dt(m,/&\f/g,d[b])))&&(l[y++]=v);return Cf(i,e,t,n===0?Fy:o,l,u,c)}function S3(i,e,t){return Cf(i,e,t,VC,kf(p3()),Eu(i,2,-2),0)}function Fv(i,e,t,r){return Cf(i,e,t,Ay,Eu(i,0,r),Eu(i,r+1,-1),r)}function zo(i,e){for(var t="",r=Vy(i),n=0;n<r;n++)t+=e(i[n],n,i,e)||"";return t}function x3(i,e,t,r){switch(i.type){case l3:if(i.children.length)break;case o3:case Ay:return i.return=i.return||i.value;case VC:return"";case HC:return i.return=i.value+"{"+zo(i.children,r)+"}";case Fy:i.value=i.props.join(",")}return Hn(t=zo(i.children,r))?i.return=i.value+"{"+t+"}":""}function k3(i){var e=Vy(i);return function(t,r,n,s){for(var a="",o=0;o<e;o++)a+=i[o](t,r,n,s)||"";return a}}function T3(i){return function(e){e.root||(e=e.return)&&i(e)}}function C3(i){var e=Object.create(null);return function(t){return e[t]===void 0&&(e[t]=i(t)),e[t]}}var N3=function(e,t,r){for(var n=0,s=0;n=s,s=qn(),n===38&&s===12&&(t[r]=1),!Mu(s);)Dr();return lc(e,wr)},B3=function(e,t){var r=-1,n=44;do switch(Mu(n)){case 0:n===38&&qn()===12&&(t[r]=1),e[r]+=N3(wr-1,t,r);break;case 2:e[r]+=Eh(n);break;case 4:if(n===44){e[++r]=qn()===58?"&\f":"",t[r]=e[r].length;break}default:e[r]+=kf(n)}while(n=Dr());return e},_3=function(e,t){return GC(B3(WC(e),t))},Av=new WeakMap,P3=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var t=e.value,r=e.parent,n=e.column===r.column&&e.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(e.props.length===1&&t.charCodeAt(0)!==58&&!Av.get(r))&&!n){Av.set(e,!0);for(var s=[],a=_3(t,s),o=r.props,l=0,u=0;l<a.length;l++)for(var c=0;c<o.length;c++,u++)e.props[u]=s[l]?a[l].replace(/&\f/g,o[c]):o[c]+" "+a[l]}}},R3=function(e){if(e.type==="decl"){var t=e.value;t.charCodeAt(0)===108&&t.charCodeAt(2)===98&&(e.return="",e.value="")}};function $C(i,e){switch(h3(i,e)){case 5103:return ht+"print-"+i+i;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return ht+i+i;case 5349:case 4246:case 4810:case 6968:case 2756:return ht+i+md+i+Gi+i+i;case 6828:case 4268:return ht+i+Gi+i+i;case 6165:return ht+i+Gi+"flex-"+i+i;case 5187:return ht+i+dt(i,/(\w+).+(:[^]+)/,ht+"box-$1$2"+Gi+"flex-$1$2")+i;case 5443:return ht+i+Gi+"flex-item-"+dt(i,/flex-|-self/,"")+i;case 4675:return ht+i+Gi+"flex-line-pack"+dt(i,/align-content|flex-|-self/,"")+i;case 5548:return ht+i+Gi+dt(i,"shrink","negative")+i;case 5292:return ht+i+Gi+dt(i,"basis","preferred-size")+i;case 6060:return ht+"box-"+dt(i,"-grow","")+ht+i+Gi+dt(i,"grow","positive")+i;case 4554:return ht+dt(i,/([^-])(transform)/g,"$1"+ht+"$2")+i;case 6187:return dt(dt(dt(i,/(zoom-|grab)/,ht+"$1"),/(image-set)/,ht+"$1"),i,"")+i;case 5495:case 3959:return dt(i,/(image-set\([^]*)/,ht+"$1$`$1");case 4968:return dt(dt(i,/(.+:)(flex-)?(.*)/,ht+"box-pack:$3"+Gi+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+ht+i+i;case 4095:case 3583:case 4068:case 2532:return dt(i,/(.+)-inline(.+)/,ht+"$1$2")+i;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Hn(i)-1-e>6)switch(Li(i,e+1)){case 109:if(Li(i,e+4)!==45)break;case 102:return dt(i,/(.+:)(.+)-([^]+)/,"$1"+ht+"$2-$3$1"+md+(Li(i,e+3)==108?"$3":"$2-$3"))+i;case 115:return~Gm(i,"stretch")?$C(dt(i,"stretch","fill-available"),e)+i:i}break;case 4949:if(Li(i,e+1)!==115)break;case 6444:switch(Li(i,Hn(i)-3-(~Gm(i,"!important")&&10))){case 107:return dt(i,":",":"+ht)+i;case 101:return dt(i,/(.+:)([^;!]+)(;|!.+)?/,"$1"+ht+(Li(i,14)===45?"inline-":"")+"box$3$1"+ht+"$2$3$1"+Gi+"$2box$3")+i}break;case 5936:switch(Li(i,e+11)){case 114:return ht+i+Gi+dt(i,/[svh]\w+-[tblr]{2}/,"tb")+i;case 108:return ht+i+Gi+dt(i,/[svh]\w+-[tblr]{2}/,"tb-rl")+i;case 45:return ht+i+Gi+dt(i,/[svh]\w+-[tblr]{2}/,"lr")+i}return ht+i+Gi+i+i}return i}var E3=function(e,t,r,n){if(e.length>-1&&!e.return)switch(e.type){case Ay:e.return=$C(e.value,e.length);break;case HC:return zo([El(e,{value:dt(e.value,"@","@"+ht)})],n);case Fy:if(e.length)return f3(e.props,function(s){switch(d3(s,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return zo([El(e,{props:[dt(s,/:(read-\w+)/,":"+md+"$1")]})],n);case"::placeholder":return zo([El(e,{props:[dt(s,/:(plac\w+)/,":"+ht+"input-$1")]}),El(e,{props:[dt(s,/:(plac\w+)/,":"+md+"$1")]}),El(e,{props:[dt(s,/:(plac\w+)/,Gi+"input-$1")]})],n)}return""})}},M3=[E3],jC=function(e){var t=e.key;if(t==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(g){var y=g.getAttribute("data-emotion");y.indexOf(" ")!==-1&&(document.head.appendChild(g),g.setAttribute("data-s",""))})}var n=e.stylisPlugins||M3,s={},a,o=[];a=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),function(g){for(var y=g.getAttribute("data-emotion").split(" "),b=1;b<y.length;b++)s[y[b]]=!0;o.push(g)});var l,u=[P3,R3];{var c,h=[x3,T3(function(g){c.insert(g)})],d=k3(u.concat(n,h)),f=function(y){return zo(w3(y),d)};l=function(y,b,m,v){c=m,f(y?y+"{"+b.styles+"}":b.styles),v&&(p.inserted[b.name]=!0)}}var p={key:t,sheet:new a3({key:t,container:a,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:s,registered:{},insert:l};return p.sheet.hydrate(o),p};function le(){return le=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},le.apply(null,arguments)}var YC={exports:{}},yt={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ri=typeof Symbol=="function"&&Symbol.for,Hy=Ri?Symbol.for("react.element"):60103,zy=Ri?Symbol.for("react.portal"):60106,Nf=Ri?Symbol.for("react.fragment"):60107,Bf=Ri?Symbol.for("react.strict_mode"):60108,_f=Ri?Symbol.for("react.profiler"):60114,Pf=Ri?Symbol.for("react.provider"):60109,Rf=Ri?Symbol.for("react.context"):60110,Uy=Ri?Symbol.for("react.async_mode"):60111,Ef=Ri?Symbol.for("react.concurrent_mode"):60111,Mf=Ri?Symbol.for("react.forward_ref"):60112,Of=Ri?Symbol.for("react.suspense"):60113,O3=Ri?Symbol.for("react.suspense_list"):60120,If=Ri?Symbol.for("react.memo"):60115,Lf=Ri?Symbol.for("react.lazy"):60116,I3=Ri?Symbol.for("react.block"):60121,L3=Ri?Symbol.for("react.fundamental"):60117,D3=Ri?Symbol.for("react.responder"):60118,F3=Ri?Symbol.for("react.scope"):60119;function Gr(i){if(typeof i=="object"&&i!==null){var e=i.$$typeof;switch(e){case Hy:switch(i=i.type,i){case Uy:case Ef:case Nf:case _f:case Bf:case Of:return i;default:switch(i=i&&i.$$typeof,i){case Rf:case Mf:case Lf:case If:case Pf:return i;default:return e}}case zy:return e}}}function XC(i){return Gr(i)===Ef}yt.AsyncMode=Uy;yt.ConcurrentMode=Ef;yt.ContextConsumer=Rf;yt.ContextProvider=Pf;yt.Element=Hy;yt.ForwardRef=Mf;yt.Fragment=Nf;yt.Lazy=Lf;yt.Memo=If;yt.Portal=zy;yt.Profiler=_f;yt.StrictMode=Bf;yt.Suspense=Of;yt.isAsyncMode=function(i){return XC(i)||Gr(i)===Uy};yt.isConcurrentMode=XC;yt.isContextConsumer=function(i){return Gr(i)===Rf};yt.isContextProvider=function(i){return Gr(i)===Pf};yt.isElement=function(i){return typeof i=="object"&&i!==null&&i.$$typeof===Hy};yt.isForwardRef=function(i){return Gr(i)===Mf};yt.isFragment=function(i){return Gr(i)===Nf};yt.isLazy=function(i){return Gr(i)===Lf};yt.isMemo=function(i){return Gr(i)===If};yt.isPortal=function(i){return Gr(i)===zy};yt.isProfiler=function(i){return Gr(i)===_f};yt.isStrictMode=function(i){return Gr(i)===Bf};yt.isSuspense=function(i){return Gr(i)===Of};yt.isValidElementType=function(i){return typeof i=="string"||typeof i=="function"||i===Nf||i===Ef||i===_f||i===Bf||i===Of||i===O3||typeof i=="object"&&i!==null&&(i.$$typeof===Lf||i.$$typeof===If||i.$$typeof===Pf||i.$$typeof===Rf||i.$$typeof===Mf||i.$$typeof===L3||i.$$typeof===D3||i.$$typeof===F3||i.$$typeof===I3)};yt.typeOf=Gr;YC.exports=yt;var A3=YC.exports,KC=A3,V3={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},H3={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},qC={};qC[KC.ForwardRef]=V3;qC[KC.Memo]=H3;var z3=!0;function Wy(i,e,t){var r="";return t.split(" ").forEach(function(n){i[n]!==void 0?e.push(i[n]+";"):r+=n+" "}),r}var JC=function(e,t,r){var n=e.key+"-"+t.name;(r===!1||z3===!1)&&e.registered[n]===void 0&&(e.registered[n]=t.styles)},Gy=function(e,t,r){JC(e,t,r);var n=e.key+"-"+t.name;if(e.inserted[t.name]===void 0){var s=t;do e.insert(t===s?"."+n:"",s,e.sheet,!0),s=s.next;while(s!==void 0)}};function U3(i){for(var e=0,t,r=0,n=i.length;n>=4;++r,n-=4)t=i.charCodeAt(r)&255|(i.charCodeAt(++r)&255)<<8|(i.charCodeAt(++r)&255)<<16|(i.charCodeAt(++r)&255)<<24,t=(t&65535)*1540483477+((t>>>16)*59797<<16),t^=t>>>24,e=(t&65535)*1540483477+((t>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(n){case 3:e^=(i.charCodeAt(r+2)&255)<<16;case 2:e^=(i.charCodeAt(r+1)&255)<<8;case 1:e^=i.charCodeAt(r)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var W3={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},G3=/[A-Z]|^ms/g,$3=/_EMO_([^_]+?)_([^]*?)_EMO_/g,QC=function(e){return e.charCodeAt(1)===45},Vv=function(e){return e!=null&&typeof e!="boolean"},Qp=C3(function(i){return QC(i)?i:i.replace(G3,"-$&").toLowerCase()}),Hv=function(e,t){switch(e){case"animation":case"animationName":if(typeof t=="string")return t.replace($3,function(r,n,s){return zn={name:n,styles:s,next:zn},n})}return W3[e]!==1&&!QC(e)&&typeof t=="number"&&t!==0?t+"px":t};function Ou(i,e,t){if(t==null)return"";if(t.__emotion_styles!==void 0)return t;switch(typeof t){case"boolean":return"";case"object":{if(t.anim===1)return zn={name:t.name,styles:t.styles,next:zn},t.name;if(t.styles!==void 0){var r=t.next;if(r!==void 0)for(;r!==void 0;)zn={name:r.name,styles:r.styles,next:zn},r=r.next;var n=t.styles+";";return n}return j3(i,e,t)}case"function":{if(i!==void 0){var s=zn,a=t(i);return zn=s,Ou(i,e,a)}break}}if(e==null)return t;var o=e[t];return o!==void 0?o:t}function j3(i,e,t){var r="";if(Array.isArray(t))for(var n=0;n<t.length;n++)r+=Ou(i,e,t[n])+";";else for(var s in t){var a=t[s];if(typeof a!="object")e!=null&&e[a]!==void 0?r+=s+"{"+e[a]+"}":Vv(a)&&(r+=Qp(s)+":"+Hv(s,a)+";");else if(Array.isArray(a)&&typeof a[0]=="string"&&(e==null||e[a[0]]===void 0))for(var o=0;o<a.length;o++)Vv(a[o])&&(r+=Qp(s)+":"+Hv(s,a[o])+";");else{var l=Ou(i,e,a);switch(s){case"animation":case"animationName":{r+=Qp(s)+":"+l+";";break}default:r+=s+"{"+l+"}"}}}return r}var zv=/label:\s*([^\s;\n{]+)\s*(;|$)/g,zn,Uo=function(e,t,r){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var n=!0,s="";zn=void 0;var a=e[0];a==null||a.raw===void 0?(n=!1,s+=Ou(r,t,a)):s+=a[0];for(var o=1;o<e.length;o++)s+=Ou(r,t,e[o]),n&&(s+=a[o]);zv.lastIndex=0;for(var l="",u;(u=zv.exec(s))!==null;)l+="-"+u[1];var c=U3(s)+l;return{name:c,styles:s,next:zn}},Y3=function(e){return e()},ZC=cu.useInsertionEffect?cu.useInsertionEffect:!1,X3=ZC||Y3,Uv=ZC||S.useLayoutEffect,$y={}.hasOwnProperty,eN=S.createContext(typeof HTMLElement<"u"?jC({key:"css"}):null);eN.Provider;var tN=function(e){return S.forwardRef(function(t,r){var n=S.useContext(eN);return e(t,n,r)})},iN=S.createContext({}),jm="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",K3=function(e,t){var r={};for(var n in t)$y.call(t,n)&&(r[n]=t[n]);return r[jm]=e,r},q3=function(e){var t=e.cache,r=e.serialized,n=e.isStringTag;return JC(t,r,n),X3(function(){return Gy(t,r,n)}),null},J3=tN(function(i,e,t){var r=i.css;typeof r=="string"&&e.registered[r]!==void 0&&(r=e.registered[r]);var n=i[jm],s=[r],a="";typeof i.className=="string"?a=Wy(e.registered,s,i.className):i.className!=null&&(a=i.className+" ");var o=Uo(s,void 0,S.useContext(iN));a+=e.key+"-"+o.name;var l={};for(var u in i)$y.call(i,u)&&u!=="css"&&u!==jm&&(l[u]=i[u]);return l.ref=t,l.className=a,S.createElement(S.Fragment,null,S.createElement(q3,{cache:e,serialized:o,isStringTag:typeof n=="string"}),S.createElement(n,l))}),Q3=J3,Pe=function(e,t){var r=arguments;if(t==null||!$y.call(t,"css"))return S.createElement.apply(void 0,r);var n=r.length,s=new Array(n);s[0]=Q3,s[1]=K3(e,t);for(var a=2;a<n;a++)s[a]=r[a];return S.createElement.apply(null,s)},Z3=tN(function(i,e){var t=i.styles,r=Uo([t],void 0,S.useContext(iN)),n=S.useRef();return Uv(function(){var s=e.key+"-global",a=new e.sheet.constructor({key:s,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),o=!1,l=document.querySelector('style[data-emotion="'+s+" "+r.name+'"]');return e.sheet.tags.length&&(a.before=e.sheet.tags[0]),l!==null&&(o=!0,l.setAttribute("data-emotion",s),a.hydrate([l])),n.current=[a,o],function(){a.flush()}},[e]),Uv(function(){var s=n.current,a=s[0],o=s[1];if(o){s[1]=!1;return}if(r.next!==void 0&&Gy(e,r.next,!0),a.tags.length){var l=a.tags[a.tags.length-1].nextElementSibling;a.before=l,a.flush()}e.insert("",r,a,!1)},[e,r.name]),null});function Df(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];return Uo(e)}var e5=function(){var e=Df.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}};const t5=Df`
  #root {
    width: 100vw;
    height: 100vh;
  }
  #modal {
    /* No styling for now */
  }
  #tooltip {
    position: fixed;
    top: 0px;
    left: 0px;
    width: 100vw;
    height: 100vh;
    pointer-events: none;
  }

  *,
  *::before,
  *::after {
    box-sizing: border-box;
    margin: 0px;
    padding: 0px;
  }

  div,
  span {
    font-family: 'Poppins', sans-serif;
  }

  body {
    -webkit-font-smoothing: antialiased;
    background-color: #000000;
    /* background: linear-gradient(147deg, #000000 0%, #434343 74%); */
    height: 100vh;
    width: 100vw;
  }

  img,
  picture,
  video,
  canvas,
  svg {
    display: block;
    max-width: 100%;
  }

  input,
  button,
  textarea,
  select {
    font: inherit;
  }

  p,
  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    overflow-wrap: break-word;
  }

  a:-webkit-any-link {
    text-decoration: none;
  }

  a {
    text-decoration: none !important;
  }

  // Custom scrollbar
  * {
    --sb-track-color: #ffffff20;
    --sb-thumb-color: #ffffff60;
    --sb-size: 8px;
  }

  *::-webkit-scrollbar {
    width: var(--sb-size);
    height: var(--sb-size);
  }

  *::-webkit-scrollbar-track {
    background: var(--sb-track-color);
    border-radius: 4px;
    overflow: hidden;
  }

  *::-webkit-scrollbar-thumb {
    background: var(--sb-thumb-color);
    border-radius: 4px;
  }

  @supports not selector(::-webkit-scrollbar) {
    * {
      scrollbar-color: var(--sb-thumb-color) var(--sb-track-color);
    }
  }

  /** Alphatab stuff */
  .at-footer {
    flex: 0 0 auto;
    background: #436d9d;
    color: #fff;
  }
  /* Player */
  .at-cursor-bar {
    /* Defines the color of the bar background when a bar is played */
    background: #ffffff30;
  }
  .at-selection div {
    /* Defines the color of the selection background */
    background: #ffffff20;
  }
  .at-cursor-beat {
    /* Defines the beat cursor */
    background: red;
    width: 3px;
  }
  .at-highlight * {
    /* Defines the color of the music symbols when played (svg) */
    /* fill: #0078ff;
    stroke: #0078ff; */
  }
  // Hide big rendered by label, and display clickable logo elsewhere
  .at-surface > div:last-child {
    display: none !important;
  }
`;function Wv(i,e){if(i.inserted[e.name]===void 0)return i.insert("",e,i.sheet,!0)}function Gv(i,e,t){var r=[],n=Wy(i,r,t);return r.length<2?t:n+e(r)}var i5=function(e){var t=jC(e);t.sheet.speedy=function(o){this.isSpeedy=o},t.compat=!0;var r=function(){for(var l=arguments.length,u=new Array(l),c=0;c<l;c++)u[c]=arguments[c];var h=Uo(u,t.registered,void 0);return Gy(t,h,!1),t.key+"-"+h.name},n=function(){for(var l=arguments.length,u=new Array(l),c=0;c<l;c++)u[c]=arguments[c];var h=Uo(u,t.registered),d="animation-"+h.name;return Wv(t,{name:h.name,styles:"@keyframes "+d+"{"+h.styles+"}"}),d},s=function(){for(var l=arguments.length,u=new Array(l),c=0;c<l;c++)u[c]=arguments[c];var h=Uo(u,t.registered);Wv(t,h)},a=function(){for(var l=arguments.length,u=new Array(l),c=0;c<l;c++)u[c]=arguments[c];return Gv(t.registered,r,r5(u))};return{css:r,cx:a,injectGlobal:s,keyframes:n,hydrate:function(l){l.forEach(function(u){t.inserted[u]=!0})},flush:function(){t.registered={},t.inserted={},t.sheet.flush()},sheet:t.sheet,cache:t,getRegisteredStyles:Wy.bind(null,t.registered),merge:Gv.bind(null,t.registered,r)}},r5=function i(e){for(var t="",r=0;r<e.length;r++){var n=e[r];if(n!=null){var s=void 0;switch(typeof n){case"boolean":break;case"object":{if(Array.isArray(n))s=i(n);else{s="";for(var a in n)n[a]&&a&&(s&&(s+=" "),s+=a)}break}default:s=n}s&&(t&&(t+=" "),t+=s)}}return t},jy=i5({key:"css"}),mi=jy.cx,n5=jy.keyframes,R=jy.css;/**
 * @remix-run/router v1.17.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Iu(){return Iu=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},Iu.apply(this,arguments)}var $s;(function(i){i.Pop="POP",i.Push="PUSH",i.Replace="REPLACE"})($s||($s={}));const $v="popstate";function s5(i){i===void 0&&(i={});function e(n,s){let{pathname:a="/",search:o="",hash:l=""}=to(n.location.hash.substr(1));return!a.startsWith("/")&&!a.startsWith(".")&&(a="/"+a),Ym("",{pathname:a,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(n,s){let a=n.document.querySelector("base"),o="";if(a&&a.getAttribute("href")){let l=n.location.href,u=l.indexOf("#");o=u===-1?l:l.slice(0,u)}return o+"#"+(typeof s=="string"?s:yd(s))}function r(n,s){Yy(n.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(s)+")")}return o5(e,t,r,i)}function si(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function Yy(i,e){if(!i){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function a5(){return Math.random().toString(36).substr(2,8)}function jv(i,e){return{usr:i.state,key:i.key,idx:e}}function Ym(i,e,t,r){return t===void 0&&(t=null),Iu({pathname:typeof i=="string"?i:i.pathname,search:"",hash:""},typeof e=="string"?to(e):e,{state:t,key:e&&e.key||r||a5()})}function yd(i){let{pathname:e="/",search:t="",hash:r=""}=i;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function to(i){let e={};if(i){let t=i.indexOf("#");t>=0&&(e.hash=i.substr(t),i=i.substr(0,t));let r=i.indexOf("?");r>=0&&(e.search=i.substr(r),i=i.substr(0,r)),i&&(e.pathname=i)}return e}function o5(i,e,t,r){r===void 0&&(r={});let{window:n=document.defaultView,v5Compat:s=!1}=r,a=n.history,o=$s.Pop,l=null,u=c();u==null&&(u=0,a.replaceState(Iu({},a.state,{idx:u}),""));function c(){return(a.state||{idx:null}).idx}function h(){o=$s.Pop;let y=c(),b=y==null?null:y-u;u=y,l&&l({action:o,location:g.location,delta:b})}function d(y,b){o=$s.Push;let m=Ym(g.location,y,b);t&&t(m,y),u=c()+1;let v=jv(m,u),k=g.createHref(m);try{a.pushState(v,"",k)}catch(x){if(x instanceof DOMException&&x.name==="DataCloneError")throw x;n.location.assign(k)}s&&l&&l({action:o,location:g.location,delta:1})}function f(y,b){o=$s.Replace;let m=Ym(g.location,y,b);t&&t(m,y),u=c();let v=jv(m,u),k=g.createHref(m);a.replaceState(v,"",k),s&&l&&l({action:o,location:g.location,delta:0})}function p(y){let b=n.location.origin!=="null"?n.location.origin:n.location.href,m=typeof y=="string"?y:yd(y);return m=m.replace(/ $/,"%20"),si(b,"No window.location.(origin|href) available to create URL for href: "+m),new URL(m,b)}let g={get action(){return o},get location(){return i(n,a)},listen(y){if(l)throw new Error("A history only accepts one active listener");return n.addEventListener($v,h),l=y,()=>{n.removeEventListener($v,h),l=null}},createHref(y){return e(n,y)},createURL:p,encodeLocation(y){let b=p(y);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:d,replace:f,go(y){return a.go(y)}};return g}var Yv;(function(i){i.data="data",i.deferred="deferred",i.redirect="redirect",i.error="error"})(Yv||(Yv={}));function l5(i,e,t){return t===void 0&&(t="/"),u5(i,e,t,!1)}function u5(i,e,t,r){let n=typeof e=="string"?to(e):e,s=Xy(n.pathname||"/",t);if(s==null)return null;let a=rN(i);c5(a);let o=null;for(let l=0;o==null&&l<a.length;++l){let u=S5(s);o=v5(a[l],u,r)}return o}function rN(i,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let n=(s,a,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};l.relativePath.startsWith("/")&&(si(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let u=ea([r,l.relativePath]),c=t.concat(l);s.children&&s.children.length>0&&(si(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),rN(s.children,e,c,u)),!(s.path==null&&!s.index)&&e.push({path:u,score:y5(u,s.index),routesMeta:c})};return i.forEach((s,a)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))n(s,a);else for(let l of nN(s.path))n(s,a,l)}),e}function nN(i){let e=i.split("/");if(e.length===0)return[];let[t,...r]=e,n=t.endsWith("?"),s=t.replace(/\?$/,"");if(r.length===0)return n?[s,""]:[s];let a=nN(r.join("/")),o=[];return o.push(...a.map(l=>l===""?s:[s,l].join("/"))),n&&o.push(...a),o.map(l=>i.startsWith("/")&&l===""?"/":l)}function c5(i){i.sort((e,t)=>e.score!==t.score?t.score-e.score:b5(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const h5=/^:[\w-]+$/,d5=3,f5=2,p5=1,g5=10,m5=-2,Xv=i=>i==="*";function y5(i,e){let t=i.split("/"),r=t.length;return t.some(Xv)&&(r+=m5),e&&(r+=f5),t.filter(n=>!Xv(n)).reduce((n,s)=>n+(h5.test(s)?d5:s===""?p5:g5),r)}function b5(i,e){return i.length===e.length&&i.slice(0,-1).every((r,n)=>r===e[n])?i[i.length-1]-e[e.length-1]:0}function v5(i,e,t){let{routesMeta:r}=i,n={},s="/",a=[];for(let o=0;o<r.length;++o){let l=r[o],u=o===r.length-1,c=s==="/"?e:e.slice(s.length)||"/",h=Kv({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},c),d=l.route;if(!h&&u&&t&&!r[r.length-1].route.index&&(h=Kv({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},c)),!h)return null;Object.assign(n,h.params),a.push({params:n,pathname:ea([s,h.pathname]),pathnameBase:C5(ea([s,h.pathnameBase])),route:d}),h.pathnameBase!=="/"&&(s=ea([s,h.pathnameBase]))}return a}function Kv(i,e){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[t,r]=w5(i.path,i.caseSensitive,i.end),n=e.match(t);if(!n)return null;let s=n[0],a=s.replace(/(.)\/+$/,"$1"),o=n.slice(1);return{params:r.reduce((u,c,h)=>{let{paramName:d,isOptional:f}=c;if(d==="*"){let g=o[h]||"";a=s.slice(0,s.length-g.length).replace(/(.)\/+$/,"$1")}const p=o[h];return f&&!p?u[d]=void 0:u[d]=(p||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:a,pattern:i}}function w5(i,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),Yy(i==="*"||!i.endsWith("*")||i.endsWith("/*"),'Route path "'+i+'" will be treated as if it were '+('"'+i.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+i.replace(/\*$/,"/*")+'".'));let r=[],n="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,l)=>(r.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return i.endsWith("*")?(r.push({paramName:"*"}),n+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?n+="\\/*$":i!==""&&i!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,e?void 0:"i"),r]}function S5(i){try{return i.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Yy(!1,'The URL path "'+i+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),i}}function Xy(i,e){if(e==="/")return i;if(!i.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=i.charAt(t);return r&&r!=="/"?null:i.slice(t)||"/"}function x5(i,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:n=""}=typeof i=="string"?to(i):i;return{pathname:t?t.startsWith("/")?t:k5(t,e):e,search:N5(r),hash:B5(n)}}function k5(i,e){let t=e.replace(/\/+$/,"").split("/");return i.split("/").forEach(n=>{n===".."?t.length>1&&t.pop():n!=="."&&t.push(n)}),t.length>1?t.join("/"):"/"}function Zp(i,e,t,r){return"Cannot include a '"+i+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function T5(i){return i.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Ky(i,e){let t=T5(i);return e?t.map((r,n)=>n===i.length-1?r.pathname:r.pathnameBase):t.map(r=>r.pathnameBase)}function qy(i,e,t,r){r===void 0&&(r=!1);let n;typeof i=="string"?n=to(i):(n=Iu({},i),si(!n.pathname||!n.pathname.includes("?"),Zp("?","pathname","search",n)),si(!n.pathname||!n.pathname.includes("#"),Zp("#","pathname","hash",n)),si(!n.search||!n.search.includes("#"),Zp("#","search","hash",n)));let s=i===""||n.pathname==="",a=s?"/":n.pathname,o;if(a==null)o=t;else{let h=e.length-1;if(!r&&a.startsWith("..")){let d=a.split("/");for(;d[0]==="..";)d.shift(),h-=1;n.pathname=d.join("/")}o=h>=0?e[h]:"/"}let l=x5(n,o),u=a&&a!=="/"&&a.endsWith("/"),c=(s||a===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}const ea=i=>i.join("/").replace(/\/\/+/g,"/"),C5=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),N5=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,B5=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i;function _5(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}const sN=["post","put","patch","delete"];new Set(sN);const P5=["get",...sN];new Set(P5);/**
 * React Router v6.24.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Lu(){return Lu=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},Lu.apply(this,arguments)}const Jy=S.createContext(null),R5=S.createContext(null),ba=S.createContext(null),Ff=S.createContext(null),Zn=S.createContext({outlet:null,matches:[],isDataRoute:!1}),aN=S.createContext(null);function E5(i,e){let{relative:t}=e===void 0?{}:e;pl()||si(!1);let{basename:r,navigator:n}=S.useContext(ba),{hash:s,pathname:a,search:o}=uN(i,{relative:t}),l=a;return r!=="/"&&(l=a==="/"?r:ea([r,a])),n.createHref({pathname:l,search:o,hash:s})}function pl(){return S.useContext(Ff)!=null}function io(){return pl()||si(!1),S.useContext(Ff).location}function oN(i){S.useContext(ba).static||S.useLayoutEffect(i)}function Af(){let{isDataRoute:i}=S.useContext(Zn);return i?j5():M5()}function M5(){pl()||si(!1);let i=S.useContext(Jy),{basename:e,future:t,navigator:r}=S.useContext(ba),{matches:n}=S.useContext(Zn),{pathname:s}=io(),a=JSON.stringify(Ky(n,t.v7_relativeSplatPath)),o=S.useRef(!1);return oN(()=>{o.current=!0}),S.useCallback(function(u,c){if(c===void 0&&(c={}),!o.current)return;if(typeof u=="number"){r.go(u);return}let h=qy(u,JSON.parse(a),s,c.relative==="path");i==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:ea([e,h.pathname])),(c.replace?r.replace:r.push)(h,c.state,c)},[e,r,a,s,i])}const O5=S.createContext(null);function I5(i){let e=S.useContext(Zn).outlet;return e&&S.createElement(O5.Provider,{value:i},e)}function lN(){let{matches:i}=S.useContext(Zn),e=i[i.length-1];return e?e.params:{}}function uN(i,e){let{relative:t}=e===void 0?{}:e,{future:r}=S.useContext(ba),{matches:n}=S.useContext(Zn),{pathname:s}=io(),a=JSON.stringify(Ky(n,r.v7_relativeSplatPath));return S.useMemo(()=>qy(i,JSON.parse(a),s,t==="path"),[i,a,s,t])}function L5(i,e){return D5(i,e)}function D5(i,e,t,r){pl()||si(!1);let{navigator:n}=S.useContext(ba),{matches:s}=S.useContext(Zn),a=s[s.length-1],o=a?a.params:{};a&&a.pathname;let l=a?a.pathnameBase:"/";a&&a.route;let u=io(),c;if(e){var h;let y=typeof e=="string"?to(e):e;l==="/"||(h=y.pathname)!=null&&h.startsWith(l)||si(!1),c=y}else c=u;let d=c.pathname||"/",f=d;if(l!=="/"){let y=l.replace(/^\//,"").split("/");f="/"+d.replace(/^\//,"").split("/").slice(y.length).join("/")}let p=l5(i,{pathname:f}),g=z5(p&&p.map(y=>Object.assign({},y,{params:Object.assign({},o,y.params),pathname:ea([l,n.encodeLocation?n.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?l:ea([l,n.encodeLocation?n.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),s,t,r);return e&&g?S.createElement(Ff.Provider,{value:{location:Lu({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:$s.Pop}},g):g}function F5(){let i=$5(),e=_5(i)?i.status+" "+i.statusText:i instanceof Error?i.message:JSON.stringify(i),t=i instanceof Error?i.stack:null,n={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return S.createElement(S.Fragment,null,S.createElement("h2",null,"Unexpected Application Error!"),S.createElement("h3",{style:{fontStyle:"italic"}},e),t?S.createElement("pre",{style:n},t):null,null)}const A5=S.createElement(F5,null);class V5 extends S.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?S.createElement(Zn.Provider,{value:this.props.routeContext},S.createElement(aN.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function H5(i){let{routeContext:e,match:t,children:r}=i,n=S.useContext(Jy);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),S.createElement(Zn.Provider,{value:e},r)}function z5(i,e,t,r){var n;if(e===void 0&&(e=[]),t===void 0&&(t=null),r===void 0&&(r=null),i==null){var s;if((s=t)!=null&&s.errors)i=t.matches;else return null}let a=i,o=(n=t)==null?void 0:n.errors;if(o!=null){let c=a.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);c>=0||si(!1),a=a.slice(0,Math.min(a.length,c+1))}let l=!1,u=-1;if(t&&r&&r.v7_partialHydration)for(let c=0;c<a.length;c++){let h=a[c];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=c),h.route.id){let{loaderData:d,errors:f}=t,p=h.route.loader&&d[h.route.id]===void 0&&(!f||f[h.route.id]===void 0);if(h.route.lazy||p){l=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((c,h,d)=>{let f,p=!1,g=null,y=null;t&&(f=o&&h.route.id?o[h.route.id]:void 0,g=h.route.errorElement||A5,l&&(u<0&&d===0?(p=!0,y=null):u===d&&(p=!0,y=h.route.hydrateFallbackElement||null)));let b=e.concat(a.slice(0,d+1)),m=()=>{let v;return f?v=g:p?v=y:h.route.Component?v=S.createElement(h.route.Component,null):h.route.element?v=h.route.element:v=c,S.createElement(H5,{match:h,routeContext:{outlet:c,matches:b,isDataRoute:t!=null},children:v})};return t&&(h.route.ErrorBoundary||h.route.errorElement||d===0)?S.createElement(V5,{location:t.location,revalidation:t.revalidation,component:g,error:f,children:m(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):m()},null)}var cN=function(i){return i.UseBlocker="useBlocker",i.UseRevalidator="useRevalidator",i.UseNavigateStable="useNavigate",i}(cN||{}),bd=function(i){return i.UseBlocker="useBlocker",i.UseLoaderData="useLoaderData",i.UseActionData="useActionData",i.UseRouteError="useRouteError",i.UseNavigation="useNavigation",i.UseRouteLoaderData="useRouteLoaderData",i.UseMatches="useMatches",i.UseRevalidator="useRevalidator",i.UseNavigateStable="useNavigate",i.UseRouteId="useRouteId",i}(bd||{});function U5(i){let e=S.useContext(Jy);return e||si(!1),e}function W5(i){let e=S.useContext(R5);return e||si(!1),e}function G5(i){let e=S.useContext(Zn);return e||si(!1),e}function hN(i){let e=G5(),t=e.matches[e.matches.length-1];return t.route.id||si(!1),t.route.id}function $5(){var i;let e=S.useContext(aN),t=W5(bd.UseRouteError),r=hN(bd.UseRouteError);return e!==void 0?e:(i=t.errors)==null?void 0:i[r]}function j5(){let{router:i}=U5(cN.UseNavigateStable),e=hN(bd.UseNavigateStable),t=S.useRef(!1);return oN(()=>{t.current=!0}),S.useCallback(function(n,s){s===void 0&&(s={}),t.current&&(typeof n=="number"?i.navigate(n):i.navigate(n,Lu({fromRouteId:e},s)))},[i,e])}function qv(i){let{to:e,replace:t,state:r,relative:n}=i;pl()||si(!1);let{future:s,static:a}=S.useContext(ba),{matches:o}=S.useContext(Zn),{pathname:l}=io(),u=Af(),c=qy(e,Ky(o,s.v7_relativeSplatPath),l,n==="path"),h=JSON.stringify(c);return S.useEffect(()=>u(JSON.parse(h),{replace:t,state:r,relative:n}),[u,h,n,t,r]),null}function Y5(i){return I5(i.context)}function Ta(i){si(!1)}function X5(i){let{basename:e="/",children:t=null,location:r,navigationType:n=$s.Pop,navigator:s,static:a=!1,future:o}=i;pl()&&si(!1);let l=e.replace(/^\/*/,"/"),u=S.useMemo(()=>({basename:l,navigator:s,static:a,future:Lu({v7_relativeSplatPath:!1},o)}),[l,o,s,a]);typeof r=="string"&&(r=to(r));let{pathname:c="/",search:h="",hash:d="",state:f=null,key:p="default"}=r,g=S.useMemo(()=>{let y=Xy(c,l);return y==null?null:{location:{pathname:y,search:h,hash:d,state:f,key:p},navigationType:n}},[l,c,h,d,f,p,n]);return g==null?null:S.createElement(ba.Provider,{value:u},S.createElement(Ff.Provider,{children:t,value:g}))}function K5(i){let{children:e,location:t}=i;return L5(Xm(e),t)}new Promise(()=>{});function Xm(i,e){e===void 0&&(e=[]);let t=[];return S.Children.forEach(i,(r,n)=>{if(!S.isValidElement(r))return;let s=[...e,n];if(r.type===S.Fragment){t.push.apply(t,Xm(r.props.children,s));return}r.type!==Ta&&si(!1),!r.props.index||!r.props.children||si(!1);let a={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=Xm(r.props.children,s)),t.push(a)}),t}var dN={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Jv=et.createContext&&et.createContext(dN),q5=["attr","size","title"];function J5(i,e){if(i==null)return{};var t=Q5(i,e),r,n;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);for(n=0;n<s.length;n++)r=s[n],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(i,r)&&(t[r]=i[r])}return t}function Q5(i,e){if(i==null)return{};var t={};for(var r in i)if(Object.prototype.hasOwnProperty.call(i,r)){if(e.indexOf(r)>=0)continue;t[r]=i[r]}return t}function vd(){return vd=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},vd.apply(this,arguments)}function Qv(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(i,n).enumerable})),t.push.apply(t,r)}return t}function wd(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Qv(Object(t),!0).forEach(function(r){Z5(i,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):Qv(Object(t)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(t,r))})}return i}function Z5(i,e,t){return e=e4(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function e4(i){var e=t4(i,"string");return typeof e=="symbol"?e:e+""}function t4(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function fN(i){return i&&i.map((e,t)=>et.createElement(e.tag,wd({key:t},e.attr),fN(e.child)))}function pt(i){return e=>et.createElement(i4,vd({attr:wd({},i.attr)},e),fN(i.child))}function i4(i){var e=t=>{var{attr:r,size:n,title:s}=i,a=J5(i,q5),o=n||t.size||"1em",l;return t.className&&(l=t.className),i.className&&(l=(l?l+" ":"")+i.className),et.createElement("svg",vd({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,a,{className:l,style:wd(wd({color:i.color||t.color},t.style),i.style),height:o,width:o,xmlns:"http://www.w3.org/2000/svg"}),s&&et.createElement("title",null,s),i.children)};return Jv!==void 0?et.createElement(Jv.Consumer,null,t=>e(t)):e(dN)}function pN(i){return pt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"},child:[]},{tag:"line",attr:{x1:"12",y1:"8",x2:"12",y2:"16"},child:[]},{tag:"line",attr:{x1:"8",y1:"12",x2:"16",y2:"12"},child:[]}]})(i)}function ro(i){return pt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"3 6 5 6 21 6"},child:[]},{tag:"path",attr:{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"},child:[]},{tag:"line",attr:{x1:"10",y1:"11",x2:"10",y2:"17"},child:[]},{tag:"line",attr:{x1:"14",y1:"11",x2:"14",y2:"17"},child:[]}]})(i)}function r4(i){return pt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M15.4565 9.67503L15.3144 9.53297C14.6661 8.90796 13.8549 8.43369 12.9235 8.18412C10.0168 7.40527 7.22541 9.05273 6.43185 12.0143C6.38901 12.1742 6.36574 12.3537 6.3285 12.8051C6.17423 14.6752 5.73449 16.0697 4.5286 17.4842C6.78847 18.3727 9.46572 18.9986 11.5016 18.9986C13.9702 18.9986 16.1644 17.3394 16.8126 14.9202C17.3306 12.9869 16.7513 11.0181 15.4565 9.67503ZM13.2886 6.21301L18.2278 2.37142C18.6259 2.0618 19.1922 2.09706 19.5488 2.45367L22.543 5.44787C22.8997 5.80448 22.9349 6.37082 22.6253 6.76891L18.7847 11.7068C19.0778 12.8951 19.0836 14.1721 18.7444 15.4379C17.8463 18.7897 14.8142 20.9986 11.5016 20.9986C8 20.9986 3.5 19.4967 1 17.9967C4.97978 14.9967 4.04722 13.1865 4.5 11.4967C5.55843 7.54658 9.34224 5.23935 13.2886 6.21301ZM16.7015 8.09161C16.7673 8.15506 16.8319 8.21964 16.8952 8.28533L18.0297 9.41984L20.5046 6.23786L18.7589 4.4921L15.5769 6.96698L16.7015 8.09161Z"},child:[]}]})(i)}function n4(i){return pt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M8.5 7C9.32843 7 10 6.32843 10 5.5C10 4.67157 9.32843 4 8.5 4C7.67157 4 7 4.67157 7 5.5C7 6.32843 7.67157 7 8.5 7ZM8.5 13.5C9.32843 13.5 10 12.8284 10 12C10 11.1716 9.32843 10.5 8.5 10.5C7.67157 10.5 7 11.1716 7 12C7 12.8284 7.67157 13.5 8.5 13.5ZM10 18.5C10 19.3284 9.32843 20 8.5 20C7.67157 20 7 19.3284 7 18.5C7 17.6716 7.67157 17 8.5 17C9.32843 17 10 17.6716 10 18.5ZM15.5 7C16.3284 7 17 6.32843 17 5.5C17 4.67157 16.3284 4 15.5 4C14.6716 4 14 4.67157 14 5.5C14 6.32843 14.6716 7 15.5 7ZM17 12C17 12.8284 16.3284 13.5 15.5 13.5C14.6716 13.5 14 12.8284 14 12C14 11.1716 14.6716 10.5 15.5 10.5C16.3284 10.5 17 11.1716 17 12ZM15.5 20C16.3284 20 17 19.3284 17 18.5C17 17.6716 16.3284 17 15.5 17C14.6716 17 14 17.6716 14 18.5C14 19.3284 14.6716 20 15.5 20Z"},child:[]}]})(i)}function gN(i){return pt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M4 18.0001H9.5V19.2501C9.5 20.7688 8.26878 22.0001 6.75 22.0001C5.23122 22.0001 4 20.7688 4 19.2501V18.0001ZM8 6.12067C10 6.12067 11 9.00006 11 11.0001C11 12.0001 10.5 13.0001 10 14.5001L9.5 16.0001H4C4 15.0001 3.5 13.5001 3.5 11.0001C3.5 8.50006 5.49783 6.12067 8 6.12067ZM20.054 14.0984L19.8369 15.3294C19.5732 16.8251 18.1468 17.8238 16.6511 17.5601C15.1554 17.2964 14.1567 15.87 14.4205 14.3743L14.6375 13.1433L20.054 14.0984ZM18.1776 1.70488C20.6417 2.13938 22.196 4.82954 21.7619 7.29156C21.3278 9.75358 20.5749 11.144 20.4013 12.1288L14.9848 11.1737L14.7529 9.60967C14.5209 8.04564 14.2022 6.974 14.3758 5.9892C14.7231 4.01958 16.2079 1.35759 18.1776 1.70488Z"},child:[]}]})(i)}function s4(i){return pt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M6 3H8V21H6V3ZM16 3H18V21H16V3Z"},child:[]}]})(i)}function a4(i){return pt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M6 20.1957V3.80421C6 3.01878 6.86395 2.53993 7.53 2.95621L20.6432 11.152C21.2699 11.5436 21.2699 12.4563 20.6432 12.848L7.53 21.0437C6.86395 21.46 6 20.9812 6 20.1957Z"},child:[]}]})(i)}function o4(i){return pt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M3 4C3 3.44772 3.44772 3 4 3H20C20.5523 3 21 3.44772 21 4V20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V4Z"},child:[]}]})(i)}function l4(i){return pt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M5.88889 16H2C1.44772 16 1 15.5523 1 15V9.00001C1 8.44772 1.44772 8.00001 2 8.00001H5.88889L11.1834 3.66815C11.3971 3.49329 11.7121 3.52479 11.887 3.73851C11.9601 3.82784 12 3.93971 12 4.05513V19.9449C12 20.221 11.7761 20.4449 11.5 20.4449C11.3846 20.4449 11.2727 20.405 11.1834 20.3319L5.88889 16ZM20.4142 12L23.9497 15.5355L22.5355 16.9498L19 13.4142L15.4645 16.9498L14.0503 15.5355L17.5858 12L14.0503 8.46447L15.4645 7.05026L19 10.5858L22.5355 7.05026L23.9497 8.46447L20.4142 12Z"},child:[]}]})(i)}function u4(i){return pt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M2 16.0001H5.88889L11.1834 20.3319C11.2727 20.405 11.3846 20.4449 11.5 20.4449C11.7761 20.4449 12 20.2211 12 19.9449V4.05519C12 3.93977 11.9601 3.8279 11.887 3.73857C11.7121 3.52485 11.3971 3.49335 11.1834 3.66821L5.88889 8.00007H2C1.44772 8.00007 1 8.44778 1 9.00007V15.0001C1 15.5524 1.44772 16.0001 2 16.0001ZM23 12C23 15.292 21.5539 18.2463 19.2622 20.2622L17.8445 18.8444C19.7758 17.1937 21 14.7398 21 12C21 9.26016 19.7758 6.80629 17.8445 5.15557L19.2622 3.73779C21.5539 5.75368 23 8.70795 23 12ZM18 12C18 10.0883 17.106 8.38548 15.7133 7.28673L14.2842 8.71584C15.3213 9.43855 16 10.64 16 12C16 13.36 15.3213 14.5614 14.2842 15.2841L15.7133 16.7132C17.106 15.6145 18 13.9116 18 12Z"},child:[]}]})(i)}function Vf(i){return pt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M18.031 16.6168L22.3137 20.8995L20.8995 22.3137L16.6168 18.031C15.0769 19.263 13.124 20 11 20C6.032 20 2 15.968 2 11C2 6.032 6.032 2 11 2C15.968 2 20 6.032 20 11C20 13.124 19.263 15.0769 18.031 16.6168ZM16.0247 15.8748C17.2475 14.6146 18 12.8956 18 11C18 7.1325 14.8675 4 11 4C7.1325 4 4 7.1325 4 11C4 14.8675 7.1325 18 11 18C12.8956 18 14.6146 17.2475 15.8748 16.0247L16.0247 15.8748Z"},child:[]}]})(i)}function c4(i){return pt({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M208.49,152.49l-72,72a12,12,0,0,1-17,0l-72-72a12,12,0,0,1,17-17L116,187V40a12,12,0,0,1,24,0V187l51.51-51.52a12,12,0,0,1,17,17Z"},child:[]}]})(i)}function h4(i){return pt({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M228,128a12,12,0,0,1-12,12H69l51.52,51.51a12,12,0,0,1-17,17l-72-72a12,12,0,0,1,0-17l72-72a12,12,0,0,1,17,17L69,116H216A12,12,0,0,1,228,128Z"},child:[]}]})(i)}function d4(i){return pt({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M208.49,120.49a12,12,0,0,1-17,0L140,69V216a12,12,0,0,1-24,0V69L64.49,120.49a12,12,0,0,1-17-17l72-72a12,12,0,0,1,17,0l72,72A12,12,0,0,1,208.49,120.49Z"},child:[]}]})(i)}function f4(i){return pt({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M216,28H88A12,12,0,0,0,76,40V76H40A12,12,0,0,0,28,88V216a12,12,0,0,0,12,12H168a12,12,0,0,0,12-12V180h36a12,12,0,0,0,12-12V40A12,12,0,0,0,216,28ZM156,204H52V100H156Zm48-48H180V88a12,12,0,0,0-12-12H100V52H204Z"},child:[]}]})(i)}function p4(i){return pt({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M219.05,201.94l-27.4-86.12,25.23-27.75a12,12,0,0,0-17.76-16.14L183.24,89.39l-15.1-47.45A19.93,19.93,0,0,0,149.08,28H106.91A19.93,19.93,0,0,0,87.85,41.94l-50.91,160A20,20,0,0,0,56,228H200a20,20,0,0,0,19.06-26.06ZM179.25,156H155.12L173,136.34ZM109.83,52h36.33l18.42,57.91L122.69,156H76.74ZM61.47,204l7.63-24H186.89l7.63,24Z"},child:[]}]})(i)}function Qy(i){return pt({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M228,128a12,12,0,0,1-12,12H140v76a12,12,0,0,1-24,0V140H40a12,12,0,0,1,0-24h76V40a12,12,0,0,1,24,0v76h76A12,12,0,0,1,228,128Z"},child:[]}]})(i)}function g4(i){return pt({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M216,130.16q.06-2.16,0-4.32l14.92-18.64a8,8,0,0,0,1.48-7.06,107.6,107.6,0,0,0-10.88-26.25,8,8,0,0,0-6-3.93l-23.72-2.64q-1.48-1.56-3-3L186,40.54a8,8,0,0,0-3.94-6,107.29,107.29,0,0,0-26.25-10.86,8,8,0,0,0-7.06,1.48L130.16,40Q128,40,125.84,40L107.2,25.11a8,8,0,0,0-7.06-1.48A107.6,107.6,0,0,0,73.89,34.51a8,8,0,0,0-3.93,6L67.32,64.27q-1.56,1.49-3,3L40.54,70a8,8,0,0,0-6,3.94,107.71,107.71,0,0,0-10.87,26.25,8,8,0,0,0,1.49,7.06L40,125.84Q40,128,40,130.16L25.11,148.8a8,8,0,0,0-1.48,7.06,107.6,107.6,0,0,0,10.88,26.25,8,8,0,0,0,6,3.93l23.72,2.64q1.49,1.56,3,3L70,215.46a8,8,0,0,0,3.94,6,107.71,107.71,0,0,0,26.25,10.87,8,8,0,0,0,7.06-1.49L125.84,216q2.16.06,4.32,0l18.64,14.92a8,8,0,0,0,7.06,1.48,107.21,107.21,0,0,0,26.25-10.88,8,8,0,0,0,3.93-6l2.64-23.72q1.56-1.48,3-3L215.46,186a8,8,0,0,0,6-3.94,107.71,107.71,0,0,0,10.87-26.25,8,8,0,0,0-1.49-7.06ZM128,168a40,40,0,1,1,40-40A40,40,0,0,1,128,168Z"},child:[]}]})(i)}function m4(i){return pt({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M212.24,83.76l-56-56A6,6,0,0,0,152,26H56A14,14,0,0,0,42,40V216a14,14,0,0,0,14,14H200a14,14,0,0,0,14-14V88A6,6,0,0,0,212.24,83.76ZM158,46.48,193.52,82H158ZM200,218H56a2,2,0,0,1-2-2V40a2,2,0,0,1,2-2h90V88a6,6,0,0,0,6,6h50V216A2,2,0,0,1,200,218Z"},child:[]}]})(i)}function Oh(i){return pt({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M211.69,19.27a6,6,0,0,0-5.15-1.09l-128,32A6,6,0,0,0,74,56V170.11A34,34,0,1,0,86,196V108.68l116-29v58.43A34,34,0,1,0,214,164V24A6,6,0,0,0,211.69,19.27ZM52,218a22,22,0,1,1,22-22A22,22,0,0,1,52,218ZM86,96.32V60.68l116-29V67.32ZM180,186a22,22,0,1,1,22-22A22,22,0,0,1,180,186Z"},child:[]}]})(i)}function mN(i){return pt({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M128,80a48,48,0,1,0,48,48A48.05,48.05,0,0,0,128,80Zm0,80a32,32,0,1,1,32-32A32,32,0,0,1,128,160Zm88-29.84q.06-2.16,0-4.32l14.92-18.64a8,8,0,0,0,1.48-7.06,107.21,107.21,0,0,0-10.88-26.25,8,8,0,0,0-6-3.93l-23.72-2.64q-1.48-1.56-3-3L186,40.54a8,8,0,0,0-3.94-6,107.71,107.71,0,0,0-26.25-10.87,8,8,0,0,0-7.06,1.49L130.16,40Q128,40,125.84,40L107.2,25.11a8,8,0,0,0-7.06-1.48A107.6,107.6,0,0,0,73.89,34.51a8,8,0,0,0-3.93,6L67.32,64.27q-1.56,1.49-3,3L40.54,70a8,8,0,0,0-6,3.94,107.71,107.71,0,0,0-10.87,26.25,8,8,0,0,0,1.49,7.06L40,125.84Q40,128,40,130.16L25.11,148.8a8,8,0,0,0-1.48,7.06,107.21,107.21,0,0,0,10.88,26.25,8,8,0,0,0,6,3.93l23.72,2.64q1.49,1.56,3,3L70,215.46a8,8,0,0,0,3.94,6,107.71,107.71,0,0,0,26.25,10.87,8,8,0,0,0,7.06-1.49L125.84,216q2.16.06,4.32,0l18.64,14.92a8,8,0,0,0,7.06,1.48,107.21,107.21,0,0,0,26.25-10.88,8,8,0,0,0,3.93-6l2.64-23.72q1.56-1.48,3-3L215.46,186a8,8,0,0,0,6-3.94,107.71,107.71,0,0,0,10.87-26.25,8,8,0,0,0-1.49-7.06Zm-16.1-6.5a73.93,73.93,0,0,1,0,8.68,8,8,0,0,0,1.74,5.48l14.19,17.73a91.57,91.57,0,0,1-6.23,15L187,173.11a8,8,0,0,0-5.1,2.64,74.11,74.11,0,0,1-6.14,6.14,8,8,0,0,0-2.64,5.1l-2.51,22.58a91.32,91.32,0,0,1-15,6.23l-17.74-14.19a8,8,0,0,0-5-1.75h-.48a73.93,73.93,0,0,1-8.68,0,8,8,0,0,0-5.48,1.74L100.45,215.8a91.57,91.57,0,0,1-15-6.23L82.89,187a8,8,0,0,0-2.64-5.1,74.11,74.11,0,0,1-6.14-6.14,8,8,0,0,0-5.1-2.64L46.43,170.6a91.32,91.32,0,0,1-6.23-15l14.19-17.74a8,8,0,0,0,1.74-5.48,73.93,73.93,0,0,1,0-8.68,8,8,0,0,0-1.74-5.48L40.2,100.45a91.57,91.57,0,0,1,6.23-15L69,82.89a8,8,0,0,0,5.1-2.64,74.11,74.11,0,0,1,6.14-6.14A8,8,0,0,0,82.89,69L85.4,46.43a91.32,91.32,0,0,1,15-6.23l17.74,14.19a8,8,0,0,0,5.48,1.74,73.93,73.93,0,0,1,8.68,0,8,8,0,0,0,5.48-1.74L155.55,40.2a91.57,91.57,0,0,1,15,6.23L173.11,69a8,8,0,0,0,2.64,5.1,74.11,74.11,0,0,1,6.14,6.14,8,8,0,0,0,5.1,2.64l22.58,2.51a91.32,91.32,0,0,1,6.23,15l-14.19,17.74A8,8,0,0,0,199.87,123.66Z"},child:[]}]})(i)}function Km(i){return pt({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M210.3,56.34l-80-24A8,8,0,0,0,120,40V148.26A48,48,0,1,0,136,184V50.75l69.7,20.91a8,8,0,1,0,4.6-15.32ZM88,216a32,32,0,1,1,32-32A32,32,0,0,1,88,216Z"},child:[]}]})(i)}function y4(i){return pt({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M212.92,17.69a8,8,0,0,0-6.86-1.45l-128,32A8,8,0,0,0,72,56V166.08A36,36,0,1,0,88,196V62.25l112-28v99.83A36,36,0,1,0,216,164V24A8,8,0,0,0,212.92,17.69ZM52,216a20,20,0,1,1,20-20A20,20,0,0,1,52,216Zm128-32a20,20,0,1,1,20-20A20,20,0,0,1,180,184Z"},child:[]}]})(i)}function b4(i){return pt({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M227.32,73.37,182.63,28.69a16,16,0,0,0-22.63,0L36.69,152A15.86,15.86,0,0,0,32,163.31V208a16,16,0,0,0,16,16H216a8,8,0,0,0,0-16H115.32l112-112A16,16,0,0,0,227.32,73.37ZM136,75.31,152.69,92,68,176.69,51.31,160ZM48,208V179.31L76.69,208Zm48-3.31L79.32,188,164,103.31,180.69,120Zm96-96L147.32,64l24-24L216,84.69Z"},child:[]}]})(i)}function yN(i){return pt({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M236.8,188.09,149.35,36.22h0a24.76,24.76,0,0,0-42.7,0L19.2,188.09a23.51,23.51,0,0,0,0,23.72A24.35,24.35,0,0,0,40.55,224h174.9a24.35,24.35,0,0,0,21.33-12.19A23.51,23.51,0,0,0,236.8,188.09ZM222.93,203.8a8.5,8.5,0,0,1-7.48,4.2H40.55a8.5,8.5,0,0,1-7.48-4.2,7.59,7.59,0,0,1,0-7.72L120.52,44.21a8.75,8.75,0,0,1,15,0l87.45,151.87A7.59,7.59,0,0,1,222.93,203.8ZM120,144V104a8,8,0,0,1,16,0v40a8,8,0,0,1-16,0Zm20,36a12,12,0,1,1-12-12A12,12,0,0,1,140,180Z"},child:[]}]})(i)}function bN(i){return pt({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M205.66,194.34a8,8,0,0,1-11.32,11.32L128,139.31,61.66,205.66a8,8,0,0,1-11.32-11.32L116.69,128,50.34,61.66A8,8,0,0,1,61.66,50.34L128,116.69l66.34-66.35a8,8,0,0,1,11.32,11.32L139.31,128Z"},child:[]}]})(i)}const v4=R`
  position: absolute;
  top: 0px;
  left: 0px;
  width: 100vw;
  height: 100vh;
  z-index: 2;
  backdrop-filter: blur(30px);
  background-color: #00000005;
  display: flex;
  align-items: center;
  justify-content: center;
  user-select: none;
`,w4=R`
  background-color: #1c1c1c;
  border-radius: 14px;
  user-select: text;
  display: flex;
  flex-direction: row;
  align-items: stretch;
  box-shadow: rgba(0, 0, 0, 0.07) 0px 1px 2px, rgba(0, 0, 0, 0.07) 0px 2px 4px,
    rgba(0, 0, 0, 0.07) 0px 4px 8px, rgba(0, 0, 0, 0.07) 0px 8px 16px,
    rgba(0, 0, 0, 0.07) 0px 16px 32px, rgba(0, 0, 0, 0.07) 0px 32px 64px;
`,S4=document.getElementById("modal"),x4=({onBackdropClick:i,modalClassName:e,backdropClassName:t,children:r})=>{const n=s=>{s.preventDefault(),s.stopPropagation()};return wn.createPortal(T.jsx("div",{className:mi(v4,t),onClick:i,children:T.jsx("div",{onClick:n,className:mi(w4,e),children:r})}),S4)};var k4={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0};const T4=ec(k4);var C4=/\s([^'"/\s><]+?)[\s/>]|([^\s=]+)=\s?(".*?"|'.*?')/g;function Zv(i){var e={type:"tag",name:"",voidElement:!1,attrs:{},children:[]},t=i.match(/<\/?([^\s]+?)[/\s>]/);if(t&&(e.name=t[1],(T4[t[1]]||i.charAt(i.length-2)==="/")&&(e.voidElement=!0),e.name.startsWith("!--"))){var r=i.indexOf("-->");return{type:"comment",comment:r!==-1?i.slice(4,r):""}}for(var n=new RegExp(C4),s=null;(s=n.exec(i))!==null;)if(s[0].trim())if(s[1]){var a=s[1].trim(),o=[a,""];a.indexOf("=")>-1&&(o=a.split("=")),e.attrs[o[0]]=o[1],n.lastIndex--}else s[2]&&(e.attrs[s[2]]=s[3].trim().substring(1,s[3].length-1));return e}var N4=/<[a-zA-Z0-9\-\!\/](?:"[^"]*"|'[^']*'|[^'">])*>/g,B4=/^\s*$/,_4=Object.create(null);function vN(i,e){switch(e.type){case"text":return i+e.content;case"tag":return i+="<"+e.name+(e.attrs?function(t){var r=[];for(var n in t)r.push(n+'="'+t[n]+'"');return r.length?" "+r.join(" "):""}(e.attrs):"")+(e.voidElement?"/>":">"),e.voidElement?i:i+e.children.reduce(vN,"")+"</"+e.name+">";case"comment":return i+"<!--"+e.comment+"-->"}}var P4={parse:function(i,e){e||(e={}),e.components||(e.components=_4);var t,r=[],n=[],s=-1,a=!1;if(i.indexOf("<")!==0){var o=i.indexOf("<");r.push({type:"text",content:o===-1?i:i.substring(0,o)})}return i.replace(N4,function(l,u){if(a){if(l!=="</"+t.name+">")return;a=!1}var c,h=l.charAt(1)!=="/",d=l.startsWith("<!--"),f=u+l.length,p=i.charAt(f);if(d){var g=Zv(l);return s<0?(r.push(g),r):((c=n[s]).children.push(g),r)}if(h&&(s++,(t=Zv(l)).type==="tag"&&e.components[t.name]&&(t.type="component",a=!0),t.voidElement||a||!p||p==="<"||t.children.push({type:"text",content:i.slice(f,i.indexOf("<",f))}),s===0&&r.push(t),(c=n[s-1])&&c.children.push(t),n[s]=t),(!h||t.voidElement)&&(s>-1&&(t.voidElement||t.name===l.slice(2,-1))&&(s--,t=s===-1?r:n[s]),!a&&p!=="<"&&p)){c=s===-1?r:n[s].children;var y=i.indexOf("<",f),b=i.slice(f,y===-1?void 0:y);B4.test(b)&&(b=" "),(y>-1&&s+c.length>=0||b!==" ")&&c.push({type:"text",content:b})}}),r},stringify:function(i){return i.reduce(function(e,t){return e+vN("",t)},"")}};const Ih=(...i)=>{console!=null&&console.warn&&(nn(i[0])&&(i[0]=`react-i18next:: ${i[0]}`),console.warn(...i))},ew={},Sd=(...i)=>{nn(i[0])&&ew[i[0]]||(nn(i[0])&&(ew[i[0]]=new Date),Ih(...i))},wN=(i,e)=>()=>{if(i.isInitialized)e();else{const t=()=>{setTimeout(()=>{i.off("initialized",t)},0),e()};i.on("initialized",t)}},tw=(i,e,t)=>{i.loadNamespaces(e,wN(i,t))},iw=(i,e,t,r)=>{nn(t)&&(t=[t]),t.forEach(n=>{i.options.ns.indexOf(n)<0&&i.options.ns.push(n)}),i.loadLanguages(e,wN(i,r))},R4=(i,e,t={})=>!e.languages||!e.languages.length?(Sd("i18n.languages were undefined or empty",e.languages),!0):e.hasLoadedNamespace(i,{lng:t.lng,precheck:(r,n)=>{var s;if(((s=t.bindI18n)==null?void 0:s.indexOf("languageChanging"))>-1&&r.services.backendConnector.backend&&r.isLanguageChangingTo&&!n(r.isLanguageChangingTo,i))return!1}}),nn=i=>typeof i=="string",Po=i=>typeof i=="object"&&i!==null,E4=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,M4={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"©","&#169;":"©","&reg;":"®","&#174;":"®","&hellip;":"…","&#8230;":"…","&#x2F;":"/","&#47;":"/"},O4=i=>M4[i],I4=i=>i.replace(E4,O4);let L4={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:I4};const SN=()=>L4;let D4;const Zy=()=>D4,eg=(i,e)=>{var r;if(!i)return!1;const t=((r=i.props)==null?void 0:r.children)??i.children;return e?t.length>0:!!t},tg=i=>{var t,r;if(!i)return[];const e=((t=i.props)==null?void 0:t.children)??i.children;return(r=i.props)!=null&&r.i18nIsDynamicList?Ro(e):e},F4=i=>Array.isArray(i)&&i.every(S.isValidElement),Ro=i=>Array.isArray(i)?i:[i],A4=(i,e)=>{const t={...e};return t.props=Object.assign(i.props,e.props),t},xN=(i,e)=>{if(!i)return"";let t="";const r=Ro(i),n=e!=null&&e.transSupportBasicHtmlNodes?e.transKeepBasicHtmlNodesFor??[]:[];return r.forEach((s,a)=>{if(nn(s))t+=`${s}`;else if(S.isValidElement(s)){const{props:o,type:l}=s,u=Object.keys(o).length,c=n.indexOf(l)>-1,h=o.children;if(!h&&c&&!u)t+=`<${l}/>`;else if(!h&&(!c||u)||o.i18nIsDynamicList)t+=`<${a}></${a}>`;else if(c&&u===1&&nn(h))t+=`<${l}>${h}</${l}>`;else{const d=xN(h,e);t+=`<${a}>${d}</${a}>`}}else if(s===null)Ih("Trans: the passed in value is invalid - seems you passed in a null child.");else if(Po(s)){const{format:o,...l}=s,u=Object.keys(l);if(u.length===1){const c=o?`${u[0]}, ${o}`:u[0];t+=`{{${c}}}`}else Ih("react-i18next: the passed in object contained more than one variable - the object should look like {{ value, format }} where format is optional.",s)}else Ih("Trans: the passed in value is invalid - seems you passed in a variable like {number} - please pass in variables for interpolation as full objects like {{number}}.",s)}),t},V4=(i,e,t,r,n,s)=>{if(e==="")return[];const a=r.transKeepBasicHtmlNodesFor||[],o=e&&new RegExp(a.map(y=>`<${y}`).join("|")).test(e);if(!i&&!o&&!s)return[e];const l={},u=y=>{Ro(y).forEach(m=>{nn(m)||(eg(m)?u(tg(m)):Po(m)&&!S.isValidElement(m)&&Object.assign(l,m))})};u(i);const c=P4.parse(`<0>${e}</0>`),h={...l,...n},d=(y,b,m)=>{var x;const v=tg(y),k=p(v,b.children,m);return F4(v)&&k.length===0||(x=y.props)!=null&&x.i18nIsDynamicList?v:k},f=(y,b,m,v,k)=>{y.dummy?(y.children=b,m.push(S.cloneElement(y,{key:v},k?void 0:b))):m.push(...S.Children.map([y],x=>{const C={...x.props};return delete C.i18nIsDynamicList,S.createElement(x.type,{...C,key:v,ref:x.ref},k?null:b)}))},p=(y,b,m)=>{const v=Ro(y);return Ro(b).reduce((x,C,N)=>{var E,O;const B=((O=(E=C.children)==null?void 0:E[0])==null?void 0:O.content)&&t.services.interpolator.interpolate(C.children[0].content,h,t.language);if(C.type==="tag"){let z=v[parseInt(C.name,10)];m.length===1&&!z&&(z=m[0][C.name]),z||(z={});const J=Object.keys(C.attrs).length!==0?A4({props:C.attrs},z):z,he=S.isValidElement(J),oe=he&&eg(C,!0)&&!C.voidElement,ye=o&&Po(J)&&J.dummy&&!he,se=Po(i)&&Object.hasOwnProperty.call(i,C.name);if(nn(J)){const K=t.services.interpolator.interpolate(J,h,t.language);x.push(K)}else if(eg(J)||oe){const K=d(J,C,m);f(J,K,x,N)}else if(ye){const K=p(v,C.children,m);f(J,K,x,N)}else if(Number.isNaN(parseFloat(C.name)))if(se){const K=d(J,C,m);f(J,K,x,N,C.voidElement)}else if(r.transSupportBasicHtmlNodes&&a.indexOf(C.name)>-1)if(C.voidElement)x.push(S.createElement(C.name,{key:`${C.name}-${N}`}));else{const K=p(v,C.children,m);x.push(S.createElement(C.name,{key:`${C.name}-${N}`},K))}else if(C.voidElement)x.push(`<${C.name} />`);else{const K=p(v,C.children,m);x.push(`<${C.name}>${K}</${C.name}>`)}else if(Po(J)&&!he){const K=C.children[0]?B:null;K&&x.push(K)}else f(J,B,x,N,C.children.length!==1||!B)}else if(C.type==="text"){const z=r.transWrapTextNodes,J=s?r.unescape(t.services.interpolator.interpolate(C.content,h,t.language)):t.services.interpolator.interpolate(C.content,h,t.language);z?x.push(S.createElement(z,{key:`${C.name}-${N}`},J)):x.push(J)}return x},[])},g=p([{dummy:!0,children:i||[]}],c,Ro(i||[]));return tg(g[0])};function H4({children:i,count:e,parent:t,i18nKey:r,context:n,tOptions:s={},values:a,defaults:o,components:l,ns:u,i18n:c,t:h,shouldUnescape:d,...f}){var z,J,he,oe;const p=c||Zy();if(!p)return Sd("You will need to pass in an i18next instance by using i18nextReactModule"),i;const g=h||p.t.bind(p)||(ye=>ye),y={...SN(),...(z=p.options)==null?void 0:z.react};let b=u||g.ns||((J=p.options)==null?void 0:J.defaultNS);b=nn(b)?[b]:b||["translation"];const m=xN(i,y),v=o||m||y.transEmptyNodeValue||r,{hashTransKey:k}=y,x=r||(k?k(m||v):m||v);(oe=(he=p.options)==null?void 0:he.interpolation)!=null&&oe.defaultVariables&&(a=a&&Object.keys(a).length>0?{...a,...p.options.interpolation.defaultVariables}:{...p.options.interpolation.defaultVariables});const C=a||e!==void 0||!i?s.interpolation:{interpolation:{...s.interpolation,prefix:"#$?",suffix:"?$#"}},N={...s,context:n||s.context,count:e,...a,...C,defaultValue:v,ns:b},B=x?g(x,N):v;l&&Object.keys(l).forEach(ye=>{const se=l[ye];if(typeof se.type=="function"||!se.props||!se.props.children||B.indexOf(`${ye}/>`)<0&&B.indexOf(`${ye} />`)<0)return;function K(){return S.createElement(S.Fragment,null,se)}l[ye]=S.createElement(K)});const E=V4(l||i,B,p,y,N,d),O=t??y.defaultTransParent;return O?S.createElement(O,f,E):E}const e1=S.createContext();class z4{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(t=>{var r;(r=this.usedNamespaces)[t]??(r[t]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}function U4({children:i,count:e,parent:t,i18nKey:r,context:n,tOptions:s={},values:a,defaults:o,components:l,ns:u,i18n:c,t:h,shouldUnescape:d,...f}){var m;const{i18n:p,defaultNS:g}=S.useContext(e1)||{},y=c||p||Zy(),b=h||(y==null?void 0:y.t.bind(y));return H4({children:i,count:e,parent:t,i18nKey:r,context:n,tOptions:s,values:a,defaults:o,components:l,ns:u||(b==null?void 0:b.ns)||g||((m=y==null?void 0:y.options)==null?void 0:m.defaultNS),i18n:y,t:h,shouldUnescape:d,...f})}const W4=(i,e)=>{const t=S.useRef();return S.useEffect(()=>{t.current=i},[i,e]),t.current},kN=(i,e,t,r)=>i.getFixedT(e,t,r),G4=(i,e,t,r)=>S.useCallback(kN(i,e,t,r),[i,e,t,r]),vt=(i,e={})=>{var k,x,C,N;const{i18n:t}=e,{i18n:r,defaultNS:n}=S.useContext(e1)||{},s=t||r||Zy();if(s&&!s.reportNamespaces&&(s.reportNamespaces=new z4),!s){Sd("You will need to pass in an i18next instance by using initReactI18next");const B=(O,z)=>nn(z)?z:Po(z)&&nn(z.defaultValue)?z.defaultValue:Array.isArray(O)?O[O.length-1]:O,E=[B,{},!1];return E.t=B,E.i18n={},E.ready=!1,E}(k=s.options.react)!=null&&k.wait&&Sd("It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const a={...SN(),...s.options.react,...e},{useSuspense:o,keyPrefix:l}=a;let u=n||((x=s.options)==null?void 0:x.defaultNS);u=nn(u)?[u]:u||["translation"],(N=(C=s.reportNamespaces).addUsedNamespaces)==null||N.call(C,u);const c=(s.isInitialized||s.initializedStoreOnce)&&u.every(B=>R4(B,s,a)),h=G4(s,e.lng||null,a.nsMode==="fallback"?u:u[0],l),d=()=>h,f=()=>kN(s,e.lng||null,a.nsMode==="fallback"?u:u[0],l),[p,g]=S.useState(d);let y=u.join();e.lng&&(y=`${e.lng}${y}`);const b=W4(y),m=S.useRef(!0);S.useEffect(()=>{const{bindI18n:B,bindI18nStore:E}=a;m.current=!0,!c&&!o&&(e.lng?iw(s,e.lng,u,()=>{m.current&&g(f)}):tw(s,u,()=>{m.current&&g(f)})),c&&b&&b!==y&&m.current&&g(f);const O=()=>{m.current&&g(f)};return B&&(s==null||s.on(B,O)),E&&(s==null||s.store.on(E,O)),()=>{m.current=!1,s&&(B==null||B.split(" ").forEach(z=>s.off(z,O))),E&&s&&E.split(" ").forEach(z=>s.store.off(z,O))}},[s,y]),S.useEffect(()=>{m.current&&c&&g(d)},[s,l,c]);const v=[p,s,c];if(v.t=p,v.i18n=s,v.ready=c,c||!c&&!o)return v;throw new Promise(B=>{e.lng?iw(s,e.lng,u,()=>B()):tw(s,u,()=>B())})};function $4({i18n:i,defaultNS:e,children:t}){const r=S.useMemo(()=>({i18n:i,defaultNS:e}),[i,e]);return S.createElement(e1.Provider,{value:r},t)}function TN(i){return pt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M228.2 26.89c-15.2-.25-27.7 33.46-12.3 39.8l8.9 3.61 17.8-15.5-1.8-23.5-8.7-3.6c-1.1-.43-2.1-.68-3.2-.78h-.7zm134.4 7.92h-2.3c-7.4.3-15.3 2.12-23.3 5.75-21.2 9.67-43.6 32.67-59.7 75.74L174.4 394.7l-.1.2v.2c.9.5 3.6 1.9 8 4 9.8 4.8 24 15.7 26.1 38.8v.5l-1 55.6H304c-.1-17.6 1.4-34.5 8.1-51.5 11.7-29.4 39.3-54.9 97-77 0-.2 0 0 .1-.4.3-2 .4-6 0-11-1-10.1-4-24.9-8.6-42.2-9.2-34.7-24.8-80.2-42.4-124.9l-2.4-6.2 5.2-4.2c36.1-28.2 51.1-56.4 53.8-79.56 2.7-23.06-6.5-41.48-21.3-52.25-8.7-6.31-19.3-9.99-30.9-10.02zM260.5 52.44l.7 10.01-7.6 6.6 21.7 8.93c1.2-2.17 2.5-4.28 3.8-6.33l4-9.89zm69 18.56c8.8 0 16 7.16 16 16s-7.2 16-16 16-16-7.16-16-16 7.2-16 16-16zm-136.7 49.7c-15.2-.3-27.9 33.4-12.3 39.8l8.8 3.6 17.8-15.5-1.7-23.6-8.8-3.6c-1.1-.4-2.1-.6-3.1-.7zm32.2 25.5l.7 10-7.6 6.6 19.9 8.1 6.2-16.8zm71.6 19.8c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm-139.8 50.6c-15.3-.3-27.8 33.4-12.4 39.8l8.9 3.6 17.8-15.5-1.8-23.6-8.7-3.6c-1.1-.4-2.1-.6-3.1-.7zm32.2 25.5l.7 10-7.6 6.6 20.4 8.3 6.2-16.8zm67.2 19.3c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm-140.1 54.4c-15.2-.3-27.78 33.4-12.3 39.8l8.8 3.6 17.8-15.5-1.8-23.6-8.7-3.6c-1.1-.4-2.1-.6-3.1-.7zm32.2 25.5l.7 10-7.6 6.6 22.8 9.3 6.8-16.6zm69.3 18.5c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z"},child:[]}]})(i)}const j4=R`
  display: flex;
  flex-direction: column;
  padding: 14px;
  pointer-events: auto;
`,Y4=R`
  font-size: 1em;
  color: #ffffff;
  margin-bottom: 2px;
  pointer-events: auto;
`,X4=R`
  font-size: 0.8em;
  margin-bottom: 10px;
  color: #ffffffaa;
`;function qm({Editor:i,name:e,value:t,data:r,description:n,onChange:s}){const a=S.useMemo(()=>`${e.toLowerCase().replace(/^\W/gi,"").replace(/\s+/g,"-")}-${Ir()}`,[e]);return T.jsxs("div",{className:j4,children:[T.jsx("label",{className:Y4,htmlFor:a,children:e}),T.jsx("span",{className:X4,children:n}),T.jsx(i,{id:a,value:t,data:r,onChange:s})]})}const K4=R`
  border-radius: 6px;
  background-color: #ffffff10;
  flex: 1;
  color: #ffffff;
  border: none;
  outline: none;
  padding: 10px 14px;
  font-size: 1em;
  &:hover {
    background-color: #ffffff30;
  }
  &:focus {
    background-color: #ffffff50;
  }
`,q4=({id:i,value:e,onChange:t,data:r})=>{const n=s=>{t(s.target.value)};return T.jsx("input",{type:"text",className:K4,...r??{},id:i,value:e,onChange:n})};function Ka(i){"@babel/helpers - typeof";return Ka=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ka(i)}function J4(i,e){if(Ka(i)!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(Ka(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function CN(i){var e=J4(i,"string");return Ka(e)=="symbol"?e:e+""}function Hl(i,e,t){return(e=CN(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function rw(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(i,n).enumerable})),t.push.apply(t,r)}return t}function Me(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?rw(Object(t),!0).forEach(function(r){Hl(i,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):rw(Object(t)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(t,r))})}return i}function Q4(i){if(Array.isArray(i))return i}function Z4(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var r,n,s,a,o=[],l=!0,u=!1;try{if(s=(t=t.call(i)).next,e===0){if(Object(t)!==t)return;l=!1}else for(;!(l=(r=s.call(t)).done)&&(o.push(r.value),o.length!==e);l=!0);}catch(c){u=!0,n=c}finally{try{if(!l&&t.return!=null&&(a=t.return(),Object(a)!==a))return}finally{if(u)throw n}}return o}}function Jm(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,r=Array(e);t<e;t++)r[t]=i[t];return r}function NN(i,e){if(i){if(typeof i=="string")return Jm(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Jm(i,e):void 0}}function eD(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fs(i,e){return Q4(i)||Z4(i,e)||NN(i,e)||eD()}function zl(i,e){if(i==null)return{};var t={};for(var r in i)if({}.hasOwnProperty.call(i,r)){if(e.includes(r))continue;t[r]=i[r]}return t}function _s(i,e){if(i==null)return{};var t,r,n=zl(i,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);for(r=0;r<s.length;r++)t=s[r],e.includes(t)||{}.propertyIsEnumerable.call(i,t)&&(n[t]=i[t])}return n}var tD=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function iD(i){var e=i.defaultInputValue,t=e===void 0?"":e,r=i.defaultMenuIsOpen,n=r===void 0?!1:r,s=i.defaultValue,a=s===void 0?null:s,o=i.inputValue,l=i.menuIsOpen,u=i.onChange,c=i.onInputChange,h=i.onMenuClose,d=i.onMenuOpen,f=i.value,p=_s(i,tD),g=S.useState(o!==void 0?o:t),y=fs(g,2),b=y[0],m=y[1],v=S.useState(l!==void 0?l:n),k=fs(v,2),x=k[0],C=k[1],N=S.useState(f!==void 0?f:a),B=fs(N,2),E=B[0],O=B[1],z=S.useCallback(function(U,Z){typeof u=="function"&&u(U,Z),O(U)},[u]),J=S.useCallback(function(U,Z){var re;typeof c=="function"&&(re=c(U,Z)),m(re!==void 0?re:U)},[c]),he=S.useCallback(function(){typeof d=="function"&&d(),C(!0)},[d]),oe=S.useCallback(function(){typeof h=="function"&&h(),C(!1)},[h]),ye=o!==void 0?o:b,se=l!==void 0?l:x,K=f!==void 0?f:E;return Me(Me({},p),{},{inputValue:ye,menuIsOpen:se,onChange:z,onInputChange:J,onMenuClose:oe,onMenuOpen:he,value:K})}function rD(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function nw(i,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(i,CN(r.key),r)}}function nD(i,e,t){return e&&nw(i.prototype,e),t&&nw(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}function Qm(i,e){return Qm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},Qm(i,e)}function sD(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&Qm(i,e)}function xd(i){return xd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},xd(i)}function BN(){try{var i=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(BN=function(){return!!i})()}function aD(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function oD(i,e){if(e&&(Ka(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aD(i)}function lD(i){var e=BN();return function(){var t,r=xd(i);if(e){var n=xd(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return oD(this,t)}}function uD(i){if(Array.isArray(i))return Jm(i)}function cD(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function hD(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function t1(i){return uD(i)||cD(i)||NN(i)||hD()}function dD(i,e){return e||(e=i.slice(0)),Object.freeze(Object.defineProperties(i,{raw:{value:Object.freeze(e)}}))}const fD=Math.min,pD=Math.max,kd=Math.round,$c=Math.floor,Td=i=>({x:i,y:i});function gD(i){const{x:e,y:t,width:r,height:n}=i;return{width:r,height:n,top:t,left:e,right:e+r,bottom:t+n,x:e,y:t}}function _N(i){return RN(i)?(i.nodeName||"").toLowerCase():"#document"}function Ss(i){var e;return(i==null||(e=i.ownerDocument)==null?void 0:e.defaultView)||window}function PN(i){var e;return(e=(RN(i)?i.ownerDocument:i.document)||window.document)==null?void 0:e.documentElement}function RN(i){return i instanceof Node||i instanceof Ss(i).Node}function mD(i){return i instanceof Element||i instanceof Ss(i).Element}function i1(i){return i instanceof HTMLElement||i instanceof Ss(i).HTMLElement}function sw(i){return typeof ShadowRoot>"u"?!1:i instanceof ShadowRoot||i instanceof Ss(i).ShadowRoot}function EN(i){const{overflow:e,overflowX:t,overflowY:r,display:n}=r1(i);return/auto|scroll|overlay|hidden|clip/.test(e+r+t)&&!["inline","contents"].includes(n)}function yD(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function bD(i){return["html","body","#document"].includes(_N(i))}function r1(i){return Ss(i).getComputedStyle(i)}function vD(i){if(_N(i)==="html")return i;const e=i.assignedSlot||i.parentNode||sw(i)&&i.host||PN(i);return sw(e)?e.host:e}function MN(i){const e=vD(i);return bD(e)?i.ownerDocument?i.ownerDocument.body:i.body:i1(e)&&EN(e)?e:MN(e)}function Cd(i,e,t){var r;e===void 0&&(e=[]),t===void 0&&(t=!0);const n=MN(i),s=n===((r=i.ownerDocument)==null?void 0:r.body),a=Ss(n);if(s){const o=wD(a);return e.concat(a,a.visualViewport||[],EN(n)?n:[],o&&t?Cd(o):[])}return e.concat(n,Cd(n,[],t))}function wD(i){return i.parent&&Object.getPrototypeOf(i.parent)?i.frameElement:null}function SD(i){const e=r1(i);let t=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const n=i1(i),s=n?i.offsetWidth:t,a=n?i.offsetHeight:r,o=kd(t)!==s||kd(r)!==a;return o&&(t=s,r=a),{width:t,height:r,$:o}}function n1(i){return mD(i)?i:i.contextElement}function aw(i){const e=n1(i);if(!i1(e))return Td(1);const t=e.getBoundingClientRect(),{width:r,height:n,$:s}=SD(e);let a=(s?kd(t.width):t.width)/r,o=(s?kd(t.height):t.height)/n;return(!a||!Number.isFinite(a))&&(a=1),(!o||!Number.isFinite(o))&&(o=1),{x:a,y:o}}const xD=Td(0);function kD(i){const e=Ss(i);return!yD()||!e.visualViewport?xD:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function TD(i,e,t){return!1}function ow(i,e,t,r){e===void 0&&(e=!1);const n=i.getBoundingClientRect(),s=n1(i);let a=Td(1);e&&(a=aw(i));const o=TD()?kD(s):Td(0);let l=(n.left+o.x)/a.x,u=(n.top+o.y)/a.y,c=n.width/a.x,h=n.height/a.y;if(s){const d=Ss(s),f=r;let p=d,g=p.frameElement;for(;g&&r&&f!==p;){const y=aw(g),b=g.getBoundingClientRect(),m=r1(g),v=b.left+(g.clientLeft+parseFloat(m.paddingLeft))*y.x,k=b.top+(g.clientTop+parseFloat(m.paddingTop))*y.y;l*=y.x,u*=y.y,c*=y.x,h*=y.y,l+=v,u+=k,p=Ss(g),g=p.frameElement}}return gD({width:c,height:h,x:l,y:u})}function CD(i,e){let t=null,r;const n=PN(i);function s(){var o;clearTimeout(r),(o=t)==null||o.disconnect(),t=null}function a(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),s();const{left:u,top:c,width:h,height:d}=i.getBoundingClientRect();if(o||e(),!h||!d)return;const f=$c(c),p=$c(n.clientWidth-(u+h)),g=$c(n.clientHeight-(c+d)),y=$c(u),m={rootMargin:-f+"px "+-p+"px "+-g+"px "+-y+"px",threshold:pD(0,fD(1,l))||1};let v=!0;function k(x){const C=x[0].intersectionRatio;if(C!==l){if(!v)return a();C?a(!1,C):r=setTimeout(()=>{a(!1,1e-7)},1e3)}v=!1}try{t=new IntersectionObserver(k,{...m,root:n.ownerDocument})}catch{t=new IntersectionObserver(k,m)}t.observe(i)}return a(!0),s}function ND(i,e,t,r){r===void 0&&(r={});const{ancestorScroll:n=!0,ancestorResize:s=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,u=n1(i),c=n||s?[...u?Cd(u):[],...Cd(e)]:[];c.forEach(b=>{n&&b.addEventListener("scroll",t,{passive:!0}),s&&b.addEventListener("resize",t)});const h=u&&o?CD(u,t):null;let d=-1,f=null;a&&(f=new ResizeObserver(b=>{let[m]=b;m&&m.target===u&&f&&(f.unobserve(e),cancelAnimationFrame(d),d=requestAnimationFrame(()=>{var v;(v=f)==null||v.observe(e)})),t()}),u&&!l&&f.observe(u),f.observe(e));let p,g=l?ow(i):null;l&&y();function y(){const b=ow(i);g&&(b.x!==g.x||b.y!==g.y||b.width!==g.width||b.height!==g.height)&&t(),g=b,p=requestAnimationFrame(y)}return t(),()=>{var b;c.forEach(m=>{n&&m.removeEventListener("scroll",t),s&&m.removeEventListener("resize",t)}),h==null||h(),(b=f)==null||b.disconnect(),f=null,l&&cancelAnimationFrame(p)}}var Zm=S.useLayoutEffect,BD=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],Nd=function(){};function _D(i,e){return e?e[0]==="-"?i+e:i+"__"+e:i}function PD(i,e){for(var t=arguments.length,r=new Array(t>2?t-2:0),n=2;n<t;n++)r[n-2]=arguments[n];var s=[].concat(r);if(e&&i)for(var a in e)e.hasOwnProperty(a)&&e[a]&&s.push("".concat(_D(i,a)));return s.filter(function(o){return o}).map(function(o){return String(o).trim()}).join(" ")}var lw=function(e){return AD(e)?e.filter(Boolean):Ka(e)==="object"&&e!==null?[e]:[]},ON=function(e){e.className,e.clearValue,e.cx,e.getStyles,e.getClassNames,e.getValue,e.hasValue,e.isMulti,e.isRtl,e.options,e.selectOption,e.selectProps,e.setValue,e.theme;var t=_s(e,BD);return Me({},t)},ti=function(e,t,r){var n=e.cx,s=e.getStyles,a=e.getClassNames,o=e.className;return{css:s(t,e),className:n(r??{},a(t,e),o)}};function Hf(i){return[document.documentElement,document.body,window].indexOf(i)>-1}function RD(i){return Hf(i)?window.innerHeight:i.clientHeight}function IN(i){return Hf(i)?window.pageYOffset:i.scrollTop}function Bd(i,e){if(Hf(i)){window.scrollTo(0,e);return}i.scrollTop=e}function ED(i){var e=getComputedStyle(i),t=e.position==="absolute",r=/(auto|scroll)/;if(e.position==="fixed")return document.documentElement;for(var n=i;n=n.parentElement;)if(e=getComputedStyle(n),!(t&&e.position==="static")&&r.test(e.overflow+e.overflowY+e.overflowX))return n;return document.documentElement}function MD(i,e,t,r){return t*((i=i/r-1)*i*i+1)+e}function jc(i,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Nd,n=IN(i),s=e-n,a=10,o=0;function l(){o+=a;var u=MD(o,n,s,t);Bd(i,u),o<t?window.requestAnimationFrame(l):r(i)}l()}function uw(i,e){var t=i.getBoundingClientRect(),r=e.getBoundingClientRect(),n=e.offsetHeight/3;r.bottom+n>t.bottom?Bd(i,Math.min(e.offsetTop+e.clientHeight-i.offsetHeight+n,i.scrollHeight)):r.top-n<t.top&&Bd(i,Math.max(e.offsetTop-n,0))}function OD(i){var e=i.getBoundingClientRect();return{bottom:e.bottom,height:e.height,left:e.left,right:e.right,top:e.top,width:e.width}}function cw(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function ID(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var LN=!1,LD={get passive(){return LN=!0}},Yc=typeof window<"u"?window:{};Yc.addEventListener&&Yc.removeEventListener&&(Yc.addEventListener("p",Nd,LD),Yc.removeEventListener("p",Nd,!1));var DD=LN;function FD(i){return i!=null}function AD(i){return Array.isArray(i)}function Xc(i,e,t){return i?e:t}var VD=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var s=Object.entries(e).filter(function(a){var o=fs(a,1),l=o[0];return!r.includes(l)});return s.reduce(function(a,o){var l=fs(o,2),u=l[0],c=l[1];return a[u]=c,a},{})},HD=["children","innerProps"],zD=["children","innerProps"];function UD(i){var e=i.maxHeight,t=i.menuEl,r=i.minHeight,n=i.placement,s=i.shouldScroll,a=i.isFixedPosition,o=i.controlHeight,l=ED(t),u={placement:"bottom",maxHeight:e};if(!t||!t.offsetParent)return u;var c=l.getBoundingClientRect(),h=c.height,d=t.getBoundingClientRect(),f=d.bottom,p=d.height,g=d.top,y=t.offsetParent.getBoundingClientRect(),b=y.top,m=a?window.innerHeight:RD(l),v=IN(l),k=parseInt(getComputedStyle(t).marginBottom,10),x=parseInt(getComputedStyle(t).marginTop,10),C=b-x,N=m-g,B=C+v,E=h-v-g,O=f-m+v+k,z=v+g-x,J=160;switch(n){case"auto":case"bottom":if(N>=p)return{placement:"bottom",maxHeight:e};if(E>=p&&!a)return s&&jc(l,O,J),{placement:"bottom",maxHeight:e};if(!a&&E>=r||a&&N>=r){s&&jc(l,O,J);var he=a?N-k:E-k;return{placement:"bottom",maxHeight:he}}if(n==="auto"||a){var oe=e,ye=a?C:B;return ye>=r&&(oe=Math.min(ye-k-o,e)),{placement:"top",maxHeight:oe}}if(n==="bottom")return s&&Bd(l,O),{placement:"bottom",maxHeight:e};break;case"top":if(C>=p)return{placement:"top",maxHeight:e};if(B>=p&&!a)return s&&jc(l,z,J),{placement:"top",maxHeight:e};if(!a&&B>=r||a&&C>=r){var se=e;return(!a&&B>=r||a&&C>=r)&&(se=a?C-x:B-x),s&&jc(l,z,J),{placement:"top",maxHeight:se}}return{placement:"bottom",maxHeight:e};default:throw new Error('Invalid placement provided "'.concat(n,'".'))}return u}function WD(i){var e={bottom:"top",top:"bottom"};return i?e[i]:"bottom"}var DN=function(e){return e==="auto"?"bottom":e},GD=function(e,t){var r,n=e.placement,s=e.theme,a=s.borderRadius,o=s.spacing,l=s.colors;return Me((r={label:"menu"},Hl(r,WD(n),"100%"),Hl(r,"position","absolute"),Hl(r,"width","100%"),Hl(r,"zIndex",1),r),t?{}:{backgroundColor:l.neutral0,borderRadius:a,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:o.menuGutter,marginTop:o.menuGutter})},FN=S.createContext(null),$D=function(e){var t=e.children,r=e.minMenuHeight,n=e.maxMenuHeight,s=e.menuPlacement,a=e.menuPosition,o=e.menuShouldScrollIntoView,l=e.theme,u=S.useContext(FN)||{},c=u.setPortalPlacement,h=S.useRef(null),d=S.useState(n),f=fs(d,2),p=f[0],g=f[1],y=S.useState(null),b=fs(y,2),m=b[0],v=b[1],k=l.spacing.controlHeight;return Zm(function(){var x=h.current;if(x){var C=a==="fixed",N=o&&!C,B=UD({maxHeight:n,menuEl:x,minHeight:r,placement:s,shouldScroll:N,isFixedPosition:C,controlHeight:k});g(B.maxHeight),v(B.placement),c==null||c(B.placement)}},[n,s,a,o,r,c,k]),t({ref:h,placerProps:Me(Me({},e),{},{placement:m||DN(s),maxHeight:p})})},jD=function(e){var t=e.children,r=e.innerRef,n=e.innerProps;return Pe("div",le({},ti(e,"menu",{menu:!0}),{ref:r},n),t)},YD=jD,XD=function(e,t){var r=e.maxHeight,n=e.theme.spacing.baseUnit;return Me({maxHeight:r,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},t?{}:{paddingBottom:n,paddingTop:n})},KD=function(e){var t=e.children,r=e.innerProps,n=e.innerRef,s=e.isMulti;return Pe("div",le({},ti(e,"menuList",{"menu-list":!0,"menu-list--is-multi":s}),{ref:n},r),t)},AN=function(e,t){var r=e.theme,n=r.spacing.baseUnit,s=r.colors;return Me({textAlign:"center"},t?{}:{color:s.neutral40,padding:"".concat(n*2,"px ").concat(n*3,"px")})},qD=AN,JD=AN,QD=function(e){var t=e.children,r=t===void 0?"No options":t,n=e.innerProps,s=_s(e,HD);return Pe("div",le({},ti(Me(Me({},s),{},{children:r,innerProps:n}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),n),r)},ZD=function(e){var t=e.children,r=t===void 0?"Loading...":t,n=e.innerProps,s=_s(e,zD);return Pe("div",le({},ti(Me(Me({},s),{},{children:r,innerProps:n}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),n),r)},eF=function(e){var t=e.rect,r=e.offset,n=e.position;return{left:t.left,position:n,top:r,width:t.width,zIndex:1}},tF=function(e){var t=e.appendTo,r=e.children,n=e.controlElement,s=e.innerProps,a=e.menuPlacement,o=e.menuPosition,l=S.useRef(null),u=S.useRef(null),c=S.useState(DN(a)),h=fs(c,2),d=h[0],f=h[1],p=S.useMemo(function(){return{setPortalPlacement:f}},[]),g=S.useState(null),y=fs(g,2),b=y[0],m=y[1],v=S.useCallback(function(){if(n){var N=OD(n),B=o==="fixed"?0:window.pageYOffset,E=N[d]+B;(E!==(b==null?void 0:b.offset)||N.left!==(b==null?void 0:b.rect.left)||N.width!==(b==null?void 0:b.rect.width))&&m({offset:E,rect:N})}},[n,o,d,b==null?void 0:b.offset,b==null?void 0:b.rect.left,b==null?void 0:b.rect.width]);Zm(function(){v()},[v]);var k=S.useCallback(function(){typeof u.current=="function"&&(u.current(),u.current=null),n&&l.current&&(u.current=ND(n,l.current,v,{elementResize:"ResizeObserver"in window}))},[n,v]);Zm(function(){k()},[k]);var x=S.useCallback(function(N){l.current=N,k()},[k]);if(!t&&o!=="fixed"||!b)return null;var C=Pe("div",le({ref:x},ti(Me(Me({},e),{},{offset:b.offset,position:o,rect:b.rect}),"menuPortal",{"menu-portal":!0}),s),r);return Pe(FN.Provider,{value:p},t?wn.createPortal(C,t):C)},iF=function(e){var t=e.isDisabled,r=e.isRtl;return{label:"container",direction:r?"rtl":void 0,pointerEvents:t?"none":void 0,position:"relative"}},rF=function(e){var t=e.children,r=e.innerProps,n=e.isDisabled,s=e.isRtl;return Pe("div",le({},ti(e,"container",{"--is-disabled":n,"--is-rtl":s}),r),t)},nF=function(e,t){var r=e.theme.spacing,n=e.isMulti,s=e.hasValue,a=e.selectProps.controlShouldRenderValue;return Me({alignItems:"center",display:n&&s&&a?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},t?{}:{padding:"".concat(r.baseUnit/2,"px ").concat(r.baseUnit*2,"px")})},sF=function(e){var t=e.children,r=e.innerProps,n=e.isMulti,s=e.hasValue;return Pe("div",le({},ti(e,"valueContainer",{"value-container":!0,"value-container--is-multi":n,"value-container--has-value":s}),r),t)},aF=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},oF=function(e){var t=e.children,r=e.innerProps;return Pe("div",le({},ti(e,"indicatorsContainer",{indicators:!0}),r),t)},hw,lF=["size"],uF=["innerProps","isRtl","size"],cF={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},VN=function(e){var t=e.size,r=_s(e,lF);return Pe("svg",le({height:t,width:t,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:cF},r))},s1=function(e){return Pe(VN,le({size:20},e),Pe("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},HN=function(e){return Pe(VN,le({size:20},e),Pe("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},zN=function(e,t){var r=e.isFocused,n=e.theme,s=n.spacing.baseUnit,a=n.colors;return Me({label:"indicatorContainer",display:"flex",transition:"color 150ms"},t?{}:{color:r?a.neutral60:a.neutral20,padding:s*2,":hover":{color:r?a.neutral80:a.neutral40}})},hF=zN,dF=function(e){var t=e.children,r=e.innerProps;return Pe("div",le({},ti(e,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),r),t||Pe(HN,null))},fF=zN,pF=function(e){var t=e.children,r=e.innerProps;return Pe("div",le({},ti(e,"clearIndicator",{indicator:!0,"clear-indicator":!0}),r),t||Pe(s1,null))},gF=function(e,t){var r=e.isDisabled,n=e.theme,s=n.spacing.baseUnit,a=n.colors;return Me({label:"indicatorSeparator",alignSelf:"stretch",width:1},t?{}:{backgroundColor:r?a.neutral10:a.neutral20,marginBottom:s*2,marginTop:s*2})},mF=function(e){var t=e.innerProps;return Pe("span",le({},t,ti(e,"indicatorSeparator",{"indicator-separator":!0})))},yF=e5(hw||(hw=dD([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),bF=function(e,t){var r=e.isFocused,n=e.size,s=e.theme,a=s.colors,o=s.spacing.baseUnit;return Me({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:n,lineHeight:1,marginRight:n,textAlign:"center",verticalAlign:"middle"},t?{}:{color:r?a.neutral60:a.neutral20,padding:o*2})},ig=function(e){var t=e.delay,r=e.offset;return Pe("span",{css:Df({animation:"".concat(yF," 1s ease-in-out ").concat(t,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:r?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},vF=function(e){var t=e.innerProps,r=e.isRtl,n=e.size,s=n===void 0?4:n,a=_s(e,uF);return Pe("div",le({},ti(Me(Me({},a),{},{innerProps:t,isRtl:r,size:s}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),t),Pe(ig,{delay:0,offset:r}),Pe(ig,{delay:160,offset:!0}),Pe(ig,{delay:320,offset:!r}))},wF=function(e,t){var r=e.isDisabled,n=e.isFocused,s=e.theme,a=s.colors,o=s.borderRadius,l=s.spacing;return Me({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:l.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},t?{}:{backgroundColor:r?a.neutral5:a.neutral0,borderColor:r?a.neutral10:n?a.primary:a.neutral20,borderRadius:o,borderStyle:"solid",borderWidth:1,boxShadow:n?"0 0 0 1px ".concat(a.primary):void 0,"&:hover":{borderColor:n?a.primary:a.neutral30}})},SF=function(e){var t=e.children,r=e.isDisabled,n=e.isFocused,s=e.innerRef,a=e.innerProps,o=e.menuIsOpen;return Pe("div",le({ref:s},ti(e,"control",{control:!0,"control--is-disabled":r,"control--is-focused":n,"control--menu-is-open":o}),a,{"aria-disabled":r||void 0}),t)},xF=SF,kF=["data"],TF=function(e,t){var r=e.theme.spacing;return t?{}:{paddingBottom:r.baseUnit*2,paddingTop:r.baseUnit*2}},CF=function(e){var t=e.children,r=e.cx,n=e.getStyles,s=e.getClassNames,a=e.Heading,o=e.headingProps,l=e.innerProps,u=e.label,c=e.theme,h=e.selectProps;return Pe("div",le({},ti(e,"group",{group:!0}),l),Pe(a,le({},o,{selectProps:h,theme:c,getStyles:n,getClassNames:s,cx:r}),u),Pe("div",null,t))},NF=function(e,t){var r=e.theme,n=r.colors,s=r.spacing;return Me({label:"group",cursor:"default",display:"block"},t?{}:{color:n.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:s.baseUnit*3,paddingRight:s.baseUnit*3,textTransform:"uppercase"})},BF=function(e){var t=ON(e);t.data;var r=_s(t,kF);return Pe("div",le({},ti(e,"groupHeading",{"group-heading":!0}),r))},_F=CF,PF=["innerRef","isDisabled","isHidden","inputClassName"],RF=function(e,t){var r=e.isDisabled,n=e.value,s=e.theme,a=s.spacing,o=s.colors;return Me(Me({visibility:r?"hidden":"visible",transform:n?"translateZ(0)":""},EF),t?{}:{margin:a.baseUnit/2,paddingBottom:a.baseUnit/2,paddingTop:a.baseUnit/2,color:o.neutral80})},UN={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},EF={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":Me({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},UN)},MF=function(e){return Me({label:"input",color:"inherit",background:0,opacity:e?0:1,width:"100%"},UN)},OF=function(e){var t=e.cx,r=e.value,n=ON(e),s=n.innerRef,a=n.isDisabled,o=n.isHidden,l=n.inputClassName,u=_s(n,PF);return Pe("div",le({},ti(e,"input",{"input-container":!0}),{"data-value":r||""}),Pe("input",le({className:t({input:!0},l),ref:s,style:MF(o),disabled:a},u)))},IF=OF,LF=function(e,t){var r=e.theme,n=r.spacing,s=r.borderRadius,a=r.colors;return Me({label:"multiValue",display:"flex",minWidth:0},t?{}:{backgroundColor:a.neutral10,borderRadius:s/2,margin:n.baseUnit/2})},DF=function(e,t){var r=e.theme,n=r.borderRadius,s=r.colors,a=e.cropWithEllipsis;return Me({overflow:"hidden",textOverflow:a||a===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},t?{}:{borderRadius:n/2,color:s.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},FF=function(e,t){var r=e.theme,n=r.spacing,s=r.borderRadius,a=r.colors,o=e.isFocused;return Me({alignItems:"center",display:"flex"},t?{}:{borderRadius:s/2,backgroundColor:o?a.dangerLight:void 0,paddingLeft:n.baseUnit,paddingRight:n.baseUnit,":hover":{backgroundColor:a.dangerLight,color:a.danger}})},WN=function(e){var t=e.children,r=e.innerProps;return Pe("div",r,t)},AF=WN,VF=WN;function HF(i){var e=i.children,t=i.innerProps;return Pe("div",le({role:"button"},t),e||Pe(s1,{size:14}))}var zF=function(e){var t=e.children,r=e.components,n=e.data,s=e.innerProps,a=e.isDisabled,o=e.removeProps,l=e.selectProps,u=r.Container,c=r.Label,h=r.Remove;return Pe(u,{data:n,innerProps:Me(Me({},ti(e,"multiValue",{"multi-value":!0,"multi-value--is-disabled":a})),s),selectProps:l},Pe(c,{data:n,innerProps:Me({},ti(e,"multiValueLabel",{"multi-value__label":!0})),selectProps:l},t),Pe(h,{data:n,innerProps:Me(Me({},ti(e,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(t||"option")},o),selectProps:l}))},UF=zF,WF=function(e,t){var r=e.isDisabled,n=e.isFocused,s=e.isSelected,a=e.theme,o=a.spacing,l=a.colors;return Me({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},t?{}:{backgroundColor:s?l.primary:n?l.primary25:"transparent",color:r?l.neutral20:s?l.neutral0:"inherit",padding:"".concat(o.baseUnit*2,"px ").concat(o.baseUnit*3,"px"),":active":{backgroundColor:r?void 0:s?l.primary:l.primary50}})},GF=function(e){var t=e.children,r=e.isDisabled,n=e.isFocused,s=e.isSelected,a=e.innerRef,o=e.innerProps;return Pe("div",le({},ti(e,"option",{option:!0,"option--is-disabled":r,"option--is-focused":n,"option--is-selected":s}),{ref:a,"aria-disabled":r},o),t)},$F=GF,jF=function(e,t){var r=e.theme,n=r.spacing,s=r.colors;return Me({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},t?{}:{color:s.neutral50,marginLeft:n.baseUnit/2,marginRight:n.baseUnit/2})},YF=function(e){var t=e.children,r=e.innerProps;return Pe("div",le({},ti(e,"placeholder",{placeholder:!0}),r),t)},XF=YF,KF=function(e,t){var r=e.isDisabled,n=e.theme,s=n.spacing,a=n.colors;return Me({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},t?{}:{color:r?a.neutral40:a.neutral80,marginLeft:s.baseUnit/2,marginRight:s.baseUnit/2})},qF=function(e){var t=e.children,r=e.isDisabled,n=e.innerProps;return Pe("div",le({},ti(e,"singleValue",{"single-value":!0,"single-value--is-disabled":r}),n),t)},JF=qF,QF={ClearIndicator:pF,Control:xF,DropdownIndicator:dF,DownChevron:HN,CrossIcon:s1,Group:_F,GroupHeading:BF,IndicatorsContainer:oF,IndicatorSeparator:mF,Input:IF,LoadingIndicator:vF,Menu:YD,MenuList:KD,MenuPortal:tF,LoadingMessage:ZD,NoOptionsMessage:QD,MultiValue:UF,MultiValueContainer:AF,MultiValueLabel:VF,MultiValueRemove:HF,Option:$F,Placeholder:XF,SelectContainer:rF,SingleValue:JF,ValueContainer:sF},ZF=function(e){return Me(Me({},QF),e.components)},dw=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function eA(i,e){return!!(i===e||dw(i)&&dw(e))}function tA(i,e){if(i.length!==e.length)return!1;for(var t=0;t<i.length;t++)if(!eA(i[t],e[t]))return!1;return!0}function iA(i,e){e===void 0&&(e=tA);var t=null;function r(){for(var n=[],s=0;s<arguments.length;s++)n[s]=arguments[s];if(t&&t.lastThis===this&&e(n,t.lastArgs))return t.lastResult;var a=i.apply(this,n);return t={lastResult:a,lastArgs:n,lastThis:this},a}return r.clear=function(){t=null},r}var rA={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},nA=function(e){return Pe("span",le({css:rA},e))},fw=nA,sA={guidance:function(e){var t=e.isSearchable,r=e.isMulti,n=e.tabSelectsValue,s=e.context,a=e.isInitialFocus;switch(s){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(n?", press Tab to select the option and exit the menu":"",".");case"input":return a?"".concat(e["aria-label"]||"Select"," is focused ").concat(t?",type to refine list":"",", press Down to open the menu, ").concat(r?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(e){var t=e.action,r=e.label,n=r===void 0?"":r,s=e.labels,a=e.isDisabled;switch(t){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(n,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(s.length>1?"s":""," ").concat(s.join(","),", selected.");case"select-option":return a?"option ".concat(n," is disabled. Select another option."):"option ".concat(n,", selected.");default:return""}},onFocus:function(e){var t=e.context,r=e.focused,n=e.options,s=e.label,a=s===void 0?"":s,o=e.selectValue,l=e.isDisabled,u=e.isSelected,c=e.isAppleDevice,h=function(g,y){return g&&g.length?"".concat(g.indexOf(y)+1," of ").concat(g.length):""};if(t==="value"&&o)return"value ".concat(a," focused, ").concat(h(o,r),".");if(t==="menu"&&c){var d=l?" disabled":"",f="".concat(u?" selected":"").concat(d);return"".concat(a).concat(f,", ").concat(h(n,r),".")}return""},onFilter:function(e){var t=e.inputValue,r=e.resultsMessage;return"".concat(r).concat(t?" for search term "+t:"",".")}},aA=function(e){var t=e.ariaSelection,r=e.focusedOption,n=e.focusedValue,s=e.focusableOptions,a=e.isFocused,o=e.selectValue,l=e.selectProps,u=e.id,c=e.isAppleDevice,h=l.ariaLiveMessages,d=l.getOptionLabel,f=l.inputValue,p=l.isMulti,g=l.isOptionDisabled,y=l.isSearchable,b=l.menuIsOpen,m=l.options,v=l.screenReaderStatus,k=l.tabSelectsValue,x=l.isLoading,C=l["aria-label"],N=l["aria-live"],B=S.useMemo(function(){return Me(Me({},sA),h||{})},[h]),E=S.useMemo(function(){var ye="";if(t&&B.onChange){var se=t.option,K=t.options,U=t.removedValue,Z=t.removedValues,re=t.value,ge=function(Xe){return Array.isArray(Xe)?null:Xe},G=U||se||ge(re),q=G?d(G):"",ie=K||Z||void 0,ae=ie?ie.map(d):[],Re=Me({isDisabled:G&&g(G,o),label:q,labels:ae},t);ye=B.onChange(Re)}return ye},[t,B,g,o,d]),O=S.useMemo(function(){var ye="",se=r||n,K=!!(r&&o&&o.includes(r));if(se&&B.onFocus){var U={focused:se,label:d(se),isDisabled:g(se,o),isSelected:K,options:s,context:se===r?"menu":"value",selectValue:o,isAppleDevice:c};ye=B.onFocus(U)}return ye},[r,n,d,g,B,s,o,c]),z=S.useMemo(function(){var ye="";if(b&&m.length&&!x&&B.onFilter){var se=v({count:s.length});ye=B.onFilter({inputValue:f,resultsMessage:se})}return ye},[s,f,b,B,m,v,x]),J=(t==null?void 0:t.action)==="initial-input-focus",he=S.useMemo(function(){var ye="";if(B.guidance){var se=n?"value":b?"menu":"input";ye=B.guidance({"aria-label":C,context:se,isDisabled:r&&g(r,o),isMulti:p,isSearchable:y,tabSelectsValue:k,isInitialFocus:J})}return ye},[C,r,n,p,g,y,b,B,o,k,J]),oe=Pe(S.Fragment,null,Pe("span",{id:"aria-selection"},E),Pe("span",{id:"aria-focused"},O),Pe("span",{id:"aria-results"},z),Pe("span",{id:"aria-guidance"},he));return Pe(S.Fragment,null,Pe(fw,{id:u},J&&oe),Pe(fw,{"aria-live":N,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},a&&!J&&oe))},oA=aA,e0=[{base:"A",letters:"AⒶＡÀÁÂẦẤẪẨÃĀĂẰẮẴẲȦǠÄǞẢÅǺǍȀȂẠẬẶḀĄȺⱯ"},{base:"AA",letters:"Ꜳ"},{base:"AE",letters:"ÆǼǢ"},{base:"AO",letters:"Ꜵ"},{base:"AU",letters:"Ꜷ"},{base:"AV",letters:"ꜸꜺ"},{base:"AY",letters:"Ꜽ"},{base:"B",letters:"BⒷＢḂḄḆɃƂƁ"},{base:"C",letters:"CⒸＣĆĈĊČÇḈƇȻꜾ"},{base:"D",letters:"DⒹＤḊĎḌḐḒḎĐƋƊƉꝹ"},{base:"DZ",letters:"ǱǄ"},{base:"Dz",letters:"ǲǅ"},{base:"E",letters:"EⒺＥÈÉÊỀẾỄỂẼĒḔḖĔĖËẺĚȄȆẸỆȨḜĘḘḚƐƎ"},{base:"F",letters:"FⒻＦḞƑꝻ"},{base:"G",letters:"GⒼＧǴĜḠĞĠǦĢǤƓꞠꝽꝾ"},{base:"H",letters:"HⒽＨĤḢḦȞḤḨḪĦⱧⱵꞍ"},{base:"I",letters:"IⒾＩÌÍÎĨĪĬİÏḮỈǏȈȊỊĮḬƗ"},{base:"J",letters:"JⒿＪĴɈ"},{base:"K",letters:"KⓀＫḰǨḲĶḴƘⱩꝀꝂꝄꞢ"},{base:"L",letters:"LⓁＬĿĹĽḶḸĻḼḺŁȽⱢⱠꝈꝆꞀ"},{base:"LJ",letters:"Ǉ"},{base:"Lj",letters:"ǈ"},{base:"M",letters:"MⓂＭḾṀṂⱮƜ"},{base:"N",letters:"NⓃＮǸŃÑṄŇṆŅṊṈȠƝꞐꞤ"},{base:"NJ",letters:"Ǌ"},{base:"Nj",letters:"ǋ"},{base:"O",letters:"OⓄＯÒÓÔỒỐỖỔÕṌȬṎŌṐṒŎȮȰÖȪỎŐǑȌȎƠỜỚỠỞỢỌỘǪǬØǾƆƟꝊꝌ"},{base:"OI",letters:"Ƣ"},{base:"OO",letters:"Ꝏ"},{base:"OU",letters:"Ȣ"},{base:"P",letters:"PⓅＰṔṖƤⱣꝐꝒꝔ"},{base:"Q",letters:"QⓆＱꝖꝘɊ"},{base:"R",letters:"RⓇＲŔṘŘȐȒṚṜŖṞɌⱤꝚꞦꞂ"},{base:"S",letters:"SⓈＳẞŚṤŜṠŠṦṢṨȘŞⱾꞨꞄ"},{base:"T",letters:"TⓉＴṪŤṬȚŢṰṮŦƬƮȾꞆ"},{base:"TZ",letters:"Ꜩ"},{base:"U",letters:"UⓊＵÙÚÛŨṸŪṺŬÜǛǗǕǙỦŮŰǓȔȖƯỪỨỮỬỰỤṲŲṶṴɄ"},{base:"V",letters:"VⓋＶṼṾƲꝞɅ"},{base:"VY",letters:"Ꝡ"},{base:"W",letters:"WⓌＷẀẂŴẆẄẈⱲ"},{base:"X",letters:"XⓍＸẊẌ"},{base:"Y",letters:"YⓎＹỲÝŶỸȲẎŸỶỴƳɎỾ"},{base:"Z",letters:"ZⓏＺŹẐŻŽẒẔƵȤⱿⱫꝢ"},{base:"a",letters:"aⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐ"},{base:"aa",letters:"ꜳ"},{base:"ae",letters:"æǽǣ"},{base:"ao",letters:"ꜵ"},{base:"au",letters:"ꜷ"},{base:"av",letters:"ꜹꜻ"},{base:"ay",letters:"ꜽ"},{base:"b",letters:"bⓑｂḃḅḇƀƃɓ"},{base:"c",letters:"cⓒｃćĉċčçḉƈȼꜿↄ"},{base:"d",letters:"dⓓｄḋďḍḑḓḏđƌɖɗꝺ"},{base:"dz",letters:"ǳǆ"},{base:"e",letters:"eⓔｅèéêềếễểẽēḕḗĕėëẻěȅȇẹệȩḝęḙḛɇɛǝ"},{base:"f",letters:"fⓕｆḟƒꝼ"},{base:"g",letters:"gⓖｇǵĝḡğġǧģǥɠꞡᵹꝿ"},{base:"h",letters:"hⓗｈĥḣḧȟḥḩḫẖħⱨⱶɥ"},{base:"hv",letters:"ƕ"},{base:"i",letters:"iⓘｉìíîĩīĭïḯỉǐȉȋịįḭɨı"},{base:"j",letters:"jⓙｊĵǰɉ"},{base:"k",letters:"kⓚｋḱǩḳķḵƙⱪꝁꝃꝅꞣ"},{base:"l",letters:"lⓛｌŀĺľḷḹļḽḻſłƚɫⱡꝉꞁꝇ"},{base:"lj",letters:"ǉ"},{base:"m",letters:"mⓜｍḿṁṃɱɯ"},{base:"n",letters:"nⓝｎǹńñṅňṇņṋṉƞɲŉꞑꞥ"},{base:"nj",letters:"ǌ"},{base:"o",letters:"oⓞｏòóôồốỗổõṍȭṏōṑṓŏȯȱöȫỏőǒȍȏơờớỡởợọộǫǭøǿɔꝋꝍɵ"},{base:"oi",letters:"ƣ"},{base:"ou",letters:"ȣ"},{base:"oo",letters:"ꝏ"},{base:"p",letters:"pⓟｐṕṗƥᵽꝑꝓꝕ"},{base:"q",letters:"qⓠｑɋꝗꝙ"},{base:"r",letters:"rⓡｒŕṙřȑȓṛṝŗṟɍɽꝛꞧꞃ"},{base:"s",letters:"sⓢｓßśṥŝṡšṧṣṩșşȿꞩꞅẛ"},{base:"t",letters:"tⓣｔṫẗťṭțţṱṯŧƭʈⱦꞇ"},{base:"tz",letters:"ꜩ"},{base:"u",letters:"uⓤｕùúûũṹūṻŭüǜǘǖǚủůűǔȕȗưừứữửựụṳųṷṵʉ"},{base:"v",letters:"vⓥｖṽṿʋꝟʌ"},{base:"vy",letters:"ꝡ"},{base:"w",letters:"wⓦｗẁẃŵẇẅẘẉⱳ"},{base:"x",letters:"xⓧｘẋẍ"},{base:"y",letters:"yⓨｙỳýŷỹȳẏÿỷẙỵƴɏỿ"},{base:"z",letters:"zⓩｚźẑżžẓẕƶȥɀⱬꝣ"}],lA=new RegExp("["+e0.map(function(i){return i.letters}).join("")+"]","g"),GN={};for(var rg=0;rg<e0.length;rg++)for(var ng=e0[rg],sg=0;sg<ng.letters.length;sg++)GN[ng.letters[sg]]=ng.base;var $N=function(e){return e.replace(lA,function(t){return GN[t]})},uA=iA($N),pw=function(e){return e.replace(/^\s+|\s+$/g,"")},cA=function(e){return"".concat(e.label," ").concat(e.value)},hA=function(e){return function(t,r){if(t.data.__isNew__)return!0;var n=Me({ignoreCase:!0,ignoreAccents:!0,stringify:cA,trim:!0,matchFrom:"any"},e),s=n.ignoreCase,a=n.ignoreAccents,o=n.stringify,l=n.trim,u=n.matchFrom,c=l?pw(r):r,h=l?pw(o(t)):o(t);return s&&(c=c.toLowerCase(),h=h.toLowerCase()),a&&(c=uA(c),h=$N(h)),u==="start"?h.substr(0,c.length)===c:h.indexOf(c)>-1}},dA=["innerRef"];function fA(i){var e=i.innerRef,t=_s(i,dA),r=VD(t,"onExited","in","enter","exit","appear");return Pe("input",le({ref:e},r,{css:Df({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var pA=function(e){e.cancelable&&e.preventDefault(),e.stopPropagation()};function gA(i){var e=i.isEnabled,t=i.onBottomArrive,r=i.onBottomLeave,n=i.onTopArrive,s=i.onTopLeave,a=S.useRef(!1),o=S.useRef(!1),l=S.useRef(0),u=S.useRef(null),c=S.useCallback(function(y,b){if(u.current!==null){var m=u.current,v=m.scrollTop,k=m.scrollHeight,x=m.clientHeight,C=u.current,N=b>0,B=k-x-v,E=!1;B>b&&a.current&&(r&&r(y),a.current=!1),N&&o.current&&(s&&s(y),o.current=!1),N&&b>B?(t&&!a.current&&t(y),C.scrollTop=k,E=!0,a.current=!0):!N&&-b>v&&(n&&!o.current&&n(y),C.scrollTop=0,E=!0,o.current=!0),E&&pA(y)}},[t,r,n,s]),h=S.useCallback(function(y){c(y,y.deltaY)},[c]),d=S.useCallback(function(y){l.current=y.changedTouches[0].clientY},[]),f=S.useCallback(function(y){var b=l.current-y.changedTouches[0].clientY;c(y,b)},[c]),p=S.useCallback(function(y){if(y){var b=DD?{passive:!1}:!1;y.addEventListener("wheel",h,b),y.addEventListener("touchstart",d,b),y.addEventListener("touchmove",f,b)}},[f,d,h]),g=S.useCallback(function(y){y&&(y.removeEventListener("wheel",h,!1),y.removeEventListener("touchstart",d,!1),y.removeEventListener("touchmove",f,!1))},[f,d,h]);return S.useEffect(function(){if(e){var y=u.current;return p(y),function(){g(y)}}},[e,p,g]),function(y){u.current=y}}var gw=["boxSizing","height","overflow","paddingRight","position"],mw={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function yw(i){i.preventDefault()}function bw(i){i.stopPropagation()}function vw(){var i=this.scrollTop,e=this.scrollHeight,t=i+this.offsetHeight;i===0?this.scrollTop=1:t===e&&(this.scrollTop=i-1)}function ww(){return"ontouchstart"in window||navigator.maxTouchPoints}var Sw=!!(typeof window<"u"&&window.document&&window.document.createElement),Ml=0,lo={capture:!1,passive:!1};function mA(i){var e=i.isEnabled,t=i.accountForScrollbars,r=t===void 0?!0:t,n=S.useRef({}),s=S.useRef(null),a=S.useCallback(function(l){if(Sw){var u=document.body,c=u&&u.style;if(r&&gw.forEach(function(p){var g=c&&c[p];n.current[p]=g}),r&&Ml<1){var h=parseInt(n.current.paddingRight,10)||0,d=document.body?document.body.clientWidth:0,f=window.innerWidth-d+h||0;Object.keys(mw).forEach(function(p){var g=mw[p];c&&(c[p]=g)}),c&&(c.paddingRight="".concat(f,"px"))}u&&ww()&&(u.addEventListener("touchmove",yw,lo),l&&(l.addEventListener("touchstart",vw,lo),l.addEventListener("touchmove",bw,lo))),Ml+=1}},[r]),o=S.useCallback(function(l){if(Sw){var u=document.body,c=u&&u.style;Ml=Math.max(Ml-1,0),r&&Ml<1&&gw.forEach(function(h){var d=n.current[h];c&&(c[h]=d)}),u&&ww()&&(u.removeEventListener("touchmove",yw,lo),l&&(l.removeEventListener("touchstart",vw,lo),l.removeEventListener("touchmove",bw,lo)))}},[r]);return S.useEffect(function(){if(e){var l=s.current;return a(l),function(){o(l)}}},[e,a,o]),function(l){s.current=l}}var yA=function(e){var t=e.target;return t.ownerDocument.activeElement&&t.ownerDocument.activeElement.blur()},bA={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function vA(i){var e=i.children,t=i.lockEnabled,r=i.captureEnabled,n=r===void 0?!0:r,s=i.onBottomArrive,a=i.onBottomLeave,o=i.onTopArrive,l=i.onTopLeave,u=gA({isEnabled:n,onBottomArrive:s,onBottomLeave:a,onTopArrive:o,onTopLeave:l}),c=mA({isEnabled:t}),h=function(f){u(f),c(f)};return Pe(S.Fragment,null,t&&Pe("div",{onClick:yA,css:bA}),e(h))}var wA={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},SA=function(e){var t=e.name,r=e.onFocus;return Pe("input",{required:!0,name:t,tabIndex:-1,"aria-hidden":"true",onFocus:r,css:wA,value:"",onChange:function(){}})},xA=SA;function a1(i){var e;return typeof window<"u"&&window.navigator!=null?i.test(((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.platform)||window.navigator.platform):!1}function kA(){return a1(/^iPhone/i)}function jN(){return a1(/^Mac/i)}function TA(){return a1(/^iPad/i)||jN()&&navigator.maxTouchPoints>1}function CA(){return kA()||TA()}function NA(){return jN()||CA()}var BA=function(e){return e.label},_A=function(e){return e.label},PA=function(e){return e.value},RA=function(e){return!!e.isDisabled},EA={clearIndicator:fF,container:iF,control:wF,dropdownIndicator:hF,group:TF,groupHeading:NF,indicatorsContainer:aF,indicatorSeparator:gF,input:RF,loadingIndicator:bF,loadingMessage:JD,menu:GD,menuList:XD,menuPortal:eF,multiValue:LF,multiValueLabel:DF,multiValueRemove:FF,noOptionsMessage:qD,option:WF,placeholder:jF,singleValue:KF,valueContainer:nF},MA={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},OA=4,YN=4,IA=38,LA=YN*2,DA={baseUnit:YN,controlHeight:IA,menuGutter:LA},ag={borderRadius:OA,colors:MA,spacing:DA},FA={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:cw(),captureMenuScroll:!cw(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:hA(),formatGroupLabel:BA,getOptionLabel:_A,getOptionValue:PA,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:RA,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!ID(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(e){var t=e.count;return"".concat(t," result").concat(t!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function xw(i,e,t,r){var n=qN(i,e,t),s=JN(i,e,t),a=KN(i,e),o=_d(i,e);return{type:"option",data:e,isDisabled:n,isSelected:s,label:a,value:o,index:r}}function Lh(i,e){return i.options.map(function(t,r){if("options"in t){var n=t.options.map(function(a,o){return xw(i,a,e,o)}).filter(function(a){return Tw(i,a)});return n.length>0?{type:"group",data:t,options:n,index:r}:void 0}var s=xw(i,t,e,r);return Tw(i,s)?s:void 0}).filter(FD)}function XN(i){return i.reduce(function(e,t){return t.type==="group"?e.push.apply(e,t1(t.options.map(function(r){return r.data}))):e.push(t.data),e},[])}function kw(i,e){return i.reduce(function(t,r){return r.type==="group"?t.push.apply(t,t1(r.options.map(function(n){return{data:n.data,id:"".concat(e,"-").concat(r.index,"-").concat(n.index)}}))):t.push({data:r.data,id:"".concat(e,"-").concat(r.index)}),t},[])}function AA(i,e){return XN(Lh(i,e))}function Tw(i,e){var t=i.inputValue,r=t===void 0?"":t,n=e.data,s=e.isSelected,a=e.label,o=e.value;return(!ZN(i)||!s)&&QN(i,{label:a,value:o,data:n},r)}function VA(i,e){var t=i.focusedValue,r=i.selectValue,n=r.indexOf(t);if(n>-1){var s=e.indexOf(t);if(s>-1)return t;if(n<e.length)return e[n]}return null}function HA(i,e){var t=i.focusedOption;return t&&e.indexOf(t)>-1?t:e[0]}var og=function(e,t){var r,n=(r=e.find(function(s){return s.data===t}))===null||r===void 0?void 0:r.id;return n||null},KN=function(e,t){return e.getOptionLabel(t)},_d=function(e,t){return e.getOptionValue(t)};function qN(i,e,t){return typeof i.isOptionDisabled=="function"?i.isOptionDisabled(e,t):!1}function JN(i,e,t){if(t.indexOf(e)>-1)return!0;if(typeof i.isOptionSelected=="function")return i.isOptionSelected(e,t);var r=_d(i,e);return t.some(function(n){return _d(i,n)===r})}function QN(i,e,t){return i.filterOption?i.filterOption(e,t):!0}var ZN=function(e){var t=e.hideSelectedOptions,r=e.isMulti;return t===void 0?r:t},zA=1,e2=function(i){sD(t,i);var e=lD(t);function t(r){var n;if(rD(this,t),n=e.call(this,r),n.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:""},n.blockOptionHover=!1,n.isComposing=!1,n.commonProps=void 0,n.initialTouchX=0,n.initialTouchY=0,n.openAfterFocus=!1,n.scrollToFocusedOptionOnUpdate=!1,n.userIsDragging=void 0,n.isAppleDevice=NA(),n.controlRef=null,n.getControlRef=function(l){n.controlRef=l},n.focusedOptionRef=null,n.getFocusedOptionRef=function(l){n.focusedOptionRef=l},n.menuListRef=null,n.getMenuListRef=function(l){n.menuListRef=l},n.inputRef=null,n.getInputRef=function(l){n.inputRef=l},n.focus=n.focusInput,n.blur=n.blurInput,n.onChange=function(l,u){var c=n.props,h=c.onChange,d=c.name;u.name=d,n.ariaOnChange(l,u),h(l,u)},n.setValue=function(l,u,c){var h=n.props,d=h.closeMenuOnSelect,f=h.isMulti,p=h.inputValue;n.onInputChange("",{action:"set-value",prevInputValue:p}),d&&(n.setState({inputIsHiddenAfterUpdate:!f}),n.onMenuClose()),n.setState({clearFocusValueOnUpdate:!0}),n.onChange(l,{action:u,option:c})},n.selectOption=function(l){var u=n.props,c=u.blurInputOnSelect,h=u.isMulti,d=u.name,f=n.state.selectValue,p=h&&n.isOptionSelected(l,f),g=n.isOptionDisabled(l,f);if(p){var y=n.getOptionValue(l);n.setValue(f.filter(function(b){return n.getOptionValue(b)!==y}),"deselect-option",l)}else if(!g)h?n.setValue([].concat(t1(f),[l]),"select-option",l):n.setValue(l,"select-option");else{n.ariaOnChange(l,{action:"select-option",option:l,name:d});return}c&&n.blurInput()},n.removeValue=function(l){var u=n.props.isMulti,c=n.state.selectValue,h=n.getOptionValue(l),d=c.filter(function(p){return n.getOptionValue(p)!==h}),f=Xc(u,d,d[0]||null);n.onChange(f,{action:"remove-value",removedValue:l}),n.focusInput()},n.clearValue=function(){var l=n.state.selectValue;n.onChange(Xc(n.props.isMulti,[],null),{action:"clear",removedValues:l})},n.popValue=function(){var l=n.props.isMulti,u=n.state.selectValue,c=u[u.length-1],h=u.slice(0,u.length-1),d=Xc(l,h,h[0]||null);n.onChange(d,{action:"pop-value",removedValue:c})},n.getFocusedOptionId=function(l){return og(n.state.focusableOptionsWithIds,l)},n.getFocusableOptionsWithIds=function(){return kw(Lh(n.props,n.state.selectValue),n.getElementId("option"))},n.getValue=function(){return n.state.selectValue},n.cx=function(){for(var l=arguments.length,u=new Array(l),c=0;c<l;c++)u[c]=arguments[c];return PD.apply(void 0,[n.props.classNamePrefix].concat(u))},n.getOptionLabel=function(l){return KN(n.props,l)},n.getOptionValue=function(l){return _d(n.props,l)},n.getStyles=function(l,u){var c=n.props.unstyled,h=EA[l](u,c);h.boxSizing="border-box";var d=n.props.styles[l];return d?d(h,u):h},n.getClassNames=function(l,u){var c,h;return(c=(h=n.props.classNames)[l])===null||c===void 0?void 0:c.call(h,u)},n.getElementId=function(l){return"".concat(n.state.instancePrefix,"-").concat(l)},n.getComponents=function(){return ZF(n.props)},n.buildCategorizedOptions=function(){return Lh(n.props,n.state.selectValue)},n.getCategorizedOptions=function(){return n.props.menuIsOpen?n.buildCategorizedOptions():[]},n.buildFocusableOptions=function(){return XN(n.buildCategorizedOptions())},n.getFocusableOptions=function(){return n.props.menuIsOpen?n.buildFocusableOptions():[]},n.ariaOnChange=function(l,u){n.setState({ariaSelection:Me({value:l},u)})},n.onMenuMouseDown=function(l){l.button===0&&(l.stopPropagation(),l.preventDefault(),n.focusInput())},n.onMenuMouseMove=function(l){n.blockOptionHover=!1},n.onControlMouseDown=function(l){if(!l.defaultPrevented){var u=n.props.openMenuOnClick;n.state.isFocused?n.props.menuIsOpen?l.target.tagName!=="INPUT"&&l.target.tagName!=="TEXTAREA"&&n.onMenuClose():u&&n.openMenu("first"):(u&&(n.openAfterFocus=!0),n.focusInput()),l.target.tagName!=="INPUT"&&l.target.tagName!=="TEXTAREA"&&l.preventDefault()}},n.onDropdownIndicatorMouseDown=function(l){if(!(l&&l.type==="mousedown"&&l.button!==0)&&!n.props.isDisabled){var u=n.props,c=u.isMulti,h=u.menuIsOpen;n.focusInput(),h?(n.setState({inputIsHiddenAfterUpdate:!c}),n.onMenuClose()):n.openMenu("first"),l.preventDefault()}},n.onClearIndicatorMouseDown=function(l){l&&l.type==="mousedown"&&l.button!==0||(n.clearValue(),l.preventDefault(),n.openAfterFocus=!1,l.type==="touchend"?n.focusInput():setTimeout(function(){return n.focusInput()}))},n.onScroll=function(l){typeof n.props.closeMenuOnScroll=="boolean"?l.target instanceof HTMLElement&&Hf(l.target)&&n.props.onMenuClose():typeof n.props.closeMenuOnScroll=="function"&&n.props.closeMenuOnScroll(l)&&n.props.onMenuClose()},n.onCompositionStart=function(){n.isComposing=!0},n.onCompositionEnd=function(){n.isComposing=!1},n.onTouchStart=function(l){var u=l.touches,c=u&&u.item(0);c&&(n.initialTouchX=c.clientX,n.initialTouchY=c.clientY,n.userIsDragging=!1)},n.onTouchMove=function(l){var u=l.touches,c=u&&u.item(0);if(c){var h=Math.abs(c.clientX-n.initialTouchX),d=Math.abs(c.clientY-n.initialTouchY),f=5;n.userIsDragging=h>f||d>f}},n.onTouchEnd=function(l){n.userIsDragging||(n.controlRef&&!n.controlRef.contains(l.target)&&n.menuListRef&&!n.menuListRef.contains(l.target)&&n.blurInput(),n.initialTouchX=0,n.initialTouchY=0)},n.onControlTouchEnd=function(l){n.userIsDragging||n.onControlMouseDown(l)},n.onClearIndicatorTouchEnd=function(l){n.userIsDragging||n.onClearIndicatorMouseDown(l)},n.onDropdownIndicatorTouchEnd=function(l){n.userIsDragging||n.onDropdownIndicatorMouseDown(l)},n.handleInputChange=function(l){var u=n.props.inputValue,c=l.currentTarget.value;n.setState({inputIsHiddenAfterUpdate:!1}),n.onInputChange(c,{action:"input-change",prevInputValue:u}),n.props.menuIsOpen||n.onMenuOpen()},n.onInputFocus=function(l){n.props.onFocus&&n.props.onFocus(l),n.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(n.openAfterFocus||n.props.openMenuOnFocus)&&n.openMenu("first"),n.openAfterFocus=!1},n.onInputBlur=function(l){var u=n.props.inputValue;if(n.menuListRef&&n.menuListRef.contains(document.activeElement)){n.inputRef.focus();return}n.props.onBlur&&n.props.onBlur(l),n.onInputChange("",{action:"input-blur",prevInputValue:u}),n.onMenuClose(),n.setState({focusedValue:null,isFocused:!1})},n.onOptionHover=function(l){if(!(n.blockOptionHover||n.state.focusedOption===l)){var u=n.getFocusableOptions(),c=u.indexOf(l);n.setState({focusedOption:l,focusedOptionId:c>-1?n.getFocusedOptionId(l):null})}},n.shouldHideSelectedOptions=function(){return ZN(n.props)},n.onValueInputFocus=function(l){l.preventDefault(),l.stopPropagation(),n.focus()},n.onKeyDown=function(l){var u=n.props,c=u.isMulti,h=u.backspaceRemovesValue,d=u.escapeClearsValue,f=u.inputValue,p=u.isClearable,g=u.isDisabled,y=u.menuIsOpen,b=u.onKeyDown,m=u.tabSelectsValue,v=u.openMenuOnFocus,k=n.state,x=k.focusedOption,C=k.focusedValue,N=k.selectValue;if(!g&&!(typeof b=="function"&&(b(l),l.defaultPrevented))){switch(n.blockOptionHover=!0,l.key){case"ArrowLeft":if(!c||f)return;n.focusValue("previous");break;case"ArrowRight":if(!c||f)return;n.focusValue("next");break;case"Delete":case"Backspace":if(f)return;if(C)n.removeValue(C);else{if(!h)return;c?n.popValue():p&&n.clearValue()}break;case"Tab":if(n.isComposing||l.shiftKey||!y||!m||!x||v&&n.isOptionSelected(x,N))return;n.selectOption(x);break;case"Enter":if(l.keyCode===229)break;if(y){if(!x||n.isComposing)return;n.selectOption(x);break}return;case"Escape":y?(n.setState({inputIsHiddenAfterUpdate:!1}),n.onInputChange("",{action:"menu-close",prevInputValue:f}),n.onMenuClose()):p&&d&&n.clearValue();break;case" ":if(f)return;if(!y){n.openMenu("first");break}if(!x)return;n.selectOption(x);break;case"ArrowUp":y?n.focusOption("up"):n.openMenu("last");break;case"ArrowDown":y?n.focusOption("down"):n.openMenu("first");break;case"PageUp":if(!y)return;n.focusOption("pageup");break;case"PageDown":if(!y)return;n.focusOption("pagedown");break;case"Home":if(!y)return;n.focusOption("first");break;case"End":if(!y)return;n.focusOption("last");break;default:return}l.preventDefault()}},n.state.instancePrefix="react-select-"+(n.props.instanceId||++zA),n.state.selectValue=lw(r.value),r.menuIsOpen&&n.state.selectValue.length){var s=n.getFocusableOptionsWithIds(),a=n.buildFocusableOptions(),o=a.indexOf(n.state.selectValue[0]);n.state.focusableOptionsWithIds=s,n.state.focusedOption=a[o],n.state.focusedOptionId=og(s,a[o])}return n}return nD(t,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&uw(this.menuListRef,this.focusedOptionRef)}},{key:"componentDidUpdate",value:function(n){var s=this.props,a=s.isDisabled,o=s.menuIsOpen,l=this.state.isFocused;(l&&!a&&n.isDisabled||l&&o&&!n.menuIsOpen)&&this.focusInput(),l&&a&&!n.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!l&&!a&&n.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(uw(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(n,s){this.props.onInputChange(n,s)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(n){var s=this,a=this.state,o=a.selectValue,l=a.isFocused,u=this.buildFocusableOptions(),c=n==="first"?0:u.length-1;if(!this.props.isMulti){var h=u.indexOf(o[0]);h>-1&&(c=h)}this.scrollToFocusedOptionOnUpdate=!(l&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:u[c],focusedOptionId:this.getFocusedOptionId(u[c])},function(){return s.onMenuOpen()})}},{key:"focusValue",value:function(n){var s=this.state,a=s.selectValue,o=s.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var l=a.indexOf(o);o||(l=-1);var u=a.length-1,c=-1;if(a.length){switch(n){case"previous":l===0?c=0:l===-1?c=u:c=l-1;break;case"next":l>-1&&l<u&&(c=l+1);break}this.setState({inputIsHidden:c!==-1,focusedValue:a[c]})}}}},{key:"focusOption",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",s=this.props.pageSize,a=this.state.focusedOption,o=this.getFocusableOptions();if(o.length){var l=0,u=o.indexOf(a);a||(u=-1),n==="up"?l=u>0?u-1:o.length-1:n==="down"?l=(u+1)%o.length:n==="pageup"?(l=u-s,l<0&&(l=0)):n==="pagedown"?(l=u+s,l>o.length-1&&(l=o.length-1)):n==="last"&&(l=o.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:o[l],focusedValue:null,focusedOptionId:this.getFocusedOptionId(o[l])})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(ag):Me(Me({},ag),this.props.theme):ag}},{key:"getCommonProps",value:function(){var n=this.clearValue,s=this.cx,a=this.getStyles,o=this.getClassNames,l=this.getValue,u=this.selectOption,c=this.setValue,h=this.props,d=h.isMulti,f=h.isRtl,p=h.options,g=this.hasValue();return{clearValue:n,cx:s,getStyles:a,getClassNames:o,getValue:l,hasValue:g,isMulti:d,isRtl:f,options:p,selectOption:u,selectProps:h,setValue:c,theme:this.getTheme()}}},{key:"hasValue",value:function(){var n=this.state.selectValue;return n.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var n=this.props,s=n.isClearable,a=n.isMulti;return s===void 0?a:s}},{key:"isOptionDisabled",value:function(n,s){return qN(this.props,n,s)}},{key:"isOptionSelected",value:function(n,s){return JN(this.props,n,s)}},{key:"filterOption",value:function(n,s){return QN(this.props,n,s)}},{key:"formatOptionLabel",value:function(n,s){if(typeof this.props.formatOptionLabel=="function"){var a=this.props.inputValue,o=this.state.selectValue;return this.props.formatOptionLabel(n,{context:s,inputValue:a,selectValue:o})}else return this.getOptionLabel(n)}},{key:"formatGroupLabel",value:function(n){return this.props.formatGroupLabel(n)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var n=this.props,s=n.isDisabled,a=n.isSearchable,o=n.inputId,l=n.inputValue,u=n.tabIndex,c=n.form,h=n.menuIsOpen,d=n.required,f=this.getComponents(),p=f.Input,g=this.state,y=g.inputIsHidden,b=g.ariaSelection,m=this.commonProps,v=o||this.getElementId("input"),k=Me(Me(Me({"aria-autocomplete":"list","aria-expanded":h,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":d,role:"combobox","aria-activedescendant":this.isAppleDevice?void 0:this.state.focusedOptionId||""},h&&{"aria-controls":this.getElementId("listbox")}),!a&&{"aria-readonly":!0}),this.hasValue()?(b==null?void 0:b.action)==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return a?S.createElement(p,le({},m,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:v,innerRef:this.getInputRef,isDisabled:s,isHidden:y,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:u,form:c,type:"text",value:l},k)):S.createElement(fA,le({id:v,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:Nd,onFocus:this.onInputFocus,disabled:s,tabIndex:u,inputMode:"none",form:c,value:""},k))}},{key:"renderPlaceholderOrValue",value:function(){var n=this,s=this.getComponents(),a=s.MultiValue,o=s.MultiValueContainer,l=s.MultiValueLabel,u=s.MultiValueRemove,c=s.SingleValue,h=s.Placeholder,d=this.commonProps,f=this.props,p=f.controlShouldRenderValue,g=f.isDisabled,y=f.isMulti,b=f.inputValue,m=f.placeholder,v=this.state,k=v.selectValue,x=v.focusedValue,C=v.isFocused;if(!this.hasValue()||!p)return b?null:S.createElement(h,le({},d,{key:"placeholder",isDisabled:g,isFocused:C,innerProps:{id:this.getElementId("placeholder")}}),m);if(y)return k.map(function(B,E){var O=B===x,z="".concat(n.getOptionLabel(B),"-").concat(n.getOptionValue(B));return S.createElement(a,le({},d,{components:{Container:o,Label:l,Remove:u},isFocused:O,isDisabled:g,key:z,index:E,removeProps:{onClick:function(){return n.removeValue(B)},onTouchEnd:function(){return n.removeValue(B)},onMouseDown:function(he){he.preventDefault()}},data:B}),n.formatOptionLabel(B,"value"))});if(b)return null;var N=k[0];return S.createElement(c,le({},d,{data:N,isDisabled:g}),this.formatOptionLabel(N,"value"))}},{key:"renderClearIndicator",value:function(){var n=this.getComponents(),s=n.ClearIndicator,a=this.commonProps,o=this.props,l=o.isDisabled,u=o.isLoading,c=this.state.isFocused;if(!this.isClearable()||!s||l||!this.hasValue()||u)return null;var h={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return S.createElement(s,le({},a,{innerProps:h,isFocused:c}))}},{key:"renderLoadingIndicator",value:function(){var n=this.getComponents(),s=n.LoadingIndicator,a=this.commonProps,o=this.props,l=o.isDisabled,u=o.isLoading,c=this.state.isFocused;if(!s||!u)return null;var h={"aria-hidden":"true"};return S.createElement(s,le({},a,{innerProps:h,isDisabled:l,isFocused:c}))}},{key:"renderIndicatorSeparator",value:function(){var n=this.getComponents(),s=n.DropdownIndicator,a=n.IndicatorSeparator;if(!s||!a)return null;var o=this.commonProps,l=this.props.isDisabled,u=this.state.isFocused;return S.createElement(a,le({},o,{isDisabled:l,isFocused:u}))}},{key:"renderDropdownIndicator",value:function(){var n=this.getComponents(),s=n.DropdownIndicator;if(!s)return null;var a=this.commonProps,o=this.props.isDisabled,l=this.state.isFocused,u={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return S.createElement(s,le({},a,{innerProps:u,isDisabled:o,isFocused:l}))}},{key:"renderMenu",value:function(){var n=this,s=this.getComponents(),a=s.Group,o=s.GroupHeading,l=s.Menu,u=s.MenuList,c=s.MenuPortal,h=s.LoadingMessage,d=s.NoOptionsMessage,f=s.Option,p=this.commonProps,g=this.state.focusedOption,y=this.props,b=y.captureMenuScroll,m=y.inputValue,v=y.isLoading,k=y.loadingMessage,x=y.minMenuHeight,C=y.maxMenuHeight,N=y.menuIsOpen,B=y.menuPlacement,E=y.menuPosition,O=y.menuPortalTarget,z=y.menuShouldBlockScroll,J=y.menuShouldScrollIntoView,he=y.noOptionsMessage,oe=y.onMenuScrollToTop,ye=y.onMenuScrollToBottom;if(!N)return null;var se=function(q,ie){var ae=q.type,Re=q.data,We=q.isDisabled,Xe=q.isSelected,De=q.label,Ce=q.value,Tt=g===Re,rt=We?void 0:function(){return n.onOptionHover(Re)},Ot=We?void 0:function(){return n.selectOption(Re)},Ze="".concat(n.getElementId("option"),"-").concat(ie),Ct={id:Ze,onClick:Ot,onMouseMove:rt,onMouseOver:rt,tabIndex:-1,role:"option","aria-selected":n.isAppleDevice?void 0:Xe};return S.createElement(f,le({},p,{innerProps:Ct,data:Re,isDisabled:We,isSelected:Xe,key:Ze,label:De,type:ae,value:Ce,isFocused:Tt,innerRef:Tt?n.getFocusedOptionRef:void 0}),n.formatOptionLabel(q.data,"menu"))},K;if(this.hasOptions())K=this.getCategorizedOptions().map(function(G){if(G.type==="group"){var q=G.data,ie=G.options,ae=G.index,Re="".concat(n.getElementId("group"),"-").concat(ae),We="".concat(Re,"-heading");return S.createElement(a,le({},p,{key:Re,data:q,options:ie,Heading:o,headingProps:{id:We,data:G.data},label:n.formatGroupLabel(G.data)}),G.options.map(function(Xe){return se(Xe,"".concat(ae,"-").concat(Xe.index))}))}else if(G.type==="option")return se(G,"".concat(G.index))});else if(v){var U=k({inputValue:m});if(U===null)return null;K=S.createElement(h,p,U)}else{var Z=he({inputValue:m});if(Z===null)return null;K=S.createElement(d,p,Z)}var re={minMenuHeight:x,maxMenuHeight:C,menuPlacement:B,menuPosition:E,menuShouldScrollIntoView:J},ge=S.createElement($D,le({},p,re),function(G){var q=G.ref,ie=G.placerProps,ae=ie.placement,Re=ie.maxHeight;return S.createElement(l,le({},p,re,{innerRef:q,innerProps:{onMouseDown:n.onMenuMouseDown,onMouseMove:n.onMenuMouseMove},isLoading:v,placement:ae}),S.createElement(vA,{captureEnabled:b,onTopArrive:oe,onBottomArrive:ye,lockEnabled:z},function(We){return S.createElement(u,le({},p,{innerRef:function(De){n.getMenuListRef(De),We(De)},innerProps:{role:"listbox","aria-multiselectable":p.isMulti,id:n.getElementId("listbox")},isLoading:v,maxHeight:Re,focusedOption:g}),K)}))});return O||E==="fixed"?S.createElement(c,le({},p,{appendTo:O,controlElement:this.controlRef,menuPlacement:B,menuPosition:E}),ge):ge}},{key:"renderFormField",value:function(){var n=this,s=this.props,a=s.delimiter,o=s.isDisabled,l=s.isMulti,u=s.name,c=s.required,h=this.state.selectValue;if(c&&!this.hasValue()&&!o)return S.createElement(xA,{name:u,onFocus:this.onValueInputFocus});if(!(!u||o))if(l)if(a){var d=h.map(function(g){return n.getOptionValue(g)}).join(a);return S.createElement("input",{name:u,type:"hidden",value:d})}else{var f=h.length>0?h.map(function(g,y){return S.createElement("input",{key:"i-".concat(y),name:u,type:"hidden",value:n.getOptionValue(g)})}):S.createElement("input",{name:u,type:"hidden",value:""});return S.createElement("div",null,f)}else{var p=h[0]?this.getOptionValue(h[0]):"";return S.createElement("input",{name:u,type:"hidden",value:p})}}},{key:"renderLiveRegion",value:function(){var n=this.commonProps,s=this.state,a=s.ariaSelection,o=s.focusedOption,l=s.focusedValue,u=s.isFocused,c=s.selectValue,h=this.getFocusableOptions();return S.createElement(oA,le({},n,{id:this.getElementId("live-region"),ariaSelection:a,focusedOption:o,focusedValue:l,isFocused:u,selectValue:c,focusableOptions:h,isAppleDevice:this.isAppleDevice}))}},{key:"render",value:function(){var n=this.getComponents(),s=n.Control,a=n.IndicatorsContainer,o=n.SelectContainer,l=n.ValueContainer,u=this.props,c=u.className,h=u.id,d=u.isDisabled,f=u.menuIsOpen,p=this.state.isFocused,g=this.commonProps=this.getCommonProps();return S.createElement(o,le({},g,{className:c,innerProps:{id:h,onKeyDown:this.onKeyDown},isDisabled:d,isFocused:p}),this.renderLiveRegion(),S.createElement(s,le({},g,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:d,isFocused:p,menuIsOpen:f}),S.createElement(l,le({},g,{isDisabled:d}),this.renderPlaceholderOrValue(),this.renderInput()),S.createElement(a,le({},g,{isDisabled:d}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(n,s){var a=s.prevProps,o=s.clearFocusValueOnUpdate,l=s.inputIsHiddenAfterUpdate,u=s.ariaSelection,c=s.isFocused,h=s.prevWasFocused,d=s.instancePrefix,f=n.options,p=n.value,g=n.menuIsOpen,y=n.inputValue,b=n.isMulti,m=lw(p),v={};if(a&&(p!==a.value||f!==a.options||g!==a.menuIsOpen||y!==a.inputValue)){var k=g?AA(n,m):[],x=g?kw(Lh(n,m),"".concat(d,"-option")):[],C=o?VA(s,m):null,N=HA(s,k),B=og(x,N);v={selectValue:m,focusedOption:N,focusedOptionId:B,focusableOptionsWithIds:x,focusedValue:C,clearFocusValueOnUpdate:!1}}var E=l!=null&&n!==a?{inputIsHidden:l,inputIsHiddenAfterUpdate:void 0}:{},O=u,z=c&&h;return c&&!z&&(O={value:Xc(b,m,m[0]||null),options:m,action:"initial-input-focus"},z=!h),(u==null?void 0:u.action)==="initial-input-focus"&&(O=null),Me(Me(Me({},v),E),{},{prevProps:n,ariaSelection:O,prevWasFocused:z})}}]),t}(S.Component);e2.defaultProps=FA;var UA=S.forwardRef(function(i,e){var t=iD(i);return S.createElement(e2,le({ref:e},t))}),t2=UA;function WA({id:i,value:e,values:t,styles:r,components:n,autoFocus:s,placeholder:a,onChange:o,getLabel:l}){const u=d=>{o(d.value)},c=S.useMemo(()=>t.map(d=>({label:l?l(d):d,value:d})),[t,l]),h=S.useMemo(()=>c.find(d=>d.value===e),[c,e]);return T.jsx(t2,{inputId:i,autoFocus:s,placeholder:a,value:h,options:c,styles:r,components:n,onChange:u})}const Kc=i=>({...i,fontSize:"1em",color:"#ffffff"}),i2={input:Kc,singleValue:Kc,menuList:i=>({...Kc(i),backgroundColor:"#181818"}),placeholder:Kc,control:i=>({...i,borderWidth:"0px",boxShadow:"none",padding:"3px 6px",borderRadius:"6px",backgroundColor:"#ffffff10",":hover":{backgroundColor:"#ffffff30"},":focus":{backgroundColor:"#ffffff50"}}),option:(i,{isSelected:e,isFocused:t})=>({...i,backgroundColor:e?"#ffffff40":t?"#ffffff30":"transparent",":active":{backgroundColor:"#ffffff30"}}),menu:i=>({...i,minWidth:"60px"})},r2={IndicatorSeparator:()=>null};function GA(i){return{label:i,value:i}}const $A=({id:i,value:e,data:t,onChange:r})=>{const n=o=>{r(o.value)},s=S.useMemo(()=>((t==null?void 0:t.values)??[]).map(GA),[t==null?void 0:t.values]),a=S.useMemo(()=>s.find(o=>o.value===e),[s,e]);return T.jsx(t2,{inputId:i,value:a,options:s,styles:i2,components:r2,onChange:n})};function jA(i,e,t,r){if(A(e)||A(t)||A(r))return;const n=Vi.selectors.getProgression(i,e),s=on.selectors.getBar(i,t),a=tr.selectors.getChord(i,r);if(A(n)||A(s)||A(a))return;const o=s.chords.indexOf(a.id);if(o<0)return;const l=s.chords[o+1];if(!A(l))return tr.selectors.getChord(i,l);const u=n.bars.indexOf(s.id);if(u<0)return;const c=n.bars[u+1];if(A(c))return;const h=on.selectors.getBar(i,c);if(!(A(h)||h.chords.length===0))return tr.selectors.getChord(i,h.chords[0])}function YA(i,e){return!(i.some(t=>t.chords.length===0)||e.slice(0,-1).every(t=>!A(t.transitionId)))}function XA(i,e){if(i.length===1&&i[0].chords.length<2||i.some(n=>n.chords.length===0))return!1;const t=e.slice(0,-1),r=e[e.length-1];return!(t.some(n=>A(n.transitionId))||!A(r.transitionId))}function KA(i,e){return e.some(t=>t.transitionId!==void 0)}const qc={canAutoFillTransitions:!1,canGenerateScore:!1,canClearTransitions:!1};function n2(i,e){if(A(e))return qc;const t=Vi.selectors.getProgression(i,e);if(A(t))return qc;const r=t.bars.map(s=>on.selectors.getBar(i,s));if(r.length===0||r.some(A))return qc;const n=r.flatMap(s=>s.chords).map(s=>tr.selectors.getChord(i,s));return n.some(A)?qc:{canAutoFillTransitions:YA(r,n),canGenerateScore:XA(r,n),canClearTransitions:KA(r,n)}}function qA(i){return[`\\track "${i.name}" "${i.shortName}"`,i.instrument?`\\instrument "${i.instrument}"`:void 0,i.tuning?`\\tuning ${i.tuning.join(" ")}`:void 0].filter(e=>e!==void 0)}function o1(i,e){return[i,A(e)?void 0:`{ch "${e}"}`].filter(r=>r!==void 0).join(" ")}function JA(i){return`${i} {bd 120}`}function QA(i){return o1(`${i.fret}.${i.string}.${i.duration}`,i.label)}function ZA(i){const e=i.notes.map(t=>`${t.fret}.${t.string}`);return JA(o1(`(${e.join(" ")}).${i.duration}`,i.label))}function e6(i){return o1(`r.${i.duration}`,i.label)}function t6(i){switch(i.type){case"note":return QA(i);case"chord":return ZA(i);case"rest":return e6(i)}}function Cw(i){return i.items.map(e=>t6(e)).join(" ")}function i6(i){if(i.bars.length===0)return[];const e=[`\\clef ${i.clef}`,`\\ts ${i.timeSignature.top} ${i.timeSignature.bottom}`,`\\ks ${i.keySignature}`].join(" "),[t,...r]=i.bars;return[`${e} ${Cw(t)}`,...r.map(s=>Cw(s))]}function Nw(i){return[qA(i).join(" "),i6(i).join(`
|`)].join(`
`)}function r6(i,e){return{tuning:e,instrument:"AcousticBass",clef:"Bass",name:"",shortName:"",keySignature:"C",timeSignature:{bottom:4,top:4},bars:i.map(({chords:t})=>({items:t.flatMap(n=>n.pitches).map(({duration:n,fret:s,string:a,meta:o})=>({type:"note",duration:n,fret:s,string:a,label:o}))}))}}function n6(i){return{tuning:PC,instrument:"AcousticGrandPiano",clef:"Treble",name:"Chords",shortName:"",keySignature:"C",timeSignature:{bottom:4,top:4},bars:i.map(e=>({items:e.chords.map(({duration:r,pitches:n})=>({type:"chord",duration:r,notes:n.map(({fret:s,string:a})=>({fret:s,string:a}))}))}))}}function Bw(i,e,t=!0){const r=e.filter(n=>{const s=el.freq(i),a=el.freq(n);return!A(s)&&!A(a)&&s>=a}).map(n=>({fret:Bs.semitones(Zo(n,i)),note:i,string:e.indexOf(n)+1})).filter(({fret:n})=>n<=24);if(!t&&r.length===0)throw new TypeError(`Can't place ${i} in tuning: ${e.join(", ")}`);return r}function il(i){if(!i)return"Missing";const e=`${i.name}${Ly(i.type)}`,[t]=Ru(i.root);return i.name!==t?`${e}/${i.root}`:e}function s6(i){return Sf[i]}const a6=(i,e)=>i.fret-e.fret,o6=i=>(e,t)=>Math.abs(i-e.fret)-Math.abs(i-t.fret);function l6(i,e,t){const r=[];return i.forEach((n,s)=>{const a=e[n.id],o=n.id;if(s===i.length-1){const u=n.root;r.push({id:Ir(),progressionId:t,barId:a,chordId:o,note:u,fret:-1,duration:-1,string:-1,meta:il(n)});return}const l=s6(n.transitionId);DC(n,i[s+1],l).forEach((u,c)=>{r.push({id:Ir(),progressionId:t,barId:a,chordId:o,note:u,fret:-1,duration:-1,string:-1,meta:c===0?il(n):void 0})})}),r}function u6(i,e){if(i.length===0)return;const t=i[0],n=Bw(t.note,e,!1).sort(a6)[0];t.fret=n.fret,t.string=n.string;for(let s=1;s<i.length;s+=1){const a=i[s],o=i[s-1],u=Bw(a.note,e,!1).sort(o6(o.fret))[0];a.fret=u.fret,a.string=u.string}}function c6(i,e){return e.map(t=>{const r=t.chords.map(n=>({chordId:n,pitches:i.filter(s=>s.chordId===n)}));return{barId:t.id,chords:r}})}function h6(i){i.forEach(e=>{const t=e.chords.length;e.chords.forEach(r=>{const n=t*r.pitches.length;r.pitches.forEach(s=>s.duration=n)})})}function d6(i){return i.reduce((e,t)=>(t.chords.forEach(r=>{e[r]=t.id}),e),{})}function f6(i,e){const t=Vi.selectors.getProgression(i,e),r=t.tuning,n=t.bars.map(u=>on.selectors.getBar(i,u)),s=d6(n),a=n.flatMap(u=>u.chords.map(c=>tr.selectors.getChord(i,c))),o=l6(a,s,e);u6(o,r);const l=c6(o,n);return h6(l),l}const p6={"A#":{note:"A#5",fret:6,string:6},Bb:{note:"Bb5",fret:6,string:6},B:{note:"B5",fret:7,string:6},C:{note:"C6",fret:8,string:6},"C#":{note:"C#6",fret:9,string:6},Db:{note:"Db6",fret:9,string:6},D:{note:"D6",fret:10,string:6},"D#":{note:"D#6",fret:10,string:6},Eb:{note:"Eb6",fret:11,string:6},E:{note:"E6",fret:7,string:5},F:{note:"F6",fret:8,string:5},"F#":{note:"F#6",fret:9,string:5},Gb:{note:"Gb6",fret:9,string:5},G:{note:"G6",fret:10,string:5},"G#":{note:"G#6",fret:11,string:5},Ab:{note:"Ab6",fret:11,string:5},A:{note:"A6",fret:12,string:5}};function g6(i){const[e]=Ru(i.root),t=p6[e],r=t.string-1,n=Ly(i.type,!1);return bC.notes(n,e).map((a,o)=>{if(a===e)return t;const l=PC[r-o],[u]=Ru(l);return{note:void 0,string:t.string-o,fret:Bs.semitones(Zo(u,a))}})}function m6(i,e){return Vi.selectors.getProgression(i,e).bars.map(n=>on.selectors.getBar(i,n)).map(n=>{const s=n.chords.map(o=>tr.selectors.getChord(i,o)),a=s.map(o=>({chordId:o.id,pitches:g6(o),duration:s.length}));return{barId:n.id,chords:a}})}function y6(i,e){const t=Vi.selectors.getProgression(i,e),r=r6(f6(i,e),t.tuning),n=n6(m6(i,e));return[`\\title "${t.name}" \\tempo ${t.bpm??120}`,".",Nw(r),Nw(n)].join(`
`)}function s2(i){if(A(i))return[];const e=new Set;return i.forEach(t=>{PL.forEach(r=>{const n=vr(t,r),s=el.enharmonic(n);e.add(n).add(s)})}),Array.from(e)}function b6(i,e){const t=[];for(let r=0;r<i.length;r+=1){const n=i[r],s=n.transitions.filter(e);s.length>0&&t.push({...n,transitions:s})}return t}function v6(i){return Vr(e=>Vi.selectors.getProgression(e,i))}function es(){const{progressionId:i}=lN();return v6(i)}function a2(i){return Vr(e=>on.selectors.getBar(e,i))}function w6(i){return Vr(e=>tr.selectors.getChord(e,i))}function S6(i,e,t){return Vr(r=>jA(r,i,e,t))}function x6(i,e){return Vr(t=>{var a;const r=on.selectors.getBar(t,i),n=((a=r==null?void 0:r.chords)==null?void 0:a.length)??-1;if(e>=n)return;const s=r==null?void 0:r.chords[e];return tr.selectors.getChord(t,s)})}function l1(){return Vr(i=>i.config)}function k6(i){return Vr(e=>n2(e,i))}function T6(i){return Vr(e=>y6(e,i))}function C6(i,e,t,r){return S.useMemo(()=>b6(_C,n=>Dy(t,r,i,n,e)),[t,r,i])}function N6(i,e){return S.useMemo(()=>OC(e,s2(i)),[i,e])}function B6(i){return A(i)?void 0:Sf[i]}function _6(i){return{type:"global/fillTransitions",payload:i}}function P6(i){return{type:"global/clearTransitions",payload:i}}function R6(i){return{type:"global/createProgressionFromTemplate",payload:i}}function E6(i){return{type:"global/deleteChords",payload:i}}function M6(i){return{type:"global/deleteBars",payload:i}}function O6(i){return{type:"global/deleteProgressions",payload:i}}function I6(i){return{type:"global/cloneBar",payload:i}}function L6(i){return{type:"global/moveBar",payload:i}}function D6(i){return{type:"global/setNoteCount",payload:i}}const F6={values:["2","4"]},A6=()=>{var a;const i=On(),e=es(),{t}=vt();function r(o){A(e)||i(Vi.actions.updateProgression({progressionId:e.id,updates:o}))}const n=o=>{r({bpm:parseInt(o)})},s=o=>{i(D6({noteCount:parseInt(o),progressionId:e.id}))};return T.jsxs(T.Fragment,{children:[T.jsx(qm,{name:t("Settings.TempoName"),description:t("Settings.TempoDescription"),Editor:q4,onChange:n,value:((e==null?void 0:e.bpm)??120).toString(),data:{type:"number",min:60,max:500,step:1}}),T.jsx(qm,{name:t("Settings.NotesInABarName"),description:t("Settings.NotesInABarDescription"),Editor:$A,data:F6,onChange:s,value:((a=e==null?void 0:e.noteCount)==null?void 0:a.toString())??""})]})},V6=R`
  display: flex;
  flex-direction: column;
  padding: 14px;
  pointer-events: auto;
`,H6=R`
  font-size: 1em;
  color: #ffffff;
  margin-bottom: 2px;
  pointer-events: auto;
`,z6=R`
  font-size: 0.8em;
  margin-bottom: 10px;
  color: #ffffffaa;
`,U6=R`
  display: flex;
  flex-direction: column;
  gap: 10px;
`,W6=R`
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: center;
  gap: 10px;
`,G6=R`
  background-color: #ffffffaa;
  flex: 1 1 1px;
`,$6=R`
  width: 110px;
`,j6=R`
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: center;
  gap: 6px;
`,uo=R`
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: center;
  border: none;
  color: #ffffffdd;
  padding: 8px 16px;
  gap: 6px;
  cursor: pointer;
  font-size: 1em;
  border-radius: 6px;
  background-color: transparent;
  background-color: #ffffff10;
  &:hover {
    color: #fff;
    background-color: #ffffff20;
  }
  &:disabled {
    background-color: transparent;
    color: #ffffff50;
    cursor: not-allowed;
  }
`,Y6=R`
  display: flex;
  flex-direction: row;
`,X6=R`
  flex: 1;
  display: flex;
  flex-direction: row;
  gap: 10px;
`,K6=R`
  border-color: #ffffff66;
  margin: 20px 0px;
`,q6=()=>{const i=On(),e=es(),{t}=vt(),r=e==null?void 0:e.tuning;function n(d){A(e)||i(Vi.actions.updateProgression({progressionId:e.id,updates:{tuning:d}}))}const s=d=>f=>{n(r.map((p,g)=>g===d?f:p))},a=d=>()=>{n(OL(r,d))},o=d=>()=>{n(DL(r,d))},l=d=>()=>{n(IL(r,d))},u=()=>{n([...r,"B0"])},c=()=>{n(vL)},h=()=>{n(wL)};return T.jsxs("div",{className:V6,children:[T.jsx("label",{className:H6,children:t("Settings.TuningName")}),T.jsx("span",{className:z6,children:t("Settings.TuningDescription")}),T.jsx("div",{className:U6,children:r.map((d,f)=>{const p=ML(6,18,f/r.length),g=p/2;return T.jsxs("div",{className:W6,children:[T.jsx("div",{className:$6,children:T.jsx(WA,{value:d,values:EC,onChange:s(f),components:r2,styles:i2})}),T.jsx("div",{className:G6,style:{borderRadius:g,height:p}}),T.jsxs("div",{className:j6,children:[T.jsx("button",{className:uo,disabled:f===0,onClick:a(f),children:T.jsx(d4,{})}),T.jsx("button",{className:uo,disabled:f===r.length-1,onClick:o(f),children:T.jsx(c4,{})}),T.jsx("button",{className:uo,onClick:l(f),children:T.jsx(bN,{})})]})]},`${d}-${f}`)})}),T.jsx("hr",{className:K6}),T.jsxs("div",{className:Y6,children:[T.jsxs("div",{className:X6,children:[T.jsxs("button",{className:uo,onClick:c,children:[T.jsx(Km,{})," E A D G"]}),T.jsxs("button",{className:uo,onClick:h,children:[T.jsx(Km,{})," B E A D G"]})]}),T.jsxs("button",{className:uo,onClick:u,children:[T.jsx(Qy,{})," ",t("Settings.TuningAddString")]})]})]})},xs={score:i=>`/${i}/score`,editor:i=>`/${i}/editor`,home:()=>"/"},J6=R`
  display: flex;
  flex-direction: column;
  padding: 14px;
  pointer-events: auto;
`,Q6=R`
  font-size: 1em;
  color: #ffffff;
  margin-bottom: 2px;
  pointer-events: auto;
`,Z6=R`
  font-size: 0.8em;
  margin-bottom: 10px;
  color: #ffffffaa;
`,e7=R`
  display: flex;
  flex-direction: row;
`,t7=R`
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: center;
  border: none;
  color: #ffffffdd;
  padding: 8px 16px;
  gap: 6px;
  cursor: pointer;
  font-size: 1em;
  border-radius: 6px;
  background-color: transparent;
  background-color: #ff000050;
  &:hover {
    color: #fff;
    background-color: #ff000060;
  }
  &:disabled {
    background-color: transparent;
    color: #ffffff50;
    cursor: not-allowed;
  }
`,i7=()=>{const i=On(),e=es(),t=Af(),{t:r}=vt(),n=()=>{A(e)||(i(O6({progressionIds:[e.id]})),t(xs.home()))};return T.jsxs("div",{className:J6,children:[T.jsx("label",{className:Q6,children:r("Settings.DeleteProgressionName")}),T.jsx("span",{className:Z6,children:r("Settings.DeleteProgressionDescription")}),T.jsx("div",{className:e7,children:T.jsxs("button",{className:t7,onClick:n,children:[T.jsx(ro,{}),r("Settings.DeleteProgressionButton")]})})]})},r7=R`
  position: relative;
  display: inline-block;
  width: 60px;
  height: 34px;
`,n7=R`
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  transition: 0.4s;
  border-radius: 26px;
  background-color: #323232;

  &:before {
    position: absolute;
    content: '';
    height: 26px;
    width: 26px;
    left: 4px;
    bottom: 4px;
    transition: 0.4s;
    border-radius: 50%;
    background-color: #ffffff;
  }
`,s7=R`
  background-color: #238636;

  &:before {
    transform: translateX(26px);
  }
`,a7=R`
  opacity: 0;
  width: 100%;
  height: 100%;
  position: absolute;
  top: 0;
  left: 0;
  cursor: pointer;
  z-index: 2; /* Ensure the input is on top of the slider */
`,o7=({id:i,value:e,onChange:t})=>{const r=()=>{t(!e)};return T.jsxs("label",{className:r7,children:[T.jsx("input",{id:i,type:"checkbox",checked:e,onChange:LC,onClick:r,className:a7}),T.jsx("span",{className:mi(n7,e?s7:void 0)})]})},l7=()=>{const i=On(),{showTooltips:e}=l1(),{t}=vt(),r=n=>{i(Ra.actions.updateConfig({showTooltips:n}))};return T.jsx(T.Fragment,{children:T.jsx(qm,{name:t("Settings.ShowTooltipsName"),description:t("Settings.ShowTooltipsDescription"),Editor:o7,onChange:r,value:e??!0})})};function u7(){const{t:i,i18n:e}=vt();return S.useMemo(()=>[{id:Ir(),name:i("Settings.General"),Icon:mN,Component:l7},{id:Ir(),name:i("Settings.Progression"),Icon:y4,Component:A6},{id:Ir(),name:i("Settings.Tuning"),Icon:TN,Component:q6},{id:Ir(),name:i("Settings.DangerZone"),Icon:yN,Component:i7}],[i,e.language])}const c7=R`
  border-top-left-radius: 14px;
  border-bottom-left-radius: 14px;
  background-color: #ffffff10;
  min-width: 200px;
`,h7=R`
  display: flex;
  flex-direction: row;
  align-items: center;
  font-size: 1.4em;
  font-weight: bold;
  color: #ffffff;
  gap: 10px;
  padding: 14px 18px;
`,d7=R`
  position: relative;
  top: 1px;
`,f7=R`
  overflow-x: auto;
  display: flex;
  flex-direction: column;
  padding: 14px 0px;
`,p7=R`
  display: flex;
  align-items: center;
  color: #ffffffcc;
  font-size: 1.2em;
  gap: 10px;
  padding: 10px 18px;
  cursor: pointer;
  &:hover {
    color: #ffffff;
    background-color: #ffffff10;
  }
`,g7=R`
  background-color: #ffffff20;
  color: #ffffff;
  &:hover {
    color: #ffffff;
    background-color: #ffffff20;
  }
`,m7=R`
  flex: 1;
  min-width: 400px;
`,y7=R`
  display: flex;
  flex-direction: row;
  gap: 10px;
  align-items: center;
`,b7=R`
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  align-items: center;
  font-size: 1.4em;
  font-weight: bold;
  color: #ffffff;
  padding: 14px;
`,v7=R`
  font-size: 1.4em;
  color: #ffffff;
  cursor: pointer;
`,w7=R`
  width: 600px;
  height: 600px;
`,S7=({onClose:i})=>{const e=u7(),[t,r]=S.useState(e[0]),{t:n}=vt();return T.jsxs(x4,{onBackdropClick:i,children:[T.jsxs("div",{className:c7,children:[T.jsxs("header",{className:h7,children:[T.jsx(g4,{className:d7})," ",n("Settings.Settings")]}),T.jsx("div",{className:f7,children:e.map(s=>{const{id:a,name:o,Icon:l}=s,u=mi(p7,a===t.id?g7:null),c=()=>r(s);return T.jsxs("div",{className:u,onClick:c,children:[T.jsx(l,{})," ",o]},a)})})]}),T.jsxs("div",{className:m7,children:[T.jsxs("header",{className:b7,children:[T.jsxs("div",{className:y7,children:[T.jsx(t.Icon,{})," ",t.name]}),T.jsx(bN,{className:v7,onClick:i})]}),T.jsx("div",{className:w7,children:T.jsx(t.Component,{onClose:i})})]})]})},x7=R`
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  pointer-events: none !important;
  color: #fff;
  visibility: hidden !important;
`,k7=({value:i,className:e,...t})=>{const[r,n]=S.useState(0),s=S.useRef(null);return S.useEffect(()=>{if(A(s.current))return;const a=s.current.getBoundingClientRect();n(Math.ceil(a.width)+5)},[i]),T.jsxs(T.Fragment,{children:[T.jsx("div",{className:mi(e,x7),ref:s,children:i}),T.jsx("input",{type:"text",value:i,className:e,style:{...t.style,width:r},...t})]})};/**
 * React Router DOM v6.24.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function t0(){return t0=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},t0.apply(this,arguments)}function T7(i,e){if(i==null)return{};var t={},r=Object.keys(i),n,s;for(s=0;s<r.length;s++)n=r[s],!(e.indexOf(n)>=0)&&(t[n]=i[n]);return t}function C7(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function N7(i,e){return i.button===0&&(!e||e==="_self")&&!C7(i)}const B7=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],_7="6";try{window.__reactRouterVersion=_7}catch{}const P7="startTransition",_w=cu[P7];function R7(i){let{basename:e,children:t,future:r,window:n}=i,s=S.useRef();s.current==null&&(s.current=s5({window:n,v5Compat:!0}));let a=s.current,[o,l]=S.useState({action:a.action,location:a.location}),{v7_startTransition:u}=r||{},c=S.useCallback(h=>{u&&_w?_w(()=>l(h)):l(h)},[l,u]);return S.useLayoutEffect(()=>a.listen(c),[a,c]),S.createElement(X5,{basename:e,children:t,location:o.location,navigationType:o.action,navigator:a,future:r})}const E7=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",M7=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ua=S.forwardRef(function(e,t){let{onClick:r,relative:n,reloadDocument:s,replace:a,state:o,target:l,to:u,preventScrollReset:c,unstable_viewTransition:h}=e,d=T7(e,B7),{basename:f}=S.useContext(ba),p,g=!1;if(typeof u=="string"&&M7.test(u)&&(p=u,E7))try{let v=new URL(window.location.href),k=u.startsWith("//")?new URL(v.protocol+u):new URL(u),x=Xy(k.pathname,f);k.origin===v.origin&&x!=null?u=x+k.search+k.hash:g=!0}catch{}let y=E5(u,{relative:n}),b=O7(u,{replace:a,state:o,target:l,preventScrollReset:c,relative:n,unstable_viewTransition:h});function m(v){r&&r(v),v.defaultPrevented||b(v)}return S.createElement("a",t0({},d,{href:p||y,onClick:g||s?r:m,ref:t,target:l}))});var Pw;(function(i){i.UseScrollRestoration="useScrollRestoration",i.UseSubmit="useSubmit",i.UseSubmitFetcher="useSubmitFetcher",i.UseFetcher="useFetcher",i.useViewTransitionState="useViewTransitionState"})(Pw||(Pw={}));var Rw;(function(i){i.UseFetcher="useFetcher",i.UseFetchers="useFetchers",i.UseScrollRestoration="useScrollRestoration"})(Rw||(Rw={}));function O7(i,e){let{target:t,replace:r,state:n,preventScrollReset:s,relative:a,unstable_viewTransition:o}=e===void 0?{}:e,l=Af(),u=io(),c=uN(i,{relative:a});return S.useCallback(h=>{if(N7(h,t)){h.preventDefault();let d=r!==void 0?r:yd(u)===yd(c);l(i,{replace:d,state:n,preventScrollReset:s,relative:a,unstable_viewTransition:o})}},[u,l,c,r,n,t,i,s,a,o])}const I7=R`
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: space-between;
  background-color: #ffffff20;
  height: 70px;
  width: 100%;
  padding: 0px 60px;
`,Ew=R`
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 10px;
`,Dh=R`
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: center;
  border: none;
  color: #ffffffdd;
  padding: 8px 16px;
  gap: 6px;
  cursor: pointer;
  font-size: 1em;
  border-radius: 6px;
  background-color: transparent;
  &:hover {
    color: #fff;
    background-color: #ffffff20;
  }
  &:disabled {
    background-color: transparent;
    color: #ffffff50;
    cursor: not-allowed;
  }
`,L7=mi(Dh,R`
    padding: 0px;
    width: 40px;
    height: 40px;
    border-radius: 20px;
  `),D7=R`
  display: inline;
  font-weight: 600;
  color: #ffffffee;
  padding: 8px 16px;
  font-size: 1em;
  text-align: center;
  text-shadow: 0px 0px 0px transparent;
  transition: text-shadow 0.2s ease, color 0.2s ease;
  user-select: none;
  cursor: pointer;
  background-color: transparent;
  border: none;
  border-radius: 20px;
  background-color: #ffffff10;
  &:hover,
  &:focus {
    border: none;
    outline: none;
  }

  &:hover {
    color: #ffffff;
    background-color: #ffffff30;
  }
  &:focus {
    color: #ffffff;
    background-color: #ffffff50;
  }
`,Jc=R`
  font-size: 1.2em;
  flex-shrink: 0;
`,F7=()=>{const[i,e]=S.useState(!1),t=es(),{t:r}=vt(),{canAutoFillTransitions:n,canClearTransitions:s}=k6(t==null?void 0:t.id),a=On(),o=()=>{A(t)||a(_6({progressionId:t.id}))},l=()=>{A(t)||a(P6({progressionId:t.id}))},u=p=>{A(t)||a(Vi.actions.updateProgression({progressionId:t.id,updates:{name:p.target.value}}))},c=p=>{p.key==="Enter"&&p.target.blur()},h=p=>{p.target.select()},d=()=>e(!0),f=()=>e(!1);return T.jsxs(T.Fragment,{children:[i&&T.jsx(S7,{onClose:f}),T.jsxs("div",{className:I7,children:[T.jsxs("div",{className:Ew,children:[T.jsx(ua,{to:xs.home(),className:L7,children:T.jsx(h4,{className:Jc})}),T.jsx(k7,{type:"text",value:(t==null?void 0:t.name)??"",className:D7,minLength:1,onChange:u,onFocus:h,onKeyDown:c}),T.jsxs("button",{className:Dh,disabled:!n,onClick:o,"data-tooltip":"Tooltips.Progression.FillTransitions",children:[T.jsx(r4,{className:Jc}),r("EditorNavigation.FillTransitions")]}),T.jsxs("button",{className:Dh,disabled:!s,onClick:l,"data-tooltip":"Tooltips.Progression.ClearTransitions",children:[T.jsx(ro,{className:Jc}),r("EditorNavigation.ClearTransitions")]})]}),T.jsx("div",{className:Ew,children:T.jsxs("button",{disabled:A(t==null?void 0:t.id),className:Dh,onClick:d,children:[T.jsx(mN,{className:Jc}),r("EditorNavigation.Settings")]})})]})]})};function A7(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];return S.useMemo(()=>r=>{e.forEach(n=>n(r))},e)}const zf=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function gl(i){const e=Object.prototype.toString.call(i);return e==="[object Window]"||e==="[object global]"}function u1(i){return"nodeType"in i}function sr(i){var e,t;return i?gl(i)?i:u1(i)&&(e=(t=i.ownerDocument)==null?void 0:t.defaultView)!=null?e:window:window}function c1(i){const{Document:e}=sr(i);return i instanceof e}function uc(i){return gl(i)?!1:i instanceof sr(i).HTMLElement}function o2(i){return i instanceof sr(i).SVGElement}function ml(i){return i?gl(i)?i.document:u1(i)?c1(i)?i:uc(i)||o2(i)?i.ownerDocument:document:document:document}const ln=zf?S.useLayoutEffect:S.useEffect;function Uf(i){const e=S.useRef(i);return ln(()=>{e.current=i}),S.useCallback(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.current==null?void 0:e.current(...r)},[])}function V7(){const i=S.useRef(null),e=S.useCallback((r,n)=>{i.current=setInterval(r,n)},[]),t=S.useCallback(()=>{i.current!==null&&(clearInterval(i.current),i.current=null)},[]);return[e,t]}function Du(i,e){e===void 0&&(e=[i]);const t=S.useRef(i);return ln(()=>{t.current!==i&&(t.current=i)},e),t}function cc(i,e){const t=S.useRef();return S.useMemo(()=>{const r=i(t.current);return t.current=r,r},[...e])}function Pd(i){const e=Uf(i),t=S.useRef(null),r=S.useCallback(n=>{n!==t.current&&(e==null||e(n,t.current)),t.current=n},[]);return[t,r]}function Rd(i){const e=S.useRef();return S.useEffect(()=>{e.current=i},[i]),e.current}let lg={};function hc(i,e){return S.useMemo(()=>{if(e)return e;const t=lg[i]==null?0:lg[i]+1;return lg[i]=t,i+"-"+t},[i,e])}function l2(i){return function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return r.reduce((s,a)=>{const o=Object.entries(a);for(const[l,u]of o){const c=s[l];c!=null&&(s[l]=c+i*u)}return s},{...e})}}const Wo=l2(1),Fu=l2(-1);function H7(i){return"clientX"in i&&"clientY"in i}function Wf(i){if(!i)return!1;const{KeyboardEvent:e}=sr(i.target);return e&&i instanceof e}function z7(i){if(!i)return!1;const{TouchEvent:e}=sr(i.target);return e&&i instanceof e}function Ed(i){if(z7(i)){if(i.touches&&i.touches.length){const{clientX:e,clientY:t}=i.touches[0];return{x:e,y:t}}else if(i.changedTouches&&i.changedTouches.length){const{clientX:e,clientY:t}=i.changedTouches[0];return{x:e,y:t}}}return H7(i)?{x:i.clientX,y:i.clientY}:null}const ca=Object.freeze({Translate:{toString(i){if(!i)return;const{x:e,y:t}=i;return"translate3d("+(e?Math.round(e):0)+"px, "+(t?Math.round(t):0)+"px, 0)"}},Scale:{toString(i){if(!i)return;const{scaleX:e,scaleY:t}=i;return"scaleX("+e+") scaleY("+t+")"}},Transform:{toString(i){if(i)return[ca.Translate.toString(i),ca.Scale.toString(i)].join(" ")}},Transition:{toString(i){let{property:e,duration:t,easing:r}=i;return e+" "+t+"ms "+r}}}),Mw="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function U7(i){return i.matches(Mw)?i:i.querySelector(Mw)}const W7={display:"none"};function G7(i){let{id:e,value:t}=i;return et.createElement("div",{id:e,style:W7},t)}function $7(i){let{id:e,announcement:t,ariaLiveType:r="assertive"}=i;const n={position:"fixed",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return et.createElement("div",{id:e,style:n,role:"status","aria-live":r,"aria-atomic":!0},t)}function j7(){const[i,e]=S.useState("");return{announce:S.useCallback(r=>{r!=null&&e(r)},[]),announcement:i}}const u2=S.createContext(null);function Y7(i){const e=S.useContext(u2);S.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(i)},[i,e])}function X7(){const[i]=S.useState(()=>new Set),e=S.useCallback(r=>(i.add(r),()=>i.delete(r)),[i]);return[S.useCallback(r=>{let{type:n,event:s}=r;i.forEach(a=>{var o;return(o=a[n])==null?void 0:o.call(a,s)})},[i]),e]}const K7={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},q7={onDragStart(i){let{active:e}=i;return"Picked up draggable item "+e.id+"."},onDragOver(i){let{active:e,over:t}=i;return t?"Draggable item "+e.id+" was moved over droppable area "+t.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(i){let{active:e,over:t}=i;return t?"Draggable item "+e.id+" was dropped over droppable area "+t.id:"Draggable item "+e.id+" was dropped."},onDragCancel(i){let{active:e}=i;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function J7(i){let{announcements:e=q7,container:t,hiddenTextDescribedById:r,screenReaderInstructions:n=K7}=i;const{announce:s,announcement:a}=j7(),o=hc("DndLiveRegion"),[l,u]=S.useState(!1);if(S.useEffect(()=>{u(!0)},[]),Y7(S.useMemo(()=>({onDragStart(h){let{active:d}=h;s(e.onDragStart({active:d}))},onDragMove(h){let{active:d,over:f}=h;e.onDragMove&&s(e.onDragMove({active:d,over:f}))},onDragOver(h){let{active:d,over:f}=h;s(e.onDragOver({active:d,over:f}))},onDragEnd(h){let{active:d,over:f}=h;s(e.onDragEnd({active:d,over:f}))},onDragCancel(h){let{active:d,over:f}=h;s(e.onDragCancel({active:d,over:f}))}}),[s,e])),!l)return null;const c=et.createElement(et.Fragment,null,et.createElement(G7,{id:r,value:n.draggable}),et.createElement($7,{id:o,announcement:a}));return t?wn.createPortal(c,t):c}var vi;(function(i){i.DragStart="dragStart",i.DragMove="dragMove",i.DragEnd="dragEnd",i.DragCancel="dragCancel",i.DragOver="dragOver",i.RegisterDroppable="registerDroppable",i.SetDroppableDisabled="setDroppableDisabled",i.UnregisterDroppable="unregisterDroppable"})(vi||(vi={}));function Md(){}function Ow(i,e){return S.useMemo(()=>({sensor:i,options:e??{}}),[i,e])}function Q7(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];return S.useMemo(()=>[...e].filter(r=>r!=null),[...e])}const Rn=Object.freeze({x:0,y:0});function c2(i,e){return Math.sqrt(Math.pow(i.x-e.x,2)+Math.pow(i.y-e.y,2))}function Z7(i,e){const t=Ed(i);if(!t)return"0 0";const r={x:(t.x-e.left)/e.width*100,y:(t.y-e.top)/e.height*100};return r.x+"% "+r.y+"%"}function h2(i,e){let{data:{value:t}}=i,{data:{value:r}}=e;return t-r}function e8(i,e){let{data:{value:t}}=i,{data:{value:r}}=e;return r-t}function Iw(i){let{left:e,top:t,height:r,width:n}=i;return[{x:e,y:t},{x:e+n,y:t},{x:e,y:t+r},{x:e+n,y:t+r}]}function d2(i,e){if(!i||i.length===0)return null;const[t]=i;return t[e]}function Lw(i,e,t){return e===void 0&&(e=i.left),t===void 0&&(t=i.top),{x:e+i.width*.5,y:t+i.height*.5}}const t8=i=>{let{collisionRect:e,droppableRects:t,droppableContainers:r}=i;const n=Lw(e,e.left,e.top),s=[];for(const a of r){const{id:o}=a,l=t.get(o);if(l){const u=c2(Lw(l),n);s.push({id:o,data:{droppableContainer:a,value:u}})}}return s.sort(h2)},i8=i=>{let{collisionRect:e,droppableRects:t,droppableContainers:r}=i;const n=Iw(e),s=[];for(const a of r){const{id:o}=a,l=t.get(o);if(l){const u=Iw(l),c=n.reduce((d,f,p)=>d+c2(u[p],f),0),h=Number((c/4).toFixed(4));s.push({id:o,data:{droppableContainer:a,value:h}})}}return s.sort(h2)};function r8(i,e){const t=Math.max(e.top,i.top),r=Math.max(e.left,i.left),n=Math.min(e.left+e.width,i.left+i.width),s=Math.min(e.top+e.height,i.top+i.height),a=n-r,o=s-t;if(r<n&&t<s){const l=e.width*e.height,u=i.width*i.height,c=a*o,h=c/(l+u-c);return Number(h.toFixed(4))}return 0}const n8=i=>{let{collisionRect:e,droppableRects:t,droppableContainers:r}=i;const n=[];for(const s of r){const{id:a}=s,o=t.get(a);if(o){const l=r8(o,e);l>0&&n.push({id:a,data:{droppableContainer:s,value:l}})}}return n.sort(e8)};function s8(i,e,t){return{...i,scaleX:e&&t?e.width/t.width:1,scaleY:e&&t?e.height/t.height:1}}function f2(i,e){return i&&e?{x:i.left-e.left,y:i.top-e.top}:Rn}function a8(i){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];return n.reduce((a,o)=>({...a,top:a.top+i*o.y,bottom:a.bottom+i*o.y,left:a.left+i*o.x,right:a.right+i*o.x}),{...t})}}const o8=a8(1);function p2(i){if(i.startsWith("matrix3d(")){const e=i.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(i.startsWith("matrix(")){const e=i.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function l8(i,e,t){const r=p2(e);if(!r)return i;const{scaleX:n,scaleY:s,x:a,y:o}=r,l=i.left-a-(1-n)*parseFloat(t),u=i.top-o-(1-s)*parseFloat(t.slice(t.indexOf(" ")+1)),c=n?i.width/n:i.width,h=s?i.height/s:i.height;return{width:c,height:h,top:u,right:l+c,bottom:u+h,left:l}}const u8={ignoreTransform:!1};function yl(i,e){e===void 0&&(e=u8);let t=i.getBoundingClientRect();if(e.ignoreTransform){const{transform:u,transformOrigin:c}=sr(i).getComputedStyle(i);u&&(t=l8(t,u,c))}const{top:r,left:n,width:s,height:a,bottom:o,right:l}=t;return{top:r,left:n,width:s,height:a,bottom:o,right:l}}function Dw(i){return yl(i,{ignoreTransform:!0})}function c8(i){const e=i.innerWidth,t=i.innerHeight;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}function h8(i,e){return e===void 0&&(e=sr(i).getComputedStyle(i)),e.position==="fixed"}function d8(i,e){e===void 0&&(e=sr(i).getComputedStyle(i));const t=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(n=>{const s=e[n];return typeof s=="string"?t.test(s):!1})}function Gf(i,e){const t=[];function r(n){if(e!=null&&t.length>=e||!n)return t;if(c1(n)&&n.scrollingElement!=null&&!t.includes(n.scrollingElement))return t.push(n.scrollingElement),t;if(!uc(n)||o2(n)||t.includes(n))return t;const s=sr(i).getComputedStyle(n);return n!==i&&d8(n,s)&&t.push(n),h8(n,s)?t:r(n.parentNode)}return i?r(i):t}function g2(i){const[e]=Gf(i,1);return e??null}function ug(i){return!zf||!i?null:gl(i)?i:u1(i)?c1(i)||i===ml(i).scrollingElement?window:uc(i)?i:null:null}function m2(i){return gl(i)?i.scrollX:i.scrollLeft}function y2(i){return gl(i)?i.scrollY:i.scrollTop}function i0(i){return{x:m2(i),y:y2(i)}}var Bi;(function(i){i[i.Forward=1]="Forward",i[i.Backward=-1]="Backward"})(Bi||(Bi={}));function b2(i){return!zf||!i?!1:i===document.scrollingElement}function v2(i){const e={x:0,y:0},t=b2(i)?{height:window.innerHeight,width:window.innerWidth}:{height:i.clientHeight,width:i.clientWidth},r={x:i.scrollWidth-t.width,y:i.scrollHeight-t.height},n=i.scrollTop<=e.y,s=i.scrollLeft<=e.x,a=i.scrollTop>=r.y,o=i.scrollLeft>=r.x;return{isTop:n,isLeft:s,isBottom:a,isRight:o,maxScroll:r,minScroll:e}}const f8={x:.2,y:.2};function p8(i,e,t,r,n){let{top:s,left:a,right:o,bottom:l}=t;r===void 0&&(r=10),n===void 0&&(n=f8);const{isTop:u,isBottom:c,isLeft:h,isRight:d}=v2(i),f={x:0,y:0},p={x:0,y:0},g={height:e.height*n.y,width:e.width*n.x};return!u&&s<=e.top+g.height?(f.y=Bi.Backward,p.y=r*Math.abs((e.top+g.height-s)/g.height)):!c&&l>=e.bottom-g.height&&(f.y=Bi.Forward,p.y=r*Math.abs((e.bottom-g.height-l)/g.height)),!d&&o>=e.right-g.width?(f.x=Bi.Forward,p.x=r*Math.abs((e.right-g.width-o)/g.width)):!h&&a<=e.left+g.width&&(f.x=Bi.Backward,p.x=r*Math.abs((e.left+g.width-a)/g.width)),{direction:f,speed:p}}function g8(i){if(i===document.scrollingElement){const{innerWidth:s,innerHeight:a}=window;return{top:0,left:0,right:s,bottom:a,width:s,height:a}}const{top:e,left:t,right:r,bottom:n}=i.getBoundingClientRect();return{top:e,left:t,right:r,bottom:n,width:i.clientWidth,height:i.clientHeight}}function w2(i){return i.reduce((e,t)=>Wo(e,i0(t)),Rn)}function m8(i){return i.reduce((e,t)=>e+m2(t),0)}function y8(i){return i.reduce((e,t)=>e+y2(t),0)}function S2(i,e){if(e===void 0&&(e=yl),!i)return;const{top:t,left:r,bottom:n,right:s}=e(i);g2(i)&&(n<=0||s<=0||t>=window.innerHeight||r>=window.innerWidth)&&i.scrollIntoView({block:"center",inline:"center"})}const b8=[["x",["left","right"],m8],["y",["top","bottom"],y8]];class h1{constructor(e,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=Gf(t),n=w2(r);this.rect={...e},this.width=e.width,this.height=e.height;for(const[s,a,o]of b8)for(const l of a)Object.defineProperty(this,l,{get:()=>{const u=o(r),c=n[s]-u;return this.rect[l]+c},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class tu{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(t=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...t)})},this.target=e}add(e,t,r){var n;(n=this.target)==null||n.addEventListener(e,t,r),this.listeners.push([e,t,r])}}function v8(i){const{EventTarget:e}=sr(i);return i instanceof e?i:ml(i)}function cg(i,e){const t=Math.abs(i.x),r=Math.abs(i.y);return typeof e=="number"?Math.sqrt(t**2+r**2)>e:"x"in e&&"y"in e?t>e.x&&r>e.y:"x"in e?t>e.x:"y"in e?r>e.y:!1}var Kr;(function(i){i.Click="click",i.DragStart="dragstart",i.Keydown="keydown",i.ContextMenu="contextmenu",i.Resize="resize",i.SelectionChange="selectionchange",i.VisibilityChange="visibilitychange"})(Kr||(Kr={}));function Fw(i){i.preventDefault()}function w8(i){i.stopPropagation()}var st;(function(i){i.Space="Space",i.Down="ArrowDown",i.Right="ArrowRight",i.Left="ArrowLeft",i.Up="ArrowUp",i.Esc="Escape",i.Enter="Enter"})(st||(st={}));const x2={start:[st.Space,st.Enter],cancel:[st.Esc],end:[st.Space,st.Enter]},S8=(i,e)=>{let{currentCoordinates:t}=e;switch(i.code){case st.Right:return{...t,x:t.x+25};case st.Left:return{...t,x:t.x-25};case st.Down:return{...t,y:t.y+25};case st.Up:return{...t,y:t.y-25}}};class d1{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new tu(ml(t)),this.windowListeners=new tu(sr(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Kr.Resize,this.handleCancel),this.windowListeners.add(Kr.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Kr.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:t}=this.props,r=e.node.current;r&&S2(r),t(Rn)}handleKeyDown(e){if(Wf(e)){const{active:t,context:r,options:n}=this.props,{keyboardCodes:s=x2,coordinateGetter:a=S8,scrollBehavior:o="smooth"}=n,{code:l}=e;if(s.end.includes(l)){this.handleEnd(e);return}if(s.cancel.includes(l)){this.handleCancel(e);return}const{collisionRect:u}=r.current,c=u?{x:u.left,y:u.top}:Rn;this.referenceCoordinates||(this.referenceCoordinates=c);const h=a(e,{active:t,context:r.current,currentCoordinates:c});if(h){const d=Fu(h,c),f={x:0,y:0},{scrollableAncestors:p}=r.current;for(const g of p){const y=e.code,{isTop:b,isRight:m,isLeft:v,isBottom:k,maxScroll:x,minScroll:C}=v2(g),N=g8(g),B={x:Math.min(y===st.Right?N.right-N.width/2:N.right,Math.max(y===st.Right?N.left:N.left+N.width/2,h.x)),y:Math.min(y===st.Down?N.bottom-N.height/2:N.bottom,Math.max(y===st.Down?N.top:N.top+N.height/2,h.y))},E=y===st.Right&&!m||y===st.Left&&!v,O=y===st.Down&&!k||y===st.Up&&!b;if(E&&B.x!==h.x){const z=g.scrollLeft+d.x,J=y===st.Right&&z<=x.x||y===st.Left&&z>=C.x;if(J&&!d.y){g.scrollTo({left:z,behavior:o});return}J?f.x=g.scrollLeft-z:f.x=y===st.Right?g.scrollLeft-x.x:g.scrollLeft-C.x,f.x&&g.scrollBy({left:-f.x,behavior:o});break}else if(O&&B.y!==h.y){const z=g.scrollTop+d.y,J=y===st.Down&&z<=x.y||y===st.Up&&z>=C.y;if(J&&!d.x){g.scrollTo({top:z,behavior:o});return}J?f.y=g.scrollTop-z:f.y=y===st.Down?g.scrollTop-x.y:g.scrollTop-C.y,f.y&&g.scrollBy({top:-f.y,behavior:o});break}}this.handleMove(e,Wo(Fu(h,this.referenceCoordinates),f))}}}handleMove(e,t){const{onMove:r}=this.props;e.preventDefault(),r(t)}handleEnd(e){const{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){const{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}d1.activators=[{eventName:"onKeyDown",handler:(i,e,t)=>{let{keyboardCodes:r=x2,onActivation:n}=e,{active:s}=t;const{code:a}=i.nativeEvent;if(r.start.includes(a)){const o=s.activatorNode.current;return o&&i.target!==o?!1:(i.preventDefault(),n==null||n({event:i.nativeEvent}),!0)}return!1}}];function Aw(i){return!!(i&&"distance"in i)}function Vw(i){return!!(i&&"delay"in i)}class f1{constructor(e,t,r){var n;r===void 0&&(r=v8(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:s}=e,{target:a}=s;this.props=e,this.events=t,this.document=ml(a),this.documentListeners=new tu(this.document),this.listeners=new tu(r),this.windowListeners=new tu(sr(a)),this.initialCoordinates=(n=Ed(s))!=null?n:Rn,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:t,bypassActivationConstraint:r}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),this.windowListeners.add(Kr.Resize,this.handleCancel),this.windowListeners.add(Kr.DragStart,Fw),this.windowListeners.add(Kr.VisibilityChange,this.handleCancel),this.windowListeners.add(Kr.ContextMenu,Fw),this.documentListeners.add(Kr.Keydown,this.handleKeydown),t){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Vw(t)){this.timeoutId=setTimeout(this.handleStart,t.delay);return}if(Aw(t))return}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handleStart(){const{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(Kr.Click,w8,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Kr.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;const{activated:r,initialCoordinates:n,props:s}=this,{onMove:a,options:{activationConstraint:o}}=s;if(!n)return;const l=(t=Ed(e))!=null?t:Rn,u=Fu(n,l);if(!r&&o){if(Aw(o)){if(o.tolerance!=null&&cg(u,o.tolerance))return this.handleCancel();if(cg(u,o.distance))return this.handleStart()}return Vw(o)&&cg(u,o.tolerance)?this.handleCancel():void 0}e.cancelable&&e.preventDefault(),a(l)}handleEnd(){const{onEnd:e}=this.props;this.detach(),e()}handleCancel(){const{onCancel:e}=this.props;this.detach(),e()}handleKeydown(e){e.code===st.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const x8={move:{name:"pointermove"},end:{name:"pointerup"}};class p1 extends f1{constructor(e){const{event:t}=e,r=ml(t.target);super(e,x8,r)}}p1.activators=[{eventName:"onPointerDown",handler:(i,e)=>{let{nativeEvent:t}=i,{onActivation:r}=e;return!t.isPrimary||t.button!==0?!1:(r==null||r({event:t}),!0)}}];const k8={move:{name:"mousemove"},end:{name:"mouseup"}};var r0;(function(i){i[i.RightClick=2]="RightClick"})(r0||(r0={}));class T8 extends f1{constructor(e){super(e,k8,ml(e.event.target))}}T8.activators=[{eventName:"onMouseDown",handler:(i,e)=>{let{nativeEvent:t}=i,{onActivation:r}=e;return t.button===r0.RightClick?!1:(r==null||r({event:t}),!0)}}];const hg={move:{name:"touchmove"},end:{name:"touchend"}};class C8 extends f1{constructor(e){super(e,hg)}static setup(){return window.addEventListener(hg.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(hg.move.name,e)};function e(){}}}C8.activators=[{eventName:"onTouchStart",handler:(i,e)=>{let{nativeEvent:t}=i,{onActivation:r}=e;const{touches:n}=t;return n.length>1?!1:(r==null||r({event:t}),!0)}}];var iu;(function(i){i[i.Pointer=0]="Pointer",i[i.DraggableRect=1]="DraggableRect"})(iu||(iu={}));var Od;(function(i){i[i.TreeOrder=0]="TreeOrder",i[i.ReversedTreeOrder=1]="ReversedTreeOrder"})(Od||(Od={}));function N8(i){let{acceleration:e,activator:t=iu.Pointer,canScroll:r,draggingRect:n,enabled:s,interval:a=5,order:o=Od.TreeOrder,pointerCoordinates:l,scrollableAncestors:u,scrollableAncestorRects:c,delta:h,threshold:d}=i;const f=_8({delta:h,disabled:!s}),[p,g]=V7(),y=S.useRef({x:0,y:0}),b=S.useRef({x:0,y:0}),m=S.useMemo(()=>{switch(t){case iu.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case iu.DraggableRect:return n}},[t,n,l]),v=S.useRef(null),k=S.useCallback(()=>{const C=v.current;if(!C)return;const N=y.current.x*b.current.x,B=y.current.y*b.current.y;C.scrollBy(N,B)},[]),x=S.useMemo(()=>o===Od.TreeOrder?[...u].reverse():u,[o,u]);S.useEffect(()=>{if(!s||!u.length||!m){g();return}for(const C of x){if((r==null?void 0:r(C))===!1)continue;const N=u.indexOf(C),B=c[N];if(!B)continue;const{direction:E,speed:O}=p8(C,B,m,e,d);for(const z of["x","y"])f[z][E[z]]||(O[z]=0,E[z]=0);if(O.x>0||O.y>0){g(),v.current=C,p(k,a),y.current=O,b.current=E;return}}y.current={x:0,y:0},b.current={x:0,y:0},g()},[e,k,r,g,s,a,JSON.stringify(m),JSON.stringify(f),p,u,x,c,JSON.stringify(d)])}const B8={x:{[Bi.Backward]:!1,[Bi.Forward]:!1},y:{[Bi.Backward]:!1,[Bi.Forward]:!1}};function _8(i){let{delta:e,disabled:t}=i;const r=Rd(e);return cc(n=>{if(t||!r||!n)return B8;const s={x:Math.sign(e.x-r.x),y:Math.sign(e.y-r.y)};return{x:{[Bi.Backward]:n.x[Bi.Backward]||s.x===-1,[Bi.Forward]:n.x[Bi.Forward]||s.x===1},y:{[Bi.Backward]:n.y[Bi.Backward]||s.y===-1,[Bi.Forward]:n.y[Bi.Forward]||s.y===1}}},[t,e,r])}function P8(i,e){const t=e!==null?i.get(e):void 0,r=t?t.node.current:null;return cc(n=>{var s;return e===null?null:(s=r??n)!=null?s:null},[r,e])}function R8(i,e){return S.useMemo(()=>i.reduce((t,r)=>{const{sensor:n}=r,s=n.activators.map(a=>({eventName:a.eventName,handler:e(a.handler,r)}));return[...t,...s]},[]),[i,e])}var Au;(function(i){i[i.Always=0]="Always",i[i.BeforeDragging=1]="BeforeDragging",i[i.WhileDragging=2]="WhileDragging"})(Au||(Au={}));var n0;(function(i){i.Optimized="optimized"})(n0||(n0={}));const Hw=new Map;function E8(i,e){let{dragging:t,dependencies:r,config:n}=e;const[s,a]=S.useState(null),{frequency:o,measure:l,strategy:u}=n,c=S.useRef(i),h=y(),d=Du(h),f=S.useCallback(function(b){b===void 0&&(b=[]),!d.current&&a(m=>m===null?b:m.concat(b.filter(v=>!m.includes(v))))},[d]),p=S.useRef(null),g=cc(b=>{if(h&&!t)return Hw;if(!b||b===Hw||c.current!==i||s!=null){const m=new Map;for(let v of i){if(!v)continue;if(s&&s.length>0&&!s.includes(v.id)&&v.rect.current){m.set(v.id,v.rect.current);continue}const k=v.node.current,x=k?new h1(l(k),k):null;v.rect.current=x,x&&m.set(v.id,x)}return m}return b},[i,s,t,h,l]);return S.useEffect(()=>{c.current=i},[i]),S.useEffect(()=>{h||f()},[t,h]),S.useEffect(()=>{s&&s.length>0&&a(null)},[JSON.stringify(s)]),S.useEffect(()=>{h||typeof o!="number"||p.current!==null||(p.current=setTimeout(()=>{f(),p.current=null},o))},[o,h,f,...r]),{droppableRects:g,measureDroppableContainers:f,measuringScheduled:s!=null};function y(){switch(u){case Au.Always:return!1;case Au.BeforeDragging:return t;default:return!t}}}function g1(i,e){return cc(t=>i?t||(typeof e=="function"?e(i):i):null,[e,i])}function M8(i,e){return g1(i,e)}function O8(i){let{callback:e,disabled:t}=i;const r=Uf(e),n=S.useMemo(()=>{if(t||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:s}=window;return new s(r)},[r,t]);return S.useEffect(()=>()=>n==null?void 0:n.disconnect(),[n]),n}function $f(i){let{callback:e,disabled:t}=i;const r=Uf(e),n=S.useMemo(()=>{if(t||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:s}=window;return new s(r)},[t]);return S.useEffect(()=>()=>n==null?void 0:n.disconnect(),[n]),n}function I8(i){return new h1(yl(i),i)}function zw(i,e,t){e===void 0&&(e=I8);const[r,n]=S.useReducer(o,null),s=O8({callback(l){if(i)for(const u of l){const{type:c,target:h}=u;if(c==="childList"&&h instanceof HTMLElement&&h.contains(i)){n();break}}}}),a=$f({callback:n});return ln(()=>{n(),i?(a==null||a.observe(i),s==null||s.observe(document.body,{childList:!0,subtree:!0})):(a==null||a.disconnect(),s==null||s.disconnect())},[i]),r;function o(l){if(!i)return null;if(i.isConnected===!1){var u;return(u=l??t)!=null?u:null}const c=e(i);return JSON.stringify(l)===JSON.stringify(c)?l:c}}function L8(i){const e=g1(i);return f2(i,e)}const Uw=[];function D8(i){const e=S.useRef(i),t=cc(r=>i?r&&r!==Uw&&i&&e.current&&i.parentNode===e.current.parentNode?r:Gf(i):Uw,[i]);return S.useEffect(()=>{e.current=i},[i]),t}function F8(i){const[e,t]=S.useState(null),r=S.useRef(i),n=S.useCallback(s=>{const a=ug(s.target);a&&t(o=>o?(o.set(a,i0(a)),new Map(o)):null)},[]);return S.useEffect(()=>{const s=r.current;if(i!==s){a(s);const o=i.map(l=>{const u=ug(l);return u?(u.addEventListener("scroll",n,{passive:!0}),[u,i0(u)]):null}).filter(l=>l!=null);t(o.length?new Map(o):null),r.current=i}return()=>{a(i),a(s)};function a(o){o.forEach(l=>{const u=ug(l);u==null||u.removeEventListener("scroll",n)})}},[n,i]),S.useMemo(()=>i.length?e?Array.from(e.values()).reduce((s,a)=>Wo(s,a),Rn):w2(i):Rn,[i,e])}function Ww(i,e){e===void 0&&(e=[]);const t=S.useRef(null);return S.useEffect(()=>{t.current=null},e),S.useEffect(()=>{const r=i!==Rn;r&&!t.current&&(t.current=i),!r&&t.current&&(t.current=null)},[i]),t.current?Fu(i,t.current):Rn}function A8(i){S.useEffect(()=>{if(!zf)return;const e=i.map(t=>{let{sensor:r}=t;return r.setup==null?void 0:r.setup()});return()=>{for(const t of e)t==null||t()}},i.map(e=>{let{sensor:t}=e;return t}))}function V8(i,e){return S.useMemo(()=>i.reduce((t,r)=>{let{eventName:n,handler:s}=r;return t[n]=a=>{s(a,e)},t},{}),[i,e])}function k2(i){return S.useMemo(()=>i?c8(i):null,[i])}const dg=[];function H8(i,e){e===void 0&&(e=yl);const[t]=i,r=k2(t?sr(t):null),[n,s]=S.useReducer(o,dg),a=$f({callback:s});return i.length>0&&n===dg&&s(),ln(()=>{i.length?i.forEach(l=>a==null?void 0:a.observe(l)):(a==null||a.disconnect(),s())},[i]),n;function o(){return i.length?i.map(l=>b2(l)?r:new h1(e(l),l)):dg}}function T2(i){if(!i)return null;if(i.children.length>1)return i;const e=i.children[0];return uc(e)?e:i}function z8(i){let{measure:e}=i;const[t,r]=S.useState(null),n=S.useCallback(u=>{for(const{target:c}of u)if(uc(c)){r(h=>{const d=e(c);return h?{...h,width:d.width,height:d.height}:d});break}},[e]),s=$f({callback:n}),a=S.useCallback(u=>{const c=T2(u);s==null||s.disconnect(),c&&(s==null||s.observe(c)),r(c?e(c):null)},[e,s]),[o,l]=Pd(a);return S.useMemo(()=>({nodeRef:o,rect:t,setRef:l}),[t,o,l])}const U8=[{sensor:p1,options:{}},{sensor:d1,options:{}}],W8={current:{}},Fh={draggable:{measure:Dw},droppable:{measure:Dw,strategy:Au.WhileDragging,frequency:n0.Optimized},dragOverlay:{measure:yl}};class ru extends Map{get(e){var t;return e!=null&&(t=super.get(e))!=null?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:t}=e;return!t})}getNodeFor(e){var t,r;return(t=(r=this.get(e))==null?void 0:r.node.current)!=null?t:void 0}}const G8={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new ru,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Md},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Fh,measureDroppableContainers:Md,windowRect:null,measuringScheduled:!1},C2={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Md,draggableNodes:new Map,over:null,measureDroppableContainers:Md},dc=S.createContext(C2),N2=S.createContext(G8);function $8(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new ru}}}function j8(i,e){switch(e.type){case vi.DragStart:return{...i,draggable:{...i.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case vi.DragMove:return i.draggable.active?{...i,draggable:{...i.draggable,translate:{x:e.coordinates.x-i.draggable.initialCoordinates.x,y:e.coordinates.y-i.draggable.initialCoordinates.y}}}:i;case vi.DragEnd:case vi.DragCancel:return{...i,draggable:{...i.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case vi.RegisterDroppable:{const{element:t}=e,{id:r}=t,n=new ru(i.droppable.containers);return n.set(r,t),{...i,droppable:{...i.droppable,containers:n}}}case vi.SetDroppableDisabled:{const{id:t,key:r,disabled:n}=e,s=i.droppable.containers.get(t);if(!s||r!==s.key)return i;const a=new ru(i.droppable.containers);return a.set(t,{...s,disabled:n}),{...i,droppable:{...i.droppable,containers:a}}}case vi.UnregisterDroppable:{const{id:t,key:r}=e,n=i.droppable.containers.get(t);if(!n||r!==n.key)return i;const s=new ru(i.droppable.containers);return s.delete(t),{...i,droppable:{...i.droppable,containers:s}}}default:return i}}function Y8(i){let{disabled:e}=i;const{active:t,activatorEvent:r,draggableNodes:n}=S.useContext(dc),s=Rd(r),a=Rd(t==null?void 0:t.id);return S.useEffect(()=>{if(!e&&!r&&s&&a!=null){if(!Wf(s)||document.activeElement===s.target)return;const o=n.get(a);if(!o)return;const{activatorNode:l,node:u}=o;if(!l.current&&!u.current)return;requestAnimationFrame(()=>{for(const c of[l.current,u.current]){if(!c)continue;const h=U7(c);if(h){h.focus();break}}})}},[r,e,n,a,s]),null}function B2(i,e){let{transform:t,...r}=e;return i!=null&&i.length?i.reduce((n,s)=>s({transform:n,...r}),t):t}function X8(i){return S.useMemo(()=>({draggable:{...Fh.draggable,...i==null?void 0:i.draggable},droppable:{...Fh.droppable,...i==null?void 0:i.droppable},dragOverlay:{...Fh.dragOverlay,...i==null?void 0:i.dragOverlay}}),[i==null?void 0:i.draggable,i==null?void 0:i.droppable,i==null?void 0:i.dragOverlay])}function K8(i){let{activeNode:e,measure:t,initialRect:r,config:n=!0}=i;const s=S.useRef(!1),{x:a,y:o}=typeof n=="boolean"?{x:n,y:n}:n;ln(()=>{if(!a&&!o||!e){s.current=!1;return}if(s.current||!r)return;const u=e==null?void 0:e.node.current;if(!u||u.isConnected===!1)return;const c=t(u),h=f2(c,r);if(a||(h.x=0),o||(h.y=0),s.current=!0,Math.abs(h.x)>0||Math.abs(h.y)>0){const d=g2(u);d&&d.scrollBy({top:h.y,left:h.x})}},[e,a,o,r,t])}const jf=S.createContext({...Rn,scaleX:1,scaleY:1});var Hs;(function(i){i[i.Uninitialized=0]="Uninitialized",i[i.Initializing=1]="Initializing",i[i.Initialized=2]="Initialized"})(Hs||(Hs={}));const q8=S.memo(function(e){var t,r,n,s;let{id:a,accessibility:o,autoScroll:l=!0,children:u,sensors:c=U8,collisionDetection:h=n8,measuring:d,modifiers:f,...p}=e;const g=S.useReducer(j8,void 0,$8),[y,b]=g,[m,v]=X7(),[k,x]=S.useState(Hs.Uninitialized),C=k===Hs.Initialized,{draggable:{active:N,nodes:B,translate:E},droppable:{containers:O}}=y,z=N?B.get(N):null,J=S.useRef({initial:null,translated:null}),he=S.useMemo(()=>{var Ei;return N!=null?{id:N,data:(Ei=z==null?void 0:z.data)!=null?Ei:W8,rect:J}:null},[N,z]),oe=S.useRef(null),[ye,se]=S.useState(null),[K,U]=S.useState(null),Z=Du(p,Object.values(p)),re=hc("DndDescribedBy",a),ge=S.useMemo(()=>O.getEnabled(),[O]),G=X8(d),{droppableRects:q,measureDroppableContainers:ie,measuringScheduled:ae}=E8(ge,{dragging:C,dependencies:[E.x,E.y],config:G.droppable}),Re=P8(B,N),We=S.useMemo(()=>K?Ed(K):null,[K]),Xe=y_(),De=M8(Re,G.draggable.measure);K8({activeNode:N?B.get(N):null,config:Xe.layoutShiftCompensation,initialRect:De,measure:G.draggable.measure});const Ce=zw(Re,G.draggable.measure,De),Tt=zw(Re?Re.parentElement:null),rt=S.useRef({activatorEvent:null,active:null,activeNode:Re,collisionRect:null,collisions:null,droppableRects:q,draggableNodes:B,draggingNode:null,draggingNodeRect:null,droppableContainers:O,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Ot=O.getNodeFor((t=rt.current.over)==null?void 0:t.id),Ze=z8({measure:G.dragOverlay.measure}),Ct=(r=Ze.nodeRef.current)!=null?r:Re,nt=C?(n=Ze.rect)!=null?n:Ce:null,It=!!(Ze.nodeRef.current&&Ze.rect),zi=L8(It?null:Ce),Sr=k2(Ct?sr(Ct):null),Kt=D8(C?Ot??Re:null),Ve=H8(Kt),ui=B2(f,{transform:{x:E.x-zi.x,y:E.y-zi.y,scaleX:1,scaleY:1},activatorEvent:K,active:he,activeNodeRect:Ce,containerNodeRect:Tt,draggingNodeRect:nt,over:rt.current.over,overlayNodeRect:Ze.rect,scrollableAncestors:Kt,scrollableAncestorRects:Ve,windowRect:Sr}),yi=We?Wo(We,E):null,ar=F8(Kt),xr=Ww(ar),kr=Ww(ar,[Ce]),Os=Wo(ui,xr),$r=nt?o8(nt,ui):null,va=he&&$r?h({active:he,collisionRect:$r,droppableRects:q,droppableContainers:ge,pointerCoordinates:yi}):null,eb=d2(va,"id"),[Is,tb]=S.useState(null),d_=It?ui:Wo(ui,kr),f_=s8(d_,(s=Is==null?void 0:Is.rect)!=null?s:null,Ce),ib=S.useCallback((Ei,Tr)=>{let{sensor:Cr,options:Ls}=Tr;if(oe.current==null)return;const jr=B.get(oe.current);if(!jr)return;const cn=Ei.nativeEvent,Ln=new Cr({active:oe.current,activeNode:jr,event:cn,options:Ls,context:rt,onStart(hn){const vl=oe.current;if(vl==null)return;const wl=B.get(vl);if(!wl)return;const{onDragStart:kc}=Z.current,Tc={active:{id:vl,data:wl.data,rect:J}};wn.unstable_batchedUpdates(()=>{kc==null||kc(Tc),x(Hs.Initializing),b({type:vi.DragStart,initialCoordinates:hn,active:vl}),m({type:"onDragStart",event:Tc})})},onMove(hn){b({type:vi.DragMove,coordinates:hn})},onEnd:ao(vi.DragEnd),onCancel:ao(vi.DragCancel)});wn.unstable_batchedUpdates(()=>{se(Ln),U(Ei.nativeEvent)});function ao(hn){return async function(){const{active:wl,collisions:kc,over:Tc,scrollAdjustedTranslate:nb}=rt.current;let Sl=null;if(wl&&nb){const{cancelDrop:xl}=Z.current;Sl={activatorEvent:cn,active:wl,collisions:kc,delta:nb,over:Tc},hn===vi.DragEnd&&typeof xl=="function"&&await Promise.resolve(xl(Sl))&&(hn=vi.DragCancel)}oe.current=null,wn.unstable_batchedUpdates(()=>{b({type:hn}),x(Hs.Uninitialized),tb(null),se(null),U(null);const xl=hn===vi.DragEnd?"onDragEnd":"onDragCancel";if(Sl){const wp=Z.current[xl];wp==null||wp(Sl),m({type:xl,event:Sl})}})}}},[B]),p_=S.useCallback((Ei,Tr)=>(Cr,Ls)=>{const jr=Cr.nativeEvent,cn=B.get(Ls);if(oe.current!==null||!cn||jr.dndKit||jr.defaultPrevented)return;const Ln={active:cn};Ei(Cr,Tr.options,Ln)===!0&&(jr.dndKit={capturedBy:Tr.sensor},oe.current=Ls,ib(Cr,Tr))},[B,ib]),rb=R8(c,p_);A8(c),ln(()=>{Ce&&k===Hs.Initializing&&x(Hs.Initialized)},[Ce,k]),S.useEffect(()=>{const{onDragMove:Ei}=Z.current,{active:Tr,activatorEvent:Cr,collisions:Ls,over:jr}=rt.current;if(!Tr||!Cr)return;const cn={active:Tr,activatorEvent:Cr,collisions:Ls,delta:{x:Os.x,y:Os.y},over:jr};wn.unstable_batchedUpdates(()=>{Ei==null||Ei(cn),m({type:"onDragMove",event:cn})})},[Os.x,Os.y]),S.useEffect(()=>{const{active:Ei,activatorEvent:Tr,collisions:Cr,droppableContainers:Ls,scrollAdjustedTranslate:jr}=rt.current;if(!Ei||oe.current==null||!Tr||!jr)return;const{onDragOver:cn}=Z.current,Ln=Ls.get(eb),ao=Ln&&Ln.rect.current?{id:Ln.id,rect:Ln.rect.current,data:Ln.data,disabled:Ln.disabled}:null,hn={active:Ei,activatorEvent:Tr,collisions:Cr,delta:{x:jr.x,y:jr.y},over:ao};wn.unstable_batchedUpdates(()=>{tb(ao),cn==null||cn(hn),m({type:"onDragOver",event:hn})})},[eb]),ln(()=>{rt.current={activatorEvent:K,active:he,activeNode:Re,collisionRect:$r,collisions:va,droppableRects:q,draggableNodes:B,draggingNode:Ct,draggingNodeRect:nt,droppableContainers:O,over:Is,scrollableAncestors:Kt,scrollAdjustedTranslate:Os},J.current={initial:nt,translated:$r}},[he,Re,va,$r,B,Ct,nt,q,O,Is,Kt,Os]),N8({...Xe,delta:E,draggingRect:$r,pointerCoordinates:yi,scrollableAncestors:Kt,scrollableAncestorRects:Ve});const g_=S.useMemo(()=>({active:he,activeNode:Re,activeNodeRect:Ce,activatorEvent:K,collisions:va,containerNodeRect:Tt,dragOverlay:Ze,draggableNodes:B,droppableContainers:O,droppableRects:q,over:Is,measureDroppableContainers:ie,scrollableAncestors:Kt,scrollableAncestorRects:Ve,measuringConfiguration:G,measuringScheduled:ae,windowRect:Sr}),[he,Re,Ce,K,va,Tt,Ze,B,O,q,Is,ie,Kt,Ve,G,ae,Sr]),m_=S.useMemo(()=>({activatorEvent:K,activators:rb,active:he,activeNodeRect:Ce,ariaDescribedById:{draggable:re},dispatch:b,draggableNodes:B,over:Is,measureDroppableContainers:ie}),[K,rb,he,Ce,b,re,B,Is,ie]);return et.createElement(u2.Provider,{value:v},et.createElement(dc.Provider,{value:m_},et.createElement(N2.Provider,{value:g_},et.createElement(jf.Provider,{value:f_},u)),et.createElement(Y8,{disabled:(o==null?void 0:o.restoreFocus)===!1})),et.createElement(J7,{...o,hiddenTextDescribedById:re}));function y_(){const Ei=(ye==null?void 0:ye.autoScrollEnabled)===!1,Tr=typeof l=="object"?l.enabled===!1:l===!1,Cr=C&&!Ei&&!Tr;return typeof l=="object"?{...l,enabled:Cr}:{enabled:Cr}}}),J8=S.createContext(null),Gw="button",Q8="Droppable";function Z8(i){let{id:e,data:t,disabled:r=!1,attributes:n}=i;const s=hc(Q8),{activators:a,activatorEvent:o,active:l,activeNodeRect:u,ariaDescribedById:c,draggableNodes:h,over:d}=S.useContext(dc),{role:f=Gw,roleDescription:p="draggable",tabIndex:g=0}=n??{},y=(l==null?void 0:l.id)===e,b=S.useContext(y?jf:J8),[m,v]=Pd(),[k,x]=Pd(),C=V8(a,e),N=Du(t);ln(()=>(h.set(e,{id:e,key:s,node:m,activatorNode:k,data:N}),()=>{const E=h.get(e);E&&E.key===s&&h.delete(e)}),[h,e]);const B=S.useMemo(()=>({role:f,tabIndex:g,"aria-disabled":r,"aria-pressed":y&&f===Gw?!0:void 0,"aria-roledescription":p,"aria-describedby":c.draggable}),[r,f,g,y,p,c.draggable]);return{active:l,activatorEvent:o,activeNodeRect:u,attributes:B,isDragging:y,listeners:r?void 0:C,node:m,over:d,setNodeRef:v,setActivatorNodeRef:x,transform:b}}function _2(){return S.useContext(N2)}const eV="Droppable",tV={timeout:25};function iV(i){let{data:e,disabled:t=!1,id:r,resizeObserverConfig:n}=i;const s=hc(eV),{active:a,dispatch:o,over:l,measureDroppableContainers:u}=S.useContext(dc),c=S.useRef({disabled:t}),h=S.useRef(!1),d=S.useRef(null),f=S.useRef(null),{disabled:p,updateMeasurementsFor:g,timeout:y}={...tV,...n},b=Du(g??r),m=S.useCallback(()=>{if(!h.current){h.current=!0;return}f.current!=null&&clearTimeout(f.current),f.current=setTimeout(()=>{u(Array.isArray(b.current)?b.current:[b.current]),f.current=null},y)},[y]),v=$f({callback:m,disabled:p||!a}),k=S.useCallback((B,E)=>{v&&(E&&(v.unobserve(E),h.current=!1),B&&v.observe(B))},[v]),[x,C]=Pd(k),N=Du(e);return S.useEffect(()=>{!v||!x.current||(v.disconnect(),h.current=!1,v.observe(x.current))},[x,v]),ln(()=>(o({type:vi.RegisterDroppable,element:{id:r,key:s,disabled:t,node:x,rect:d,data:N}}),()=>o({type:vi.UnregisterDroppable,key:s,id:r})),[r]),S.useEffect(()=>{t!==c.current.disabled&&(o({type:vi.SetDroppableDisabled,id:r,key:s,disabled:t}),c.current.disabled=t)},[r,s,t,o]),{active:a,rect:d,isOver:(l==null?void 0:l.id)===r,node:x,over:l,setNodeRef:C}}function rV(i){let{animation:e,children:t}=i;const[r,n]=S.useState(null),[s,a]=S.useState(null),o=Rd(t);return!t&&!r&&o&&n(o),ln(()=>{if(!s)return;const l=r==null?void 0:r.key,u=r==null?void 0:r.props.id;if(l==null||u==null){n(null);return}Promise.resolve(e(u,s)).then(()=>{n(null)})},[e,r,s]),et.createElement(et.Fragment,null,t,r?S.cloneElement(r,{ref:a}):null)}const nV={x:0,y:0,scaleX:1,scaleY:1};function sV(i){let{children:e}=i;return et.createElement(dc.Provider,{value:C2},et.createElement(jf.Provider,{value:nV},e))}const aV={position:"fixed",touchAction:"none"},oV=i=>Wf(i)?"transform 250ms ease":void 0,lV=S.forwardRef((i,e)=>{let{as:t,activatorEvent:r,adjustScale:n,children:s,className:a,rect:o,style:l,transform:u,transition:c=oV}=i;if(!o)return null;const h=n?u:{...u,scaleX:1,scaleY:1},d={...aV,width:o.width,height:o.height,top:o.top,left:o.left,transform:ca.Transform.toString(h),transformOrigin:n&&r?Z7(r,o):void 0,transition:typeof c=="function"?c(r):c,...l};return et.createElement(t,{className:a,style:d,ref:e},s)}),uV=i=>e=>{let{active:t,dragOverlay:r}=e;const n={},{styles:s,className:a}=i;if(s!=null&&s.active)for(const[o,l]of Object.entries(s.active))l!==void 0&&(n[o]=t.node.style.getPropertyValue(o),t.node.style.setProperty(o,l));if(s!=null&&s.dragOverlay)for(const[o,l]of Object.entries(s.dragOverlay))l!==void 0&&r.node.style.setProperty(o,l);return a!=null&&a.active&&t.node.classList.add(a.active),a!=null&&a.dragOverlay&&r.node.classList.add(a.dragOverlay),function(){for(const[l,u]of Object.entries(n))t.node.style.setProperty(l,u);a!=null&&a.active&&t.node.classList.remove(a.active)}},cV=i=>{let{transform:{initial:e,final:t}}=i;return[{transform:ca.Transform.toString(e)},{transform:ca.Transform.toString(t)}]},hV={duration:250,easing:"ease",keyframes:cV,sideEffects:uV({styles:{active:{opacity:"0"}}})};function dV(i){let{config:e,draggableNodes:t,droppableContainers:r,measuringConfiguration:n}=i;return Uf((s,a)=>{if(e===null)return;const o=t.get(s);if(!o)return;const l=o.node.current;if(!l)return;const u=T2(a);if(!u)return;const{transform:c}=sr(a).getComputedStyle(a),h=p2(c);if(!h)return;const d=typeof e=="function"?e:fV(e);return S2(l,n.draggable.measure),d({active:{id:s,data:o.data,node:l,rect:n.draggable.measure(l)},draggableNodes:t,dragOverlay:{node:a,rect:n.dragOverlay.measure(u)},droppableContainers:r,measuringConfiguration:n,transform:h})})}function fV(i){const{duration:e,easing:t,sideEffects:r,keyframes:n}={...hV,...i};return s=>{let{active:a,dragOverlay:o,transform:l,...u}=s;if(!e)return;const c={x:o.rect.left-a.rect.left,y:o.rect.top-a.rect.top},h={scaleX:l.scaleX!==1?a.rect.width*l.scaleX/o.rect.width:1,scaleY:l.scaleY!==1?a.rect.height*l.scaleY/o.rect.height:1},d={x:l.x-c.x,y:l.y-c.y,...h},f=n({...u,active:a,dragOverlay:o,transform:{initial:l,final:d}}),[p]=f,g=f[f.length-1];if(JSON.stringify(p)===JSON.stringify(g))return;const y=r==null?void 0:r({active:a,dragOverlay:o,...u}),b=o.node.animate(f,{duration:e,easing:t,fill:"forwards"});return new Promise(m=>{b.onfinish=()=>{y==null||y(),m()}})}}let $w=0;function pV(i){return S.useMemo(()=>{if(i!=null)return $w++,$w},[i])}const gV=et.memo(i=>{let{adjustScale:e=!1,children:t,dropAnimation:r,style:n,transition:s,modifiers:a,wrapperElement:o="div",className:l,zIndex:u=999}=i;const{activatorEvent:c,active:h,activeNodeRect:d,containerNodeRect:f,draggableNodes:p,droppableContainers:g,dragOverlay:y,over:b,measuringConfiguration:m,scrollableAncestors:v,scrollableAncestorRects:k,windowRect:x}=_2(),C=S.useContext(jf),N=pV(h==null?void 0:h.id),B=B2(a,{activatorEvent:c,active:h,activeNodeRect:d,containerNodeRect:f,draggingNodeRect:y.rect,over:b,overlayNodeRect:y.rect,scrollableAncestors:v,scrollableAncestorRects:k,transform:C,windowRect:x}),E=g1(d),O=dV({config:r,draggableNodes:p,droppableContainers:g,measuringConfiguration:m}),z=E?y.setRef:void 0;return et.createElement(sV,null,et.createElement(rV,{animation:O},h&&N?et.createElement(lV,{key:N,id:h.id,ref:z,as:o,activatorEvent:c,adjustScale:e,className:l,transition:s,rect:E,style:{zIndex:u,...n},transform:B},t):null))});function P2(i,e,t){const r=i.slice();return r.splice(t<0?r.length+t:t,0,r.splice(e,1)[0]),r}function mV(i,e){return i.reduce((t,r,n)=>{const s=e.get(r);return s&&(t[n]=s),t},Array(i.length))}function Qc(i){return i!==null&&i>=0}function yV(i,e){if(i===e)return!0;if(i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(i[t]!==e[t])return!1;return!0}function bV(i){return typeof i=="boolean"?{draggable:i,droppable:i}:i}const m1=i=>{let{rects:e,activeIndex:t,overIndex:r,index:n}=i;const s=P2(e,r,t),a=e[n],o=s[n];return!o||!a?null:{x:o.left-a.left,y:o.top-a.top,scaleX:o.width/a.width,scaleY:o.height/a.height}},R2="Sortable",E2=et.createContext({activeIndex:-1,containerId:R2,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:m1,disabled:{draggable:!1,droppable:!1}});function vV(i){let{children:e,id:t,items:r,strategy:n=m1,disabled:s=!1}=i;const{active:a,dragOverlay:o,droppableRects:l,over:u,measureDroppableContainers:c}=_2(),h=hc(R2,t),d=o.rect!==null,f=S.useMemo(()=>r.map(C=>typeof C=="object"&&"id"in C?C.id:C),[r]),p=a!=null,g=a?f.indexOf(a.id):-1,y=u?f.indexOf(u.id):-1,b=S.useRef(f),m=!yV(f,b.current),v=y!==-1&&g===-1||m,k=bV(s);ln(()=>{m&&p&&c(f)},[m,f,p,c]),S.useEffect(()=>{b.current=f},[f]);const x=S.useMemo(()=>({activeIndex:g,containerId:h,disabled:k,disableTransforms:v,items:f,overIndex:y,useDragOverlay:d,sortedRects:mV(f,l),strategy:n}),[g,h,k.draggable,k.droppable,v,f,y,l,d,n]);return et.createElement(E2.Provider,{value:x},e)}const wV=i=>{let{id:e,items:t,activeIndex:r,overIndex:n}=i;return P2(t,r,n).indexOf(e)},SV=i=>{let{containerId:e,isSorting:t,wasDragging:r,index:n,items:s,newIndex:a,previousItems:o,previousContainerId:l,transition:u}=i;return!u||!r||o!==s&&n===a?!1:t?!0:a!==n&&e===l},xV={duration:200,easing:"ease"},M2="transform",kV=ca.Transition.toString({property:M2,duration:0,easing:"linear"}),TV={roleDescription:"sortable"};function CV(i){let{disabled:e,index:t,node:r,rect:n}=i;const[s,a]=S.useState(null),o=S.useRef(t);return ln(()=>{if(!e&&t!==o.current&&r.current){const l=n.current;if(l){const u=yl(r.current,{ignoreTransform:!0}),c={x:l.left-u.left,y:l.top-u.top,scaleX:l.width/u.width,scaleY:l.height/u.height};(c.x||c.y)&&a(c)}}t!==o.current&&(o.current=t)},[e,t,r,n]),S.useEffect(()=>{s&&a(null)},[s]),s}function NV(i){let{animateLayoutChanges:e=SV,attributes:t,disabled:r,data:n,getNewIndex:s=wV,id:a,strategy:o,resizeObserverConfig:l,transition:u=xV}=i;const{items:c,containerId:h,activeIndex:d,disabled:f,disableTransforms:p,sortedRects:g,overIndex:y,useDragOverlay:b,strategy:m}=S.useContext(E2),v=BV(r,f),k=c.indexOf(a),x=S.useMemo(()=>({sortable:{containerId:h,index:k,items:c},...n}),[h,n,k,c]),C=S.useMemo(()=>c.slice(c.indexOf(a)),[c,a]),{rect:N,node:B,isOver:E,setNodeRef:O}=iV({id:a,data:x,disabled:v.droppable,resizeObserverConfig:{updateMeasurementsFor:C,...l}}),{active:z,activatorEvent:J,activeNodeRect:he,attributes:oe,setNodeRef:ye,listeners:se,isDragging:K,over:U,setActivatorNodeRef:Z,transform:re}=Z8({id:a,data:x,attributes:{...TV,...t},disabled:v.draggable}),ge=A7(O,ye),G=!!z,q=G&&!p&&Qc(d)&&Qc(y),ie=!b&&K,ae=ie&&q?re:null,We=q?ae??(o??m)({rects:g,activeNodeRect:he,activeIndex:d,overIndex:y,index:k}):null,Xe=Qc(d)&&Qc(y)?s({id:a,items:c,activeIndex:d,overIndex:y}):k,De=z==null?void 0:z.id,Ce=S.useRef({activeId:De,items:c,newIndex:Xe,containerId:h}),Tt=c!==Ce.current.items,rt=e({active:z,containerId:h,isDragging:K,isSorting:G,id:a,index:k,items:c,newIndex:Ce.current.newIndex,previousItems:Ce.current.items,previousContainerId:Ce.current.containerId,transition:u,wasDragging:Ce.current.activeId!=null}),Ot=CV({disabled:!rt,index:k,node:B,rect:N});return S.useEffect(()=>{G&&Ce.current.newIndex!==Xe&&(Ce.current.newIndex=Xe),h!==Ce.current.containerId&&(Ce.current.containerId=h),c!==Ce.current.items&&(Ce.current.items=c)},[G,Xe,h,c]),S.useEffect(()=>{if(De===Ce.current.activeId)return;if(De&&!Ce.current.activeId){Ce.current.activeId=De;return}const Ct=setTimeout(()=>{Ce.current.activeId=De},50);return()=>clearTimeout(Ct)},[De]),{active:z,activeIndex:d,attributes:oe,data:x,rect:N,index:k,newIndex:Xe,items:c,isOver:E,isSorting:G,isDragging:K,listeners:se,node:B,overIndex:y,over:U,setNodeRef:ge,setActivatorNodeRef:Z,setDroppableNodeRef:O,setDraggableNodeRef:ye,transform:Ot??We,transition:Ze()};function Ze(){if(Ot||Tt&&Ce.current.newIndex===k)return kV;if(!(ie&&!Wf(J)||!u)&&(G||rt))return ca.Transition.toString({...u,property:M2})}}function BV(i,e){var t,r;return typeof i=="boolean"?{draggable:i,droppable:!1}:{draggable:(t=i==null?void 0:i.draggable)!=null?t:e.draggable,droppable:(r=i==null?void 0:i.droppable)!=null?r:e.droppable}}function Id(i){if(!i)return!1;const e=i.data.current;return!!(e&&"sortable"in e&&typeof e.sortable=="object"&&"containerId"in e.sortable&&"items"in e.sortable&&"index"in e.sortable)}const _V=[st.Down,st.Right,st.Up,st.Left],PV=(i,e)=>{let{context:{active:t,collisionRect:r,droppableRects:n,droppableContainers:s,over:a,scrollableAncestors:o}}=e;if(_V.includes(i.code)){if(i.preventDefault(),!t||!r)return;const l=[];s.getEnabled().forEach(h=>{if(!h||h!=null&&h.disabled)return;const d=n.get(h.id);if(d)switch(i.code){case st.Down:r.top<d.top&&l.push(h);break;case st.Up:r.top>d.top&&l.push(h);break;case st.Left:r.left>d.left&&l.push(h);break;case st.Right:r.left<d.left&&l.push(h);break}});const u=i8({active:t,collisionRect:r,droppableRects:n,droppableContainers:l,pointerCoordinates:null});let c=d2(u,"id");if(c===(a==null?void 0:a.id)&&u.length>1&&(c=u[1].id),c!=null){const h=s.get(t.id),d=s.get(c),f=d?n.get(d.id):null,p=d==null?void 0:d.node.current;if(p&&f&&h&&d){const y=Gf(p).some((C,N)=>o[N]!==C),b=O2(h,d),m=RV(h,d),v=y||!b?{x:0,y:0}:{x:m?r.width-f.width:0,y:m?r.height-f.height:0},k={x:f.left,y:f.top};return v.x&&v.y?k:Fu(k,v)}}}};function O2(i,e){return!Id(i)||!Id(e)?!1:i.data.current.sortable.containerId===e.data.current.sortable.containerId}function RV(i,e){return!Id(i)||!Id(e)||!O2(i,e)?!1:i.data.current.sortable.index<e.data.current.sortable.index}const EV=["#387BA8","#7A5265","#37A347","#A37F37","#6B37A3","#6C654B","#A3377A","#A36137","#A3A337","#37A391","#A34537","#29357A"].reduce((i,e,t)=>((xL[t]??[]).forEach(n=>{i[n]=e}),i),{}),MV=R`
  display: flex;
  flex-direction: column;
  align-items: center;
  flex: 1;
  border-radius: 10px;
  gap: 3px;
  height: 138px;
  padding: 12px 14px 8px 14px;
`,OV=({onHoverStatusChanged:i,color:e,children:t})=>{const r=()=>i==null?void 0:i(!0),n=()=>i==null?void 0:i(!1);return T.jsx("div",{className:MV,style:{background:e},onMouseEnter:r,onMouseLeave:n,children:t})},IV=R`
  display: flex;
  width: 100%;
  justify-content: space-between;
  flex-direction: row;
`,LV=R`
  display: flex;
  flex-direction: column;
  gap: 10px;
  margin-bottom: 4px;
`,DV=R`
  display: flex;
  width: 100%;
  justify-content: space-between;
  flex-direction: row;
  align-items: flex-end;
`,FV=R`
  cursor: pointer;
  color: #ffffffbb;
  &:hover {
    color: #ffffff;
  }
`,AV=R`
  height: 36px;
  width: 16px;
`,VV=({children:i})=>T.jsx("div",{className:IV,children:i}),HV=({children:i})=>T.jsx("div",{className:DV,children:i}),zV=({children:i})=>T.jsxs("div",{className:LV,children:[" ",i]}),UV=()=>T.jsx("div",{className:AV}),WV=({icon:i,visible:e,onClick:t,...r})=>T.jsx(i,{className:FV,onClick:t,style:{visibility:A(e)||e?"visible":"hidden"},...r});var ks={},Yf={};Object.defineProperty(Yf,"__esModule",{value:!0});Yf.PopoverPortal=void 0;var GV=S,$V=wn,jV=function(i){var e=i.container,t=i.element,r=i.scoutElement,n=i.children;return(0,GV.useLayoutEffect)(function(){return e.appendChild(t),e.appendChild(r),function(){e.removeChild(t),e.removeChild(r)}},[e,t,r]),(0,$V.createPortal)(n,t)};Yf.PopoverPortal=jV;var Xf={};(function(i){var e=gs&&gs.__assign||function(){return e=Object.assign||function(l){for(var u,c=1,h=arguments.length;c<h;c++){u=arguments[c];for(var d in u)Object.prototype.hasOwnProperty.call(u,d)&&(l[d]=u[d])}return l},e.apply(this,arguments)};Object.defineProperty(i,"__esModule",{value:!0}),i.getNudgedPopoverRect=i.getNewPopoverRect=i.popoverRectForPosition=i.createContainer=i.rectsAreEqual=i.createRect=i.EMPTY_RECT=void 0,i.EMPTY_RECT={top:0,left:0,right:0,bottom:0,width:0,height:0};var t=function(l){var u=l.top,c=l.left,h=l.width,d=l.height;return{top:u,left:c,width:h,height:d,right:c+h,bottom:u+d}};i.createRect=t;var r=function(l,u){return l===u||(l==null?void 0:l.bottom)===(u==null?void 0:u.bottom)&&(l==null?void 0:l.height)===(u==null?void 0:u.height)&&(l==null?void 0:l.left)===(u==null?void 0:u.left)&&(l==null?void 0:l.right)===(u==null?void 0:u.right)&&(l==null?void 0:l.top)===(u==null?void 0:u.top)&&(l==null?void 0:l.width)===(u==null?void 0:u.width)};i.rectsAreEqual=r;var n=function(l){var u=l.containerStyle,c=l.containerClassName,h=l.id,d=window.document.createElement("div");return d.id=h,c&&(d.className=c),Object.assign(d.style,u),d};i.createContainer=n;var s=function(l,u,c,h,d){var f=u.left+u.width/2,p=u.top+u.height/2,g=c.width,y=c.height,b,m;switch(l){case"left":b=p-y/2,m=u.left-h-g,d==="start"&&(b=u.top),d==="end"&&(b=u.bottom-y);break;case"bottom":b=u.bottom+h,m=f-g/2,d==="start"&&(m=u.left),d==="end"&&(m=u.right-g);break;case"right":b=p-y/2,m=u.right+h,d==="start"&&(b=u.top),d==="end"&&(b=u.bottom-y);break;default:b=u.top-y-h,m=f-g/2,d==="start"&&(m=u.left),d==="end"&&(m=u.right-g);break}return(0,i.createRect)({left:m,top:b,width:g,height:y})};i.popoverRectForPosition=s;var a=function(l,u){var c=l.position,h=l.align,d=l.childRect,f=l.popoverRect,p=l.boundaryRect,g=l.padding,y=l.reposition,b=(0,i.popoverRectForPosition)(c,d,f,g,h),m=y&&(c==="top"&&b.top<p.top+u||c==="left"&&b.left<p.left+u||c==="right"&&b.right>p.right-u||c==="bottom"&&b.bottom>p.bottom-u);return{rect:b,boundaryViolation:m}};i.getNewPopoverRect=a;var o=function(l,u,c){var h=u.top+c,d=u.left+c,f=u.right-c,p=u.bottom-c,g=l.top<h?h:l.top;g=g+l.height>p?p-l.height:g;var y=l.left<d?d:l.left;return y=y+l.width>f?f-l.width:y,(0,i.createRect)(e(e({},l),{top:g,left:y}))};i.getNudgedPopoverRect=o})(Xf);var Kf={},qf={};Object.defineProperty(qf,"__esModule",{value:!0});qf.useElementRef=void 0;var jw=S,YV=Xf,XV=function(i){var e=i.containerClassName,t=i.containerStyle,r=i.id,n=(0,jw.useRef)(),s=(0,jw.useMemo)(function(){return(0,YV.createContainer)({containerStyle:t,containerClassName:e,id:r})},[e,t,r]);return n.current=s,n};qf.useElementRef=XV;Object.defineProperty(Kf,"__esModule",{value:!0});Kf.usePopover=void 0;var KV=S,co=Xf,Yw=qf,qV={position:"fixed",overflow:"visible",top:"0px",left:"0px"},JV={position:"fixed",top:"0px",left:"0px",width:"0px",height:"0px",visibility:"hidden"},QV=function(i){var e=i.isOpen,t=i.childRef,r=i.positions,n=i.containerClassName,s=i.parentElement,a=i.transform,o=i.transformMode,l=i.align,u=i.padding,c=i.reposition,h=i.boundaryInset,d=i.boundaryElement,f=i.onPositionPopover,p=(0,Yw.useElementRef)({id:"react-tiny-popover-scout",containerStyle:JV}),g=(0,Yw.useElementRef)({id:"react-tiny-popover-container",containerClassName:n,containerStyle:qV}),y=(0,KV.useCallback)(function(b){var m,v,k=b===void 0?{}:b,x=k.positionIndex,C=x===void 0?0:x,N=k.parentRect,B=N===void 0?s.getBoundingClientRect():N,E=k.childRect,O=E===void 0?(m=t==null?void 0:t.current)===null||m===void 0?void 0:m.getBoundingClientRect():E,z=k.scoutRect,J=z===void 0?(v=p==null?void 0:p.current)===null||v===void 0?void 0:v.getBoundingClientRect():z,he=k.popoverRect,oe=he===void 0?g.current.getBoundingClientRect():he,ye=k.boundaryRect,se=ye===void 0?d===s?B:d.getBoundingClientRect():ye;if(!(!O||!B||!e)){if(a&&o==="absolute"){var K=typeof a=="function"?a({childRect:O,popoverRect:oe,parentRect:B,boundaryRect:se,padding:u,align:l,nudgedTop:0,nudgedLeft:0,boundaryInset:h,violations:co.EMPTY_RECT,hasViolations:!1}):a,U=K.top,Z=K.left,re=Math.round(B.left+Z-J.left),ge=Math.round(B.top+U-J.top);g.current.style.transform="translate(".concat(re,"px, ").concat(ge,"px)"),f({childRect:O,popoverRect:(0,co.createRect)({left:re,top:ge,width:oe.width,height:oe.height}),parentRect:B,boundaryRect:se,padding:u,align:l,transform:{top:U,left:Z},nudgedTop:0,nudgedLeft:0,boundaryInset:h,violations:co.EMPTY_RECT,hasViolations:!1});return}var G=C===r.length,q=G?r[0]:r[C],ie=(0,co.getNewPopoverRect)({childRect:O,popoverRect:oe,boundaryRect:se,position:q,align:l,padding:u,reposition:c},h),ae=ie.rect,Re=ie.boundaryViolation;if(Re&&c&&!G){y({positionIndex:C+1,childRect:O,popoverRect:oe,parentRect:B,boundaryRect:se});return}var We=ae.top,Xe=ae.left,De=ae.width,Ce=ae.height,Tt=c&&!G,rt=(0,co.getNudgedPopoverRect)(ae,se,h),Ot=rt.left,Ze=rt.top,Ct=We,nt=Xe;Tt&&(Ct=Ze,nt=Ot),Ct=Math.round(Ct-J.top),nt=Math.round(nt-J.left),g.current.style.transform="translate(".concat(nt,"px, ").concat(Ct,"px)");var It={top:se.top+h-Ct,left:se.left+h-nt,right:nt+De-se.right+h,bottom:Ct+Ce-se.bottom+h},zi={childRect:O,popoverRect:(0,co.createRect)({left:nt,top:Ct,width:De,height:Ce}),parentRect:B,boundaryRect:se,position:q,align:l,padding:u,nudgedTop:Ze-We,nudgedLeft:Ot-Xe,boundaryInset:h,violations:{top:It.top<=0?0:It.top,left:It.left<=0?0:It.left,right:It.right<=0?0:It.right,bottom:It.bottom<=0?0:It.bottom},hasViolations:It.top>0||It.left>0||It.right>0||It.bottom>0};if(a){f(zi);var Sr=typeof a=="function"?a(zi):a,Kt=Sr.top,Ve=Sr.left;g.current.style.transform="translate(".concat(Math.round(nt+(Ve??0)),"px, ").concat(Math.round(Ct+(Kt??0)),"px)"),zi.nudgedLeft+=Ve??0,zi.nudgedTop+=Kt??0,zi.transform={top:Kt,left:Ve}}f(zi)}},[s,t,p,g,d,e,a,o,r,l,u,c,h,f]);return{positionPopover:y,popoverRef:g,scoutRef:p}};Kf.usePopover=QV;var Jf={};Object.defineProperty(Jf,"__esModule",{value:!0});Jf.useMemoizedArray=void 0;var Xw=S,ZV=function(i){var e=(0,Xw.useRef)(i),t=(0,Xw.useMemo)(function(){if(e.current===i)return e.current;if(e.current.length!==i.length)return e.current=i,i;for(var r=0;r<i.length;r+=1)if(i[r]!==e.current[r])return e.current=i,i;return e.current},[i]);return t};Jf.useMemoizedArray=ZV;var fc={},s0=gs&&gs.__assign||function(){return s0=Object.assign||function(i){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n])}return i},s0.apply(this,arguments)};Object.defineProperty(fc,"__esModule",{value:!0});fc.useArrowContainer=void 0;var Kw=S,eH=function(i){var e=i.childRect,t=i.popoverRect,r=i.position,n=i.arrowSize,s=i.arrowColor,a=(0,Kw.useMemo)(function(){return{padding:n}},[n]),o=(0,Kw.useMemo)(function(){return s0({position:"absolute"},function(){var l=n*2,u=e.top-t.top+e.height/2-l/2,c=e.left-t.left+e.width/2-l/2,h=n,d=t.width-n,f=t.height-n;switch(c=c<h?h:c,c=c+l>d?d-l:c,u=u<h?h:u,u=u+l>f?f-l:u,u=Number.isNaN(u)?0:u,c=Number.isNaN(c)?0:c,r){case"right":return{borderTop:"".concat(n,"px solid transparent"),borderBottom:"".concat(n,"px solid transparent"),borderRight:"".concat(n,"px solid ").concat(s),left:0,top:u};case"left":return{borderTop:"".concat(n,"px solid transparent"),borderBottom:"".concat(n,"px solid transparent"),borderLeft:"".concat(n,"px solid ").concat(s),right:0,top:u};case"bottom":return{borderLeft:"".concat(n,"px solid transparent"),borderRight:"".concat(n,"px solid transparent"),borderBottom:"".concat(n,"px solid ").concat(s),top:0,left:c};case"top":return{borderLeft:"".concat(n,"px solid transparent"),borderRight:"".concat(n,"px solid transparent"),borderTop:"".concat(n,"px solid ").concat(s),bottom:0,left:c};default:return{display:"hidden"}}}())},[s,n,e.height,e.left,e.top,e.width,t.height,t.left,t.top,t.width,r]);return{arrowContainerStyle:a,arrowStyle:o}};fc.useArrowContainer=eH;var Qf={},Eo=gs&&gs.__assign||function(){return Eo=Object.assign||function(i){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n])}return i},Eo.apply(this,arguments)};Object.defineProperty(Qf,"__esModule",{value:!0});Qf.ArrowContainer=void 0;var qw=T,Jw=S,tH=fc,iH=function(i){var e=i.childRect,t=i.popoverRect,r=i.position,n=i.arrowColor,s=i.arrowSize,a=i.arrowClassName,o=i.arrowStyle,l=i.className,u=i.children,c=i.style,h=(0,tH.useArrowContainer)({childRect:e,popoverRect:t,position:r,arrowColor:n,arrowSize:s}),d=h.arrowContainerStyle,f=h.arrowStyle,p=(0,Jw.useMemo)(function(){return Eo(Eo({},d),c)},[d,c]),g=(0,Jw.useMemo)(function(){return Eo(Eo({},f),o)},[f,o]);return(0,qw.jsxs)("div",{className:l,style:p,children:[(0,qw.jsx)("div",{style:g,className:a}),u]})};Qf.ArrowContainer=iH;(function(i){var e=gs&&gs.__assign||function(){return e=Object.assign||function(d){for(var f,p=1,g=arguments.length;p<g;p++){f=arguments[p];for(var y in f)Object.prototype.hasOwnProperty.call(f,y)&&(d[y]=f[y])}return d},e.apply(this,arguments)};Object.defineProperty(i,"__esModule",{value:!0}),i.Popover=i.usePopover=i.ArrowContainer=i.useArrowContainer=void 0;var t=T,r=S,n=Yf,s=Xf,a=Kf;Object.defineProperty(i,"usePopover",{enumerable:!0,get:function(){return a.usePopover}});var o=Jf,l=fc;Object.defineProperty(i,"useArrowContainer",{enumerable:!0,get:function(){return l.useArrowContainer}});var u=Qf;Object.defineProperty(i,"ArrowContainer",{enumerable:!0,get:function(){return u.ArrowContainer}});var c=["top","left","right","bottom"],h=(0,r.forwardRef)(function(d,f){var p=d.isOpen,g=d.children,y=d.content,b=d.positions,m=b===void 0?c:b,v=d.align,k=v===void 0?"center":v,x=d.padding,C=x===void 0?0:x,N=d.reposition,B=N===void 0?!0:N,E=d.parentElement,O=E===void 0?window.document.body:E,z=d.boundaryElement,J=z===void 0?O:z,he=d.containerClassName,oe=d.containerStyle,ye=d.transform,se=d.transformMode,K=se===void 0?"absolute":se,U=d.boundaryInset,Z=U===void 0?0:U,re=d.onClickOutside,ge=d.clickOutsideCapture,G=ge===void 0?!1:ge,q=(0,o.useMemoizedArray)(Array.isArray(m)?m:[m]),ie=(0,r.useRef)(!1),ae=(0,r.useRef)(),Re=(0,r.useRef)(B),We=(0,r.useRef)(),Xe=(0,r.useState)({align:k,nudgedLeft:0,nudgedTop:0,position:q[0],padding:C,childRect:s.EMPTY_RECT,popoverRect:s.EMPTY_RECT,parentRect:s.EMPTY_RECT,boundaryRect:s.EMPTY_RECT,boundaryInset:Z,violations:s.EMPTY_RECT,hasViolations:!1}),De=Xe[0],Ce=Xe[1],Tt=(0,r.useCallback)(function(Ve){return Ce(Ve)},[]),rt=(0,a.usePopover)({isOpen:p,childRef:We,containerClassName:he,parentElement:O,boundaryElement:J,transform:ye,transformMode:K,positions:q,align:k,padding:C,boundaryInset:Z,reposition:B,onPositionPopover:Tt}),Ot=rt.positionPopover,Ze=rt.popoverRef,Ct=rt.scoutRef;(0,r.useLayoutEffect)(function(){var Ve=!0,ui=function(){var yi,ar;if(p&&Ve){var xr=(yi=We==null?void 0:We.current)===null||yi===void 0?void 0:yi.getBoundingClientRect(),kr=(ar=Ze==null?void 0:Ze.current)===null||ar===void 0?void 0:ar.getBoundingClientRect();xr!=null&&kr!=null&&(!(0,s.rectsAreEqual)(xr,De.childRect)||kr.width!==De.popoverRect.width||kr.height!==De.popoverRect.height||De.padding!==C||De.align!==k||q!==ae.current||B!==Re.current)&&Ot(),q!==ae.current&&(ae.current=q),B!==Re.current&&(Re.current=B),Ve&&window.requestAnimationFrame(ui)}ie.current=p};return window.requestAnimationFrame(ui),function(){Ve=!1}},[k,p,C,Ze,De.align,De.childRect,De.padding,De.popoverRect.height,De.popoverRect.width,Ot,q,B]),(0,r.useEffect)(function(){var Ve=Ze.current;return Object.assign(Ve.style,oe),function(){Object.keys(oe??{}).forEach(function(ui){return delete Ve.style[ui]})}},[oe,p,Ze]);var nt=(0,r.useCallback)(function(Ve){var ui,yi;p&&!(!((ui=Ze.current)===null||ui===void 0)&&ui.contains(Ve.target))&&!(!((yi=We.current)===null||yi===void 0)&&yi.contains(Ve.target))&&(re==null||re(Ve))},[p,re,Ze]),It=(0,r.useCallback)(function(){We.current&&window.requestAnimationFrame(function(){return Ot()})},[Ot]);(0,r.useEffect)(function(){var Ve=O.ownerDocument.body;return Ve.addEventListener("click",nt,G),Ve.addEventListener("contextmenu",nt,G),Ve.addEventListener("resize",It),function(){Ve.removeEventListener("click",nt,G),Ve.removeEventListener("contextmenu",nt,G),Ve.removeEventListener("resize",It)}},[G,nt,It,O]);var zi=(0,r.useCallback)(function(Ve){We.current=Ve,f!=null&&(typeof f=="object"?f.current=Ve:typeof f=="function"&&f(Ve))},[f]),Sr=function(){return(0,r.cloneElement)(g,{ref:zi})},Kt=function(){return p?(0,t.jsx)(n.PopoverPortal,{element:Ze.current,scoutElement:Ct.current,container:O,children:typeof y=="function"?y(De):y}):null};return(0,t.jsxs)(t.Fragment,{children:[Sr(),Kt()]})});i.Popover=(0,r.forwardRef)(function(d,f){return typeof window>"u"?d.children:(0,t.jsx)(h,e({},d,{ref:f}))})})(ks);const rH=R`
  width: 100%;
  height: 300px;
  padding-bottom: 30px;
  overflow: auto;
  display: flex;
  flex-direction: column;
`,nH=R`
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  gap: 10px;
  padding: 40px 14px;
  align-items: center;
  justify-content: flex-start;
  color: #ffffff99;
`,sH=R`
  font-size: 3em;
`,aH=R`
  font-size: 0.9em;
  text-align: center;
`,oH=R`
  display: block;
  padding-left: 14px;
  padding-right: 14px;
  margin: 14px;
  width: calc(100% - (14px * 2));
  background-color: #ffffff15;
  border: none;
  border-radius: 18px;
  height: 36px;
  font-size: 1em;
  color: #ffffff;
  outline: none;
  &:focus {
    outline: none;
    border: none;
    background-color: #ffffff30;
  }
`,lH=R`
  text-transform: uppercase;
  font-size: 0.8em;
  font-weight: bold;
  padding: 4px 10px;
  color: #ffffff99;
  background-color: #ffffff10;
`,Qw=R`
  padding: 6px 10px;
  color: #ffffff;
  font-size: 1em;
  cursor: pointer;
  &:hover {
    background-color: #ffffff25;
  }
`,uH=R`
  height: 40px;
  border-radius: 20px;
  margin: 20px 10px;
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: center;
  align-self: center;
  justify-self: flex-end;
  border: none;
  color: #ffffffdd;
  padding: 0px 20px;
  gap: 6px;
  cursor: pointer;
  font-size: 1em;
  background-color: #ffffff20;
  &:hover {
    color: #fff;
    background-color: #ffffff30;
  }
  &:disabled {
    background-color: transparent;
    color: #ffffff50;
    cursor: not-allowed;
  }
`;function Zf({categories:i,noHitsLabel:e,canCreate:t,canSearch:r,createLabel:n,showCategories:s=!0,getChildren:a,getCategoryKey:o,getCategoryLabel:l,getCategoryIcon:u,getItemKey:c,getItemLabel:h,getItemIcon:d,getHyperLink:f,onItemClick:p,onCreate:g,matches:y}){const{t:b}=vt(),[m,v]=S.useState(""),k=N=>v(N.target.value),x=N=>()=>p(N),C=S.useMemo(()=>{const N=[];for(let B of i){const E=a(B).filter(O=>y(O,m));E.length>0&&N.push([B,E])}return N},[i,a,m,y]);return T.jsxs(T.Fragment,{children:[r&&T.jsx("input",{type:"text",className:oH,placeholder:b("Progression.Search"),value:m,onChange:k}),T.jsxs("div",{className:rH,children:[C.length===0&&T.jsxs("div",{className:nH,children:[T.jsx(Vf,{className:sH}),T.jsx("span",{className:aH,children:e})]}),C.map(([N,B])=>{const E=A(u)?null:u(N);return T.jsxs(S.Fragment,{children:[s&&T.jsxs("div",{className:lH,children:[E&&T.jsx(E,{}),l(N)]}),B.map(O=>{const z=A(d)?null:d(O),J=c(O),he=h(O),oe=x(O);if(A(f))return T.jsxs("div",{className:Qw,onClick:oe,children:[z&&T.jsx(z,{}),he]},J);const ye=f(O);return T.jsxs(ua,{to:ye,className:Qw,onClick:oe,children:[z&&T.jsx(z,{}),he]},J)})]},o(N))}),t&&T.jsxs("button",{className:uH,onClick:g,children:[T.jsx(Qy,{})," ",n]})]})]})}const cH=i=>i,hH=i=>"notes",dH=i=>i.toString(),fH=i=>i,pH=(i,e)=>!0,gH=({onChange:i,values:e})=>{const{t}=vt(),r=S.useMemo(()=>[e],[e]),n=S.useCallback(s=>t("Progression.SelectRootNote"),[t]);return T.jsx(Zf,{categories:r,canSearch:!1,canCreate:!1,onItemClick:i,getChildren:cH,getCategoryKey:hH,getCategoryLabel:n,getItemKey:dH,getItemLabel:fH,matches:pH,noHitsLabel:""})},mH=R`
  cursor: pointer;
  padding: 0px 6px;
  border-radius: 6px;
  color: #ffffffbb;
  border: none;
  background-color: transparent;
  white-space: nowrap;
  &:hover,
  &:focus {
    border: none;
    background-color: #ffffff40;
    color: #ffffff;
  }
`,yH=R`
  background-color: #181818;
  border-radius: 12px;
  width: 160px;
  height: 140px;
  overflow: hidden;
  box-shadow: rgba(0, 0, 0, 0.2) 0px 2px 12px;
`,bH=({root:i,values:e,onChange:t})=>{const[r,n]=S.useState(!1),{t:s}=vt(),a=()=>n(!1),o=()=>n(!0),l=u=>{t(u),a()};return T.jsx(ks.Popover,{isOpen:r,onClickOutside:a,clickOutsideCapture:!0,positions:["bottom","right","left"],content:({position:u,childRect:c,popoverRect:h})=>T.jsx(ks.ArrowContainer,{position:u,childRect:c,popoverRect:h,arrowColor:"#181818",arrowSize:10,children:T.jsx("div",{className:yH,children:T.jsx(gH,{values:e,root:i,onChange:l})})}),children:T.jsxs("button",{className:mH,onClick:o,tabIndex:-1,"data-tooltip":"Tooltips.Progression.SelectRoot",children:[s("Progression.Root"),": ",i]})})},vH=[[1,2,4,void 0]],wH=i=>i,SH=()=>"counts",xH=i=>A(i)?"default":i.toString(),kH=()=>!0,TH=({onChange:i,progressionNoteCount:e})=>{const{t}=vt(),r=S.useCallback(()=>t("Progression.SelectNoteCount"),[t]),n=S.useCallback(s=>{const a=t("Progression.Notes"),o=t("Progression.Default");return A(s)?`${o} (${e} ${a})`:`${s} ${a}`},[e]);return T.jsx(Zf,{categories:vH,canSearch:!1,canCreate:!1,onItemClick:i,getChildren:wH,getCategoryKey:SH,getCategoryLabel:r,getItemKey:xH,getItemLabel:n,matches:kH,noHitsLabel:""})},I2=R`
  cursor: pointer;
  padding: 0px 6px;
  border-radius: 6px;
  color: #ffffffbb;
  border: none;
  background-color: transparent;
  white-space: nowrap;
  &:hover,
  &:focus {
    border: none;
    background-color: #ffffff40;
    color: #ffffff;
  }
`,CH=mi(I2,R`
    background-color: #ffffff30;
    color: #ffffff;
    font-weight: 500;
    &:hover,
    &:focus {
      border: none;
      background-color: #ffffff40;
      color: #ffffff;
    }
  `),NH=R`
  background-color: #181818;
  border-radius: 12px;
  width: 190px;
  height: 180px;
  overflow: hidden;
  box-shadow: rgba(0, 0, 0, 0.2) 0px 2px 12px;
`,BH=({noteCount:i,progressionNoteCount:e,onChange:t})=>{const[r,n]=S.useState(!1),{t:s}=vt(),a=()=>n(!1),o=()=>n(!0),l=d=>{t(d),a()},u=A(i),c=u?e:i,h=u?I2:CH;return T.jsx(ks.Popover,{isOpen:r,onClickOutside:a,clickOutsideCapture:!0,positions:["bottom","right","left"],content:({position:d,childRect:f,popoverRect:p})=>T.jsx(ks.ArrowContainer,{position:d,childRect:f,popoverRect:p,arrowColor:"#181818",arrowSize:10,children:T.jsx("div",{className:NH,children:T.jsx(TH,{noteCount:i,progressionNoteCount:e,onChange:l})})}),children:T.jsxs("button",{className:h,onClick:o,tabIndex:-1,"data-tooltip":"Tooltips.Progression.SelectNoteCount",children:[c," ",s("Progression.Notes")]})})},L2=RC.flatMap(i=>CL.map(e=>[i,e])),_H=L2.map(([i,e])=>il({name:i,type:e,root:`${i}0`})),PH=L2.reduce((i,e)=>{const[t,r]=e,n=il({name:t,type:r,root:`${t}0`}).toLowerCase();return i.set(n,e),i},new Map);var D2={exports:{}},RH="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",EH=RH,MH=EH;function F2(){}function A2(){}A2.resetWarningCache=F2;var OH=function(){function i(r,n,s,a,o,l){if(l!==MH){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}i.isRequired=i;function e(){return i}var t={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:e,element:i,elementType:i,instanceOf:e,node:i,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:A2,resetWarningCache:F2};return t.PropTypes=t,t};D2.exports=OH();var IH=D2.exports;const Ee=ec(IH);var wt={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var y1=Symbol.for("react.element"),b1=Symbol.for("react.portal"),ep=Symbol.for("react.fragment"),tp=Symbol.for("react.strict_mode"),ip=Symbol.for("react.profiler"),rp=Symbol.for("react.provider"),np=Symbol.for("react.context"),LH=Symbol.for("react.server_context"),sp=Symbol.for("react.forward_ref"),ap=Symbol.for("react.suspense"),op=Symbol.for("react.suspense_list"),lp=Symbol.for("react.memo"),up=Symbol.for("react.lazy"),DH=Symbol.for("react.offscreen"),V2;V2=Symbol.for("react.module.reference");function un(i){if(typeof i=="object"&&i!==null){var e=i.$$typeof;switch(e){case y1:switch(i=i.type,i){case ep:case ip:case tp:case ap:case op:return i;default:switch(i=i&&i.$$typeof,i){case LH:case np:case sp:case up:case lp:case rp:return i;default:return e}}case b1:return e}}}wt.ContextConsumer=np;wt.ContextProvider=rp;wt.Element=y1;wt.ForwardRef=sp;wt.Fragment=ep;wt.Lazy=up;wt.Memo=lp;wt.Portal=b1;wt.Profiler=ip;wt.StrictMode=tp;wt.Suspense=ap;wt.SuspenseList=op;wt.isAsyncMode=function(){return!1};wt.isConcurrentMode=function(){return!1};wt.isContextConsumer=function(i){return un(i)===np};wt.isContextProvider=function(i){return un(i)===rp};wt.isElement=function(i){return typeof i=="object"&&i!==null&&i.$$typeof===y1};wt.isForwardRef=function(i){return un(i)===sp};wt.isFragment=function(i){return un(i)===ep};wt.isLazy=function(i){return un(i)===up};wt.isMemo=function(i){return un(i)===lp};wt.isPortal=function(i){return un(i)===b1};wt.isProfiler=function(i){return un(i)===ip};wt.isStrictMode=function(i){return un(i)===tp};wt.isSuspense=function(i){return un(i)===ap};wt.isSuspenseList=function(i){return un(i)===op};wt.isValidElementType=function(i){return typeof i=="string"||typeof i=="function"||i===ep||i===ip||i===tp||i===ap||i===op||i===DH||typeof i=="object"&&i!==null&&(i.$$typeof===up||i.$$typeof===lp||i.$$typeof===rp||i.$$typeof===np||i.$$typeof===sp||i.$$typeof===V2||i.getModuleId!==void 0)};wt.typeOf=un;const Zw=i=>typeof i=="object"&&i!=null&&i.nodeType===1,eS=(i,e)=>(!e||i!=="hidden")&&i!=="visible"&&i!=="clip",fg=(i,e)=>{if(i.clientHeight<i.scrollHeight||i.clientWidth<i.scrollWidth){const t=getComputedStyle(i,null);return eS(t.overflowY,e)||eS(t.overflowX,e)||(r=>{const n=(s=>{if(!s.ownerDocument||!s.ownerDocument.defaultView)return null;try{return s.ownerDocument.defaultView.frameElement}catch{return null}})(r);return!!n&&(n.clientHeight<r.scrollHeight||n.clientWidth<r.scrollWidth)})(i)}return!1},Zc=(i,e,t,r,n,s,a,o)=>s<i&&a>e||s>i&&a<e?0:s<=i&&o<=t||a>=e&&o>=t?s-i-r:a>e&&o<t||s<i&&o>t?a-e+n:0,FH=i=>{const e=i.parentElement;return e??(i.getRootNode().host||null)},AH=(i,e)=>{var t,r,n,s;if(typeof document>"u")return[];const{scrollMode:a,block:o,inline:l,boundary:u,skipOverflowHiddenElements:c}=e,h=typeof u=="function"?u:se=>se!==u;if(!Zw(i))throw new TypeError("Invalid target");const d=document.scrollingElement||document.documentElement,f=[];let p=i;for(;Zw(p)&&h(p);){if(p=FH(p),p===d){f.push(p);break}p!=null&&p===document.body&&fg(p)&&!fg(document.documentElement)||p!=null&&fg(p,c)&&f.push(p)}const g=(r=(t=window.visualViewport)==null?void 0:t.width)!=null?r:innerWidth,y=(s=(n=window.visualViewport)==null?void 0:n.height)!=null?s:innerHeight,{scrollX:b,scrollY:m}=window,{height:v,width:k,top:x,right:C,bottom:N,left:B}=i.getBoundingClientRect(),{top:E,right:O,bottom:z,left:J}=(se=>{const K=window.getComputedStyle(se);return{top:parseFloat(K.scrollMarginTop)||0,right:parseFloat(K.scrollMarginRight)||0,bottom:parseFloat(K.scrollMarginBottom)||0,left:parseFloat(K.scrollMarginLeft)||0}})(i);let he=o==="start"||o==="nearest"?x-E:o==="end"?N+z:x+v/2-E+z,oe=l==="center"?B+k/2-J+O:l==="end"?C+O:B-J;const ye=[];for(let se=0;se<f.length;se++){const K=f[se],{height:U,width:Z,top:re,right:ge,bottom:G,left:q}=K.getBoundingClientRect();if(a==="if-needed"&&x>=0&&B>=0&&N<=y&&C<=g&&x>=re&&N<=G&&B>=q&&C<=ge)return ye;const ie=getComputedStyle(K),ae=parseInt(ie.borderLeftWidth,10),Re=parseInt(ie.borderTopWidth,10),We=parseInt(ie.borderRightWidth,10),Xe=parseInt(ie.borderBottomWidth,10);let De=0,Ce=0;const Tt="offsetWidth"in K?K.offsetWidth-K.clientWidth-ae-We:0,rt="offsetHeight"in K?K.offsetHeight-K.clientHeight-Re-Xe:0,Ot="offsetWidth"in K?K.offsetWidth===0?0:Z/K.offsetWidth:0,Ze="offsetHeight"in K?K.offsetHeight===0?0:U/K.offsetHeight:0;if(d===K)De=o==="start"?he:o==="end"?he-y:o==="nearest"?Zc(m,m+y,y,Re,Xe,m+he,m+he+v,v):he-y/2,Ce=l==="start"?oe:l==="center"?oe-g/2:l==="end"?oe-g:Zc(b,b+g,g,ae,We,b+oe,b+oe+k,k),De=Math.max(0,De+m),Ce=Math.max(0,Ce+b);else{De=o==="start"?he-re-Re:o==="end"?he-G+Xe+rt:o==="nearest"?Zc(re,G,U,Re,Xe+rt,he,he+v,v):he-(re+U/2)+rt/2,Ce=l==="start"?oe-q-ae:l==="center"?oe-(q+Z/2)+Tt/2:l==="end"?oe-ge+We+Tt:Zc(q,ge,Z,ae,We+Tt,oe,oe+k,k);const{scrollLeft:Ct,scrollTop:nt}=K;De=Ze===0?0:Math.max(0,Math.min(nt+De/Ze,K.scrollHeight-U/Ze+rt)),Ce=Ot===0?0:Math.max(0,Math.min(Ct+Ce/Ot,K.scrollWidth-Z/Ot+Tt)),he+=nt-De,oe+=Ct-Ce}ye.push({el:K,top:De,left:Ce})}return ye};var rl=function(){return rl=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},rl.apply(this,arguments)};var VH=0;function H2(){}function HH(i,e){if(i){var t=AH(i,{boundary:e,block:"nearest",scrollMode:"if-needed"});t.forEach(function(r){var n=r.el,s=r.top,a=r.left;n.scrollTop=s,n.scrollLeft=a})}}function tS(i,e,t){var r=i===e||e instanceof t.Node&&i.contains&&i.contains(e);return r}function z2(i,e){var t;function r(){t&&clearTimeout(t)}function n(){for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];r(),t=setTimeout(function(){t=null,i.apply(void 0,a)},e)}return n.cancel=r,n}function ts(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];return function(r){for(var n=arguments.length,s=new Array(n>1?n-1:0),a=1;a<n;a++)s[a-1]=arguments[a];return e.some(function(o){return o&&o.apply(void 0,[r].concat(s)),r.preventDownshiftDefault||r.hasOwnProperty("nativeEvent")&&r.nativeEvent.preventDownshiftDefault})}}function eh(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];return function(r){e.forEach(function(n){typeof n=="function"?n(r):n&&(n.current=r)})}}function zH(){return String(VH++)}function a0(i,e){return!i||!e?i:Object.keys(i).reduce(function(t,r){return t[r]=U2(e,r)?e[r]:i[r],t},{})}function U2(i,e){return i[e]!==void 0}function UH(i){var e=i.key,t=i.keyCode;return t>=37&&t<=40&&e.indexOf("Arrow")!==0?"Arrow"+e:e}function th(i,e,t,r,n){var s=t.length;if(s===0)return-1;var a=s-1;(typeof i!="number"||i<0||i>a)&&(i=e>0?-1:a+1);var o=i+e;o<0?o=a:o>a&&(o=0);var l=Ld(o,e<0,t,r,n);return l===-1?i>=s?-1:i:l}function Ld(i,e,t,r,n){n===void 0&&(n=!1);var s=t.length;if(e){for(var a=i;a>=0;a--)if(!r(t[a],a))return a}else for(var o=i;o<s;o++)if(!r(t[o],o))return o;return n?Ld(e?s-1:0,e,t,r):-1}function iS(i,e,t,r){return r===void 0&&(r=!0),t&&e.some(function(n){return n&&(tS(n,i,t)||r&&tS(n,t.document.activeElement,t))})}var WH=z2(function(i){W2(i).textContent=""},500);function W2(i){var e=i.getElementById("a11y-status-message");return e||(e=i.createElement("div"),e.setAttribute("id","a11y-status-message"),e.setAttribute("role","status"),e.setAttribute("aria-live","polite"),e.setAttribute("aria-relevant","additions text"),Object.assign(e.style,{border:"0",clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0",position:"absolute",width:"1px"}),i.body.appendChild(e),e)}function GH(i,e){if(!(!i||!e)){var t=W2(e);t.textContent=i,WH(e)}}function $H(i){var e=i==null?void 0:i.getElementById("a11y-status-message");e&&e.remove()}var G2={highlightedIndex:-1,isOpen:!1,selectedItem:null,inputValue:""};function jH(i,e,t){var r=i.props,n=i.type,s={};Object.keys(e).forEach(function(a){YH(a,i,e,t),t[a]!==e[a]&&(s[a]=t[a])}),r.onStateChange&&Object.keys(s).length&&r.onStateChange(le({type:n},s))}function YH(i,e,t,r){var n=e.props,s=e.type,a="on"+v1(i)+"Change";n[a]&&r[i]!==void 0&&r[i]!==t[i]&&n[a](le({type:s},r))}function XH(i,e){return e.changes}var rS=z2(function(i,e){GH(i,e)},200),KH=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?S.useLayoutEffect:S.useEffect,qH="useId"in et?function(e){var t=e.id,r=e.labelId,n=e.menuId,s=e.getItemId,a=e.toggleButtonId,o=e.inputId,l="downshift-"+et.useId();t||(t=l);var u=S.useRef({labelId:r||t+"-label",menuId:n||t+"-menu",getItemId:s||function(c){return t+"-item-"+c},toggleButtonId:a||t+"-toggle-button",inputId:o||t+"-input"});return u.current}:function(e){var t=e.id,r=t===void 0?"downshift-"+zH():t,n=e.labelId,s=e.menuId,a=e.getItemId,o=e.toggleButtonId,l=e.inputId,u=S.useRef({labelId:n||r+"-label",menuId:s||r+"-menu",getItemId:a||function(c){return r+"-item-"+c},toggleButtonId:o||r+"-toggle-button",inputId:l||r+"-input"});return u.current};function JH(i,e,t,r){var n,s;if(i===void 0){if(e===void 0)throw new Error(r);n=t[e],s=e}else s=e===void 0?t.indexOf(i):e,n=i;return[n,s]}function v1(i){return""+i.slice(0,1).toUpperCase()+i.slice(1)}function $2(i){var e=S.useRef(i);return e.current=i,e}function QH(i,e,t,r){var n=S.useRef(),s=S.useRef(),a=S.useCallback(function(f,p){s.current=p,f=a0(f,p.props);var g=i(f,p),y=p.props.stateReducer(f,le({},p,{changes:g}));return y},[i]),o=S.useReducer(a,e,t),l=o[0],u=o[1],c=$2(e),h=S.useCallback(function(f){return u(le({props:c.current},f))},[c]),d=s.current;return S.useEffect(function(){var f=a0(n.current,d==null?void 0:d.props),p=d&&n.current&&!r(f,l);p&&jH(d,f,l),n.current=l},[l,d,r]),[l,h]}var nu={itemToString:function(e){return e?String(e):""},itemToKey:function(e){return e},stateReducer:XH,scrollIntoView:HH,environment:typeof window>"u"?void 0:window};function ta(i,e,t){t===void 0&&(t=G2);var r=i["default"+v1(e)];return r!==void 0?r:t[e]}function su(i,e,t){t===void 0&&(t=G2);var r=i[e];if(r!==void 0)return r;var n=i["initial"+v1(e)];return n!==void 0?n:ta(i,e,t)}function ZH(i){var e=su(i,"selectedItem"),t=su(i,"isOpen"),r=s9(i),n=su(i,"inputValue");return{highlightedIndex:r<0&&e&&t?i.items.findIndex(function(s){return i.itemToKey(s)===i.itemToKey(e)}):r,isOpen:t,selectedItem:e,inputValue:n}}function au(i,e,t){var r=i.items,n=i.initialHighlightedIndex,s=i.defaultHighlightedIndex,a=i.isItemDisabled,o=i.itemToKey,l=e.selectedItem,u=e.highlightedIndex;return r.length===0?-1:n!==void 0&&u===n&&!a(r[n],n)?n:s!==void 0&&!a(r[s],s)?s:l?r.findIndex(function(c){return o(l)===o(c)}):t<0&&!a(r[r.length-1],r.length-1)?r.length-1:t>0&&!a(r[0],0)?0:-1}function e9(i,e,t){var r=S.useRef({isMouseDown:!1,isTouchMove:!1,isTouchEnd:!1});return S.useEffect(function(){if(!i)return H2;var n=t.map(function(c){return c.current});function s(){r.current.isTouchEnd=!1,r.current.isMouseDown=!0}function a(c){r.current.isMouseDown=!1,iS(c.target,n,i)||e()}function o(){r.current.isTouchEnd=!1,r.current.isTouchMove=!1}function l(){r.current.isTouchMove=!0}function u(c){r.current.isTouchEnd=!0,!r.current.isTouchMove&&!iS(c.target,n,i,!1)&&e()}return i.addEventListener("mousedown",s),i.addEventListener("mouseup",a),i.addEventListener("touchstart",o),i.addEventListener("touchmove",l),i.addEventListener("touchend",u),function(){i.removeEventListener("mousedown",s),i.removeEventListener("mouseup",a),i.removeEventListener("touchstart",o),i.removeEventListener("touchmove",l),i.removeEventListener("touchend",u)}},[t,i,e]),r.current}var t9=function(){return H2};function i9(i,e,t,r){r===void 0&&(r={});var n=r.document,s=w1();S.useEffect(function(){if(!(!i||s||!n)){var a=i(e);rS(a,n)}},t),S.useEffect(function(){return function(){rS.cancel(),$H(n)}},[n])}function r9(i){var e=i.highlightedIndex,t=i.isOpen,r=i.itemRefs,n=i.getItemNodeFromIndex,s=i.menuElement,a=i.scrollIntoView,o=S.useRef(!0);return KH(function(){e<0||!t||!Object.keys(r.current).length||(o.current===!1?o.current=!0:a(n(e),s))},[e]),o}function nS(i,e,t){var r;t===void 0&&(t=!0);var n=((r=i.items)==null?void 0:r.length)&&e>=0;return le({isOpen:!1,highlightedIndex:-1},n&&le({selectedItem:i.items[e],isOpen:ta(i,"isOpen"),highlightedIndex:ta(i,"highlightedIndex")},t&&{inputValue:i.itemToString(i.items[e])}))}function n9(i,e){return i.isOpen===e.isOpen&&i.inputValue===e.inputValue&&i.highlightedIndex===e.highlightedIndex&&i.selectedItem===e.selectedItem}function w1(){var i=et.useRef(!0);return et.useEffect(function(){return i.current=!1,function(){i.current=!0}},[]),i.current}function o0(i){var e=ta(i,"highlightedIndex");return e>-1&&i.isItemDisabled(i.items[e],e)?-1:e}function s9(i){var e=su(i,"highlightedIndex");return e>-1&&i.isItemDisabled(i.items[e],e)?-1:e}var Ah={environment:Ee.shape({addEventListener:Ee.func.isRequired,removeEventListener:Ee.func.isRequired,document:Ee.shape({createElement:Ee.func.isRequired,getElementById:Ee.func.isRequired,activeElement:Ee.any.isRequired,body:Ee.any.isRequired}).isRequired,Node:Ee.func.isRequired}),itemToString:Ee.func,itemToKey:Ee.func,stateReducer:Ee.func},j2=le({},Ah,{getA11yStatusMessage:Ee.func,highlightedIndex:Ee.number,defaultHighlightedIndex:Ee.number,initialHighlightedIndex:Ee.number,isOpen:Ee.bool,defaultIsOpen:Ee.bool,initialIsOpen:Ee.bool,selectedItem:Ee.any,initialSelectedItem:Ee.any,defaultSelectedItem:Ee.any,id:Ee.string,labelId:Ee.string,menuId:Ee.string,getItemId:Ee.func,toggleButtonId:Ee.string,onSelectedItemChange:Ee.func,onHighlightedIndexChange:Ee.func,onStateChange:Ee.func,onIsOpenChange:Ee.func,scrollIntoView:Ee.func});function a9(i,e,t){var r=e.type,n=e.props,s;switch(r){case t.ItemMouseMove:s={highlightedIndex:e.disabled?-1:e.index};break;case t.MenuMouseLeave:s={highlightedIndex:-1};break;case t.ToggleButtonClick:case t.FunctionToggleMenu:s={isOpen:!i.isOpen,highlightedIndex:i.isOpen?-1:au(n,i,0)};break;case t.FunctionOpenMenu:s={isOpen:!0,highlightedIndex:au(n,i,0)};break;case t.FunctionCloseMenu:s={isOpen:!1};break;case t.FunctionSetHighlightedIndex:s={highlightedIndex:n.isItemDisabled(n.items[e.highlightedIndex],e.highlightedIndex)?-1:e.highlightedIndex};break;case t.FunctionSetInputValue:s={inputValue:e.inputValue};break;case t.FunctionReset:s={highlightedIndex:o0(n),isOpen:ta(n,"isOpen"),selectedItem:ta(n,"selectedItem"),inputValue:ta(n,"inputValue")};break;default:throw new Error("Reducer called without proper action type.")}return le({},i,s)}rl(rl({},j2),{items:Ee.array.isRequired,isItemDisabled:Ee.func});rl(rl({},nu),{isItemDisabled:function(){return!1}});var S1=0,x1=1,k1=2,T1=3,C1=4,N1=5,B1=6,_1=7,P1=8,Dd=9,R1=10,Y2=11,X2=12,E1=13,K2=14,q2=15,J2=16,Q2=17,Z2=18,M1=19,eB=20,tB=21,O1=22,iB=Object.freeze({__proto__:null,ControlledPropUpdatedSelectedItem:O1,FunctionCloseMenu:Q2,FunctionOpenMenu:J2,FunctionReset:tB,FunctionSelectItem:M1,FunctionSetHighlightedIndex:Z2,FunctionSetInputValue:eB,FunctionToggleMenu:q2,InputBlur:Dd,InputChange:P1,InputClick:R1,InputKeyDownArrowDown:S1,InputKeyDownArrowUp:x1,InputKeyDownEnd:C1,InputKeyDownEnter:_1,InputKeyDownEscape:k1,InputKeyDownHome:T1,InputKeyDownPageDown:B1,InputKeyDownPageUp:N1,ItemClick:E1,ItemMouseMove:X2,MenuMouseLeave:Y2,ToggleButtonClick:K2});function o9(i){var e=ZH(i),t=e.selectedItem,r=e.inputValue;return r===""&&t&&i.defaultInputValue===void 0&&i.initialInputValue===void 0&&i.inputValue===void 0&&(r=i.itemToString(t)),le({},e,{inputValue:r})}le({},j2,{items:Ee.array.isRequired,isItemDisabled:Ee.func,inputValue:Ee.string,defaultInputValue:Ee.string,initialInputValue:Ee.string,inputId:Ee.string,onInputValueChange:Ee.func});function l9(i,e,t,r){var n=S.useRef(),s=QH(i,e,t,r),a=s[0],o=s[1],l=w1();return S.useEffect(function(){if(U2(e,"selectedItem")){if(!l){var u=e.itemToKey(e.selectedItem)!==e.itemToKey(n.current);u&&o({type:O1,inputValue:e.itemToString(e.selectedItem)})}n.current=a.selectedItem===n.current?e.selectedItem:a.selectedItem}},[a.selectedItem,e.selectedItem]),[a0(a,e),o]}var u9=le({},nu,{isItemDisabled:function(){return!1}});function c9(i,e){var t,r=e.type,n=e.props,s=e.altKey,a;switch(r){case E1:a={isOpen:ta(n,"isOpen"),highlightedIndex:o0(n),selectedItem:n.items[e.index],inputValue:n.itemToString(n.items[e.index])};break;case S1:i.isOpen?a={highlightedIndex:th(i.highlightedIndex,1,n.items,n.isItemDisabled,!0)}:a={highlightedIndex:s&&i.selectedItem==null?-1:au(n,i,1),isOpen:n.items.length>=0};break;case x1:i.isOpen?s?a=nS(n,i.highlightedIndex):a={highlightedIndex:th(i.highlightedIndex,-1,n.items,n.isItemDisabled,!0)}:a={highlightedIndex:au(n,i,-1),isOpen:n.items.length>=0};break;case _1:a=nS(n,i.highlightedIndex);break;case k1:a=le({isOpen:!1,highlightedIndex:-1},!i.isOpen&&{selectedItem:null,inputValue:""});break;case N1:a={highlightedIndex:th(i.highlightedIndex,-10,n.items,n.isItemDisabled,!0)};break;case B1:a={highlightedIndex:th(i.highlightedIndex,10,n.items,n.isItemDisabled,!0)};break;case T1:a={highlightedIndex:Ld(0,!1,n.items,n.isItemDisabled)};break;case C1:a={highlightedIndex:Ld(n.items.length-1,!0,n.items,n.isItemDisabled)};break;case Dd:a=le({isOpen:!1,highlightedIndex:-1},i.highlightedIndex>=0&&((t=n.items)==null?void 0:t.length)&&e.selectItem&&{selectedItem:n.items[i.highlightedIndex],inputValue:n.itemToString(n.items[i.highlightedIndex])});break;case P1:a={isOpen:!0,highlightedIndex:o0(n),inputValue:e.inputValue};break;case R1:a={isOpen:!i.isOpen,highlightedIndex:i.isOpen?-1:au(n,i,0)};break;case M1:a={selectedItem:e.selectedItem,inputValue:n.itemToString(e.selectedItem)};break;case O1:a={inputValue:e.inputValue};break;default:return a9(i,e,iB)}return le({},i,a)}var h9=["onMouseLeave","refKey","ref"],d9=["item","index","refKey","ref","onMouseMove","onMouseDown","onClick","onPress","disabled"],f9=["onClick","onPress","refKey","ref"],p9=["onKeyDown","onChange","onInput","onBlur","onChangeText","onClick","refKey","ref"];rB.stateChangeTypes=iB;function rB(i){i===void 0&&(i={});var e=le({},u9,i),t=e.items,r=e.scrollIntoView,n=e.environment,s=e.getA11yStatusMessage,a=l9(c9,e,o9,n9),o=a[0],l=a[1],u=o.isOpen,c=o.highlightedIndex,h=o.selectedItem,d=o.inputValue,f=S.useRef(null),p=S.useRef({}),g=S.useRef(null),y=S.useRef(null),b=w1(),m=qH(e),v=S.useRef(),k=$2({state:o,props:e}),x=S.useCallback(function(G){return p.current[m.getItemId(G)]},[m]);i9(s,o,[u,c,h,d],n);var C=r9({menuElement:f.current,highlightedIndex:c,isOpen:u,itemRefs:p,scrollIntoView:r,getItemNodeFromIndex:x});S.useEffect(function(){var G=su(e,"isOpen");G&&g.current&&g.current.focus()},[]),S.useEffect(function(){b||(v.current=t.length)});var N=e9(n,S.useCallback(function(){k.current.state.isOpen&&l({type:Dd,selectItem:!1})},[l,k]),S.useMemo(function(){return[f,y,g]},[f.current,y.current,g.current])),B=t9();S.useEffect(function(){u||(p.current={})},[u]),S.useEffect(function(){var G;!u||!(n!=null&&n.document)||!(g!=null&&(G=g.current)!=null&&G.focus)||n.document.activeElement!==g.current&&g.current.focus()},[u,n]);var E=S.useMemo(function(){return{ArrowDown:function(q){q.preventDefault(),l({type:S1,altKey:q.altKey})},ArrowUp:function(q){q.preventDefault(),l({type:x1,altKey:q.altKey})},Home:function(q){k.current.state.isOpen&&(q.preventDefault(),l({type:T1}))},End:function(q){k.current.state.isOpen&&(q.preventDefault(),l({type:C1}))},Escape:function(q){var ie=k.current.state;(ie.isOpen||ie.inputValue||ie.selectedItem||ie.highlightedIndex>-1)&&(q.preventDefault(),l({type:k1}))},Enter:function(q){var ie=k.current.state;!ie.isOpen||q.which===229||(q.preventDefault(),l({type:_1}))},PageUp:function(q){k.current.state.isOpen&&(q.preventDefault(),l({type:N1}))},PageDown:function(q){k.current.state.isOpen&&(q.preventDefault(),l({type:B1}))}}},[l,k]),O=S.useCallback(function(G){return le({id:m.labelId,htmlFor:m.inputId},G)},[m]),z=S.useCallback(function(G,q){var ie,ae=G===void 0?{}:G,Re=ae.onMouseLeave,We=ae.refKey,Xe=We===void 0?"ref":We,De=ae.ref,Ce=zl(ae,h9),Tt=q===void 0?{}:q;return Tt.suppressRefError,le((ie={},ie[Xe]=eh(De,function(rt){f.current=rt}),ie.id=m.menuId,ie.role="listbox",ie["aria-labelledby"]=Ce&&Ce["aria-label"]?void 0:""+m.labelId,ie.onMouseLeave=ts(Re,function(){l({type:Y2})}),ie),Ce)},[l,B,m]),J=S.useCallback(function(G){var q,ie,ae=G===void 0?{}:G,Re=ae.item,We=ae.index,Xe=ae.refKey,De=Xe===void 0?"ref":Xe,Ce=ae.ref,Tt=ae.onMouseMove,rt=ae.onMouseDown,Ot=ae.onClick;ae.onPress;var Ze=ae.disabled,Ct=zl(ae,d9);Ze!==void 0&&console.warn('Passing "disabled" as an argument to getItemProps is not supported anymore. Please use the isItemDisabled prop from useCombobox.');var nt=k.current,It=nt.props,zi=nt.state,Sr=JH(Re,We,It.items,"Pass either item or index to getItemProps!"),Kt=Sr[0],Ve=Sr[1],ui=It.isItemDisabled(Kt,Ve),yi="onClick",ar=Ot,xr=function(){N.isTouchEnd||Ve===zi.highlightedIndex||(C.current=!1,l({type:X2,index:Ve,disabled:ui}))},kr=function(){l({type:E1,index:Ve})},Os=function(va){return va.preventDefault()};return le((q={},q[De]=eh(Ce,function($r){$r&&(p.current[m.getItemId(Ve)]=$r)}),q["aria-disabled"]=ui,q["aria-selected"]=Ve===zi.highlightedIndex,q.id=m.getItemId(Ve),q.role="option",q),!ui&&(ie={},ie[yi]=ts(ar,kr),ie),{onMouseMove:ts(Tt,xr),onMouseDown:ts(rt,Os)},Ct)},[l,m,k,N,C]),he=S.useCallback(function(G){var q,ie=G===void 0?{}:G,ae=ie.onClick;ie.onPress;var Re=ie.refKey,We=Re===void 0?"ref":Re,Xe=ie.ref,De=zl(ie,f9),Ce=k.current.state,Tt=function(){l({type:K2})};return le((q={},q[We]=eh(Xe,function(rt){y.current=rt}),q["aria-controls"]=m.menuId,q["aria-expanded"]=Ce.isOpen,q.id=m.toggleButtonId,q.tabIndex=-1,q),!De.disabled&&le({},{onClick:ts(ae,Tt)}),De)},[l,k,m]),oe=S.useCallback(function(G,q){var ie,ae=G===void 0?{}:G,Re=ae.onKeyDown,We=ae.onChange,Xe=ae.onInput,De=ae.onBlur;ae.onChangeText;var Ce=ae.onClick,Tt=ae.refKey,rt=Tt===void 0?"ref":Tt,Ot=ae.ref,Ze=zl(ae,p9),Ct=q===void 0?{}:q;Ct.suppressRefError;var nt=k.current.state,It=function(xr){var kr=UH(xr);kr&&E[kr]&&E[kr](xr)},zi=function(xr){l({type:P1,inputValue:xr.target.value})},Sr=function(xr){if(n!=null&&n.document&&nt.isOpen&&!N.isMouseDown){var kr=xr.relatedTarget===null&&n.document.activeElement!==n.document.body;l({type:Dd,selectItem:!kr})}},Kt=function(){l({type:R1})},Ve="onChange",ui={};if(!Ze.disabled){var yi;ui=(yi={},yi[Ve]=ts(We,Xe,zi),yi.onKeyDown=ts(Re,It),yi.onBlur=ts(De,Sr),yi.onClick=ts(Ce,Kt),yi)}return le((ie={},ie[rt]=eh(Ot,function(ar){g.current=ar}),ie["aria-activedescendant"]=nt.isOpen&&nt.highlightedIndex>-1?m.getItemId(nt.highlightedIndex):"",ie["aria-autocomplete"]="list",ie["aria-controls"]=m.menuId,ie["aria-expanded"]=nt.isOpen,ie["aria-labelledby"]=Ze&&Ze["aria-label"]?void 0:m.labelId,ie.autoComplete="off",ie.id=m.inputId,ie.role="combobox",ie.value=nt.inputValue,ie),ui,Ze)},[l,m,n,E,k,N,B]),ye=S.useCallback(function(){l({type:q2})},[l]),se=S.useCallback(function(){l({type:Q2})},[l]),K=S.useCallback(function(){l({type:J2})},[l]),U=S.useCallback(function(G){l({type:Z2,highlightedIndex:G})},[l]),Z=S.useCallback(function(G){l({type:M1,selectedItem:G})},[l]),re=S.useCallback(function(G){l({type:eB,inputValue:G})},[l]),ge=S.useCallback(function(){l({type:tB})},[l]);return{getItemProps:J,getLabelProps:O,getMenuProps:z,getInputProps:oe,getToggleButtonProps:he,toggleMenu:ye,openMenu:K,closeMenu:se,setHighlightedIndex:U,setInputValue:re,selectItem:Z,reset:ge,highlightedIndex:c,isOpen:u,selectedItem:h,inputValue:d}}Ah.stateReducer,Ah.itemToKey,Ah.environment,Ee.array,Ee.array,Ee.array,Ee.func,Ee.number,Ee.number,Ee.number,Ee.func,Ee.func,Ee.string,Ee.string;nu.itemToKey,nu.stateReducer,nu.environment;var nB={},I1={};(function(i){i.__esModule=!0,i.default=n;var e=/[\u0300-\u036f]/g,t=/ł/g,r=/ñ/g;function n(s){return s.toLowerCase().normalize("NFD").replace(e,"").replace(t,"l").replace(r,"n").trim()}})(I1);var wa={},sS;function aS(){if(sS)return wa;sS=1,wa.__esModule=!0,wa.aggressiveFuzzyMatch=l,wa.createFuzzySearchImpl=d,wa.experimentalSmartFuzzyMatch=u,wa.fuzzyMatchImpl=h;var i=e(I1);function e(f){return f&&f.__esModule?f:{default:f}}var t=Number.MAX_SAFE_INTEGER,r=function(p,g){return p.score-g.score},n=function(p,g){return p[0]-g[0]},s=new Set(`  []()-–—'"“”`.split(""));function a(f){return s.has(f)}function o(f,p,g,y,b,m,v){if(f===y)return[0,[[0,f.length-1]]];var k=y.length,x=p.length,C=b.length;if(p===b)return[.1,[[0,x-1]]];if(p.startsWith(b))return[.5,[[0,C-1]]];var N=f.indexOf(y);if(N>-1&&a(f[N-1]))return[.9,[[N,N+k-1]]];var B=p.indexOf(b);if(B>-1&&a(p[B-1]))return[1,[[B,B+k-1]]];var E=m.length;if(E>1&&m.every(function(z){return g.has(z)})){var O=1.5+E*.2;return[O,m.map(function(z){var J=p.indexOf(z);return[J,J+z.length-1]}).sort(n)]}return B>-1?[2,[[B,B+k-1]]]:v==="aggressive"?l(p,b):v==="smart"?u(p,b):null}function l(f,p){for(var g=f.length,y=p.length,b=0,m=p[b],v=[],k=-1,x=-2,C=0;C<g;C+=1)if(f[C]===m){if(C!==x+1&&(k>=0&&v.push([k,x]),k=C),x=C,b+=1,b===y)return v.push([k,x]),c(v,f);m=p[b]}return null}function u(f,p){for(var g=f.length,y=[],b=0,m=p[b],v=-1,k=-2;;){var x=f.indexOf(m,k+1);if(x===-1)break;if(x===0||a(f[x-1]))v=x;else{var C=p.length-b,N=f.length-x,B=Math.min(3,C,N),E=p.slice(b,b+B);if(f.slice(x,x+B)===E)v=x;else{k+=1;continue}}for(k=v;k<g&&f[k]===m;k+=1)b+=1,m=p[b];if(k-=1,y.push([v,k]),b===p.length)return c(y,f)}return null}function c(f,p){var g=2;return f.forEach(function(y){var b=y[0],m=y[1],v=m-b+1,k=b===0||p[b]===" "||p[b-1]===" ",x=m===p.length-1||p[m]===" "||p[m+1]===" ",C=k&&x;C?g+=.2:k?g+=.4:v>=3?g+=.8:g+=1.6}),[g,f]}function h(f,p){var g=(0,i.default)(p),y=g.split(" "),b=(0,i.default)(f),m=new Set(b.split(" ")),v=o(f,b,m,p,g,y,"smart");return v?{item:f,score:v[0],matches:[v[1]]}:null}function d(f,p){var g=p.strategy,y=g===void 0?"aggressive":g,b=p.getText,m=f.map(function(v){var k;if(b)k=b(v);else{var x=p.key?v[p.key]:v;k=[x]}var C=k.map(function(N){var B=N||"",E=(0,i.default)(B),O=new Set(E.split(" "));return[B,E,O]});return[v,C]});return function(v){var k=[],x=(0,i.default)(v),C=x.split(" ");return x.length?(m.forEach(function(N){for(var B=N[0],E=N[1],O=t,z=[],J=0,he=E.length;J<he;J+=1){var oe=E[J],ye=oe[0],se=oe[1],K=oe[2],U=o(ye,se,K,v,x,C,y);U?(O=Math.min(O,U[0]),z.push(U[1])):z.push(null)}O<t&&k.push({item:B,score:O,matches:z})}),k.sort(r),k):[]}}return wa}(function(i){i.__esModule=!0,i.default=r,i.fuzzyMatch=n;var e=t(I1);i.normalizeText=e.default;function t(s){return s&&s.__esModule?s:{default:s}}function r(s,a){return a===void 0&&(a={}),aS().createFuzzySearchImpl(s,a)}function n(s,a){return aS().fuzzyMatchImpl(s,a)}})(nB);const g9=ec(nB),pc={addBarButton:"add-bar-button",addChordButton:i=>`add-chord-${i}`,chordAndTypeInput:i=>`chord-and-type-input-${i}`},m9=R``,y9=R`
  display: flex;
  align-items: center;
`,b9=R`
  display: inline;
  font-weight: bold;
  color: #ffffffde;
  padding: 0px 2px;
  font-size: 2em;
  text-align: center;
  text-shadow: 0px 0px 0px transparent;
  transition: text-shadow 0.2s ease, color 0.2s ease;
  user-select: none;
  max-width: 150px;
  height: 40px;
  cursor: pointer;
  background-color: transparent;
  border: none;
  border-radius: 10px;
  &:hover,
  &:focus {
    color: #ffffffff;
    background-color: #ffffff30;
    border: none;
    outline: none;
  }
`,v9=R`
  display: none;
`,w9=R`
  position: absolute;
  overflow: auto;
  height: 110px;
  width: 153px;
  background-color: #181818;
  box-shadow: rgba(0, 0, 0, 0.2) 0px 2px 12px;
  margin-top: 2px;
  z-index: 2;
  border-radius: 10px;
`,S9=R`
  padding: 6px 10px;
  font-size: '1em';
  color: #ffffffdd;
  cursor: pointer;
`,x9=R`
  background-color: #ffffff30;
  color: '#ffffff';
`,k9=R`
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  flex-direction: column;
  color: #ffffffdd;
`,T9=i=>[i],C9=({chord:i,chordId:e,onChange:t,chords:r=_H})=>{const{t:n}=vt(),s=k=>{if(A(k))return;const x=r.find(E=>E.toLowerCase()===k.toLowerCase());if(A(x)){o(i);return}const C=PH.get(x.toLowerCase());if(A(C)){o(i);return}const[N,B]=C;t(N,B)},[a,o]=S.useState(i),l=S.useMemo(()=>g9(r,{getText:T9,strategy:"smart"}),[r]),u=S.useMemo(()=>l(a).map(k=>k.item),[l,a]);S.useEffect(()=>o(i),[i]);const{isOpen:c,highlightedIndex:h,getInputProps:d,getMenuProps:f,getItemProps:p,closeMenu:g}=rB({inputValue:a,items:u,selectedItem:i,onInputValueChange:({inputValue:k})=>{o(k)},onSelectedItemChange:({selectedItem:k})=>{o(k),s(k)}}),y=()=>{s(a),g()},b=k=>{k.key==="Enter"&&s(a)},m=k=>{k.target.select()},v=mi(w9,c?void 0:v9);return T.jsxs("div",{className:m9,children:[T.jsx("div",{className:y9,children:T.jsx("input",{...d({onKeyDown:b,id:pc.chordAndTypeInput(e)}),className:b9,onBlur:y,onFocus:m})}),T.jsxs("ul",{...f(),className:v,children:[u.length===0&&T.jsxs("div",{className:k9,children:[T.jsx(Vf,{}),T.jsx("span",{children:n("Errors.InvalidChord")})]}),u.map((k,x)=>{const C=mi(S9,x===h?x9:void 0);return S.createElement("li",{...p({item:k,index:x}),key:k,className:C},T.jsx("span",{children:k}))})]})]})},N9=i=>i.transitions,B9=i=>i.id,_9=i=>i.name,P9=i=>i.id,R9=i=>i.name,E9=(i,e)=>i.name.toLowerCase().includes(e.toLowerCase()),M9=({setOpen:i,categories:e,onChange:t})=>{const{t:r}=vt(),n=s=>{t(s),i(!1)};return T.jsx(Zf,{categories:e,canSearch:!0,canCreate:!1,onItemClick:n,getChildren:N9,getCategoryKey:B9,getCategoryLabel:_9,getItemKey:P9,getItemLabel:R9,matches:E9,noHitsLabel:r("Errors.NoTransitionsMessage")})};function O9(i,e){S.useEffect(()=>{if(e){const t=r=>{r.key==="Escape"&&i()};return document.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t)}return()=>{}},[e])}const I9=R`
  display: flex;
  align-items: center;
  justify-content: center;
`,oS=R`
  color: #ffffffdd;
  border-radius: 6px;
  cursor: pointer;
  transition: box-shadow 0.2s ease, background-color 0.2s ease;
  user-select: none;
  overflow: hidden;
  display: flex;
  flex-direction: row;
  align-items: stretch;
  justify-content: center;
  border: none;
  background-color: #ffffff30;
  &:hover {
    background-color: #ffffff40;
    box-shadow: rgba(0, 0, 0, 0.1) 0px 4px 12px;
  }
  &:focus {
    outline: none;
    background-color: #ffffff40;
  }
`,L9=R`
  color: #fff;
  cursor: pointer;
  position: relative;
  display: inline;
  top: 3px;
`,D9=R`
  border-top-left-radius: 6px;
  border-bottom-left-radius: 6px;
  padding: 4px 10px;
  text-overflow: ellipsis;
  overflow: hidden;
  white-space: nowrap;
  font-size: 1.2em;
  border: none;
  color: #fff;
  max-width: 135px;
  min-width: 40px;
  background-color: transparent;
  cursor: pointer;
  &:hover {
    background-color: #ffffff40;
  }
  &:focus {
    outline: none;
    background-color: #ffffff40;
  }
`,F9=R`
  flex-shrink: 0;
  padding: 4px 10px;
  display: flex;
  flex-direction: row;
  border: none;
  align-items: center;
  justify-content: center;
  background-color: transparent;
  color: #fff;
  cursor: pointer;
  &:focus {
    outline: none;
    background-color: #ffffff40;
  }
  &:hover {
    background-color: #ffffff40;
  }
`,A9=mi(F9,R`
    border-top-right-radius: 6px;
    border-bottom-right-radius: 6px;
  `),V9=R`
  position: relative;
  top: -1px;
  font-size: 1em;
  flex-shrink: 0;
`,H9=R`
  text-overflow: ellipsis;
  white-space: nowrap;
  padding: 4px 10px;
  font-size: 1.2em;
`,z9=R`
  background-color: #181818;
  border-radius: 12px;
  width: 280px;
  height: auto;
  max-height: 340px;
  overflow: hidden;
  box-shadow: rgba(0, 0, 0, 0.2) 0px 2px 12px;
`,U9=({transition:i,categories:e,onChange:t})=>{const{t:r}=vt(),[n,s]=S.useState(!1),a=()=>s(!1),o=()=>s(!n),l=()=>{t(void 0),a()};return O9(a,n),T.jsx(ks.Popover,{isOpen:n,onClickOutside:a,clickOutsideCapture:!0,positions:["bottom","right","left"],content:({position:u,childRect:c,popoverRect:h})=>T.jsx(ks.ArrowContainer,{position:u,childRect:c,popoverRect:h,arrowColor:"#181818",arrowSize:10,children:T.jsx("div",{className:z9,children:T.jsx(M9,{setOpen:s,onChange:t,transition:i,categories:e})})}),children:T.jsxs("div",{className:I9,children:[A(i)&&T.jsx("button",{className:oS,onClick:o,tabIndex:-1,"data-tooltip":"Tooltips.Progression.Transition",children:T.jsxs("div",{className:H9,children:[T.jsx(gN,{className:L9})," ",r("Progression.Transition")]})}),!A(i)&&T.jsxs("div",{className:oS,children:[T.jsx("button",{className:D9,onClick:o,tabIndex:-1,"data-tooltip":"Tooltips.Progression.Transition",children:i.name}),T.jsx("button",{className:A9,onClick:l,tabIndex:-1,"data-tooltip":"Tooltips.Progression.DeleteTransition",children:T.jsx(ro,{className:V9})})]})]})})},gc=R`
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: center;
  border: none;
  color: #ffffffdd;
  padding: 4px 10px;
  gap: 6px;
  cursor: pointer;
  font-size: 1em;
  border-radius: 6px;
  background-color: transparent;
  background-color: #ffffff30;
  &:hover {
    color: #fff;
    background-color: #ffffff40;
  }
  &:disabled {
    background-color: transparent;
    color: #ffffff50;
    cursor: not-allowed;
  }
`,W9=R`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  flex: 1;
  border-radius: 10px;
  height: 138px;
  padding: 12px 14px 8px 14px;
  gap: 10px;
  border: 2px dashed #ffffff60;
  background-color: #ffffff20;
  color: #ffffffee;
`,G9=R`
  text-align: center;
  font-size: 1em;
`,$9=({onDelete:i})=>{const{t:e}=vt();return T.jsxs("div",{className:W9,children:[T.jsx("span",{className:G9,children:e("Errors.MissingChord")}),T.jsxs("button",{className:gc,onClick:i,children:[T.jsx(ro,{}),e("Errors.Delete")]})]})},j9=({barId:i,chordId:e})=>{const t=es(),r=(t==null?void 0:t.tuning)??[],n=w6(e),s=a2(i),a=S6(t==null?void 0:t.id,i,e),o=N6(r,n==null?void 0:n.name),l=(n==null?void 0:n.noteCount)??(t==null?void 0:t.noteCount),u=C6(r,l,n,a),c=B6(n==null?void 0:n.transitionId),h=On(),[d,f]=S.useState(!1),p=x=>{A(n)||h(tr.actions.updateChord({chordId:e,updates:x}))},g=x=>{p({noteCount:x,...!A(c)&&x!==(c==null?void 0:c.steps.length)?{transitionId:void 0}:{}})},y=x=>{if(A(n))return;const C={...n,root:x};!A(c)&&!Dy(C,a,r,c,l)&&(C.transitionId=void 0),p(C)},b=x=>{p({transitionId:x==null?void 0:x.id})},m=(x,C)=>{const N=OC(x,s2(r)),B=N.includes(n==null?void 0:n.root)?n==null?void 0:n.root:N[0];p({name:x,type:C,root:B})},v=()=>{A(s)||s.chords.filter(C=>C!==e).forEach(C=>{h(tr.actions.updateChord({chordId:C,updates:{noteCount:void 0}}))}),h(E6({progressionId:t==null?void 0:t.id,chordIds:[e]}))},k=n!=null&&n.name?EV[n==null?void 0:n.name]:"transparent";return A(n)?T.jsx($9,{onDelete:v}):T.jsxs(OV,{color:k,onHoverStatusChanged:f,children:[T.jsxs(VV,{children:[T.jsx(bH,{root:n.root,onChange:y,values:o}),T.jsx(BH,{progressionNoteCount:t==null?void 0:t.noteCount,noteCount:n.noteCount,onChange:g})]}),T.jsx(zV,{children:T.jsx(C9,{chordId:e,chord:il(n),onChange:m})}),T.jsxs(HV,{children:[T.jsx(UV,{}),a&&T.jsx(U9,{categories:u,transition:c,onChange:b}),T.jsx(WV,{icon:ro,onClick:v,visible:d,"data-tooltip":"Tooltips.Progression.DeleteChord"})]})]})};function Y9(i){return pt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M8 19H5c-1 0-2-1-2-2V7c0-1 1-2 2-2h3"},child:[]},{tag:"path",attr:{d:"M16 5h3c1 0 2 1 2 2v10c0 1-1 2-2 2h-3"},child:[]},{tag:"line",attr:{x1:"12",x2:"12",y1:"4",y2:"20"},child:[]}]})(i)}const X9=R`
  display: flex;
  flex-direction: column;
  gap: 0px;
  border-radius: 10px;
  background-color: #ffffff30;
  transition: box-shadow 0.2s ease, background-color 0.2s ease;
  box-shadow: none;
  height: 183px;
  &:hover {
    box-shadow: rgba(50, 50, 93, 0.25) 0px 13px 27px -5px,
      rgba(0, 0, 0, 0.3) 0px 8px 16px -8px;
    background-color: #ffffff35;
  }
`,K9=R`
  display: flex;
  flex: 1;
  flex-direction: row;
  gap: 10px;
  padding: 10px 10px 0px 10px;
  position: relative;
`,q9=R`
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  align-items: center;
  padding: 0px 10px;
  color: #fff;
  font-size: 1em;
  height: 35px;
`,J9=R`
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  justify-self: start;
`,Q9=R`
  width: 50px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 6px;
  padding: 3px;
  cursor: move;
  justify-self: center;
  &:hover {
    background-color: #ffffff20;
  }
`,Z9=R`
  transform: rotate(90deg);
`,ez=R`
  position: absolute;
  display: flex;
  align-items: center;
  justify-content: center;
  top: 60px;
  right: 10px;
  bottom: 50px;
  border-radius: 10px;
  width: 40px;
`,tz=R`
  height: 138px;
  font-weight: bold;
  color: #ffffffaa;
  padding: 0px 15px;
  font-size: 2em;
  text-align: center;
  transition: color 0.2s ease, border-color 0.2s ease,
    background-color 0.2s ease;
  display: flex;
  flex: 1;
  flex-direction: row;
  align-items: center;
  justify-content: center;
  border-radius: 10px;
  gap: 10px;
  padding: 14px;
  border: 2px dashed #ffffff30;
  background-color: #ffffff15;
  cursor: pointer;
  &:focus,
  &:hover {
    color: #ffffffcc;
    background: #ffffff25;
    border-color: #ffffff60;
  }

  &:focus {
    outline: 1px solid white;
  }
`,iz=R`
  color: #fff;
  font-size: 1.8em;
  cursor: pointer;
`,rz=R``,sB=R`
  color: #ffffffbb;
  cursor: pointer;
  &:hover {
    color: #ffffff;
  }
`,nz=mi(sB,R`
    justify-self: end;
  `),sz=S.forwardRef(({count:i,barId:e,children:t,onAddFirst:r,onAddSecond:n,onDelete:s,onClone:a,listeners:o,attributes:l,style:u},c)=>{const[h,d]=S.useState(!1),[f,p]=S.useState(!1),{t:g}=vt(),y=()=>d(!0),b=()=>d(!1),m=()=>p(!0),v=()=>p(!1),k=S.Children.toArray(t);return T.jsxs("div",{ref:c,className:X9,onMouseEnter:y,onMouseLeave:b,style:u,...l,tabIndex:-1,children:[T.jsxs("div",{className:K9,onMouseEnter:m,onMouseLeave:v,children:[k,k.length===1&&f?T.jsx("div",{className:ez,children:T.jsx(Y9,{className:iz,onClick:n,"data-tooltip":"Tooltips.Progression.SplitBar"})}):null,k.length===0?T.jsxs("button",{className:tz,onClick:r,id:pc.addChordButton(e),"data-tooltip":"Tooltips.Progression.AddChord",children:[T.jsx(pN,{className:rz}),g("Progression.Chord")]}):null]}),T.jsxs("div",{className:q9,children:[T.jsxs("div",{className:J9,children:[T.jsxs("span",{children:["＃",i]}),T.jsx(f4,{"data-tooltip":"Tooltips.Progression.CloneBar",style:{visibility:h?"visible":"hidden"},className:sB,onClick:a})]}),T.jsx("div",{style:{opacity:h?1:0},className:Q9,"data-tooltip":"Tooltips.Progression.DragBar",...o,children:T.jsx(n4,{className:Z9})}),T.jsx(ro,{"data-tooltip":"Tooltips.Progression.DeleteBar",style:{visibility:h?"visible":"hidden"},className:nz,"data-tran":!0,onClick:s})]})]})}),az=R`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 10px;
  border-radius: 10px;
  transition: box-shadow 0.2s ease, background-color 0.2s ease;
  box-shadow: none;
  height: 183px;
  border: 2px dashed #ffffff60;
  background-color: #ffffff20;
  color: #ffffffee;
  &:hover {
    box-shadow: rgba(50, 50, 93, 0.25) 0px 13px 27px -5px,
      rgba(0, 0, 0, 0.3) 0px 8px 16px -8px;
    background-color: #ffffff25;
  }
`,oz=R`
  text-align: center;
  font-size: 1em;
`,lz=({onDelete:i})=>{const{t:e}=vt();return T.jsxs("div",{className:az,children:[T.jsx("span",{className:oz,children:e("Errors.MissingBar")}),T.jsxs("button",{className:gc,onClick:i,children:[T.jsx(ro,{}),e("Errors.Delete")]})]})},uz=({barId:i,count:e})=>{const t=a2(i),r=es(),n=x6(i,0),s=On(),{attributes:a,listeners:o,setNodeRef:l,transform:u,transition:c}=NV({id:i}),h={transform:ca.Transform.toString(u),transition:c},[d,f]=S.useState();S.useEffect(()=>{var m;A(d)||((m=document.getElementById(pc.chordAndTypeInput(d)))==null||m.focus(),f(void 0))},[d]);const p=()=>{s(M6({progressionId:r==null?void 0:r.id,barIds:[i]}))},g=()=>{if(!A(n)||A(t))return;const m={id:Ir(),name:"C",type:"MAJOR",root:"C2"};s(tr.actions.createChord({chord:m})),s(on.actions.updateBar({barId:i,updates:{chords:[...t.chords,m.id]}})),f(m.id)},y=()=>{if(A(n)||A(t))return;const m=r.noteCount/2,v={...n,noteCount:m,transitionId:void 0},k={...v,id:Ir()};s(tr.actions.updateChord({chordId:v.id,updates:v})),s(tr.actions.createChord({chord:k})),s(on.actions.updateBar({barId:i,updates:{chords:[...t.chords,k.id]}})),f(k.id)},b=()=>{A(r)||s(I6({progressionId:r.id,barId:i}))};return A(t)?T.jsx(lz,{onDelete:p}):T.jsx(sz,{barId:i,count:e,onAddFirst:g,onAddSecond:y,onDelete:p,onClone:b,ref:l,listeners:o,attributes:a,style:h,children:((t==null?void 0:t.chords)??[]).map((m,v)=>T.jsx(j9,{barId:i,chordId:m},v))})},cz=R`
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  border-radius: 10px;
  border: 2px dashed #ffffff30;
  background: transparent;
  height: 183px;
  overflow: hidden;
  transition: border-color 0.2s ease, background-color 0.2s ease;
  cursor: pointer;
  &:hover {
    background: #ffffff10;
    border-color: #ffffff60;
  }
`,hz=R`
  font-weight: bold;
  color: #ffffffaa;
  font-size: 2em;
  text-align: center;
  transition: color 0.2s ease;
  display: flex;
  flex: 1;
  flex-direction: row;
  align-items: center;
  justify-content: center;
  border-radius: 10px;
  gap: 10px;
  margin: 10px;
  padding: 14px;
  width: 100%;
  height: 100%;
  &:hover {
    color: #ffffffcc;
  }
`,dz=R`
  flex-shrink: 0;
`,fz=({onClick:i})=>{const{t:e}=vt();return T.jsx("button",{className:cz,onClick:i,id:pc.addBarButton,"data-tooltip":"Tooltips.Progression.AddBar",children:T.jsxs("div",{className:hz,children:[T.jsx(pN,{className:dz})," ",e("Progression.Bar")]})})},pz=R`
  display: flex;
  flex-direction: column;
  gap: 0px;
  border-radius: 10px;
  background-color: #ffffff30;
  transition: box-shadow 0.2s ease, background-color 0.2s ease;
  box-shadow: none;
  height: 183px;
  &:hover {
    box-shadow: rgba(50, 50, 93, 0.25) 0px 13px 27px -5px,
      rgba(0, 0, 0, 0.3) 0px 8px 16px -8px;
    background-color: #ffffff35;
  }
  cursor: move;
`,gz=({})=>T.jsx("div",{className:pz}),mz=R`
  display: grid;
  grid-template-columns: 1fr 1fr 1fr 1fr;
  grid-auto-rows: 1fr;
  gap: 16px;
  padding: 22px 60px;
  overflow: auto;
  max-height: calc(100vh - 100px - 70px);
`,yz=({children:i})=>T.jsx("div",{className:mz,children:i}),bz=()=>{const i=es(),e=On(),t=Q7(Ow(p1),Ow(d1,{coordinateGetter:PV})),[r,n]=S.useState(),[s,a]=S.useState();S.useEffect(()=>{var c;A(s)||((c=document.getElementById(pc.addChordButton(s)))==null||c.focus(),a(void 0))},[s]);const o=()=>{if(A(i))return;const c={id:Ir(),chords:[]};e(on.actions.createBar({bar:c})),e(Vi.actions.updateProgression({progressionId:i.id,updates:{bars:[...i.bars,c.id]}})),a(c.id)},l=c=>{const{active:h,over:d}=c;A(i)||A(d)||h.id===d.id||e(L6({progressionId:i.id,barId:h.id,overId:d.id}))},u=c=>{n(c.active.id)};return A(i)?null:T.jsxs(q8,{sensors:t,collisionDetection:t8,onDragEnd:l,onDragStart:u,children:[T.jsx(vV,{items:i.bars,strategy:m1,children:T.jsxs(yz,{children:[i.bars.map((c,h)=>T.jsx(uz,{barId:c,count:h+1},c)),T.jsx(fz,{onClick:o})]})}),T.jsx(gV,{children:r?T.jsx(gz,{id:r}):null})]})},vz=R`
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 6px;
  margin-right: 60px;
  flex-shrink: 0;
  &:hover,
  &:active,
  &:visited {
    text-decoration: none;
  }
`,wz=R`
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 4px;
`,Sz=R`
  color: #fff;
  font-size: 3.4em;
`,xz=R`
  color: #fff;
  font-size: 2.4em;
  font-weight: bold;
  line-height: 90%;
  margin: 0px;
`,kz=R`
  color: #ffffff99;
  font-size: 0.8em;
  line-height: 90%;
  font-weight: normal;
  white-space: nowrap;
`,Tz=()=>T.jsxs(ua,{className:vz,to:xs.home(),children:[T.jsx(gN,{className:Sz}),T.jsxs("span",{className:wz,children:[T.jsx("h1",{className:xz,children:"Stick"}),T.jsx("h2",{className:kz,children:"helps you walk."})]})]}),Cz=R`
  display: flex;
  flex-direction: row;
  align-items: center;
  height: 100px;
  width: 100%;
  padding: 14px 60px;
`,mc=({children:i})=>T.jsxs("div",{className:Cz,children:[T.jsx(Tz,{}),i]}),aB=R`
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 16px;
  flex: 1;
`,lS=R`
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 8px;
  border-radius: 10px;
  padding: 8px 16px;
  color: #ddd;
  font-size: 1.4em;
  background: transparent;
  transition: color 0.2s ease, background-color 0.2s ease;
  cursor: pointer;
  text-decoration: none;
  &:hover {
    background: #ffffff30;
    color: #fff;
  }

  * {
    &:hover,
    &:active,
    &:visited {
      text-decoration: none !important;
    }
  }

  &:hover,
  &:active,
  &:visited {
    text-decoration: none !important;
  }
`,Nz=R`
  background: #ffffff30;
  color: #fff;
`;function uS(i,e){const t=e.split("/");return t[t.length-1]===i?mi(lS,Nz):lS}const oB=()=>{const{pathname:i}=io(),e=es(),{t}=vt();if(A(e))return null;const r=uS("editor",i),n=uS("score",i);return T.jsxs("div",{className:aB,children:[T.jsxs(ua,{to:xs.editor(e.id),className:r,children:[T.jsx(b4,{})," ",t("Navigation.Editor")]}),T.jsxs(ua,{to:xs.score(e.id),className:n,children:[T.jsx(Km,{})," ",t("Navigation.Score")]})]})},L1=()=>T.jsx("div",{className:aB,children:" "}),Bz=[["en","hu"]],l0={en:"English",hu:"Magyar"},_z=i=>i,Pz=()=>"lng",Rz=i=>i,Ez=()=>!0,Mz=()=>"",Oz=i=>l0[i],Iz=({onChange:i})=>T.jsx(Zf,{categories:Bz,canSearch:!1,canCreate:!1,showCategories:!1,onItemClick:i,getChildren:_z,getCategoryKey:Pz,getCategoryLabel:Mz,getItemKey:Rz,getItemLabel:Oz,matches:Ez,noHitsLabel:""}),Lz=R`
  background-color: #181818;
  border-radius: 12px;
  width: 130px;
  height: 80px;
  overflow: hidden;
  box-shadow: rgba(0, 0, 0, 0.2) 0px 2px 12px;
`,Dz=mi(gc,R`
    background-color: transparent;
  `),yc=()=>{const[i,e]=S.useState(!1),{t,i18n:r}=vt(),n=()=>e(!1),s=()=>e(!0),a=On(),o=u=>{r.changeLanguage(u),a(Ra.actions.updateConfig({language:u})),n()},l=r.language;return T.jsx(ks.Popover,{isOpen:i,onClickOutside:n,clickOutsideCapture:!0,positions:["bottom","right","left"],content:({position:u,childRect:c,popoverRect:h})=>T.jsx(ks.ArrowContainer,{position:u,childRect:c,popoverRect:h,arrowColor:"#181818",arrowSize:10,children:T.jsx("div",{className:Lz,children:T.jsx(Iz,{value:l,onChange:o})})}),children:T.jsxs("button",{className:Dz,onClick:s,tabIndex:-1,children:[t("Language"),":"," ",T.jsx("b",{children:l0[l]??l0.en})]})})},Fz=()=>T.jsxs(T.Fragment,{children:[T.jsxs(mc,{children:[T.jsx(oB,{}),T.jsx(yc,{})]}),T.jsx(F7,{}),T.jsx(bz,{})]}),Az=n5`
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
`,Vz=R`
  width: 60px;
  height: 60px;
  border: 7px solid #fff;
  border-bottom-color: transparent;
  border-radius: 50%;
  display: inline-block;
  box-sizing: border-box;
  animation: ${Az} 1s linear infinite;
`,Hz=()=>T.jsx("span",{className:Vz}),zz=R`
  position: fixed;
  top: 0px;
  left: 0px;
  right: 0px;
  bottom: 0px;
  z-index: 3;

  backdrop-filter: blur(5px);
  background: #22222299;

  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: 20px;
`,Uz=R`
  color: #ffffff;
  font-size: 2em;
`,Wz=({isVisible:i})=>i?T.jsxs("div",{className:zz,children:[T.jsx(Hz,{}),T.jsx("div",{className:Uz,children:"Score is loading..."})]}):null;var ps;(function(i){i[i.Page=0]="Page",i[i.Horizontal=1]="Horizontal"})(ps||(ps={}));var ur;(function(i){i[i.Default=0]="Default",i[i.ScoreTab=1]="ScoreTab",i[i.Score=2]="Score",i[i.Tab=3]="Tab",i[i.TabMixed=4]="TabMixed"})(ur||(ur={}));class us{static getValue(e){return us._values||(us._values=new Map),e=e.toLowerCase().replaceAll(" ",""),us._values.has(e)?us._values.get(e):0}static isPiano(e){return e<=7||e>=16&&e<=23}static isGuitar(e){return e>=24&&e<=39||e===105||e===43}}us._values=new Map([["acousticgrandpiano",0],["brightacousticpiano",1],["electricgrandpiano",2],["honkytonkpiano",3],["electricpiano1",4],["electricpiano2",5],["harpsichord",6],["clavinet",7],["celesta",8],["glockenspiel",9],["musicbox",10],["vibraphone",11],["marimba",12],["xylophone",13],["tubularbells",14],["dulcimer",15],["drawbarorgan",16],["percussiveorgan",17],["rockorgan",18],["churchorgan",19],["reedorgan",20],["accordion",21],["harmonica",22],["tangoaccordion",23],["acousticguitarnylon",24],["acousticguitarsteel",25],["electricguitarjazz",26],["electricguitarclean",27],["electricguitarmuted",28],["overdrivenguitar",29],["distortionguitar",30],["guitarharmonics",31],["acousticbass",32],["electricbassfinger",33],["electricbasspick",34],["fretlessbass",35],["slapbass1",36],["slapbass2",37],["synthbass1",38],["synthbass2",39],["violin",40],["viola",41],["cello",42],["contrabass",43],["tremolostrings",44],["pizzicatostrings",45],["orchestralharp",46],["timpani",47],["stringensemble1",48],["stringensemble2",49],["synthstrings1",50],["synthstrings2",51],["choiraahs",52],["voiceoohs",53],["synthvoice",54],["orchestrahit",55],["trumpet",56],["trombone",57],["tuba",58],["mutedtrumpet",59],["frenchhorn",60],["brasssection",61],["synthbrass1",62],["synthbrass2",63],["sopranosax",64],["altosax",65],["tenorsax",66],["baritonesax",67],["oboe",68],["englishhorn",69],["bassoon",70],["clarinet",71],["piccolo",72],["flute",73],["recorder",74],["panflute",75],["blownbottle",76],["shakuhachi",77],["whistle",78],["ocarina",79],["lead1square",80],["lead2sawtooth",81],["lead3calliope",82],["lead4chiff",83],["lead5charang",84],["lead6voice",85],["lead7fifths",86],["lead8bassandlead",87],["pad1newage",88],["pad2warm",89],["pad3polysynth",90],["pad4choir",91],["pad5bowed",92],["pad6metallic",93],["pad7halo",94],["pad8sweep",95],["fx1rain",96],["fx2soundtrack",97],["fx3crystal",98],["fx4atmosphere",99],["fx5brightness",100],["fx6goblins",101],["fx7echoes",102],["fx8scifi",103],["sitar",104],["banjo",105],["shamisen",106],["koto",107],["kalimba",108],["bagpipe",109],["fiddle",110],["shanai",111],["tinklebell",112],["agogo",113],["steeldrums",114],["woodblock",115],["taikodrum",116],["melodictom",117],["synthdrum",118],["reversecymbal",119],["guitarfretnoise",120],["breathnoise",121],["seashore",122],["birdtweet",123],["telephonering",124],["helicopter",125],["applause",126],["gunshot",127]]);class bl{init(e,t){this.data=e,this.settings=t}}var ai;(function(i){i[i.General=0]="General",i[i.Format=1]="Format",i[i.AlphaTex=2]="AlphaTex"})(ai||(ai={}));class oi extends Error{constructor(e,t="",r){super(t??"",{cause:r}),this.type=e,this.inner=r??null,Object.setPrototypeOf(this,oi.prototype)}}class gt extends oi{constructor(e=null,t=null){super(ai.Format,e??"Unsupported format"),this.inner=t,Object.setPrototypeOf(this,gt.prototype)}}var jt;(function(i){i[i.None=0]="None",i[i.Normal=1]="Normal",i[i.Heavy=2]="Heavy"})(jt||(jt={}));var $t;(function(i){i[i.Tempo=0]="Tempo",i[i.Volume=1]="Volume",i[i.Instrument=2]="Instrument",i[i.Balance=3]="Balance"})($t||($t={}));class wi{constructor(){this.isLinear=!1,this.type=$t.Tempo,this.value=0,this.ratioPosition=0,this.text=""}static buildTempoAutomation(e,t,r,n){(n<1||n>5)&&(n=2);let s=new Float32Array([1,.5,1,1.5,2,3]),a=new wi;return a.type=$t.Tempo,a.isLinear=e,a.ratioPosition=t,a.value=r*s[n],a}static buildInstrumentAutomation(e,t,r){let n=new wi;return n.type=$t.Instrument,n.isLinear=e,n.ratioPosition=t,n.value=r,n}}var ve;(function(i){i[i.Neutral=0]="Neutral",i[i.C3=1]="C3",i[i.C4=2]="C4",i[i.F4=3]="F4",i[i.G2=4]="G2"})(ve||(ve={}));var $e;(function(i){i[i._15ma=0]="_15ma",i[i._8va=1]="_8va",i[i.Regular=2]="Regular",i[i._8vb=3]="_8vb",i[i._15mb=4]="_15mb"})($e||($e={}));var Fr;(function(i){i[i.None=0]="None",i[i.Simple=1]="Simple",i[i.FirstOfDouble=2]="FirstOfDouble",i[i.SecondOfDouble=3]="SecondOfDouble"})(Fr||(Fr={}));class Ps{constructor(){this.id=Ps._globalBarId++,this.index=0,this.nextBar=null,this.previousBar=null,this.clef=ve.G2,this.clefOttava=$e.Regular,this.voices=[],this.simileMark=Fr.None,this.isMultiVoice=!1,this.displayScale=1,this.displayWidth=-1}get masterBar(){return this.staff.track.score.masterBars[this.index]}get isEmpty(){for(let e=0,t=this.voices.length;e<t;e++)if(!this.voices[e].isEmpty)return!1;return!0}addVoice(e){e.bar=this,e.index=this.voices.length,this.voices.push(e)}finish(e,t=null){this.isMultiVoice=!1;for(let r=0,n=this.voices.length;r<n;r++){let s=this.voices[r];s.finish(e,t),r>0&&!s.isEmpty&&(this.isMultiVoice=!0)}}calculateDuration(){let e=0;for(let t of this.voices){let r=t.calculateDuration();r>e&&(e=r)}return e}}Ps._globalBarId=0;class we{static ticksToMillis(e,t){return e*(6e4/(t*we.QuarterTime))|0}static millisToTicks(e,t){return e/(6e4/(t*we.QuarterTime))|0}static toTicks(e){return we.valueToTicks(e)}static valueToTicks(e){let t=e;return t<0&&(t=1/-t),we.QuarterTime*(4/t)|0}static applyDot(e,t){return t?e+(e/4|0)*3:e+(e/2|0)}static applyTuplet(e,t,r){return e*r/t|0}static removeTuplet(e,t,r){return e*t/r|0}static dynamicToVelocity(e){return we.MinVelocity+e*we.VelocityIncrement}}we.QuarterTime=960;we.MinVelocity=15;we.VelocityIncrement=16;class ${constructor(e=0,t=0){this.offset=e,this.value=t}}$.MaxPosition=60;$.MaxValue=12;var Je;(function(i){i[i.Default=0]="Default",i[i.Gradual=1]="Gradual",i[i.Fast=2]="Fast"})(Je||(Je={}));var ee;(function(i){i[i.None=0]="None",i[i.Custom=1]="Custom",i[i.Bend=2]="Bend",i[i.Release=3]="Release",i[i.BendRelease=4]="BendRelease",i[i.Hold=5]="Hold",i[i.Prebend=6]="Prebend",i[i.PrebendBend=7]="PrebendBend",i[i.PrebendRelease=8]="PrebendRelease"})(ee||(ee={}));var lt;(function(i){i[i.None=0]="None",i[i.BrushUp=1]="BrushUp",i[i.BrushDown=2]="BrushDown",i[i.ArpeggioUp=3]="ArpeggioUp",i[i.ArpeggioDown=4]="ArpeggioDown"})(lt||(lt={}));var Zi;(function(i){i[i.None=0]="None",i[i.Crescendo=1]="Crescendo",i[i.Decrescendo=2]="Decrescendo"})(Zi||(Zi={}));var _;(function(i){i[i.QuadrupleWhole=-4]="QuadrupleWhole",i[i.DoubleWhole=-2]="DoubleWhole",i[i.Whole=1]="Whole",i[i.Half=2]="Half",i[i.Quarter=4]="Quarter",i[i.Eighth=8]="Eighth",i[i.Sixteenth=16]="Sixteenth",i[i.ThirtySecond=32]="ThirtySecond",i[i.SixtyFourth=64]="SixtyFourth",i[i.OneHundredTwentyEighth=128]="OneHundredTwentyEighth",i[i.TwoHundredFiftySixth=256]="TwoHundredFiftySixth"})(_||(_={}));var _e;(function(i){i[i.PPP=0]="PPP",i[i.PP=1]="PP",i[i.P=2]="P",i[i.MP=3]="MP",i[i.MF=4]="MF",i[i.F=5]="F",i[i.FF=6]="FF",i[i.FFF=7]="FFF"})(_e||(_e={}));var ce;(function(i){i[i.None=0]="None",i[i.OnBeat=1]="OnBeat",i[i.BeforeBeat=2]="BeforeBeat",i[i.BendGrace=3]="BendGrace"})(ce||(ce={}));var be;(function(i){i[i.Unknown=-2]="Unknown",i[i.NoOrDead=-1]="NoOrDead",i[i.Thumb=0]="Thumb",i[i.IndexFinger=1]="IndexFinger",i[i.MiddleFinger=2]="MiddleFinger",i[i.AnnularFinger=3]="AnnularFinger",i[i.LittleFinger=4]="LittleFinger"})(be||(be={}));var ne;(function(i){i[i.None=0]="None",i[i.Natural=1]="Natural",i[i.Artificial=2]="Artificial",i[i.Pinch=3]="Pinch",i[i.Tap=4]="Tap",i[i.Semi=5]="Semi",i[i.Feedback=6]="Feedback"})(ne||(ne={}));var Ft;(function(i){i[i.Default=0]="Default",i[i.ForceNone=1]="ForceNone",i[i.ForceNatural=2]="ForceNatural",i[i.ForceSharp=3]="ForceSharp",i[i.ForceDoubleSharp=4]="ForceDoubleSharp",i[i.ForceFlat=5]="ForceFlat",i[i.ForceDoubleFlat=6]="ForceDoubleFlat"})(Ft||(Ft={}));var ri;(function(i){i[i.None=0]="None",i[i.IntoFromBelow=1]="IntoFromBelow",i[i.IntoFromAbove=2]="IntoFromAbove"})(ri||(ri={}));var xe;(function(i){i[i.None=0]="None",i[i.Shift=1]="Shift",i[i.Legato=2]="Legato",i[i.OutUp=3]="OutUp",i[i.OutDown=4]="OutDown",i[i.PickSlideDown=5]="PickSlideDown",i[i.PickSlideUp=6]="PickSlideUp"})(xe||(xe={}));var Ue;(function(i){i[i.None=0]="None",i[i.Slight=1]="Slight",i[i.Wide=2]="Wide"})(Ue||(Ue={}));var cs;(function(i){i[i.Hidden=0]="Hidden",i[i.ShowWithBeams=1]="ShowWithBeams",i[i.ShowWithBars=2]="ShowWithBars"})(cs||(cs={}));var En;(function(i){i[i.ScoreDefault=0]="ScoreDefault",i[i.ScoreForcePiano=1]="ScoreForcePiano",i[i.SingleNoteEffectBand=2]="SingleNoteEffectBand",i[i.SingleNoteEffectBandForcePiano=3]="SingleNoteEffectBandForcePiano"})(En||(En={}));var Zt;(function(i){i[i.GuitarPro=0]="GuitarPro",i[i.SongBook=1]="SongBook"})(Zt||(Zt={}));var pe;(function(i){i[i.ScoreTitle=0]="ScoreTitle",i[i.ScoreSubTitle=1]="ScoreSubTitle",i[i.ScoreArtist=2]="ScoreArtist",i[i.ScoreAlbum=3]="ScoreAlbum",i[i.ScoreWords=4]="ScoreWords",i[i.ScoreMusic=5]="ScoreMusic",i[i.ScoreWordsAndMusic=6]="ScoreWordsAndMusic",i[i.ScoreCopyright=7]="ScoreCopyright",i[i.GuitarTuning=8]="GuitarTuning",i[i.TrackNames=9]="TrackNames",i[i.ChordDiagrams=10]="ChordDiagrams",i[i.ParenthesisOnTiedBends=11]="ParenthesisOnTiedBends",i[i.TabNotesOnTiedBends=12]="TabNotesOnTiedBends",i[i.ZerosOnDiveWhammys=13]="ZerosOnDiveWhammys",i[i.EffectAlternateEndings=14]="EffectAlternateEndings",i[i.EffectCapo=15]="EffectCapo",i[i.EffectChordNames=16]="EffectChordNames",i[i.EffectCrescendo=17]="EffectCrescendo",i[i.EffectDynamics=18]="EffectDynamics",i[i.EffectFadeIn=19]="EffectFadeIn",i[i.EffectFermata=20]="EffectFermata",i[i.EffectFingering=21]="EffectFingering",i[i.EffectHarmonics=22]="EffectHarmonics",i[i.EffectLetRing=23]="EffectLetRing",i[i.EffectLyrics=24]="EffectLyrics",i[i.EffectMarker=25]="EffectMarker",i[i.EffectOttavia=26]="EffectOttavia",i[i.EffectPalmMute=27]="EffectPalmMute",i[i.EffectPickSlide=28]="EffectPickSlide",i[i.EffectPickStroke=29]="EffectPickStroke",i[i.EffectSlightBeatVibrato=30]="EffectSlightBeatVibrato",i[i.EffectSlightNoteVibrato=31]="EffectSlightNoteVibrato",i[i.EffectTap=32]="EffectTap",i[i.EffectTempo=33]="EffectTempo",i[i.EffectText=34]="EffectText",i[i.EffectTrill=35]="EffectTrill",i[i.EffectTripletFeel=36]="EffectTripletFeel",i[i.EffectWhammyBar=37]="EffectWhammyBar",i[i.EffectWideBeatVibrato=38]="EffectWideBeatVibrato",i[i.EffectWideNoteVibrato=39]="EffectWideNoteVibrato",i[i.EffectLeftHandTap=40]="EffectLeftHandTap"})(pe||(pe={}));class Vu{constructor(){this.notationMode=Zt.GuitarPro,this.fingeringMode=En.ScoreDefault,this.elements=new Map,this.rhythmMode=cs.Hidden,this.rhythmHeight=15,this.transpositionPitches=[],this.displayTranspositionPitches=[],this.smallGraceTabNotes=!0,this.extendBendArrowsOnTiedNotes=!0,this.extendLineEffectsToBeatEnd=!1,this.slurHeight=5}isNotationElementVisible(e){return this.elements.has(e)?this.elements.get(e):Vu.defaultElements.has(e)?Vu.defaultElements.get(e):!0}}Vu.defaultElements=new Map([[pe.ZerosOnDiveWhammys,!1]]);class lB{constructor(e){this._value=void 0,this._factory=e}get value(){return this._value===void 0&&(this._value=this._factory()),this._value}}var xn;(function(i){i[i.None=0]="None",i[i.Debug=1]="Debug",i[i.Info=2]="Info",i[i.Warning=3]="Warning",i[i.Error=4]="Error"})(xn||(xn={}));class Ea{static format(e,t){return`[AlphaTab][${e}] ${t}`}debug(e,t,...r){console.debug(Ea.format(e,t),...r)}warning(e,t,...r){console.warn(Ea.format(e,t),...r)}info(e,t,...r){console.info(Ea.format(e,t),...r)}error(e,t,...r){console.error(Ea.format(e,t),...r)}}Ea.logLevel=xn.Info;let V=class fn{static shouldLog(e){return fn.logLevel!==xn.None&&e>=fn.logLevel}static debug(e,t,...r){fn.shouldLog(xn.Debug)&&fn.log.debug(e,t,...r)}static warning(e,t,...r){fn.shouldLog(xn.Warning)&&fn.log.warning(e,t,...r)}static info(e,t,...r){fn.shouldLog(xn.Info)&&fn.log.info(e,t,...r)}static error(e,t,...r){fn.shouldLog(xn.Error)&&fn.log.error(e,t,...r)}};V.logLevel=xn.Info;V.log=new Ea;class Gz{constructor(){this.note=null,this.noteValue=0,this.octave=0}get realValue(){return this.octave*12+this.noteValue}}class ct{static getIndex(e){let t=0;return e<0?t:Math.log2(e)|0}static keySignatureIsFlat(e){return e<0}static keySignatureIsNatural(e){return e===0}static keySignatureIsSharp(e){return e>0}static applyPitchOffsets(e,t){for(let r=0;r<t.tracks.length;r++){if(r<e.notation.displayTranspositionPitches.length)for(let n of t.tracks[r].staves)n.displayTranspositionPitch=-e.notation.displayTranspositionPitches[r];if(r<e.notation.transpositionPitches.length)for(let n of t.tracks[r].staves)n.transpositionPitch=-e.notation.transpositionPitches[r]}}static fingerToString(e,t,r,n){if(e.notation.fingeringMode===En.ScoreForcePiano||e.notation.fingeringMode===En.SingleNoteEffectBandForcePiano||us.isPiano(t.voice.bar.staff.track.playbackInfo.program))switch(r){case be.Unknown:case be.NoOrDead:return null;case be.Thumb:return"1";case be.IndexFinger:return"2";case be.MiddleFinger:return"3";case be.AnnularFinger:return"4";case be.LittleFinger:return"5";default:return null}if(n)switch(r){case be.Unknown:case be.NoOrDead:return"0";case be.Thumb:return"T";case be.IndexFinger:return"1";case be.MiddleFinger:return"2";case be.AnnularFinger:return"3";case be.LittleFinger:return"4";default:return null}switch(r){case be.Unknown:case be.NoOrDead:return null;case be.Thumb:return"p";case be.IndexFinger:return"i";case be.MiddleFinger:return"m";case be.AnnularFinger:return"a";case be.LittleFinger:return"c";default:return null}}static isTuning(e){return!!ct.parseTuning(e)}static parseTuning(e){let t="",r="";for(let s=0;s<e.length;s++){let a=e.charCodeAt(s);if(a>=48&&a<=57){if(!t)return null;r+=String.fromCharCode(a)}else if(a>=65&&a<=90||a>=97&&a<=122||a===35)t+=String.fromCharCode(a);else return null}if(!r||!t)return null;let n=new Gz;return n.octave=parseInt(r)+1,n.note=t.toLowerCase(),n.noteValue=ct.getToneForText(n.note),n}static getTuningForText(e){let t=ct.parseTuning(e);return t?t.realValue:-1}static getToneForText(e){switch(e.toLowerCase()){case"c":return 0;case"c#":case"db":return 1;case"d":return 2;case"d#":case"eb":return 3;case"e":return 4;case"f":return 5;case"f#":case"gb":return 6;case"g":return 7;case"g#":case"ab":return 8;case"a":return 9;case"a#":case"bb":return 10;case"b":return 11;default:return 0}}static newGuid(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)+Math.floor((1+Math.random())*65536).toString(16).substring(1)+"-"+Math.floor((1+Math.random())*65536).toString(16).substring(1)+"-"+Math.floor((1+Math.random())*65536).toString(16).substring(1)+"-"+Math.floor((1+Math.random())*65536).toString(16).substring(1)+"-"+Math.floor((1+Math.random())*65536).toString(16).substring(1)+Math.floor((1+Math.random())*65536).toString(16).substring(1)+Math.floor((1+Math.random())*65536).toString(16).substring(1)}static isAlmostEqualTo(e,t){return Math.abs(e-t)<1e-5}static toHexString(e,t=0){let r="",n="0123456789ABCDEF";do r=String.fromCharCode(n.charCodeAt(e&15))+r,e=e>>4;while(e>0);for(;r.length<t;)r="0"+r;return r}}var gi;(function(i){i[i.None=0]="None",i[i.Up=1]="Up",i[i.Down=2]="Down"})(gi||(gi={}));var w;(function(i){i[i.None=-1]="None",i[i.GClef=57424]="GClef",i[i.CClef=57436]="CClef",i[i.FClef=57442]="FClef",i[i.UnpitchedPercussionClef1=57449]="UnpitchedPercussionClef1",i[i.SixStringTabClef=57453]="SixStringTabClef",i[i.FourStringTabClef=57454]="FourStringTabClef",i[i.TimeSig0=57472]="TimeSig0",i[i.TimeSig1=57473]="TimeSig1",i[i.TimeSig2=57474]="TimeSig2",i[i.TimeSig3=57475]="TimeSig3",i[i.TimeSig4=57476]="TimeSig4",i[i.TimeSig5=57477]="TimeSig5",i[i.TimeSig6=57478]="TimeSig6",i[i.TimeSig7=57479]="TimeSig7",i[i.TimeSig8=57480]="TimeSig8",i[i.TimeSig9=57481]="TimeSig9",i[i.TimeSigCommon=57482]="TimeSigCommon",i[i.TimeSigCutCommon=57483]="TimeSigCutCommon",i[i.NoteheadDoubleWholeSquare=57505]="NoteheadDoubleWholeSquare",i[i.NoteheadDoubleWhole=57504]="NoteheadDoubleWhole",i[i.NoteheadWhole=57506]="NoteheadWhole",i[i.NoteheadHalf=57507]="NoteheadHalf",i[i.NoteheadBlack=57508]="NoteheadBlack",i[i.NoteheadNull=57509]="NoteheadNull",i[i.NoteheadXOrnate=57514]="NoteheadXOrnate",i[i.NoteheadTriangleUpWhole=57531]="NoteheadTriangleUpWhole",i[i.NoteheadTriangleUpHalf=57532]="NoteheadTriangleUpHalf",i[i.NoteheadTriangleUpBlack=57534]="NoteheadTriangleUpBlack",i[i.NoteheadDiamondBlackWide=57564]="NoteheadDiamondBlackWide",i[i.NoteheadDiamondWhite=57565]="NoteheadDiamondWhite",i[i.NoteheadDiamondWhiteWide=57566]="NoteheadDiamondWhiteWide",i[i.NoteheadCircleX=57523]="NoteheadCircleX",i[i.NoteheadXWhole=57511]="NoteheadXWhole",i[i.NoteheadXHalf=57512]="NoteheadXHalf",i[i.NoteheadXBlack=57513]="NoteheadXBlack",i[i.NoteheadParenthesis=57550]="NoteheadParenthesis",i[i.NoteheadSlashedBlack2=57552]="NoteheadSlashedBlack2",i[i.NoteheadCircleSlash=57591]="NoteheadCircleSlash",i[i.NoteheadHeavyX=57592]="NoteheadHeavyX",i[i.NoteheadHeavyXHat=57593]="NoteheadHeavyXHat",i[i.NoteheadSlashVerticalEnds=57600]="NoteheadSlashVerticalEnds",i[i.NoteheadSlashWhiteWhole=57602]="NoteheadSlashWhiteWhole",i[i.NoteheadSlashWhiteHalf=57603]="NoteheadSlashWhiteHalf",i[i.NoteQuarterUp=57813]="NoteQuarterUp",i[i.NoteEighthUp=57815]="NoteEighthUp",i[i.Tremolo3=57890]="Tremolo3",i[i.Tremolo2=57889]="Tremolo2",i[i.Tremolo1=57888]="Tremolo1",i[i.FlagEighthUp=57920]="FlagEighthUp",i[i.FlagEighthDown=57921]="FlagEighthDown",i[i.FlagSixteenthUp=57922]="FlagSixteenthUp",i[i.FlagSixteenthDown=57923]="FlagSixteenthDown",i[i.FlagThirtySecondUp=57924]="FlagThirtySecondUp",i[i.FlagThirtySecondDown=57925]="FlagThirtySecondDown",i[i.FlagSixtyFourthUp=57926]="FlagSixtyFourthUp",i[i.FlagSixtyFourthDown=57927]="FlagSixtyFourthDown",i[i.FlagOneHundredTwentyEighthUp=57928]="FlagOneHundredTwentyEighthUp",i[i.FlagOneHundredTwentyEighthDown=57929]="FlagOneHundredTwentyEighthDown",i[i.FlagTwoHundredFiftySixthUp=57930]="FlagTwoHundredFiftySixthUp",i[i.FlagTwoHundredFiftySixthDown=57931]="FlagTwoHundredFiftySixthDown",i[i.AccidentalFlat=57952]="AccidentalFlat",i[i.AccidentalNatural=57953]="AccidentalNatural",i[i.AccidentalSharp=57954]="AccidentalSharp",i[i.AccidentalDoubleSharp=57955]="AccidentalDoubleSharp",i[i.AccidentalDoubleFlat=57956]="AccidentalDoubleFlat",i[i.AccidentalQuarterToneFlatArrowUp=57968]="AccidentalQuarterToneFlatArrowUp",i[i.AccidentalQuarterToneSharpArrowUp=57972]="AccidentalQuarterToneSharpArrowUp",i[i.AccidentalQuarterToneNaturalArrowUp=57970]="AccidentalQuarterToneNaturalArrowUp",i[i.ArticAccentAbove=58528]="ArticAccentAbove",i[i.ArticStaccatoAbove=58530]="ArticStaccatoAbove",i[i.ArticMarcatoAbove=58540]="ArticMarcatoAbove",i[i.FermataAbove=58560]="FermataAbove",i[i.FermataShortAbove=58564]="FermataShortAbove",i[i.FermataLongAbove=58566]="FermataLongAbove",i[i.RestLonga=58593]="RestLonga",i[i.RestDoubleWhole=58594]="RestDoubleWhole",i[i.RestWhole=58595]="RestWhole",i[i.RestHalf=58596]="RestHalf",i[i.RestQuarter=58597]="RestQuarter",i[i.RestEighth=58598]="RestEighth",i[i.RestSixteenth=58599]="RestSixteenth",i[i.RestThirtySecond=58600]="RestThirtySecond",i[i.RestSixtyFourth=58601]="RestSixtyFourth",i[i.RestOneHundredTwentyEighth=58602]="RestOneHundredTwentyEighth",i[i.RestTwoHundredFiftySixth=58603]="RestTwoHundredFiftySixth",i[i.Repeat1Bar=58624]="Repeat1Bar",i[i.Repeat2Bars=58625]="Repeat2Bars",i[i.Ottava=58640]="Ottava",i[i.OttavaAlta=58641]="OttavaAlta",i[i.OttavaBassaVb=58652]="OttavaBassaVb",i[i.Quindicesima=58644]="Quindicesima",i[i.QuindicesimaAlta=58645]="QuindicesimaAlta",i[i.DynamicPPP=58666]="DynamicPPP",i[i.DynamicPP=58667]="DynamicPP",i[i.DynamicPiano=58656]="DynamicPiano",i[i.DynamicMP=58668]="DynamicMP",i[i.DynamicMF=58669]="DynamicMF",i[i.DynamicForte=58658]="DynamicForte",i[i.DynamicFF=58671]="DynamicFF",i[i.DynamicFFF=58672]="DynamicFFF",i[i.OrnamentTrill=58726]="OrnamentTrill",i[i.StringsDownBow=58896]="StringsDownBow",i[i.StringsUpBow=58898]="StringsUpBow",i[i.PictEdgeOfCymbal=59177]="PictEdgeOfCymbal",i[i.GuitarString0=59443]="GuitarString0",i[i.GuitarString1=59444]="GuitarString1",i[i.GuitarString2=59445]="GuitarString2",i[i.GuitarString3=59446]="GuitarString3",i[i.GuitarString4=59447]="GuitarString4",i[i.GuitarString5=59448]="GuitarString5",i[i.GuitarString6=59449]="GuitarString6",i[i.GuitarString7=59450]="GuitarString7",i[i.GuitarString8=59451]="GuitarString8",i[i.GuitarString9=59452]="GuitarString9",i[i.GuitarGolpe=59458]="GuitarGolpe",i[i.FretboardX=59481]="FretboardX",i[i.FretboardO=59482]="FretboardO",i[i.WiggleTrill=60068]="WiggleTrill",i[i.WiggleVibratoMediumFast=60126]="WiggleVibratoMediumFast",i[i.OctaveBaselineM=60565]="OctaveBaselineM",i[i.OctaveBaselineB=60563]="OctaveBaselineB"})(w||(w={}));var ue;(function(i){i[i.Left=0]="Left",i[i.Center=1]="Center",i[i.Right=2]="Right"})(ue||(ue={}));var Se;(function(i){i[i.Top=0]="Top",i[i.Middle=1]="Middle",i[i.Bottom=2]="Bottom"})(Se||(Se={}));class cp{constructor(e,t){this.width=e,this.height=t}}class Y{constructor(e="",t=0,r=0,n=w.None,s=w.None,a=w.None,o=w.None,l=Se.Middle){this.elementType=e,this.outputMidiNumber=r,this.staffLine=t,this.noteHeadDefault=n,this.noteHeadHalf=s!==w.None?s:n,this.noteHeadWhole=a!==w.None?a:n,this.techniqueSymbol=o,this.techniqueSymbolPlacement=l}getSymbol(e){switch(e){case _.Whole:return this.noteHeadWhole;case _.Half:return this.noteHeadHalf;default:return this.noteHeadDefault}}}class At{static articulationFromElementVariation(e,t){return e<At.gp6ElementAndVariationToArticulation.length?(t>=At.gp6ElementAndVariationToArticulation.length&&(t=0),At.gp6ElementAndVariationToArticulation[e][t]):38}static getArticulation(e){const t=e.percussionArticulation,r=e.beat.voice.bar.staff.track.percussionArticulations;return t<r.length?r[t]:At.getArticulationByValue(t)}static getElementAndVariation(e){const t=At.getArticulation(e);if(!t)return[-1,-1];for(let r=0;r<At.gp6ElementAndVariationToArticulation.length;r++){const n=At.gp6ElementAndVariationToArticulation[r];for(let s=0;s<n.length;s++){const a=At.getArticulationByValue(n[s]);if((a==null?void 0:a.outputMidiNumber)===t.outputMidiNumber)return[r,s]}}return[-1,-1]}static getArticulationByValue(e){return At.instrumentArticulations.has(e)?At.instrumentArticulations.get(e):null}}At.gp6ElementAndVariationToArticulation=[[35,35,35],[38,91,37],[99,100,99],[56,100,56],[102,103,102],[43,43,43],[45,45,45],[47,47,47],[48,48,48],[50,50,50],[42,92,46],[44,44,44],[57,98,57],[49,97,49],[55,95,55],[51,93,127],[52,96,52]];At.instrumentArticulations=new Map([[38,new Y("snare",3,38,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[37,new Y("snare",3,37,w.NoteheadXBlack,w.NoteheadXBlack,w.NoteheadXBlack)],[91,new Y("snare",3,38,w.NoteheadDiamondWhite,w.NoteheadDiamondWhite,w.NoteheadDiamondWhite)],[42,new Y("hiHat",-1,42,w.NoteheadXBlack,w.NoteheadXBlack,w.NoteheadXBlack)],[92,new Y("hiHat",-1,46,w.NoteheadCircleSlash,w.NoteheadCircleSlash,w.NoteheadCircleSlash)],[46,new Y("hiHat",-1,46,w.NoteheadCircleX,w.NoteheadCircleX,w.NoteheadCircleX)],[44,new Y("hiHat",9,44,w.NoteheadXBlack,w.NoteheadXBlack,w.NoteheadXBlack)],[35,new Y("kickDrum",8,35,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[36,new Y("kickDrum",7,36,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[50,new Y("tom",1,50,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[48,new Y("tom",2,48,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[47,new Y("tom",4,47,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[45,new Y("tom",5,45,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[43,new Y("tom",6,43,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[93,new Y("ride",0,51,w.NoteheadXBlack,w.NoteheadXBlack,w.NoteheadXBlack,w.PictEdgeOfCymbal,Se.Bottom)],[51,new Y("ride",0,51,w.NoteheadXBlack,w.NoteheadXBlack,w.NoteheadXBlack)],[53,new Y("ride",0,53,w.NoteheadDiamondWhite,w.NoteheadDiamondWhite,w.NoteheadDiamondWhite)],[94,new Y("ride",0,51,w.NoteheadXBlack,w.NoteheadXBlack,w.NoteheadXBlack,w.ArticStaccatoAbove,Se.Top)],[55,new Y("splash",-2,55,w.NoteheadXBlack,w.NoteheadXBlack,w.NoteheadXBlack)],[95,new Y("splash",-2,55,w.NoteheadXBlack,w.NoteheadXBlack,w.NoteheadXBlack,w.ArticStaccatoAbove,Se.Bottom)],[52,new Y("china",-3,52,w.NoteheadHeavyXHat,w.NoteheadHeavyXHat,w.NoteheadHeavyXHat)],[96,new Y("china",-3,52,w.NoteheadHeavyXHat,w.NoteheadHeavyXHat,w.NoteheadHeavyXHat)],[49,new Y("crash",-2,49,w.NoteheadHeavyX,w.NoteheadHeavyX,w.NoteheadHeavyX)],[97,new Y("crash",-2,49,w.NoteheadHeavyX,w.NoteheadHeavyX,w.NoteheadHeavyX,w.ArticStaccatoAbove,Se.Bottom)],[57,new Y("crash",-1,57,w.NoteheadHeavyX,w.NoteheadHeavyX,w.NoteheadHeavyX)],[98,new Y("crash",-1,57,w.NoteheadHeavyX,w.NoteheadHeavyX,w.NoteheadHeavyX,w.ArticStaccatoAbove,Se.Bottom)],[99,new Y("cowbell",1,56,w.NoteheadTriangleUpBlack,w.NoteheadTriangleUpHalf,w.NoteheadTriangleUpWhole)],[100,new Y("cowbell",1,56,w.NoteheadXBlack,w.NoteheadXHalf,w.NoteheadXWhole)],[56,new Y("cowbell",0,56,w.NoteheadTriangleUpBlack,w.NoteheadTriangleUpHalf,w.NoteheadTriangleUpWhole)],[101,new Y("cowbell",0,56,w.NoteheadXBlack,w.NoteheadXHalf,w.NoteheadXWhole)],[102,new Y("cowbell",-1,56,w.NoteheadTriangleUpBlack,w.NoteheadTriangleUpHalf,w.NoteheadTriangleUpWhole)],[103,new Y("cowbell",-1,56,w.NoteheadXBlack,w.NoteheadXHalf,w.NoteheadXWhole)],[77,new Y("woodblock",-9,77,w.NoteheadTriangleUpBlack,w.NoteheadTriangleUpBlack,w.NoteheadTriangleUpBlack)],[76,new Y("woodblock",-10,76,w.NoteheadTriangleUpBlack,w.NoteheadTriangleUpBlack,w.NoteheadTriangleUpBlack)],[60,new Y("bongo",-4,60,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[104,new Y("bongo",-5,60,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole,w.NoteheadParenthesis,Se.Middle)],[105,new Y("bongo",-6,60,w.NoteheadXBlack,w.NoteheadXBlack,w.NoteheadXBlack)],[61,new Y("bongo",-7,61,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[106,new Y("bongo",-8,61,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole,w.NoteheadParenthesis,Se.Middle)],[107,new Y("bongo",-16,61,w.NoteheadXBlack,w.NoteheadXBlack,w.NoteheadXBlack)],[66,new Y("timbale",10,66,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[65,new Y("timbale",9,65,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[68,new Y("agogo",12,68,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[67,new Y("agogo",11,67,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[64,new Y("conga",17,64,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[108,new Y("conga",16,64,w.NoteheadXBlack,w.NoteheadXBlack,w.NoteheadXBlack)],[109,new Y("conga",15,64,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole,w.NoteheadParenthesis,Se.Middle)],[63,new Y("conga",14,63,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[110,new Y("conga",13,63,w.NoteheadXBlack,w.NoteheadXBlack,w.NoteheadXBlack)],[62,new Y("conga",19,62,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole,w.NoteheadParenthesis,Se.Middle)],[72,new Y("whistle",-11,72,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[71,new Y("whistle",-17,71,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[73,new Y("guiro",38,73,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[74,new Y("guiro",37,74,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[86,new Y("surdo",36,86,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[87,new Y("surdo",35,87,w.NoteheadXBlack,w.NoteheadXBlack,w.NoteheadXBlack,w.NoteheadParenthesis,Se.Middle)],[54,new Y("tambourine",3,54,w.NoteheadTriangleUpBlack,w.NoteheadTriangleUpBlack,w.NoteheadTriangleUpBlack)],[111,new Y("tambourine",2,54,w.NoteheadTriangleUpBlack,w.NoteheadTriangleUpBlack,w.NoteheadTriangleUpBlack,w.StringsUpBow,Se.Bottom)],[112,new Y("tambourine",1,54,w.NoteheadTriangleUpBlack,w.NoteheadTriangleUpBlack,w.NoteheadTriangleUpBlack,w.StringsDownBow,Se.Bottom)],[113,new Y("tambourine",-7,54,w.NoteheadXBlack,w.NoteheadXBlack,w.NoteheadXBlack)],[79,new Y("cuica",30,79,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[78,new Y("cuica",29,78,w.NoteheadXBlack,w.NoteheadXBlack,w.NoteheadXBlack)],[58,new Y("vibraslap",28,58,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[81,new Y("triangle",27,81,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[80,new Y("triangle",26,80,w.NoteheadXBlack,w.NoteheadXBlack,w.NoteheadXBlack,w.NoteheadParenthesis,Se.Middle)],[114,new Y("grancassa",25,43,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[115,new Y("piatti",18,49,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[116,new Y("piatti",24,49,w.NoteheadXBlack,w.NoteheadXBlack,w.NoteheadXBlack)],[69,new Y("cabasa",23,69,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[117,new Y("cabasa",22,69,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole,w.StringsUpBow,Se.Bottom)],[85,new Y("castanets",21,85,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[75,new Y("claves",20,75,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[70,new Y("maraca",-12,70,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[118,new Y("maraca",-13,70,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole,w.StringsUpBow,Se.Bottom)],[119,new Y("maraca",-14,70,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[120,new Y("maraca",-15,70,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole,w.StringsUpBow,Se.Bottom)],[82,new Y("shaker",-23,54,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[122,new Y("shaker",-24,54,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole,w.StringsUpBow,Se.Bottom)],[84,new Y("bellTree",-18,53,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[123,new Y("bellTree",-19,53,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole,w.StringsUpBow,Se.Bottom)],[83,new Y("jingleBell",-20,53,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[124,new Y("unpitched",-21,62,w.NoteheadNull,w.NoteheadNull,w.NoteheadNull,w.GuitarGolpe,Se.Top)],[125,new Y("unpitched",-22,62,w.NoteheadNull,w.NoteheadNull,w.NoteheadNull,w.GuitarGolpe,Se.Bottom)],[39,new Y("handClap",3,39,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[40,new Y("snare",3,40,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[31,new Y("snare",3,40,w.NoteheadSlashedBlack2,w.NoteheadSlashedBlack2,w.NoteheadSlashedBlack2)],[41,new Y("tom",5,41,w.NoteheadBlack,w.NoteheadHalf,w.NoteheadWhole)],[59,new Y("ride",2,59,w.NoteheadXBlack,w.NoteheadXBlack,w.NoteheadXBlack,w.PictEdgeOfCymbal,Se.Bottom)],[126,new Y("ride",2,59,w.NoteheadXBlack,w.NoteheadXBlack,w.NoteheadXBlack)],[127,new Y("ride",2,59,w.NoteheadDiamondWhite,w.NoteheadDiamondWhite,w.NoteheadDiamondWhite)],[29,new Y("ride",2,59,w.NoteheadXBlack,w.NoteheadXBlack,w.NoteheadXBlack,w.ArticStaccatoAbove,Se.Top)],[30,new Y("crash",-3,49,w.NoteheadXBlack,w.NoteheadXBlack,w.NoteheadXBlack)],[33,new Y("snare",3,37,w.NoteheadXBlack,w.NoteheadXBlack,w.NoteheadXBlack)],[34,new Y("snare",3,38,w.NoteheadBlack,w.NoteheadBlack,w.NoteheadBlack)]]);At.instrumentArticulationNames=new Map([["Ride (choke)",29],["Cymbal (hit)",30],["Snare (side stick)",31],["Snare (side stick) 2",33],["Snare (hit)",34],["Kick (hit)",35],["Kick (hit) 2",36],["Snare (side stick) 3",37],["Snare (hit) 2",38],["Hand Clap (hit)",39],["Snare (hit) 3",40],["Low Floor Tom (hit)",41],["Hi-Hat (closed)",42],["Very Low Tom (hit)",43],["Pedal Hi-Hat (hit)",44],["Low Tom (hit)",45],["Hi-Hat (open)",46],["Mid Tom (hit)",47],["High Tom (hit)",48],["Crash high (hit)",49],["High Floor Tom (hit)",50],["Ride (middle)",51],["China (hit)",52],["Ride (bell)",53],["Tambourine (hit)",54],["Splash (hit)",55],["Cowbell medium (hit)",56],["Crash medium (hit)",57],["Vibraslap (hit)",58],["Ride (edge)",59],["Hand (hit)",60],["Hand (hit)",61],["Conga high (mute)",62],["Conga high (hit)",63],["Conga low (hit)",64],["Timbale high (hit)",65],["Timbale low (hit)",66],["Agogo high (hit)",67],["Agogo tow (hit)",68],["Cabasa (hit)",69],["Left Maraca (hit)",70],["Whistle high (hit)",71],["Whistle low (hit)",72],["Guiro (hit)",73],["Guiro (scrap-return)",74],["Claves (hit)",75],["Woodblock high (hit)",76],["Woodblock low (hit)",77],["Cuica (mute)",78],["Cuica (open)",79],["Triangle (rnute)",80],["Triangle (hit)",81],["Shaker (hit)",82],["Tinkle Bell (hat)",83],["Jingle Bell (hit)",83],["Bell Tree (hit)",84],["Castanets (hit)",85],["Surdo (hit)",86],["Surdo (mute)",87],["Snare (rim shot)",91],["Hi-Hat (half)",92],["Ride (edge) 2",93],["Ride (choke) 2",94],["Splash (choke)",95],["China (choke)",96],["Crash high (choke)",97],["Crash medium (choke)",98],["Cowbell low (hit)",99],["Cowbell low (tip)",100],["Cowbell medium (tip)",101],["Cowbell high (hit)",102],["Cowbell high (tip)",103],["Hand (mute)",104],["Hand (slap)",105],["Hand (mute) 2",106],["Hand (slap) 2",107],["Conga low (slap)",108],["Conga low (mute)",109],["Conga high (slap)",110],["Tambourine (return)",111],["Tambourine (roll)",112],["Tambourine (hand)",113],["Grancassa (hit)",114],["Piatti (hat)",115],["Piatti (hand)",116],["Cabasa (return)",117],["Left Maraca (return)",118],["Right Maraca (hit)",119],["Right Maraca (return)",120],["Shaker (return)",122],["Bell Tee (return)",123],["Golpe (thumb)",124],["Golpe (finger)",125],["Ride (middle) 2",126],["Ride (bell) 2",127]]);class ho{constructor(){this.tieDestinationNoteId=-1,this.tieOriginNoteId=-1,this.slurDestinationNoteId=-1,this.slurOriginNoteId=-1,this.hammerPullDestinationNoteId=-1,this.hammerPullOriginNoteId=-1}}class Nt{constructor(){this.id=Nt.GlobalNoteId++,this.index=0,this.accentuated=jt.None,this.bendType=ee.None,this.bendStyle=Je.Default,this.bendOrigin=null,this.isContinuedBend=!1,this.bendPoints=null,this.maxBendPoint=null,this.fret=-1,this.string=-1,this.octave=-1,this.tone=-1,this.percussionArticulation=-1,this.isVisible=!0,this.isLeftHandTapped=!1,this.isHammerPullOrigin=!1,this.hammerPullOrigin=null,this.hammerPullDestination=null,this.isSlurDestination=!1,this.slurOrigin=null,this.slurDestination=null,this.harmonicType=ne.None,this.harmonicValue=0,this.isGhost=!1,this.isLetRing=!1,this.letRingDestination=null,this.isPalmMute=!1,this.palmMuteDestination=null,this.isDead=!1,this.isStaccato=!1,this.slideInType=ri.None,this.slideOutType=xe.None,this.slideTarget=null,this.slideOrigin=null,this.vibrato=Ue.None,this.tieOrigin=null,this.tieDestination=null,this.isTieDestination=!1,this.leftHandFinger=be.Unknown,this.rightHandFinger=be.Unknown,this.isFingering=!1,this.trillValue=-1,this.trillSpeed=_.ThirtySecond,this.durationPercent=1,this.accidentalMode=Ft.Default,this.dynamics=_e.F,this.isEffectSlurOrigin=!1,this.hasEffectSlur=!1,this.effectSlurOrigin=null,this.effectSlurDestination=null,this._noteIdBag=null}get hasBend(){return this.bendPoints!==null&&this.bendType!==ee.None}get isStringed(){return this.string>=0}get isPiano(){return!this.isStringed&&this.octave>=0&&this.tone>=0}get isPercussion(){return!this.isStringed&&this.percussionArticulation>=0}get element(){return this.isPercussion?At.getElementAndVariation(this)[0]:-1}get variation(){return this.isPercussion?At.getElementAndVariation(this)[1]:-1}get isHammerPullDestination(){return!!this.hammerPullOrigin}get isSlurOrigin(){return!!this.slurDestination}get isHarmonic(){return this.harmonicType!==ne.None}get isTieOrigin(){return this.tieDestination!==null}get trillFret(){return this.trillValue-this.stringTuning}get isTrill(){return this.trillValue>=0}get isEffectSlurDestination(){return!!this.effectSlurOrigin}get stringTuning(){return this.beat.voice.bar.staff.capo+Nt.getStringTuning(this.beat.voice.bar.staff,this.string)}static getStringTuning(e,t){return e.tuning.length>0?e.tuning[e.tuning.length-(t-1)-1]:0}get realValue(){return this.calculateRealValue(!0,!0)}get realValueWithoutHarmonic(){return this.calculateRealValue(!0,!1)}calculateRealValue(e,t){const r=e?this.beat.voice.bar.staff.transpositionPitch:0;if(t){let n=this.calculateRealValue(e,!1);return this.isStringed&&(this.harmonicType===ne.Natural?n=this.harmonicPitch+this.stringTuning-r:n+=this.harmonicPitch),n}else return this.isPercussion?this.percussionArticulation:this.isStringed?this.fret+this.stringTuning-r:this.isPiano?this.octave*12+this.tone-r:0}get harmonicPitch(){if(this.harmonicType===ne.None||!this.isStringed)return 0;let e=this.harmonicValue;return ct.isAlmostEqualTo(e,2.4)?36:ct.isAlmostEqualTo(e,2.7)?34:e<3?0:e<=3.5?31:e<=4?28:e<=5?24:e<=6?34:e<=7?19:e<=8.5?36:e<=9?28:e<=10?34:e<=11?0:e<=12?12:e<14?0:e<=15?34:e<=16?28:e<=17?36:e<=18?0:e<=19?19:e<=21?0:e<=22?36:e<=24?24:0}get initialBendValue(){return this.hasBend?Math.floor(this.bendPoints[0].value/2):this.bendOrigin?Math.floor(this.bendOrigin.bendPoints[this.bendOrigin.bendPoints.length-1].value/2):this.isTieDestination&&this.tieOrigin.bendOrigin?Math.floor(this.tieOrigin.bendOrigin.bendPoints[this.tieOrigin.bendOrigin.bendPoints.length-1].value/2):this.beat.hasWhammyBar?Math.floor(this.beat.whammyBarPoints[0].value/2):this.beat.isContinuedWhammy?Math.floor(this.beat.previousBeat.whammyBarPoints[this.beat.previousBeat.whammyBarPoints.length-1].value/2):0}get displayValue(){return this.displayValueWithoutBend+this.initialBendValue}get displayValueWithoutBend(){let e=this.realValue;switch(this.harmonicType!==ne.Natural&&this.harmonicType!==ne.None&&(e-=this.harmonicPitch),this.beat.ottava){case $e._15ma:e-=24;break;case $e._8va:e-=12;break;case $e.Regular:break;case $e._8vb:e+=12;break;case $e._15mb:e+=24;break}switch(this.beat.voice.bar.clefOttava){case $e._15ma:e-=24;break;case $e._8va:e-=12;break;case $e.Regular:break;case $e._8vb:e+=12;break;case $e._15mb:e+=24;break}return e-this.beat.voice.bar.staff.displayTranspositionPitch}get hasQuarterToneOffset(){return this.hasBend?this.bendPoints[0].value%2!==0:this.bendOrigin?this.bendOrigin.bendPoints[this.bendOrigin.bendPoints.length-1].value%2!==0:this.beat.hasWhammyBar?this.beat.whammyBarPoints[0].value%2!==0:this.beat.isContinuedWhammy?this.beat.previousBeat.whammyBarPoints[this.beat.previousBeat.whammyBarPoints.length-1].value%2!==0:!1}addBendPoint(e){let t=this.bendPoints;t===null&&(t=[],this.bendPoints=t),t.push(e),(!this.maxBendPoint||e.value>this.maxBendPoint.value)&&(this.maxBendPoint=e),this.bendType===ee.None&&(this.bendType=ee.Custom)}finish(e,t=null){let r=new lB(()=>Nt.nextNoteOnSameLine(this)),n=e&&e.notation.notationMode===Zt.SongBook;if(this.isTieDestination&&(this.chain(t),n&&this.tieOrigin&&this.tieOrigin.isLetRing&&(this.isLetRing=!0)),this.isLetRing&&(!r.value||!r.value.isLetRing?this.letRingDestination=this:this.letRingDestination=r.value,n&&this.isTieDestination&&!this.tieOrigin.hasBend&&(this.isVisible=!1)),this.isPalmMute&&(!r.value||!r.value.isPalmMute?this.palmMuteDestination=this:this.palmMuteDestination=r.value),this.isHammerPullOrigin){let o=Nt.findHammerPullDestination(this);o?(this.hammerPullDestination=o,o.hammerPullOrigin=this):this.isHammerPullOrigin=!1}switch(this.slideOutType){case xe.Shift:case xe.Legato:this.slideTarget=r.value,this.slideTarget?this.slideTarget.slideOrigin=this:this.slideOutType=xe.None;break}let s=null;this.isHammerPullOrigin&&this.hammerPullDestination?s=this.hammerPullDestination:this.slideOutType===xe.Legato&&this.slideTarget&&(s=this.slideTarget),s&&(this.hasEffectSlur=!0,this.effectSlurOrigin&&this.beat.pickStroke===gi.None?(this.effectSlurOrigin.effectSlurDestination=s,this.effectSlurOrigin.effectSlurDestination.effectSlurOrigin=this.effectSlurOrigin,this.effectSlurOrigin=null):(this.isEffectSlurOrigin=!0,this.effectSlurDestination=s,this.effectSlurDestination.effectSlurOrigin=this));const a=this.bendPoints;if(a!=null&&a.length>0&&this.bendType===ee.Custom){let o=this.isTieDestination&&this.tieOrigin.hasBend;if(this.isContinuedBend=o,a.length===4){let l=a[0],u=a[1],c=a[2],h=a[3];u.value===c.value?h.value>l.value?u.value>h.value?this.bendType=ee.BendRelease:!o&&l.value>0?(this.bendType=ee.PrebendBend,a.splice(2,1),a.splice(1,1)):(this.bendType=ee.Bend,a.splice(2,1),a.splice(1,1)):h.value<l.value?o?(this.bendType=ee.Release,a.splice(2,1),a.splice(1,1)):(this.bendType=ee.PrebendRelease,a.splice(2,1),a.splice(1,1)):u.value>l.value?this.bendType=ee.BendRelease:l.value>0&&!o?(this.bendType=ee.Prebend,a.splice(2,1),a.splice(1,1)):(this.bendType=ee.Hold,a.splice(2,1),a.splice(1,1)):V.warning("Model","Unsupported bend type detected, fallback to custom",null)}else if(a.length===2){let l=a[0],u=a[1];u.value>l.value?!o&&l.value>0?this.bendType=ee.PrebendBend:this.bendType=ee.Bend:u.value<l.value?o?this.bendType=ee.Release:this.bendType=ee.PrebendRelease:l.value>0&&!o?this.bendType=ee.Prebend:this.bendType=ee.Hold}}else(a===null||a.length===0)&&(this.bendType=ee.None);this.initialBendValue>0&&(this.accidentalMode=Ft.Default)}static nextNoteOnSameLine(e){let t=e.beat.nextBeat;for(;t&&t.voice.bar.index<=e.beat.voice.bar.index+Nt.MaxOffsetForSameLineSearch;){let r=t.getNoteOnString(e.string);if(r)return r;t=t.nextBeat}return null}static findHammerPullDestination(e){let t=e.beat.nextBeat;for(;t&&t.voice.bar.index<=e.beat.voice.bar.index+Nt.MaxOffsetForSameLineSearch;){let r=t.getNoteOnString(e.string);if(r)return r;for(let n=e.string;n>0;n--)if(r=t.getNoteOnString(n),r){if(r.isLeftHandTapped)return r;break}for(let n=e.string;n<=e.beat.voice.bar.staff.tuning.length;n++)if(r=t.getNoteOnString(n),r){if(r.isLeftHandTapped)return r;break}t=t.nextBeat}return null}static findTieOrigin(e){let t=e.beat.previousBeat;for(;t&&t.voice.bar.index>=e.beat.voice.bar.index-Nt.MaxOffsetForSameLineSearch;){if(e.isStringed){let r=t.getNoteOnString(e.string);if(r)return r}else if(e.octave===-1&&e.tone===-1){if(e.index<t.notes.length)return t.notes[e.index]}else{let r=t.getNoteWithRealValue(e.realValue);if(r)return r}t=t.previousBeat}return null}chain(e=null){if(e!==null)if(this._noteIdBag!==null){let t;e.has(Nt.NoteIdLookupKey)?t=e.get(Nt.NoteIdLookupKey):(t=new Map,e.set(Nt.NoteIdLookupKey,t)),(this._noteIdBag.hammerPullDestinationNoteId!==-1||this._noteIdBag.tieDestinationNoteId!==-1||this._noteIdBag.slurDestinationNoteId!==-1)&&t.set(this.id,this),this._noteIdBag.hammerPullOriginNoteId!==-1&&(this.hammerPullOrigin=t.get(this._noteIdBag.hammerPullOriginNoteId),this.hammerPullOrigin.hammerPullDestination=this),this._noteIdBag.tieOriginNoteId!==-1&&(this.tieOrigin=t.get(this._noteIdBag.tieOriginNoteId),this.tieOrigin.tieDestination=this),this._noteIdBag.slurOriginNoteId!==-1&&(this.slurOrigin=t.get(this._noteIdBag.slurOriginNoteId),this.slurOrigin.slurDestination=this),this._noteIdBag=null}else{if(!this.isTieDestination&&this.tieOrigin===null)return;let t=this.tieOrigin??Nt.findTieOrigin(this);t?(t.tieDestination=this,this.tieOrigin=t,this.fret=t.fret,this.octave=t.octave,this.tone=t.tone,t.hasBend&&(this.bendOrigin=this.tieOrigin)):this.isTieDestination=!1}}toJson(e){this.tieDestination!==null&&e.set("tiedestinationnoteid",this.tieDestination.id),this.tieOrigin!==null&&e.set("tieoriginnoteid",this.tieOrigin.id),this.slurDestination!==null&&e.set("slurdestinationnoteid",this.slurDestination.id),this.slurOrigin!==null&&e.set("sluroriginnoteid",this.slurOrigin.id),this.hammerPullOrigin!==null&&e.set("hammerpulloriginnoteid",this.hammerPullOrigin.id),this.hammerPullDestination!==null&&e.set("hammerpulldestinationnoteid",this.hammerPullDestination.id)}setProperty(e,t){switch(e){case"tiedestinationnoteid":return this._noteIdBag==null&&(this._noteIdBag=new ho),this._noteIdBag.tieDestinationNoteId=t,!0;case"tieoriginnoteid":return this._noteIdBag==null&&(this._noteIdBag=new ho),this._noteIdBag.tieOriginNoteId=t,!0;case"slurdestinationnoteid":return this._noteIdBag==null&&(this._noteIdBag=new ho),this._noteIdBag.slurDestinationNoteId=t,!0;case"sluroriginnoteid":return this._noteIdBag==null&&(this._noteIdBag=new ho),this._noteIdBag.slurOriginNoteId=t,!0;case"hammerpulloriginnoteid":return this._noteIdBag==null&&(this._noteIdBag=new ho),this._noteIdBag.hammerPullOriginNoteId=t,!0;case"hammerpulldestinationnoteid":return this._noteIdBag==null&&(this._noteIdBag=new ho),this._noteIdBag.hammerPullDestinationNoteId=t,!0}return!1}}Nt.GlobalNoteId=0;Nt.MaxOffsetForSameLineSearch=3;Nt.NoteIdLookupKey="NoteIdLookup";class di{constructor(e){this._isEqualLengthTuplet=!0,this.totalDuration=0,this.beats=[],this.isFull=!1,this.voice=e}check(e){if(this.beats.length===0)return this.beats.push(e),this.totalDuration+=e.playbackDuration,!0;if(e.graceType!==ce.None)return!0;if(e.voice!==this.voice||this.isFull||e.tupletNumerator!==this.beats[0].tupletNumerator||e.tupletDenominator!==this.beats[0].tupletDenominator)return!1;if(e.playbackDuration!==this.beats[0].playbackDuration&&(this._isEqualLengthTuplet=!1),this.beats.push(e),this.totalDuration+=e.playbackDuration,this._isEqualLengthTuplet)this.beats.length===this.beats[0].tupletNumerator&&(this.isFull=!0);else{let t=this.beats[0].tupletNumerator/this.beats[0].tupletDenominator|0;for(let r of di.AllTicks)if(this.totalDuration===r*t){this.isFull=!0;break}}return!0}}di.HalfTicks=1920;di.QuarterTicks=960;di.EighthTicks=480;di.SixteenthTicks=240;di.ThirtySecondTicks=120;di.SixtyFourthTicks=60;di.OneHundredTwentyEighthTicks=30;di.TwoHundredFiftySixthTicks=15;di.AllTicks=[di.HalfTicks,di.QuarterTicks,di.EighthTicks,di.SixteenthTicks,di.ThirtySecondTicks,di.SixtyFourthTicks,di.OneHundredTwentyEighthTicks,di.TwoHundredFiftySixthTicks];var Ge;(function(i){i[i.None=0]="None",i[i.Custom=1]="Custom",i[i.Dive=2]="Dive",i[i.Dip=3]="Dip",i[i.Hold=4]="Hold",i[i.Predive=5]="Predive",i[i.PrediveDive=6]="PrediveDive"})(Ge||(Ge={}));class uB{static clone(e){const t=new $;return t.offset=e.offset,t.value=e.value,t}}class cB{static clone(e){const t=new Nt;if(t.index=e.index,t.accentuated=e.accentuated,t.bendType=e.bendType,t.bendStyle=e.bendStyle,t.isContinuedBend=e.isContinuedBend,e.bendPoints){t.bendPoints=[];for(const r of e.bendPoints)t.addBendPoint(uB.clone(r))}return t.fret=e.fret,t.string=e.string,t.octave=e.octave,t.tone=e.tone,t.percussionArticulation=e.percussionArticulation,t.isVisible=e.isVisible,t.isLeftHandTapped=e.isLeftHandTapped,t.isHammerPullOrigin=e.isHammerPullOrigin,t.isSlurDestination=e.isSlurDestination,t.harmonicType=e.harmonicType,t.harmonicValue=e.harmonicValue,t.isGhost=e.isGhost,t.isLetRing=e.isLetRing,t.isPalmMute=e.isPalmMute,t.isDead=e.isDead,t.isStaccato=e.isStaccato,t.slideInType=e.slideInType,t.slideOutType=e.slideOutType,t.vibrato=e.vibrato,t.isTieDestination=e.isTieDestination,t.leftHandFinger=e.leftHandFinger,t.rightHandFinger=e.rightHandFinger,t.isFingering=e.isFingering,t.trillValue=e.trillValue,t.trillSpeed=e.trillSpeed,t.durationPercent=e.durationPercent,t.accidentalMode=e.accidentalMode,t.dynamics=e.dynamics,t}}class $z{static clone(e){const t=new wi;return t.isLinear=e.isLinear,t.type=e.type,t.value=e.value,t.ratioPosition=e.ratioPosition,t.text=e.text,t}}class D1{static clone(e){const t=new xi;t.index=e.index,t.notes=[];for(const r of e.notes)t.addNote(cB.clone(r));t.isEmpty=e.isEmpty,t.whammyStyle=e.whammyStyle,t.ottava=e.ottava,t.isLegatoOrigin=e.isLegatoOrigin,t.duration=e.duration,t.isLetRing=e.isLetRing,t.isPalmMute=e.isPalmMute,t.automations=[];for(const r of e.automations)t.automations.push($z.clone(r));if(t.dots=e.dots,t.fadeIn=e.fadeIn,t.lyrics=e.lyrics?e.lyrics.slice():null,t.hasRasgueado=e.hasRasgueado,t.pop=e.pop,t.slap=e.slap,t.tap=e.tap,t.text=e.text,t.brushType=e.brushType,t.brushDuration=e.brushDuration,t.tupletDenominator=e.tupletDenominator,t.tupletNumerator=e.tupletNumerator,t.isContinuedWhammy=e.isContinuedWhammy,t.whammyBarType=e.whammyBarType,e.whammyBarPoints){t.whammyBarPoints=[];for(const r of e.whammyBarPoints)t.addWhammyBarPoint(uB.clone(r))}return t.vibrato=e.vibrato,t.chordId=e.chordId,t.graceType=e.graceType,t.pickStroke=e.pickStroke,t.tremoloSpeed=e.tremoloSpeed,t.crescendo=e.crescendo,t.displayStart=e.displayStart,t.playbackStart=e.playbackStart,t.displayDuration=e.displayDuration,t.playbackDuration=e.playbackDuration,t.dynamics=e.dynamics,t.invertBeamDirection=e.invertBeamDirection,t.preferredBeamDirection=e.preferredBeamDirection,t.isEffectSlurOrigin=e.isEffectSlurOrigin,t.beamingMode=e.beamingMode,t}}class u0{constructor(){this.beats=[],this.id="empty",this.isComplete=!1}addBeat(e){e.graceIndex=this.beats.length,e.graceGroup=this,this.beats.push(e)}finish(){this.beats.length>0&&(this.id=this.beats[0].absoluteDisplayStart+"_"+this.beats[0].voice.index)}}var kn;(function(i){i[i.Auto=0]="Auto",i[i.ForceSplitToNext=1]="ForceSplitToNext",i[i.ForceMergeWithNext=2]="ForceMergeWithNext"})(kn||(kn={}));class xi{constructor(){this.id=xi._globalBeatId++,this.index=0,this.previousBeat=null,this.nextBeat=null,this.notes=[],this.noteStringLookup=new Map,this.noteValueLookup=new Map,this.isEmpty=!1,this.whammyStyle=Je.Default,this.ottava=$e.Regular,this.fermata=null,this.isLegatoOrigin=!1,this.minNote=null,this.maxNote=null,this.maxStringNote=null,this.minStringNote=null,this.duration=_.Quarter,this.isLetRing=!1,this.isPalmMute=!1,this.automations=[],this.dots=0,this.fadeIn=!1,this.lyrics=null,this.hasRasgueado=!1,this.pop=!1,this.slap=!1,this.tap=!1,this.text=null,this.brushType=lt.None,this.brushDuration=0,this.tupletDenominator=-1,this.tupletNumerator=-1,this.tupletGroup=null,this.isContinuedWhammy=!1,this.whammyBarType=Ge.None,this.whammyBarPoints=null,this.maxWhammyPoint=null,this.minWhammyPoint=null,this.vibrato=Ue.None,this.chordId=null,this.graceType=ce.None,this.graceGroup=null,this.graceIndex=-1,this.pickStroke=gi.None,this.tremoloSpeed=null,this.crescendo=Zi.None,this.displayStart=0,this.playbackStart=0,this.displayDuration=0,this.playbackDuration=0,this.dynamics=_e.F,this.invertBeamDirection=!1,this.preferredBeamDirection=null,this.isEffectSlurOrigin=!1,this.effectSlurOrigin=null,this.effectSlurDestination=null,this.beamingMode=kn.Auto}get isLastOfVoice(){return this.index===this.voice.beats.length-1}get isLegatoDestination(){return!!this.previousBeat&&this.previousBeat.isLegatoOrigin}get isRest(){return this.isEmpty||this.notes.length===0}get isFullBarRest(){return this.isRest&&this.voice.beats.length===1&&this.duration===_.Whole}get hasTuplet(){return!(this.tupletDenominator===-1&&this.tupletNumerator===-1)&&!(this.tupletDenominator===1&&this.tupletNumerator===1)}get hasWhammyBar(){return this.whammyBarPoints!==null&&this.whammyBarType!==Ge.None}get hasChord(){return!!this.chordId}get chord(){return this.chordId?this.voice.bar.staff.getChord(this.chordId):null}get isTremolo(){return!!this.tremoloSpeed}get absoluteDisplayStart(){return this.voice.bar.masterBar.start+this.displayStart}get absolutePlaybackStart(){return this.voice.bar.masterBar.start+this.playbackStart}get isEffectSlurDestination(){return!!this.effectSlurOrigin}addWhammyBarPoint(e){let t=this.whammyBarPoints;t===null&&(t=[],this.whammyBarPoints=t),t.push(e),(!this.maxWhammyPoint||e.value>this.maxWhammyPoint.value)&&(this.maxWhammyPoint=e),(!this.minWhammyPoint||e.value<this.minWhammyPoint.value)&&(this.minWhammyPoint=e),this.whammyBarType===Ge.None&&(this.whammyBarType=Ge.Custom)}removeWhammyBarPoint(e){const t=this.whammyBarPoints;if(t===null||e<0||e>=t.length)return;t.splice(e,1);let r=t[e];if(r===this.maxWhammyPoint){this.maxWhammyPoint=null;for(let n of t)(!this.maxWhammyPoint||n.value>this.maxWhammyPoint.value)&&(this.maxWhammyPoint=n)}if(r===this.minWhammyPoint){this.minWhammyPoint=null;for(let n of t)(!this.minWhammyPoint||n.value<this.minWhammyPoint.value)&&(this.minWhammyPoint=n)}}addNote(e){e.beat=this,e.index=this.notes.length,this.notes.push(e),e.isStringed&&this.noteStringLookup.set(e.string,e)}removeNote(e){let t=this.notes.indexOf(e);t>=0&&(this.notes.splice(t,1),e.isStringed&&this.noteStringLookup.delete(e.string))}getAutomation(e){for(let t=0,r=this.automations.length;t<r;t++){let n=this.automations[t];if(n.type===e)return n}return null}getNoteOnString(e){return this.noteStringLookup.has(e)?this.noteStringLookup.get(e):null}calculateDuration(){if(this.isFullBarRest)return this.voice.bar.masterBar.calculateDuration();let e=we.toTicks(this.duration);return this.dots===2?e=we.applyDot(e,!0):this.dots===1&&(e=we.applyDot(e,!1)),this.tupletDenominator>0&&this.tupletNumerator>=0&&(e=we.applyTuplet(e,this.tupletNumerator,this.tupletDenominator)),e}updateDurations(){let e=this.calculateDuration();switch(this.playbackDuration=e,this.graceType){case ce.BeforeBeat:case ce.OnBeat:switch(this.duration){case _.Sixteenth:this.playbackDuration=we.toTicks(_.SixtyFourth);break;case _.ThirtySecond:this.playbackDuration=we.toTicks(_.OneHundredTwentyEighth);break;default:this.playbackDuration=we.toTicks(_.ThirtySecond);break}this.displayDuration=0;break;case ce.BendGrace:this.playbackDuration/=2,this.displayDuration=0;break;default:this.displayDuration=e;let t=this.previousBeat;t&&t.graceType===ce.BendGrace&&(this.playbackDuration=t.playbackDuration);break}}finishTuplet(){let e=this.previousBeat,t=e?e.tupletGroup:null;if((this.hasTuplet||this.graceType!==ce.None&&t)&&((!e||!t||!t.check(this))&&(t=new di(this.voice),t.check(this)),this.tupletGroup=t),this.index>0){const r=this.voice.bar.masterBar.calculateDuration(),n=[];for(const s of this.automations)s.ratioPosition===0&&(s.ratioPosition=this.playbackStart/r),s.type!==$t.Volume&&n.push(s);this.automations=n}}finish(e,t=null){switch(this.getAutomation($t.Instrument)===null&&this.index===0&&this.voice.index===0&&this.voice.bar.index===0&&this.voice.bar.staff.index===0&&this.automations.push(wi.buildInstrumentAutomation(!1,0,this.voice.bar.staff.track.playbackInfo.program)),this.graceType){case ce.OnBeat:case ce.BeforeBeat:let u=this.graceGroup.beats.length;u===1?this.duration=_.Eighth:u===2?this.duration=_.Sixteenth:this.duration=_.ThirtySecond;break}let r=e?e.notation.notationMode:Zt.GuitarPro,n=this.text==="grad"||this.text==="grad.";n&&r===Zt.SongBook&&(this.text="");let s=!1;this.minNote=null,this.maxNote=null,this.minStringNote=null,this.maxStringNote=null;let a=0,o=!1;for(let u=0,c=this.notes.length;u<c;u++){let h=this.notes[u];if(h.dynamics=this.dynamics,h.finish(e,t),h.isLetRing&&(this.isLetRing=!0),h.isPalmMute&&(this.isPalmMute=!0),r===Zt.SongBook&&h.hasBend&&this.graceType!==ce.BendGrace){if(!h.isTieOrigin)switch(h.bendType){case ee.Bend:case ee.PrebendRelease:case ee.PrebendBend:s=!0;break}n||h.bendStyle===Je.Gradual?(n=!0,h.bendStyle=Je.Gradual,s=!1):h.bendStyle=Je.Fast}h.isVisible&&(a++,(!this.minNote||h.realValue<this.minNote.realValue)&&(this.minNote=h),(!this.maxNote||h.realValue>this.maxNote.realValue)&&(this.maxNote=h),(!this.minStringNote||h.string<this.minStringNote.string)&&(this.minStringNote=h),(!this.maxStringNote||h.string>this.maxStringNote.string)&&(this.maxStringNote=h),h.hasEffectSlur&&(o=!0))}if(o&&(this.effectSlurOrigin?(this.effectSlurOrigin.effectSlurDestination=this.nextBeat,this.effectSlurOrigin.effectSlurDestination&&(this.effectSlurOrigin.effectSlurDestination.effectSlurOrigin=this.effectSlurOrigin),this.effectSlurOrigin=null):(this.isEffectSlurOrigin=!0,this.effectSlurDestination=this.nextBeat,this.effectSlurDestination&&(this.effectSlurDestination.effectSlurOrigin=this))),this.notes.length>0&&a===0&&(this.isEmpty=!0),!this.isRest&&(!this.isLetRing||!this.isPalmMute)){let u=this.previousBeat;for(;u&&u.isRest;)this.isLetRing||(u.isLetRing=!1),this.isPalmMute||(u.isPalmMute=!1),u=u.previousBeat}else this.isRest&&this.previousBeat&&e&&e.notation.notationMode===Zt.GuitarPro&&(this.previousBeat.isLetRing&&(this.isLetRing=!0),this.previousBeat.isPalmMute&&(this.isPalmMute=!0));const l=this.whammyBarPoints;if(l!==null&&l.length>0&&this.whammyBarType===Ge.Custom){r===Zt.SongBook&&(this.whammyStyle=n?Je.Gradual:Je.Fast);let u=!!this.previousBeat&&this.previousBeat.hasWhammyBar;if(this.isContinuedWhammy=u,l.length===4){let c=l[0],h=l[1],d=l[2],f=l[3];h.value===d.value&&(c.value<h.value&&h.value<f.value||c.value>h.value&&h.value>f.value?(c.value!==0&&!u?this.whammyBarType=Ge.PrediveDive:this.whammyBarType=Ge.Dive,l.splice(2,1),l.splice(1,1)):c.value>h.value&&h.value<f.value||c.value<h.value&&h.value>f.value?(this.whammyBarType=Ge.Dip,(h.offset===d.offset||r===Zt.SongBook)&&l.splice(2,1)):c.value===h.value&&h.value===f.value&&(c.value!==0&&!u?this.whammyBarType=Ge.Predive:this.whammyBarType=Ge.Hold,l.splice(2,1),l.splice(1,1)))}}if(this.updateDurations(),s){let u=D1.clone(this);u.id=xi._globalBeatId++,u.pickStroke=gi.None;for(let c=0,h=u.notes.length;c<h;c++){let d=u.notes[c],f=this.notes[c];if(d.bendType=ee.None,d.maxBendPoint=null,d.bendPoints=null,d.bendStyle=Je.Default,d.id=Nt.GlobalNoteId++,f.isTieOrigin&&(d.tieDestination=f.tieDestination,f.tieDestination.tieOrigin=d),f.isTieDestination&&(d.tieOrigin=f.tieOrigin?f.tieOrigin:null,f.tieOrigin.tieDestination=d),f.hasBend&&f.isTieOrigin){let p=Nt.findTieOrigin(f);if(p&&p.hasBend){d.bendType=ee.Hold;let g=f.bendPoints[f.bendPoints.length-1];d.addBendPoint(new $(0,g.value)),d.addBendPoint(new $($.MaxPosition,g.value))}}d.isTieDestination=!0}this.graceType=ce.BendGrace,this.graceGroup=new u0,this.graceGroup.addBeat(this),this.graceGroup.isComplete=!0,this.graceGroup.finish(),this.updateDurations(),this.voice.insertBeat(this,u),u.graceGroup=new u0,u.graceGroup.addBeat(this),u.graceGroup.isComplete=!0,u.graceGroup.finish()}}isBefore(e){return this.voice.bar.index<e.voice.bar.index||e.voice.bar.index===this.voice.bar.index&&this.index<e.index}isAfter(e){return this.voice.bar.index>e.voice.bar.index||e.voice.bar.index===this.voice.bar.index&&this.index>e.index}hasNoteOnString(e){return this.noteStringLookup.has(e)}getNoteWithRealValue(e){return this.noteValueLookup.has(e)?this.noteValueLookup.get(e):null}chain(e=null){for(const t of this.notes)this.noteValueLookup.set(t.realValue,t),t.chain(e)}}xi._globalBeatId=0;class ha{constructor(){this.name="",this.firstFret=1,this.strings=[],this.barreFrets=[],this.showName=!0,this.showDiagram=!0,this.showFingering=!0}get uniqueId(){return[this.name,this.firstFret.toString(),this.strings.join(","),this.barreFrets.join(","),this.showDiagram.toString(),this.showFingering.toString(),this.showName.toString()].join("|")}}var qt;(function(i){i[i.Cb=-7]="Cb",i[i.Gb=-6]="Gb",i[i.Db=-5]="Db",i[i.Ab=-4]="Ab",i[i.Eb=-3]="Eb",i[i.Bb=-2]="Bb",i[i.F=-1]="F",i[i.C=0]="C",i[i.G=1]="G",i[i.D=2]="D",i[i.A=3]="A",i[i.E=4]="E",i[i.B=5]="B",i[i.FSharp=6]="FSharp",i[i.CSharp=7]="CSharp"})(qt||(qt={}));var ki;(function(i){i[i.IgnoreSpaces=0]="IgnoreSpaces",i[i.Begin=1]="Begin",i[i.Text=2]="Text",i[i.Comment=3]="Comment",i[i.Dash=4]="Dash"})(ki||(ki={}));class Ut{constructor(){this.startBar=0,this.text=""}finish(e=!1){this.chunks=[],this.parse(this.text,0,this.chunks,e)}parse(e,t,r,n){if(!e)return;let s=ki.Begin,a=ki.Begin,o=!1,l=0;for(;t<e.length;){let u=e.charCodeAt(t);switch(s){case ki.IgnoreSpaces:switch(u){case Ut.CharCodeLF:case Ut.CharCodeCR:case Ut.CharCodeTab:break;case Ut.CharCodeSpace:if(!o){s=a;continue}break;default:o=!1,s=a;continue}break;case ki.Begin:switch(u){case Ut.CharCodeBrackedOpen:s=ki.Comment;break;default:l=t,s=ki.Text;continue}break;case ki.Comment:switch(u){case Ut.CharCodeBrackedClose:s=ki.Begin;break}break;case ki.Text:switch(u){case Ut.CharCodeDash:s=ki.Dash;break;case Ut.CharCodeCR:case Ut.CharCodeLF:case Ut.CharCodeSpace:let c=e.substr(l,t-l);this.addChunk(c,n),s=ki.IgnoreSpaces,a=ki.Begin;break}break;case ki.Dash:switch(u){case Ut.CharCodeDash:break;default:let c=e.substr(l,t-l);this.addChunk(c,n),o=!0,s=ki.IgnoreSpaces,a=ki.Begin;continue}break}t+=1}s===ki.Text&&t!==l&&this.addChunk(e.substr(l,t-l),n)}addChunk(e,t){e=this.prepareChunk(e),(!t||e.length>0&&e!=="-")&&this.chunks.push(e)}prepareChunk(e){let t=e.split("+").join(" "),r=t.length;for(;r>0&&t.charAt(r-1)==="_";)r--;return r!==t.length?t.substr(0,r):t}}Ut.CharCodeLF=10;Ut.CharCodeTab=9;Ut.CharCodeCR=13;Ut.CharCodeSpace=32;Ut.CharCodeBrackedClose=93;Ut.CharCodeBrackedOpen=91;Ut.CharCodeDash=45;var da;(function(i){i[i.Major=0]="Major",i[i.Minor=1]="Minor"})(da||(da={}));var Be;(function(i){i[i.NoTripletFeel=0]="NoTripletFeel",i[i.Triplet16th=1]="Triplet16th",i[i.Triplet8th=2]="Triplet8th",i[i.Dotted16th=3]="Dotted16th",i[i.Dotted8th=4]="Dotted8th",i[i.Scottish16th=5]="Scottish16th",i[i.Scottish8th=6]="Scottish8th"})(Be||(Be={}));class Ts{constructor(){this.alternateEndings=0,this.nextMasterBar=null,this.previousMasterBar=null,this.index=0,this.keySignature=qt.C,this.keySignatureType=da.Major,this.isDoubleBar=!1,this.isRepeatStart=!1,this.repeatCount=0,this.timeSignatureNumerator=4,this.timeSignatureDenominator=4,this.timeSignatureCommon=!1,this.tripletFeel=Be.NoTripletFeel,this.section=null,this.tempoAutomations=[],this.fermata=null,this.start=0,this.isAnacrusis=!1,this.displayScale=1,this.displayWidth=-1}get isRepeatEnd(){return this.repeatCount>0}get isSectionStart(){return!!this.section}get tempoAutomation(){return this.tempoAutomations.length>0?this.tempoAutomations[0]:null}calculateDuration(e=!0){if(this.isAnacrusis&&e){let t=0;for(let r of this.score.tracks)for(let n of r.staves){let s=this.index<n.bars.length?n.bars[this.index].calculateDuration():0;s>t&&(t=s)}return t}return this.timeSignatureNumerator*we.valueToTicks(this.timeSignatureDenominator)}addFermata(e,t){let r=this.fermata;r===null&&(r=new Map,this.fermata=r),r.set(e,t)}getFermata(e){const t=this.fermata;return t===null?null:t.has(e.playbackStart)?t.get(e.playbackStart):null}}Ts.MaxAlternateEndings=8;class jz{constructor(){this.hideDynamics=!1}}class cS{constructor(){this.masterBars=[],this.opening=null,this.closings=[],this.isClosed=!1}get openings(){const e=this.opening;return e?[e]:[]}get isOpened(){var e;return((e=this.opening)==null?void 0:e.isRepeatStart)===!0}addMasterBar(e){this.opening===null&&(this.opening=e),this.masterBars.push(e),e.repeatGroup=this,e.isRepeatEnd&&(this.closings.push(e),this.isClosed=!0)}}let no=class{constructor(){this._currentRepeatGroup=null,this._openedRepeatGroups=[],this._properlyOpenedRepeatGroups=0,this.album="",this.artist="",this.copyright="",this.instructions="",this.music="",this.notices="",this.subTitle="",this.title="",this.words="",this.tab="",this.tempo=120,this.tempoLabel="",this.masterBars=[],this.tracks=[],this.defaultSystemsLayout=3,this.systemsLayout=[],this.stylesheet=new jz}rebuildRepeatGroups(){this._currentRepeatGroup=null,this._openedRepeatGroups=[],this._properlyOpenedRepeatGroups=0;for(const e of this.masterBars)this.addMasterBarToRepeatGroups(e)}addMasterBar(e){e.score=this,e.index=this.masterBars.length,this.masterBars.length!==0&&(e.previousMasterBar=this.masterBars[this.masterBars.length-1],e.previousMasterBar.nextMasterBar=e,e.start=e.previousMasterBar.start+(e.previousMasterBar.isAnacrusis?0:e.previousMasterBar.calculateDuration())),this.addMasterBarToRepeatGroups(e),this.masterBars.push(e)}addMasterBarToRepeatGroups(e){var t;e.isRepeatStart?((t=this._currentRepeatGroup)!=null&&t.isClosed&&(this._openedRepeatGroups.pop(),this._properlyOpenedRepeatGroups--),this._currentRepeatGroup=new cS,this._openedRepeatGroups.push(this._currentRepeatGroup),this._properlyOpenedRepeatGroups++):this._currentRepeatGroup||(this._currentRepeatGroup=new cS,this._openedRepeatGroups.push(this._currentRepeatGroup)),this._currentRepeatGroup.addMasterBar(e),e.isRepeatEnd&&this._properlyOpenedRepeatGroups>1&&(this._openedRepeatGroups.pop(),this._properlyOpenedRepeatGroups--,this._currentRepeatGroup=this._openedRepeatGroups.length>0?this._openedRepeatGroups[this._openedRepeatGroups.length-1]:null)}addTrack(e){e.score=this,e.index=this.tracks.length,this.tracks.push(e)}finish(e){const t=new Map;for(let r=0,n=this.tracks.length;r<n;r++)this.tracks[r].finish(e,t)}};class hp{constructor(){this.marker="",this.text=""}}class zt extends oi{constructor(e){super(ai.Format,e),Object.setPrototypeOf(this,zt.prototype)}}class qe{constructor(e,t,r,n=255){this.raw=0,this.raw=(n&255)<<24|(e&255)<<16|(t&255)<<8|r&255,this.updateRgba()}updateRgba(){this.a===255?this.rgba="#"+ct.toHexString(this.r,2)+ct.toHexString(this.g,2)+ct.toHexString(this.b,2):this.rgba=`rgba(${this.r},${this.g},${this.b},${this.a/255})`}get a(){return this.raw>>24&255}get r(){return this.raw>>16&255}get g(){return this.raw>>8&255}get b(){return this.raw&255}static random(e=100){return new qe(Math.random()*255|0,Math.random()*255|0,Math.random()*255|0,e)}static fromJson(e){if(e instanceof qe)return e;switch(typeof e){case"number":{const t=new qe(0,0,0,0);return t.raw=e,t.updateRgba(),t}case"string":{const t=e;if(t.startsWith("#")){if(t.length===4)return new qe(parseInt(t[1],16)*17,parseInt(t[2],16)*17,parseInt(t[3],16)*17);if(t.length===5)return new qe(parseInt(t[1],16)*17,parseInt(t[2],16)*17,parseInt(t[3],16)*17,parseInt(t[4],16)*17);if(t.length===7)return new qe(parseInt(t.substring(1,3),16),parseInt(t.substring(3,5),16),parseInt(t.substring(5,7),16));if(t.length===9)return new qe(parseInt(t.substring(1,3),16),parseInt(t.substring(3,5),16),parseInt(t.substring(5,7),16),parseInt(t.substring(7,9),16))}else if(t.startsWith("rgba")||t.startsWith("rgb")){const r=t.indexOf("("),n=t.lastIndexOf(")");if(r===-1||n===-1)throw new zt("No values specified for rgb/rgba function");const s=t.substring(r+1,n).split(",");if(s.length===3)return new qe(parseInt(s[0]),parseInt(s[1]),parseInt(s[2]));if(s.length===4)return new qe(parseInt(s[0]),parseInt(s[1]),parseInt(s[2]),parseFloat(s[3])*255)}return null}}throw new zt("Unsupported format for color")}static toJson(e){return e.raw}}qe.BlackRgb="#000000";class hB{constructor(){this.volume=15,this.balance=8,this.port=1,this.program=0,this.primaryChannel=0,this.secondaryChannel=0,this.isMute=!1,this.isSolo=!1}}class F{static getTextForTuning(e,t){let r=F.getTextPartsForTuning(e);return t?r.join(""):r[0]}static getTextPartsForTuning(e,t=-1){let r=e/12|0,n=e%12;return[["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"][n],(r+t).toString()]}static getDefaultTuningFor(e){return F._defaultTunings.has(e)?F._defaultTunings.get(e):null}static getPresetsFor(e){switch(e){case 7:return F._sevenStrings;case 6:return F._sixStrings;case 5:return F._fiveStrings;case 4:return F._fourStrings}return[]}static initialize(){F._defaultTunings.set(7,new F("Guitar 7 strings",[64,59,55,50,45,40,35],!0)),F._sevenStrings.push(F._defaultTunings.get(7)),F._defaultTunings.set(6,new F("Guitar Standard Tuning",[64,59,55,50,45,40],!0)),F._sixStrings.push(F._defaultTunings.get(6)),F._sixStrings.push(new F("Guitar Tune down ½ step",[63,58,54,49,44,39],!1)),F._sixStrings.push(new F("Guitar Tune down 1 step",[62,57,53,48,43,38],!1)),F._sixStrings.push(new F("Guitar Tune down 2 step",[60,55,51,46,41,36],!1)),F._sixStrings.push(new F("Guitar Dropped D Tuning",[64,59,55,50,45,38],!1)),F._sixStrings.push(new F("Guitar Dropped D Tuning variant",[64,57,55,50,45,38],!1)),F._sixStrings.push(new F("Guitar Double Dropped D Tuning",[62,59,55,50,45,38],!1)),F._sixStrings.push(new F("Guitar Dropped E Tuning",[66,61,57,52,47,40],!1)),F._sixStrings.push(new F("Guitar Dropped C Tuning",[62,57,53,48,43,36],!1)),F._sixStrings.push(new F("Guitar Open C Tuning",[64,60,55,48,43,36],!1)),F._sixStrings.push(new F("Guitar Open Cm Tuning",[63,60,55,48,43,36],!1)),F._sixStrings.push(new F("Guitar Open C6 Tuning",[64,57,55,48,43,36],!1)),F._sixStrings.push(new F("Guitar Open Cmaj7 Tuning",[64,59,55,52,43,36],!1)),F._sixStrings.push(new F("Guitar Open D Tuning",[62,57,54,50,45,38],!1)),F._sixStrings.push(new F("Guitar Open Dm Tuning",[62,57,53,50,45,38],!1)),F._sixStrings.push(new F("Guitar Open D5 Tuning",[62,57,50,50,45,38],!1)),F._sixStrings.push(new F("Guitar Open D6 Tuning",[62,59,54,50,45,38],!1)),F._sixStrings.push(new F("Guitar Open Dsus4 Tuning",[62,57,55,50,45,38],!1)),F._sixStrings.push(new F("Guitar Open E Tuning",[64,59,56,52,47,40],!1)),F._sixStrings.push(new F("Guitar Open Em Tuning",[64,59,55,52,47,40],!1)),F._sixStrings.push(new F("Guitar Open Esus11 Tuning",[64,59,55,52,45,40],!1)),F._sixStrings.push(new F("Guitar Open F Tuning",[65,60,53,48,45,41],!1)),F._sixStrings.push(new F("Guitar Open G Tuning",[62,59,55,50,43,38],!1)),F._sixStrings.push(new F("Guitar Open Gm Tuning",[62,58,55,50,43,38],!1)),F._sixStrings.push(new F("Guitar Open G6 Tuning",[64,59,55,50,43,38],!1)),F._sixStrings.push(new F("Guitar Open Gsus4 Tuning",[62,60,55,50,43,38],!1)),F._sixStrings.push(new F("Guitar Open A Tuning",[64,61,57,52,45,40],!1)),F._sixStrings.push(new F("Guitar Open Am Tuning",[64,60,57,52,45,40],!1)),F._sixStrings.push(new F("Guitar Nashville Tuning",[64,59,67,62,57,52],!1)),F._sixStrings.push(new F("Bass 6 Strings Tuning",[48,43,38,33,28,23],!1)),F._sixStrings.push(new F("Lute or Vihuela Tuning",[64,59,54,50,45,40],!1)),F._defaultTunings.set(5,new F("Bass 5 Strings Tuning",[43,38,33,28,23],!0)),F._fiveStrings.push(F._defaultTunings.get(5)),F._fiveStrings.push(new F("Banjo Dropped C Tuning",[62,59,55,48,67],!1)),F._fiveStrings.push(new F("Banjo Open D Tuning",[62,57,54,50,69],!1)),F._fiveStrings.push(new F("Banjo Open G Tuning",[62,59,55,50,67],!1)),F._fiveStrings.push(new F("Banjo G Minor Tuning",[62,58,55,50,67],!1)),F._fiveStrings.push(new F("Banjo G Modal Tuning",[62,57,55,50,67],!1)),F._defaultTunings.set(4,new F("Bass Standard Tuning",[43,38,33,28],!0)),F._fourStrings.push(F._defaultTunings.get(4)),F._fourStrings.push(new F("Bass Tune down ½ step",[42,37,32,27],!1)),F._fourStrings.push(new F("Bass Tune down 1 step",[41,36,31,26],!1)),F._fourStrings.push(new F("Bass Tune down 2 step",[39,34,29,24],!1)),F._fourStrings.push(new F("Bass Dropped D Tuning",[43,38,33,26],!1)),F._fourStrings.push(new F("Ukulele C Tuning",[45,40,36,43],!1)),F._fourStrings.push(new F("Ukulele G Tuning",[52,47,43,38],!1)),F._fourStrings.push(new F("Mandolin Standard Tuning",[64,57,50,43],!1)),F._fourStrings.push(new F("Mandolin or Violin Tuning",[76,69,62,55],!1)),F._fourStrings.push(new F("Viola Tuning",[69,62,55,48],!1)),F._fourStrings.push(new F("Cello Tuning",[57,50,43,36],!1))}static findTuning(e){let t=F.getPresetsFor(e.length);for(let r=0,n=t.length;r<n;r++){let s=t[r],a=!0;for(let o=0,l=e.length;o<l;o++)if(e[o]!==s.tunings[o]){a=!1;break}if(a)return s}return null}constructor(e="",t=null,r=!1){this.isStandard=r,this.name=e,this.tunings=t??[]}finish(){const e=F.findTuning(this.tunings);e&&(this.name=e.name,this.isStandard=e.isStandard),this.name=this.name.trim()}}F._sevenStrings=[];F._sixStrings=[];F._fiveStrings=[];F._fourStrings=[];F._defaultTunings=new Map;F.defaultAccidentals=["","#","","#","","","#","","#","","#",""];F.defaultSteps=["C","C","D","D","E","F","F","G","G","A","A","B"];F.initialize();class dB{constructor(){this.index=0,this.bars=[],this.chords=null,this.capo=0,this.transpositionPitch=0,this.displayTranspositionPitch=0,this.stringTuning=new F("",[],!1),this.showSlash=!1,this.showTablature=!0,this.showStandardNotation=!0,this.isPercussion=!1,this.standardNotationLineCount=5}get tuning(){return this.stringTuning.tunings}get tuningName(){return this.stringTuning.name}get isStringed(){return this.stringTuning.tunings.length>0}finish(e,t=null){this.stringTuning.finish();for(let r=0,n=this.bars.length;r<n;r++)this.bars[r].finish(e,t)}addChord(e,t){t.staff=this;let r=this.chords;r===null&&(r=new Map,this.chords=r),r.set(e,t)}hasChord(e){var t;return((t=this.chords)==null?void 0:t.has(e))??!1}getChord(e){var t;return((t=this.chords)==null?void 0:t.get(e))??null}addBar(e){let t=this.bars;e.staff=this,e.index=t.length,t.length>0&&(e.previousBar=t[t.length-1],e.previousBar.nextBar=e),t.push(e)}}class Jn{constructor(){this.index=0,this.staves=[],this.playbackInfo=new hB,this.color=new qe(200,0,0,255),this.name="",this.isVisibleOnMultiTrack=!0,this.shortName="",this.defaultSystemsLayout=3,this.systemsLayout=[],this.percussionArticulations=[]}ensureStaveCount(e){for(;this.staves.length<e;)this.addStaff(new dB)}addStaff(e){e.index=this.staves.length,e.track=this,this.staves.push(e)}finish(e,t=null){this.shortName||(this.shortName=this.name,this.shortName.length>Jn.ShortNameMaxLength&&(this.shortName=this.shortName.substr(0,Jn.ShortNameMaxLength)));for(let r=0,n=this.staves.length;r<n;r++)this.staves[r].finish(e,t)}applyLyrics(e){for(let r of e)r.finish();let t=this.staves[0];for(let r=0;r<e.length;r++){let n=e[r];if(n.startBar>=0&&n.startBar<t.bars.length){let s=t.bars[n.startBar].voices[0].beats[0];for(let a=0;a<n.chunks.length&&s;a++){for(;s&&(s.isEmpty||s.isRest);)s=s.nextBeat;s&&(s.lyrics||(s.lyrics=new Array(e.length),s.lyrics.fill("")),s.lyrics[r]=n.chunks[a],s=s.nextBeat)}}}}}Jn.ShortNameMaxLength=10;let Qn=class fB{constructor(){this.id=fB._globalBarId++,this.index=0,this.beats=[],this.isEmpty=!0}insertBeat(e,t){t.nextBeat=e.nextBeat,t.nextBeat&&(t.nextBeat.previousBeat=t),t.previousBeat=e,t.voice=this,e.nextBeat=t,this.beats.splice(e.index+1,0,t)}addBeat(e){e.voice=this,e.index=this.beats.length,this.beats.push(e),e.isEmpty||(this.isEmpty=!1)}chain(e,t=null){if(this.bar){if(e.index<this.beats.length-1)e.nextBeat=this.beats[e.index+1],e.nextBeat.previousBeat=e;else if(e.isLastOfVoice&&e.voice.bar.nextBar){let r=this.bar.nextBar.voices[this.index];r.beats.length>0&&(e.nextBeat=r.beats[0]),e.nextBeat.previousBeat=e}e.chain(t)}}addGraceBeat(e){if(this.beats.length===0){this.addBeat(e);return}let t=this.beats[this.beats.length-1];this.beats.splice(this.beats.length-1,1),this.addBeat(e),this.addBeat(t),this.isEmpty=!1}getBeatAtPlaybackStart(e){return this._beatLookup.has(e)?this._beatLookup.get(e):null}finish(e,t=null){this._beatLookup=new Map;let r=null;for(let a=0;a<this.beats.length;a++){let o=this.beats[a];o.index=a,this.chain(o,t),o.graceType===ce.None?(o.graceGroup=r,r&&(r.isComplete=!0),r=null):(r||(r=new u0),r.addBeat(o))}let n=0,s=0;for(let a=0;a<this.beats.length;a++){let o=this.beats[a];if(o.index=a,o.finish(e,t),o.graceType===ce.None){if(o.graceGroup){const l=o.graceGroup.beats[0],u=o.graceGroup.beats[o.graceGroup.beats.length-1];if(l.graceType!==ce.BendGrace){let c=u.playbackStart+u.playbackDuration-l.playbackStart;switch(l.graceType){case ce.BeforeBeat:l.previousBeat?(l.previousBeat.playbackDuration-=c,l.previousBeat.voice==this?s=l.previousBeat.playbackStart+l.previousBeat.playbackDuration:s=-c):s=-c;for(const h of o.graceGroup.beats)this._beatLookup.delete(h.playbackStart),h.playbackStart=s,this._beatLookup.set(h.playbackStart,o),s+=h.playbackDuration;break;case ce.OnBeat:o.playbackDuration-=c,u.voice===this?s=u.playbackStart+u.playbackDuration:s=-c;break}}}o.displayStart=n,o.playbackStart=s,o.fermata?this.bar.masterBar.addFermata(o.playbackStart,o.fermata):o.fermata=this.bar.masterBar.getFermata(o),this._beatLookup.set(o.playbackStart,o)}else o.displayStart=n,o.playbackStart=s;o.finishTuplet(),o.graceGroup&&o.graceGroup.finish(),n+=o.displayDuration,s+=o.playbackDuration}}calculateDuration(){if(this.isEmpty||this.beats.length===0)return 0;let e=this.beats[this.beats.length-1],t=this.beats[0];return e.playbackStart+e.playbackDuration-t.playbackStart}};Qn._globalBarId=0;class Ne{static float64ToBytes(e){return Ne._dataView.setFloat64(0,e,!0),this._conversionByteArray}static bytesToFloat64(e){throw Ne._conversionByteArray.set(e,0),Ne._dataView.getFloat64(0,!0)}static uint16ToInt16(e){return Ne._dataView.setUint16(0,e,!0),Ne._dataView.getInt16(0,!0)}static int16ToUint32(e){return Ne._dataView.setInt16(0,e,!0),Ne._dataView.getUint32(0,!0)}static int32ToUint16(e){return Ne._dataView.setInt32(0,e,!0),Ne._dataView.getUint16(0,!0)}static int32ToInt16(e){return Ne._dataView.setInt32(0,e,!0),Ne._dataView.getInt16(0,!0)}static int32ToUint32(e){return Ne._dataView.setInt32(0,e,!0),Ne._dataView.getUint32(0,!0)}static uint8ToInt8(e){return Ne._dataView.setUint8(0,e),Ne._dataView.getInt8(0)}}Ne._conversionBuffer=new ArrayBuffer(8);Ne._conversionByteArray=new Uint8Array(Ne._conversionBuffer);Ne._dataView=new DataView(Ne._conversionBuffer);class M{static readInt32BE(e){let t=e.readByte(),r=e.readByte(),n=e.readByte(),s=e.readByte();return t<<24|r<<16|n<<8|s}static readInt32LE(e){let t=e.readByte(),r=e.readByte(),n=e.readByte();return e.readByte()<<24|n<<16|r<<8|t}static readUInt32LE(e){let t=e.readByte(),r=e.readByte(),n=e.readByte();return e.readByte()<<24|n<<16|r<<8|t}static decodeUInt32LE(e,t){let r=e[t],n=e[t+1],s=e[t+2];return e[t+3]<<24|s<<16|n<<8|r}static readUInt16LE(e){let t=e.readByte(),r=e.readByte();return Ne.int32ToUint16(r<<8|t)}static readInt16LE(e){let t=e.readByte(),r=e.readByte();return Ne.int32ToInt16(r<<8|t)}static readUInt32BE(e){let t=e.readByte(),r=e.readByte(),n=e.readByte(),s=e.readByte();return Ne.int32ToUint32(t<<24|r<<16|n<<8|s)}static readUInt16BE(e){let t=e.readByte(),r=e.readByte();return Ne.int32ToInt16(t<<8|r)}static readInt16BE(e){let t=e.readByte(),r=e.readByte();return Ne.int32ToInt16(t<<8|r)}static readByteArray(e,t){let r=new Uint8Array(t);return e.read(r,0,t),r}static read8BitChars(e,t){let r=new Uint8Array(t);return e.read(r,0,r.length),M.toString(r,"utf-8")}static read8BitString(e){let t="",r=e.readByte();for(;r!==0;)t+=String.fromCharCode(r),r=e.readByte();return t}static read8BitStringLength(e,t){let r="",n=-1;for(let a=0;a<t;a++){let o=e.readByte();o===0&&n===-1&&(n=a),r+=String.fromCharCode(o)}let s=r;return n>=0?s.substr(0,n):s}static readSInt8(e){let t=e.readByte();return((t&255)>>7)*-256+(t&255)}static readInt24(e,t){let r=e[t]|e[t+1]<<8|e[t+2]<<16;return(r&8388608)===8388608&&(r=r|255<<24),r}static readInt16(e,t){return Ne.int32ToInt16(e[t]|e[t+1]<<8)}static toString(e,t){let r=M.detectEncoding(e);return r&&(t=r),t||(t="utf-8"),new TextDecoder(t).decode(e.buffer)}static detectEncoding(e){return e.length>2&&e[0]===254&&e[1]===255?"utf-16be":e.length>2&&e[0]===255&&e[1]===254?"utf-16le":e.length>4&&e[0]===0&&e[1]===0&&e[2]===254&&e[3]===255?"utf-32be":e.length>4&&e[0]===255&&e[1]===254&&e[2]===0&&e[3]===0?"utf-32le":null}static stringToBytes(e){return new TextEncoder().encode(e)}static writeInt32BE(e,t){e.writeByte(t>>24&255),e.writeByte(t>>16&255),e.writeByte(t>>8&255),e.writeByte(t>>0&255)}static writeInt32LE(e,t){e.writeByte(t>>0&255),e.writeByte(t>>8&255),e.writeByte(t>>16&255),e.writeByte(t>>24&255)}static writeUInt16LE(e,t){e.writeByte(t>>0&255),e.writeByte(t>>8&255)}static writeInt16LE(e,t){e.writeByte(t>>0&255),e.writeByte(t>>8&255)}static writeInt16BE(e,t){e.writeByte(t>>8&255),e.writeByte(t>>0&255)}}class ni{constructor(){this.length=0,this.position=0}get bytesWritten(){return this.position}getBuffer(){return this._buffer}static empty(){return ni.withCapacity(0)}static withCapacity(e){let t=new ni;return t._buffer=new Uint8Array(e),t}static fromBuffer(e){let t=new ni;return t._buffer=e,t.length=e.length,t}static fromString(e){let t=M.stringToBytes(e);return ni.fromBuffer(t)}reset(){this.position=0}skip(e){this.position+=e}readByte(){return this.length-this.position<=0?-1:this._buffer[this.position++]}read(e,t,r){let n=this.length-this.position;return n>r&&(n=r),n<=0?0:(e.set(this._buffer.subarray(this.position,this.position+n),t),this.position+=n,n)}writeByte(e){let t=this.position+1;this.ensureCapacity(t),this._buffer[this.position]=e&255,t>this.length&&(this.length=t),this.position=t}write(e,t,r){let n=this.position+r;this.ensureCapacity(n);let s=Math.min(r,e.length-t);this._buffer.set(e.subarray(t,t+s),this.position),n>this.length&&(this.length=n),this.position=n}ensureCapacity(e){if(e>this._buffer.length){let t=e;t<256&&(t=256),t<this._buffer.length*2&&(t=this._buffer.length*2);let r=new Uint8Array(t);this.length>0&&r.set(this._buffer.subarray(0,0+this.length),0),this._buffer=r}}readAll(){return this.toArray()}toArray(){let e=new Uint8Array(this.length);return e.set(this._buffer.subarray(0,0+this.length),0),e}copyTo(e){e.write(this._buffer,0,this.length)}}var P;(function(i){i[i.No=0]="No",i[i.Eof=1]="Eof",i[i.Number=2]="Number",i[i.DoubleDot=3]="DoubleDot",i[i.Dot=4]="Dot",i[i.String=5]="String",i[i.Tuning=6]="Tuning",i[i.LParensis=7]="LParensis",i[i.RParensis=8]="RParensis",i[i.LBrace=9]="LBrace",i[i.RBrace=10]="RBrace",i[i.Pipe=11]="Pipe",i[i.MetaCommand=12]="MetaCommand",i[i.Multiply=13]="Multiply",i[i.LowerThan=14]="LowerThan"})(P||(P={}));class Aa extends oi{constructor(e,t,r,n,s,a,o,l=null){super(ai.AlphaTex,e),this.position=t,this.line=r,this.col=n,this.nonTerm=s??"",this.expected=a??P.No,this.symbol=o??P.No,this.symbolData=l,Object.setPrototypeOf(this,Aa.prototype)}static symbolError(e,t,r,n,s,a,o=null){let l=`MalFormed AlphaTex: @${e} (line ${t}, col ${r}): Error on block ${n}`;return s!==a?(l+=`, expected a ${P[s]} found a ${P[a]}`,o!==null&&(l+=`: '${o}'`)):l+=`, invalid value: '${o}'`,new Aa(l,e,t,r,n,s,a,o)}static errorMessage(e,t,r,n){return e=`MalFormed AlphaTex: @${t} (line ${r}, col ${n}): ${e}`,new Aa(e,t,r,n,null,null,null,null)}}class Ti extends bl{constructor(){super(),this._trackChannel=0,this._input="",this._ch=Ti.Eof,this._curChPos=0,this._line=1,this._col=0,this._lastValidSpot=[0,1,0],this._sy=P.No,this._syData="",this._allowNegatives=!1,this._allowFloat=!1,this._allowTuning=!1,this._currentDuration=_.QuadrupleWhole,this._currentDynamics=_e.PPP,this._currentTuplet=0,this._staffHasExplicitTuning=!1,this._staffTuningApplied=!1,this._percussionArticulationNames=new Map,this.logErrors=!1}get name(){return"AlphaTex"}initFromString(e,t){this.data=ni.empty(),this._input=e,this.settings=t}readScore(){try{if(this.data.length>0&&(this._input=M.toString(this.data.readAll(),this.settings.importer.encoding)),this._allowTuning=!0,this._lyrics=new Map,this.createDefaultScore(),this._curChPos=0,this._line=1,this._col=0,this.saveValidSpot(),this._currentDuration=_.Quarter,this._currentDynamics=_e.F,this._currentTuplet=1,this._ch=this.nextChar(),this._sy=this.newSy(),this._sy===P.LowerThan)throw new gt("Unknown start sign '<' (meant to import as XML?)");if(this._sy===P.Eof)throw new gt("Unexpected end of file");const e=this.metaData(),t=this.bars();if(!e&&!t)throw new gt("No alphaTex data found");this.consolidate(),this._score.finish(this.settings),this._score.rebuildRepeatGroups();for(const[r,n]of this._lyrics)this._score.tracks[r].applyLyrics(n);return this._score}catch(e){throw e instanceof Aa?new gt(e.message,e):e}}consolidate(){for(let e of this._score.tracks)for(let t of e.staves)for(;t.bars.length<this._score.masterBars.length;){let r=this.newBar(t),n=new xi;n.isEmpty=!0,r.voices[0].addBeat(n)}}error(e,t,r=!0){let n,s=!1;r?(n=this._sy,(n===P.String||n===P.Number||n===P.MetaCommand)&&(s=!0)):n=t;let a=Aa.symbolError(this._lastValidSpot[0],this._lastValidSpot[1],this._lastValidSpot[2],e,t,n,s?this._syData:null);throw this.logErrors&&V.error(this.name,a.message),a}errorMessage(e){let t=Aa.errorMessage(e,this._lastValidSpot[0],this._lastValidSpot[1],this._lastValidSpot[2]);throw this.logErrors&&V.error(this.name,t.message),t}createDefaultScore(){this._score=new no,this._score.tempo=120,this._score.tempoLabel="",this.newTrack()}newTrack(){this._currentTrack=new Jn,this._currentTrack.ensureStaveCount(1),this._currentTrack.playbackInfo.program=25,this._currentTrack.playbackInfo.primaryChannel=this._trackChannel++,this._currentTrack.playbackInfo.secondaryChannel=this._trackChannel++,this._currentStaff=this._currentTrack.staves[0],this._currentStaff.displayTranspositionPitch=-12,this._currentStaff.stringTuning.tunings=F.getDefaultTuningFor(6).tunings,this._score.addTrack(this._currentTrack),this._lyrics.set(this._currentTrack.index,[]),this._currentDynamics=_e.F}parseClefFromString(e){switch(e.toLowerCase()){case"g2":case"treble":return ve.G2;case"f4":case"bass":return ve.F4;case"c3":case"tenor":return ve.C3;case"c4":case"alto":return ve.C4;case"n":case"neutral":return ve.Neutral;default:return ve.G2}}parseClefFromInt(e){switch(e){case 43:return ve.G2;case 65:return ve.F4;case 48:return ve.C3;case 60:return ve.C4;default:return ve.G2}}parseTripletFeelFromString(e){switch(e.toLowerCase()){case"no":case"none":return Be.NoTripletFeel;case"t16":case"triplet-16th":return Be.Triplet16th;case"t8":case"triplet-8th":return Be.Triplet8th;case"d16":case"dotted-16th":return Be.Dotted16th;case"d8":case"dotted-8th":return Be.Dotted8th;case"s16":case"scottish-16th":return Be.Scottish16th;case"s8":case"scottish-8th":return Be.Scottish8th;default:return Be.NoTripletFeel}}parseTripletFeelFromInt(e){switch(e){case 0:return Be.NoTripletFeel;case 1:return Be.Triplet16th;case 2:return Be.Triplet8th;case 3:return Be.Dotted16th;case 4:return Be.Dotted8th;case 5:return Be.Scottish16th;case 6:return Be.Scottish8th;default:return Be.NoTripletFeel}}parseKeySignature(e){switch(e.toLowerCase()){case"cb":case"cbmajor":return qt.Cb;case"gb":case"gbmajor":case"d#minor":return qt.Gb;case"db":case"dbmajor":case"bbminor":return qt.Db;case"ab":case"abmajor":case"fminor":return qt.Ab;case"eb":case"ebmajor":case"cminor":return qt.Eb;case"bb":case"bbmajor":case"gminor":return qt.Bb;case"f":case"fmajor":case"dminor":return qt.F;case"c":case"cmajor":case"aminor":return qt.C;case"g":case"gmajor":case"eminor":return qt.G;case"d":case"dmajor":case"bminor":return qt.D;case"a":case"amajor":case"f#minor":return qt.A;case"e":case"emajor":case"c#minor":return qt.E;case"b":case"bmajor":case"g#minor":return qt.B;case"f#":case"f#major":case"ebminor":return qt.FSharp;case"c#":case"c#major":return qt.CSharp;default:return qt.C}}nextChar(){return this._curChPos<this._input.length?(this._ch=this._input.charCodeAt(this._curChPos++),this._ch===10?(this._line++,this._col=0):this._col++):this._ch=Ti.Eof,this._ch}saveValidSpot(){this._lastValidSpot=[this._curChPos,this._line,this._col]}newSy(){for(this.saveValidSpot(),this._sy=P.No;this._sy===P.No;)if(this._ch===Ti.Eof)this._sy=P.Eof;else if(Ti.isWhiteSpace(this._ch))this._ch=this.nextChar(),this.saveValidSpot();else if(this._ch===47){if(this._ch=this.nextChar(),this._ch===47)for(;this._ch!==13&&this._ch!==10&&this._ch!==Ti.Eof;)this._ch=this.nextChar();else if(this._ch===42)for(;this._ch!==Ti.Eof;)if(this._ch===42){if(this._ch=this.nextChar(),this._ch===47){this._ch=this.nextChar();break}}else this._ch=this.nextChar();else this.error("comment",P.String,!1);this.saveValidSpot()}else if(this._ch===34||this._ch===39){let e=this._ch;this._ch=this.nextChar();let t="";for(this._sy=P.String;this._ch!==e&&this._ch!==Ti.Eof;)t+=String.fromCharCode(this._ch),this._ch=this.nextChar();this._ch===Ti.Eof&&this.errorMessage("String opened but never closed"),this._syData=t,this._ch=this.nextChar()}else if(this._ch===45)this._allowNegatives?(this._sy=P.Number,this._syData=this.readNumber()):(this._sy=P.String,this._syData=this.readName());else if(this._ch===46)this._sy=P.Dot,this._ch=this.nextChar();else if(this._ch===58)this._sy=P.DoubleDot,this._ch=this.nextChar();else if(this._ch===40)this._sy=P.LParensis,this._ch=this.nextChar();else if(this._ch===92)this._ch=this.nextChar(),this._sy=P.MetaCommand,this._syData=this.readName();else if(this._ch===41)this._sy=P.RParensis,this._ch=this.nextChar();else if(this._ch===123)this._sy=P.LBrace,this._ch=this.nextChar();else if(this._ch===125)this._sy=P.RBrace,this._ch=this.nextChar();else if(this._ch===124)this._sy=P.Pipe,this._ch=this.nextChar();else if(this._ch===42)this._sy=P.Multiply,this._ch=this.nextChar();else if(this._ch===60)this._sy=P.LowerThan,this._ch=this.nextChar();else if(this.isDigit(this._ch))this._sy=P.Number,this._syData=this.readNumber();else if(Ti.isNameLetter(this._ch)){let e=this.readName(),t=this._allowTuning?ct.parseTuning(e):null;t?(this._sy=P.Tuning,this._syData=t):(this._sy=P.String,this._syData=e)}else this.error("symbol",P.String,!1);return this._sy}static isNameLetter(e){return!Ti.isTerminal(e)&&(33<=e&&e<=47||58<=e&&e<=126||128<=e)}static isTerminal(e){return e===46||e===123||e===125||e===91||e===93||e===40||e===41||e===124||e===39||e===34||e===92}static isWhiteSpace(e){return e===9||e===10||e===11||e===13||e===32}isDigit(e){return e>=48&&e<=57||this._allowNegatives&&e===45||this._allowFloat&&e===46}readName(){let e="";do e+=String.fromCharCode(this._ch),this._ch=this.nextChar();while(Ti.isNameLetter(this._ch)||this.isDigit(this._ch));return e}readNumber(){let e="";do e+=String.fromCharCode(this._ch),this._ch=this.nextChar();while(this.isDigit(this._ch));return this._allowFloat?parseFloat(e):parseInt(e)}metaData(){let e=!1,t=!0;for(;this._sy===P.MetaCommand&&t;){let r=this._syData.toLowerCase();switch(r){case"title":case"subtitle":case"artist":case"album":case"words":case"music":case"copyright":this._sy=this.newSy(),this._sy!==P.String&&this.error(r,P.String,!0);let n=this._syData;switch(r){case"title":this._score.title=n;break;case"subtitle":this._score.subTitle=n;break;case"artist":this._score.artist=n;break;case"album":this._score.album=n;break;case"words":this._score.words=n;break;case"music":this._score.music=n;break;case"copyright":this._score.copyright=n;break}this._sy=this.newSy(),e=!0;break;case"tempo":this._allowFloat=!0,this._sy=this.newSy(),this._allowFloat=!1,this._sy===P.Number?this._score.tempo=this._syData:this.error("tempo",P.Number,!0),this._sy=this.newSy(),e=!0;break;default:this.handleStaffMeta()?e=!0:e?this.error("metaDataTags",P.String,!1):t=!1;break}}return e?(this._sy!==P.Dot&&this.error("song",P.Dot,!0),this._sy=this.newSy()):this._sy===P.Dot&&(this._sy=this.newSy()),e}handleStaffMeta(){var e;switch(this._syData.toLowerCase()){case"capo":return this._sy=this.newSy(),this._sy===P.Number?this._currentStaff.capo=this._syData:this.error("capo",P.Number,!0),this._sy=this.newSy(),!0;case"tuning":this._sy=this.newSy();let t=this._currentStaff.tuning.length;switch(this._staffHasExplicitTuning=!0,this._staffTuningApplied=!1,this._sy){case P.String:let o=this._syData.toLowerCase();o==="piano"||o==="none"||o==="voice"?(this._currentStaff.stringTuning.tunings=[],this._currentStaff.displayTranspositionPitch=0):this.error("tuning",P.Tuning,!0),this._sy=this.newSy();break;case P.Tuning:let l=[];do{let u=this._syData;l.push(u.realValue),this._sy=this.newSy()}while(this._sy===P.Tuning);this._currentStaff.stringTuning.tunings=l;break;default:this.error("tuning",P.Tuning,!0);break}return t!==this._currentStaff.tuning.length&&(((e=this._currentStaff.chords)==null?void 0:e.size)??0)>0&&this.errorMessage("Tuning must be defined before any chord"),!0;case"instrument":if(this._sy=this.newSy(),this._staffTuningApplied=!1,this._sy===P.Number){let o=this._syData;o>=0&&o<=127?this._currentTrack.playbackInfo.program=this._syData:this.error("instrument",P.Number,!1)}else if(this._sy===P.String){let o=this._syData.toLowerCase();if(o==="percussion"){for(const l of this._currentTrack.staves)this.applyPercussionStaff(l);this._currentTrack.playbackInfo.primaryChannel=9,this._currentTrack.playbackInfo.secondaryChannel=9}else this._currentTrack.playbackInfo.program=us.getValue(o)}else this.error("instrument",P.Number,!0);return this._sy=this.newSy(),!0;case"lyrics":this._sy=this.newSy();let r=new Ut;return r.startBar=0,r.text="",this._sy===P.Number&&(r.startBar=this._syData,this._sy=this.newSy()),this._sy===P.String?(r.text=this._syData,this._sy=this.newSy()):this.error("lyrics",P.String,!0),this._lyrics.get(this._currentTrack.index).push(r),!0;case"chord":this._sy=this.newSy();let n=new ha;this.chordProperties(n),this._sy===P.String?(n.name=this._syData,this._sy=this.newSy()):this.error("chord-name",P.String,!0);for(let o=0;o<this._currentStaff.tuning.length;o++)this._sy===P.Number?n.strings.push(this._syData):this._sy===P.String&&this._syData.toLowerCase()==="x"&&n.strings.push(-1),this._sy=this.newSy();return this._currentStaff.addChord(this.getChordId(this._currentStaff,n.name),n),!0;case"articulation":this._sy=this.newSy();let s="";if(this._sy===P.String?(s=this._syData,this._sy=this.newSy()):this.error("articulation-name",P.String,!0),s==="defaults"){for(const[o,l]of At.instrumentArticulationNames)this._percussionArticulationNames.set(o.toLowerCase(),l),this._percussionArticulationNames.set(Ti.toArticulationId(o),l);return!0}let a=0;return this._sy===P.Number?(a=this._syData,this._sy=this.newSy()):this.error("articulation-number",P.Number,!0),At.instrumentArticulations.has(a)||this.errorMessage(`Unknown articulation ${a}. Refer to https://www.alphatab.net/docs/alphatex/percussion for available ids`),this._percussionArticulationNames.set(s.toLowerCase(),a),!0;default:return!1}}static toArticulationId(e){return e.replace(new RegExp("[^a-zA-Z0-9]","g"),"").toLowerCase()}applyPercussionStaff(e){e.isPercussion=!0,e.showTablature=!1}chordProperties(e){if(this._sy===P.LBrace){for(this._sy=this.newSy();this._sy===P.String;)switch(this._syData.toLowerCase()){case"firstfret":switch(this._sy=this.newSy(),this._sy){case P.Number:e.firstFret=this._syData;break;default:this.error("chord-firstfret",P.Number,!0);break}this._sy=this.newSy();break;case"showdiagram":switch(this._sy=this.newSy(),this._sy){case P.String:e.showDiagram=this._syData.toLowerCase()!=="false";break;case P.Number:e.showDiagram=this._syData!==0;break;default:this.error("chord-showdiagram",P.String,!0);break}this._sy=this.newSy();break;case"showfingering":switch(this._sy=this.newSy(),this._sy){case P.String:e.showDiagram=this._syData.toLowerCase()!=="false";break;case P.Number:e.showFingering=this._syData!==0;break;default:this.error("chord-showfingering",P.String,!0);break}this._sy=this.newSy();break;case"showname":switch(this._sy=this.newSy(),this._sy){case P.String:e.showName=this._syData.toLowerCase()!=="false";break;case P.Number:e.showName=this._syData!==0;break;default:this.error("chord-showname",P.String,!0);break}this._sy=this.newSy();break;case"barre":for(this._sy=this.newSy();this._sy===P.Number;)e.barreFrets.push(this._syData),this._sy=this.newSy();break;default:this.error("chord-properties",P.String,!1);break}this._sy!==P.RBrace&&this.error("chord-properties",P.RBrace,!0),this._sy=this.newSy()}}bars(){let e=this.bar();for(;this._sy!==P.Eof;)if(this._sy===P.Pipe)this._sy=this.newSy(),this.bar();else if(this._sy===P.MetaCommand)this.bar();else break;return e}trackStaffMeta(){if(this._sy!==P.MetaCommand)return!1;if(this._syData.toLowerCase()==="track"&&(this._staffHasExplicitTuning=!1,this._staffTuningApplied=!1,this._sy=this.newSy(),this._score.masterBars.length>0&&this.newTrack(),this._sy===P.String&&(this._currentTrack.name=this._syData,this._sy=this.newSy()),this._sy===P.String&&(this._currentTrack.shortName=this._syData,this._sy=this.newSy())),this._sy===P.MetaCommand&&this._syData.toLowerCase()==="staff"){if(this._staffHasExplicitTuning=!1,this._staffTuningApplied=!1,this._sy=this.newSy(),this._currentTrack.staves[0].bars.length>0){this._currentTrack.ensureStaveCount(this._currentTrack.staves.length+1);const e=this._currentStaff.isPercussion;this._currentStaff=this._currentTrack.staves[this._currentTrack.staves.length-1],e&&this.applyPercussionStaff(this._currentStaff),this._currentDynamics=_e.F}this.staffProperties()}return!0}staffProperties(){if(this._sy!==P.LBrace)return;this._sy=this.newSy();let e=!1,t=!1,r=!1;for(;this._sy===P.String;)switch(this._syData.toLowerCase()){case"score":e=!0,this._sy=this.newSy();break;case"tabs":t=!0,this._sy=this.newSy();break;case"slash":r=!0,this._sy=this.newSy();break;default:this.error("staff-properties",P.String,!1);break}(e||t||r)&&(this._currentStaff.showStandardNotation=e,this._currentStaff.showTablature=t,this._currentStaff.showSlash=r),this._sy!==P.RBrace&&this.error("staff-properties",P.RBrace,!0),this._sy=this.newSy()}bar(){const e=this.trackStaffMeta();let t=this.newBar(this._currentStaff);if(this._currentStaff.bars.length>this._score.masterBars.length){let a=new Ts;this._score.addMasterBar(a),a.index>0&&(a.keySignature=a.previousMasterBar.keySignature,a.keySignatureType=a.previousMasterBar.keySignatureType,a.timeSignatureDenominator=a.previousMasterBar.timeSignatureDenominator,a.timeSignatureNumerator=a.previousMasterBar.timeSignatureNumerator,a.tripletFeel=a.previousMasterBar.tripletFeel)}const r=this.barMeta(t);if(!this._staffTuningApplied&&!this._staffHasExplicitTuning){const a=this._currentTrack.playbackInfo.program;this._currentStaff.displayTranspositionPitch=0,this._currentStaff.stringTuning.tunings=[],a==15||a>=24&&a<=31?(this._currentStaff.displayTranspositionPitch=-12,this._currentStaff.stringTuning.tunings=F.getDefaultTuningFor(6).tunings):a>=32&&a<=39?(this._currentStaff.displayTranspositionPitch=-12,this._currentStaff.stringTuning.tunings=[43,38,33,28]):a==40||a==44||a==45||a==48||a==49||a==50||a==51?this._currentStaff.stringTuning.tunings=[52,57,50,43]:a==41?this._currentStaff.stringTuning.tunings=[57,50,43,36]:a==42?this._currentStaff.stringTuning.tunings=[45,38,31,24]:a==43?(this._currentStaff.displayTranspositionPitch=-12,this._currentStaff.stringTuning.tunings=[43,38,33,28]):a==105?this._currentStaff.stringTuning.tunings=[50,47,43,38,55]:a==106?this._currentStaff.stringTuning.tunings=[57,52,45]:a==107?this._currentStaff.stringTuning.tunings=[52,45,38,31]:a==110&&(this._currentStaff.stringTuning.tunings=[64,57,50,43]),this._staffTuningApplied=!0}let n=!1,s=t.voices[0];for(;this._sy!==P.Pipe&&this._sy!==P.Eof&&this.beat(s);)n=!0;if(s.beats.length===0){let a=new xi;a.isEmpty=!0,s.addBeat(a)}return e||r||n}newBar(e){let t=new Ps;e.addBar(t),t.index>0&&(t.clef=t.previousBar.clef);let r=new Qn;return t.addVoice(r),t}beat(e){this.beatDuration();let t=new xi;if(e.addBeat(t),this._allowTuning=!this._currentStaff.isPercussion,this._sy===P.LParensis){for(this._sy=this.newSy(),this.note(t);this._sy!==P.RParensis&&this._sy!==P.Eof&&(this._allowTuning=!this._currentStaff.isPercussion,!!this.note(t)););this._sy!==P.RParensis&&this.error("note-list",P.RParensis,!0),this._sy=this.newSy()}else if(this._sy===P.String&&this._syData.toLowerCase()==="r")this._sy=this.newSy();else if(!this.note(t))return e.beats.splice(e.beats.length-1,1),!1;this._sy===P.Dot&&(this._allowNegatives=!0,this._sy=this.newSy(),this._allowNegatives=!1,this._sy!==P.Number&&this.error("duration",P.Number,!0),this._currentDuration=this.parseDuration(this._syData),this._sy=this.newSy()),t.duration=this._currentDuration,t.dynamics=this._currentDynamics,this._currentTuplet!==1&&!t.hasTuplet&&Ti.applyTuplet(t,this._currentTuplet);let r=1;this._sy===P.Multiply&&(this._sy=this.newSy(),this._sy!==P.Number?this.error("multiplier",P.Number,!0):r=this._syData,this._sy=this.newSy()),this.beatEffects(t);for(let n=0;n<r-1;n++)e.addBeat(D1.clone(t));return!0}beatDuration(){if(this._sy===P.DoubleDot&&(this._allowNegatives=!0,this._sy=this.newSy(),this._allowNegatives=!1,this._sy!==P.Number&&this.error("duration",P.Number,!0),this._currentDuration=this.parseDuration(this._syData),this._currentTuplet=1,this._sy=this.newSy(),this._sy===P.LBrace)){for(this._sy=this.newSy();this._sy===P.String;)switch(this._syData.toLowerCase()){case"tu":this._sy=this.newSy(),this._sy!==P.Number&&this.error("duration-tuplet",P.Number,!0),this._currentTuplet=this._syData,this._sy=this.newSy();break;default:this.error("beat-duration",P.String,!1);break}this._sy!==P.RBrace&&this.error("beat-duration",P.RBrace,!0),this._sy=this.newSy()}}beatEffects(e){if(this._sy===P.LBrace){for(this._sy=this.newSy();this._sy===P.String;)this.applyBeatEffect(e)||this.error("beat-effects",P.String,!1);this._sy!==P.RBrace&&this.error("beat-effects",P.RBrace,!0),this._sy=this.newSy()}}applyBeatEffect(e){let t=this._syData.toLowerCase();if(t==="f")e.fadeIn=!0;else if(t==="v")e.vibrato=Ue.Slight;else if(t==="s")e.slap=!0;else if(t==="p")e.pop=!0;else if(t==="tt")e.tap=!0;else if(t==="dd")e.dots=2;else if(t==="d")e.dots=1;else if(t==="su")e.pickStroke=gi.Up;else if(t==="sd")e.pickStroke=gi.Down;else if(t==="tu"){if(this._sy=this.newSy(),this._sy!==P.Number)return this.error("tuplet",P.Number,!0),!1;Ti.applyTuplet(e,this._syData)}else if(t==="tb"||t==="tbe"){let r=t==="tbe";for(this._sy=this.newSy(),this._sy!==P.LParensis&&this.error("tremolobar-effect",P.LParensis,!0),this._allowNegatives=!0,this._sy=this.newSy();this._sy!==P.RParensis&&this._sy!==P.Eof;){let n=0,s=0;r?(this._sy!==P.Number&&this.error("tremolobar-effect",P.Number,!0),n=this._syData,this._sy=this.newSy(),this._sy!==P.Number&&this.error("tremolobar-effect",P.Number,!0),s=this._syData):(this._sy!==P.Number&&this.error("tremolobar-effect",P.Number,!0),n=0,s=this._syData),e.addWhammyBarPoint(new $(n,s)),this._sy=this.newSy()}if(e.whammyBarPoints!=null){for(;e.whammyBarPoints.length>60;)e.removeWhammyBarPoint(e.whammyBarPoints.length-1);if(r)e.whammyBarPoints.sort((n,s)=>n.offset-s.offset);else{let n=e.whammyBarPoints.length,s=60/n|0,a=0;for(;a<n;)e.whammyBarPoints[a].offset=Math.min(60,a*s),a++}}this._allowNegatives=!1,this._sy!==P.RParensis&&this.error("tremolobar-effect",P.RParensis,!0)}else if(t==="bu"||t==="bd"||t==="au"||t==="ad"){switch(t){case"bu":e.brushType=lt.BrushUp;break;case"bd":e.brushType=lt.BrushDown;break;case"au":e.brushType=lt.ArpeggioUp;break;case"ad":e.brushType=lt.ArpeggioDown;break}return this._sy=this.newSy(),this._sy===P.Number?(e.brushDuration=this._syData,this._sy=this.newSy(),!0):(e.updateDurations(),t==="bu"||t==="bd"?e.brushDuration=e.playbackDuration/4/e.notes.length:(t==="au"||t==="ad")&&(e.brushDuration=e.playbackDuration/e.notes.length),!0)}else if(t==="ch"){this._sy=this.newSy();let r=this._syData,n=this.getChordId(this._currentStaff,r);if(!this._currentStaff.hasChord(n)){let s=new ha;s.showDiagram=!1,s.name=r,this._currentStaff.addChord(n,s)}e.chordId=n}else{if(t==="gr")return this._sy=this.newSy(),this._syData.toLowerCase()==="ob"?(e.graceType=ce.OnBeat,this._sy=this.newSy()):this._syData.toLowerCase()==="b"?(e.graceType=ce.BendGrace,this._sy=this.newSy()):e.graceType=ce.BeforeBeat,!0;if(t==="dy"){switch(this._sy=this.newSy(),this._syData.toLowerCase()){case"ppp":e.dynamics=_e.PPP;break;case"pp":e.dynamics=_e.PP;break;case"p":e.dynamics=_e.P;break;case"mp":e.dynamics=_e.MP;break;case"mf":e.dynamics=_e.MF;break;case"f":e.dynamics=_e.F;break;case"ff":e.dynamics=_e.FF;break;case"fff":e.dynamics=_e.FFF;break}this._currentDynamics=e.dynamics}else if(t==="cre")e.crescendo=Zi.Crescendo;else if(t==="dec")e.crescendo=Zi.Decrescendo;else if(t==="tempo"){const r=this.readTempoAutomation();return e.automations.push(r),e.voice.bar.masterBar.tempoAutomations.push(r),!0}else if(t==="tp"){if(this._sy=this.newSy(),e.tremoloSpeed=_.Eighth,this._sy===P.Number){switch(this._syData){case 8:e.tremoloSpeed=_.Eighth;break;case 16:e.tremoloSpeed=_.Sixteenth;break;case 32:e.tremoloSpeed=_.ThirtySecond;break;default:e.tremoloSpeed=_.Eighth;break}this._sy=this.newSy()}return!0}else return!1}return this._sy=this.newSy(),!0}getChordId(e,t){return t.toLowerCase()+e.index+e.track.index}static applyTuplet(e,t){switch(t){case 3:e.tupletNumerator=3,e.tupletDenominator=2;break;case 5:e.tupletNumerator=5,e.tupletDenominator=4;break;case 6:e.tupletNumerator=6,e.tupletDenominator=4;break;case 7:e.tupletNumerator=7,e.tupletDenominator=4;break;case 9:e.tupletNumerator=9,e.tupletDenominator=8;break;case 10:e.tupletNumerator=10,e.tupletDenominator=8;break;case 11:e.tupletNumerator=11,e.tupletDenominator=8;break;case 12:e.tupletNumerator=12,e.tupletDenominator=8;break;default:e.tupletNumerator=1,e.tupletDenominator=1;break}}isNoteText(e){return e==="x"||e==="-"||e==="r"}note(e){let t=!1,r=!1,n=-1,s=-1,a=-1;switch(this._sy){case P.Number:n=this._syData,this._currentStaff.isPercussion&&!At.instrumentArticulations.has(n)&&this.errorMessage(`Unknown percussion articulation ${n}`);break;case P.String:if(this._currentStaff.isPercussion){const h=this._syData.toLowerCase();this._percussionArticulationNames.has(h)?n=this._percussionArticulationNames.get(h):this.errorMessage(`Unknown percussion articulation '${this._syData}'`)}else t=this._syData==="x",r=this._syData==="-",r||t?n=0:this.error("note-fret",P.Number,!0);break;case P.Tuning:let c=this._syData;s=c.octave,a=c.noteValue;break;default:return!1}this._sy=this.newSy();let o=s===-1&&this._currentStaff.tuning.length>0&&!this._currentStaff.isPercussion,l=-1;o&&(this._sy!==P.Dot&&this.error("note",P.Dot,!0),this._sy=this.newSy(),this._sy!==P.Number&&this.error("note-string",P.Number,!0),l=this._syData,(l<1||l>this._currentStaff.tuning.length)&&this.error("note-string",P.Number,!1),this._sy=this.newSy());let u=new Nt;return o?(u.string=this._currentStaff.tuning.length-(l-1),u.isDead=t,u.isTieDestination=r,r||(u.fret=n)):this._currentStaff.isPercussion?u.percussionArticulation=n:(u.octave=s,u.tone=a,u.isTieDestination=r),e.addNote(u),this.noteEffects(u),!0}noteEffects(e){if(this._sy===P.LBrace){for(this._sy=this.newSy();this._sy===P.String;){let t=this._syData.toLowerCase();if(t==="b"||t==="be"){let r=t==="be";for(this._sy=this.newSy(),this._sy!==P.LParensis&&this.error("bend-effect",P.LParensis,!0),this._sy=this.newSy();this._sy!==P.RParensis&&this._sy!==P.Eof;){let s=0,a=0;r?(this._sy!==P.Number&&this.error("bend-effect-value",P.Number,!0),s=this._syData,this._sy=this.newSy(),this._sy!==P.Number&&this.error("bend-effect-value",P.Number,!0),a=this._syData):(this._sy!==P.Number&&this.error("bend-effect-value",P.Number,!0),a=this._syData),e.addBendPoint(new $(s,a)),this._sy=this.newSy()}const n=e.bendPoints;if(n!=null){for(;n.length>60;)n.splice(n.length-1,1);if(r)n.sort((s,a)=>s.offset-a.offset);else{let s=n.length,a=60/(s-1)|0,o=0;for(;o<s;)n[o].offset=Math.min(60,o*a),o++}}this._sy!==P.RParensis&&this.error("bend-effect",P.RParensis,!0),this._sy=this.newSy()}else if(t==="nh")e.harmonicType=ne.Natural,this._sy=this.newSy();else if(t==="ah")e.harmonicType=ne.Artificial,this._sy=this.newSy();else if(t==="th")e.harmonicType=ne.Tap,this._sy=this.newSy();else if(t==="ph")e.harmonicType=ne.Pinch,this._sy=this.newSy();else if(t==="sh")e.harmonicType=ne.Semi,this._sy=this.newSy();else if(t==="tr"){this._sy=this.newSy(),this._sy!==P.Number&&this.error("trill-effect",P.Number,!0);let r=this._syData;this._sy=this.newSy();let n=_.Sixteenth;if(this._sy===P.Number){switch(this._syData){case 16:n=_.Sixteenth;break;case 32:n=_.ThirtySecond;break;case 64:n=_.SixtyFourth;break;default:n=_.Sixteenth;break}this._sy=this.newSy()}e.trillValue=r+e.stringTuning,e.trillSpeed=n}else if(t==="v")this._sy=this.newSy(),e.vibrato=Ue.Slight;else if(t==="sl")this._sy=this.newSy(),e.slideOutType=xe.Legato;else if(t==="ss")this._sy=this.newSy(),e.slideOutType=xe.Shift;else if(t==="sib")this._sy=this.newSy(),e.slideInType=ri.IntoFromBelow;else if(t==="sia")this._sy=this.newSy(),e.slideInType=ri.IntoFromAbove;else if(t==="sou")this._sy=this.newSy(),e.slideOutType=xe.OutUp;else if(t==="sod")this._sy=this.newSy(),e.slideOutType=xe.OutDown;else if(t==="psd")this._sy=this.newSy(),e.slideOutType=xe.PickSlideDown;else if(t==="psu")this._sy=this.newSy(),e.slideOutType=xe.PickSlideUp;else if(t==="h")this._sy=this.newSy(),e.isHammerPullOrigin=!0;else if(t==="lht")this._sy=this.newSy(),e.isLeftHandTapped=!0;else if(t==="g")this._sy=this.newSy(),e.isGhost=!0;else if(t==="ac")this._sy=this.newSy(),e.accentuated=jt.Normal;else if(t==="hac")this._sy=this.newSy(),e.accentuated=jt.Heavy;else if(t==="pm")this._sy=this.newSy(),e.isPalmMute=!0;else if(t==="st")this._sy=this.newSy(),e.isStaccato=!0;else if(t==="lr")this._sy=this.newSy(),e.isLetRing=!0;else if(t==="x")this._sy=this.newSy(),e.fret=0,e.isDead=!0;else if(t==="-"||t==="t")this._sy=this.newSy(),e.isTieDestination=!0;else if(t==="lf"){this._sy=this.newSy();let r=be.Thumb;this._sy===P.Number&&(r=this.toFinger(this._syData),this._sy=this.newSy()),e.leftHandFinger=r}else if(t==="rf"){this._sy=this.newSy();let r=be.Thumb;this._sy===P.Number&&(r=this.toFinger(this._syData),this._sy=this.newSy()),e.rightHandFinger=r}else this.applyBeatEffect(e.beat)||this.error(t,P.String,!1)}this._sy!==P.RBrace&&this.error("note-effect",P.RBrace,!1),this._sy=this.newSy()}}toFinger(e){switch(e){case 1:return be.Thumb;case 2:return be.IndexFinger;case 3:return be.MiddleFinger;case 4:return be.AnnularFinger;case 5:return be.LittleFinger}return be.Thumb}parseDuration(e){switch(e){case-4:return _.QuadrupleWhole;case-2:return _.DoubleWhole;case 1:return _.Whole;case 2:return _.Half;case 4:return _.Quarter;case 8:return _.Eighth;case 16:return _.Sixteenth;case 32:return _.ThirtySecond;case 64:return _.SixtyFourth;case 128:return _.OneHundredTwentyEighth;case 256:return _.TwoHundredFiftySixth;default:return _.Quarter}}barMeta(e){let t=!1,r=e.masterBar;for(;this._sy===P.MetaCommand;){t=!0;let n=this._syData.toLowerCase();if(n==="ts")this._sy=this.newSy(),this._sy!==P.Number&&this.error("timesignature-numerator",P.Number,!0),r.timeSignatureNumerator=this._syData,this._sy=this.newSy(),this._sy!==P.Number&&this.error("timesignature-denominator",P.Number,!0),r.timeSignatureDenominator=this._syData,this._sy=this.newSy();else if(n==="ro")r.isRepeatStart=!0,this._sy=this.newSy();else if(n==="rc")this._sy=this.newSy(),this._sy!==P.Number&&this.error("repeatclose",P.Number,!0),this._syData>2048&&this.error("repeatclose",P.Number,!1),r.repeatCount=this._syData,this._sy=this.newSy();else if(n==="ae")if(this._sy=this.newSy(),this._sy===P.LParensis){for(this._sy=this.newSy(),this._sy!==P.Number&&this.error("alternateending",P.Number,!0),this.applyAlternateEnding(r);this._sy===P.Number;)this.applyAlternateEnding(r);this._sy!==P.RParensis&&this.error("alternateending-list",P.RParensis,!0),this._sy=this.newSy()}else this._sy!==P.Number&&this.error("alternateending",P.Number,!0),this.applyAlternateEnding(r);else if(n==="ks")this._sy=this.newSy(),this._sy!==P.String&&this.error("keysignature",P.String,!0),r.keySignature=this.parseKeySignature(this._syData),this._sy=this.newSy();else if(n==="clef"){switch(this._sy=this.newSy(),this._sy){case P.String:e.clef=this.parseClefFromString(this._syData);break;case P.Number:e.clef=this.parseClefFromInt(this._syData);break;case P.Tuning:let s=this._syData;e.clef=this.parseClefFromInt(s.realValue);break;default:this.error("clef",P.String,!0);break}this._sy=this.newSy()}else if(n==="tempo"){const s=this.readTempoAutomation();r.tempoAutomations.push(s)}else if(n==="section"){this._sy=this.newSy(),this._sy!==P.String&&this.error("section",P.String,!0);let s=this._syData;this._sy=this.newSy();let a="";this._sy===P.String&&!this.isNoteText(this._syData.toLowerCase())&&(a=s,s=this._syData,this._sy=this.newSy());let o=new hp;o.marker=a,o.text=s,r.section=o}else if(n==="tf"){switch(this._allowTuning=!1,this._sy=this.newSy(),this._allowTuning=!0,this._sy){case P.String:r.tripletFeel=this.parseTripletFeelFromString(this._syData);break;case P.Number:r.tripletFeel=this.parseTripletFeelFromInt(this._syData);break;default:this.error("triplet-feel",P.String,!0);break}this._sy=this.newSy()}else n==="ac"?(r.isAnacrusis=!0,this._sy=this.newSy()):e.index===0?this.handleStaffMeta()||this.error("measure-effects",P.String,!1):this.error("measure-effects",P.String,!1)}if(r.index===0&&r.tempoAutomations.length===0){let n=new wi;n.isLinear=!1,n.type=$t.Tempo,n.value=this._score.tempo,r.tempoAutomations.push(n)}return t}readTempoAutomation(){this._allowFloat=!0,this._sy=this.newSy(),this._allowFloat=!1,this._sy!==P.Number&&this.error("tempo",P.Number,!0);const e=new wi;return e.isLinear=!1,e.type=$t.Tempo,e.value=this._syData,this._sy=this.newSy(),e}applyAlternateEnding(e){let t=this._syData;t<1&&this.error("alternateending",P.Number,!0),e.alternateEndings|=1<<t-1,this._sy=this.newSy()}}Ti.Eof=0;class Un extends bl{get name(){return"Guitar Pro 3-5"}constructor(){super(),this._versionNumber=0,this._globalTripletFeel=Be.NoTripletFeel,this._lyricsTrack=0,this._lyrics=[],this._barCount=0,this._trackCount=0,this._playbackInfos=[],this._beatTextChunksByTrack=new Map}readScore(){if(this.readVersion(),this._score=new no,this.readScoreInformation(),this._versionNumber<500&&(this._globalTripletFeel=ze.gpReadBool(this.data)?Be.Triplet8th:Be.NoTripletFeel),this._versionNumber>=400&&this.readLyrics(),this._versionNumber>=510&&this.data.skip(19),this._versionNumber>=500&&(this.readPageSetup(),this._score.tempoLabel=ze.gpReadStringIntByte(this.data,this.settings.importer.encoding)),this._score.tempo=M.readInt32LE(this.data),this._versionNumber>=510&&ze.gpReadBool(this.data),M.readInt32LE(this.data),this._versionNumber>=400&&this.data.readByte(),this.readPlaybackInfos(),this._versionNumber>=500&&(this.data.skip(38),this.data.skip(4)),this._barCount=M.readInt32LE(this.data),this._trackCount=M.readInt32LE(this.data),this.readMasterBars(),this.readTracks(),this.readBars(),this._score.masterBars.length>0){const e=wi.buildTempoAutomation(!1,0,this._score.tempo,2);e.text=this._score.tempoLabel,this._score.masterBars[0].tempoAutomations.push(e)}return this._score.finish(this.settings),this._lyrics&&this._lyricsTrack>=0&&this._score.tracks[this._lyricsTrack].applyLyrics(this._lyrics),this._score}readVersion(){let e=ze.gpReadStringByteLength(this.data,30,this.settings.importer.encoding);if(!e.startsWith(Un.VersionString))throw new gt("Unsupported format");e=e.substr(Un.VersionString.length+1);let t=e.indexOf(".");this._versionNumber=100*parseInt(e.substr(0,t))+parseInt(e.substr(t+1)),V.debug(this.name,"Guitar Pro version "+e+" detected")}readScoreInformation(){var r;this._score.title=ze.gpReadStringIntUnused(this.data,this.settings.importer.encoding),this._score.subTitle=ze.gpReadStringIntUnused(this.data,this.settings.importer.encoding),this._score.artist=ze.gpReadStringIntUnused(this.data,this.settings.importer.encoding),this._score.album=ze.gpReadStringIntUnused(this.data,this.settings.importer.encoding),this._score.words=ze.gpReadStringIntUnused(this.data,this.settings.importer.encoding),this._score.music=this._versionNumber>=500?ze.gpReadStringIntUnused(this.data,this.settings.importer.encoding):this._score.words,this._score.copyright=ze.gpReadStringIntUnused(this.data,this.settings.importer.encoding),this._score.tab=ze.gpReadStringIntUnused(this.data,this.settings.importer.encoding),this._score.instructions=ze.gpReadStringIntUnused(this.data,this.settings.importer.encoding);let e=M.readInt32LE(this.data),t="";for(let n=0;n<e;n++)n>0&&(t+=`\r
`),t+=(r=ze.gpReadStringIntUnused(this.data,this.settings.importer.encoding))==null?void 0:r.toString();this._score.notices=t}readLyrics(){this._lyrics=[],this._lyricsTrack=M.readInt32LE(this.data)-1;for(let e=0;e<5;e++){let t=new Ut;t.startBar=M.readInt32LE(this.data)-1,t.text=ze.gpReadStringInt(this.data,this.settings.importer.encoding),this._lyrics.push(t)}}readPageSetup(){this.data.skip(30);for(let e=0;e<10;e++)ze.gpReadStringIntByte(this.data,this.settings.importer.encoding)}readPlaybackInfos(){this._playbackInfos=[];for(let e=0;e<64;e++){let t=new hB;t.primaryChannel=e,t.secondaryChannel=e,t.program=M.readInt32LE(this.data),t.volume=this.data.readByte(),t.balance=this.data.readByte(),this.data.skip(6),this._playbackInfos.push(t)}}readMasterBars(){for(let e=0;e<this._barCount;e++)this.readMasterBar()}readMasterBar(){let e=null;this._score.masterBars.length>0&&(e=this._score.masterBars[this._score.masterBars.length-1]);let t=new Ts,r=this.data.readByte();if(r&1?t.timeSignatureNumerator=this.data.readByte():e&&(t.timeSignatureNumerator=e.timeSignatureNumerator),r&2?t.timeSignatureDenominator=this.data.readByte():e&&(t.timeSignatureDenominator=e.timeSignatureDenominator),t.isRepeatStart=(r&4)!==0,r&8&&(t.repeatCount=this.data.readByte()+(this._versionNumber>=500?0:1)),r&16&&this._versionNumber<500){let n=e,s=0;for(;n&&!(n.isRepeatEnd&&n!==e||n.isRepeatStart);)s=s|n.alternateEndings,n=n.previousMasterBar;let a=0,o=this.data.readByte();for(let l=0;l<8;l++){let u=1<<l;o>l&&!(s&u)&&(a=a|u)}t.alternateEndings=a}if(r&32){let n=new hp;n.text=ze.gpReadStringIntByte(this.data,this.settings.importer.encoding),n.marker="",ze.gpReadColor(this.data,!1),t.section=n}if(r&64?(t.keySignature=M.readSInt8(this.data),t.keySignatureType=this.data.readByte()):e&&(t.keySignature=e.keySignature,t.keySignatureType=e.keySignatureType),this._versionNumber>=500&&r&3&&this.data.skip(4),this._versionNumber>=500&&(t.alternateEndings=this.data.readByte()),this._versionNumber>=500){switch(this.data.readByte()){case 1:t.tripletFeel=Be.Triplet8th;break;case 2:t.tripletFeel=Be.Triplet16th;break}this.data.readByte()}else t.tripletFeel=this._globalTripletFeel;t.isDoubleBar=(r&128)!==0,this._score.addMasterBar(t)}readTracks(){for(let e=0;e<this._trackCount;e++)this.readTrack()}readTrack(){let e=new Jn;e.ensureStaveCount(1),this._score.addTrack(e);let t=e.staves[0],r=this.data.readByte();e.name=ze.gpReadStringByteLength(this.data,40,this.settings.importer.encoding),r&1&&(t.isPercussion=!0),this._versionNumber>=500&&(e.isVisibleOnMultiTrack=(r&8)!==0);let n=M.readInt32LE(this.data),s=[];for(let u=0;u<7;u++){let c=M.readInt32LE(this.data);n>u&&s.push(c)}t.stringTuning.tunings=s;let a=M.readInt32LE(this.data),o=M.readInt32LE(this.data)-1,l=M.readInt32LE(this.data)-1;if(this.data.skip(4),o>=0&&o<this._playbackInfos.length){let u=this._playbackInfos[o];u.port=a,u.isSolo=(r&16)!==0,u.isMute=(r&32)!==0,u.secondaryChannel=l,us.isGuitar(u.program)&&(t.displayTranspositionPitch=-12),e.playbackInfo=u}t.capo=M.readInt32LE(this.data),e.color=ze.gpReadColor(this.data,!1),this._versionNumber>=500&&(this.data.readByte(),this.data.readByte(),this.data.skip(43)),this._versionNumber>=510&&(this.data.skip(4),ze.gpReadStringIntByte(this.data,this.settings.importer.encoding),ze.gpReadStringIntByte(this.data,this.settings.importer.encoding))}readBars(){for(let e=0;e<this._barCount;e++)for(let t=0;t<this._trackCount;t++)this.readBar(this._score.tracks[t])}readBar(e){let t=new Ps,r=e.staves[0];r.isPercussion&&(t.clef=ve.Neutral),r.addBar(t);let n=1;this._versionNumber>=500&&(this.data.readByte(),n=2);for(let s=0;s<n;s++)this.readVoice(e,t)}readVoice(e,t){let r=M.readInt32LE(this.data);if(r===0)return;let n=new Qn;t.addVoice(n);for(let s=0;s<r;s++)this.readBeat(e,t,n)}readBeat(e,t,r){let n=new xi,s=this.data.readByte();if(s&1&&(n.dots=1),s&64){let c=this.data.readByte();n.isEmpty=(c&2)===0}switch(r.addBeat(n),M.readSInt8(this.data)){case-2:n.duration=_.Whole;break;case-1:n.duration=_.Half;break;case 0:n.duration=_.Quarter;break;case 1:n.duration=_.Eighth;break;case 2:n.duration=_.Sixteenth;break;case 3:n.duration=_.ThirtySecond;break;case 4:n.duration=_.SixtyFourth;break;default:n.duration=_.Quarter;break}if(s&32)switch(n.tupletNumerator=M.readInt32LE(this.data),n.tupletNumerator){case 1:n.tupletDenominator=1;break;case 3:n.tupletDenominator=2;break;case 5:case 6:case 7:n.tupletDenominator=4;break;case 9:case 10:case 11:case 12:case 13:n.tupletDenominator=8;break;case 2:case 4:case 8:break;default:n.tupletNumerator=1,n.tupletDenominator=1;break}s&2&&this.readChord(n);let o=this.settings.importer.beatTextAsLyrics&&e.index!==this._lyricsTrack;if(s&4){const c=ze.gpReadStringIntUnused(this.data,this.settings.importer.encoding);if(o){const h=new Ut;h.text=c.trim(),h.finish(!0);const d=[];for(let f=h.chunks.length-1;f>=0;f--)d.push(h.chunks[f]);this._beatTextChunksByTrack.set(e.index,d)}else n.text=c}let l=ne.None;s&8&&(l=this.readBeatEffects(n)),s&16&&this.readMixTableChange(n);let u=this.data.readByte();for(let c=6;c>=0;c--)if(u&1<<c&&6-c<t.staff.tuning.length){const h=this.readNote(e,t,r,n,6-c);l!==ne.None&&(h.harmonicType=l,h.harmonicType===ne.Natural&&(h.harmonicValue=this.deltaFretToHarmonicValue(h.fret)))}this._versionNumber>=500&&(this.data.readByte(),this.data.readByte()&8&&this.data.readByte()),o&&!n.isRest&&this._beatTextChunksByTrack.has(e.index)&&this._beatTextChunksByTrack.get(e.index).length>0&&(n.lyrics=[this._beatTextChunksByTrack.get(e.index).pop()])}readChord(e){let t=new ha,r=ct.newGuid();if(this._versionNumber>=500){this.data.skip(17),t.name=ze.gpReadStringByteLength(this.data,21,this.settings.importer.encoding),this.data.skip(4),t.firstFret=M.readInt32LE(this.data);for(let a=0;a<7;a++){let o=M.readInt32LE(this.data);a<e.voice.bar.staff.tuning.length&&t.strings.push(o)}let n=this.data.readByte(),s=new Uint8Array(5);this.data.read(s,0,s.length);for(let a=0;a<n;a++)t.barreFrets.push(s[a]);this.data.skip(26)}else if(this.data.readByte()!==0)if(this._versionNumber>=400){this.data.skip(16),t.name=ze.gpReadStringByteLength(this.data,21,this.settings.importer.encoding),this.data.skip(4),t.firstFret=M.readInt32LE(this.data);for(let a=0;a<7;a++){let o=M.readInt32LE(this.data);a<e.voice.bar.staff.tuning.length&&t.strings.push(o)}let n=this.data.readByte(),s=new Uint8Array(5);this.data.read(s,0,s.length);for(let a=0;a<n;a++)t.barreFrets.push(s[a]);this.data.skip(26)}else{this.data.skip(25),t.name=ze.gpReadStringByteLength(this.data,34,this.settings.importer.encoding),t.firstFret=M.readInt32LE(this.data);for(let n=0;n<6;n++){let s=M.readInt32LE(this.data);n<e.voice.bar.staff.tuning.length&&t.strings.push(s)}this.data.skip(36)}else{let n=this._versionNumber>=406?7:6;if(t.name=ze.gpReadStringIntByte(this.data,this.settings.importer.encoding),t.firstFret=M.readInt32LE(this.data),t.firstFret>0)for(let s=0;s<n;s++){let a=M.readInt32LE(this.data);s<e.voice.bar.staff.tuning.length&&t.strings.push(a)}}t.name&&(e.chordId=r,e.voice.bar.staff.addChord(e.chordId,t))}readBeatEffects(e){let t=this.data.readByte(),r=0;if(this._versionNumber>=400&&(r=this.data.readByte()),e.fadeIn=(t&16)!==0,(this._versionNumber<400&&t&1||t&2)&&(e.vibrato=Ue.Slight),e.hasRasgueado=(r&1)!==0,t&32&&this._versionNumber>=400)switch(M.readSInt8(this.data)){case 1:e.tap=!0;break;case 2:e.slap=!0;break;case 3:e.pop=!0;break}else if(t&32){switch(M.readSInt8(this.data)){case 1:e.tap=!0;break;case 2:e.slap=!0;break;case 3:e.pop=!0;break}this.data.skip(4)}if(r&4&&this.readTremoloBarEffect(e),t&64){let n=0,s=0;this._versionNumber<500?(s=this.data.readByte(),n=this.data.readByte()):(n=this.data.readByte(),s=this.data.readByte()),n>0?(e.brushType=lt.BrushUp,e.brushDuration=Un.toStrokeValue(n)):s>0&&(e.brushType=lt.BrushDown,e.brushDuration=Un.toStrokeValue(s))}if(r&2)switch(M.readSInt8(this.data)){case 0:e.pickStroke=gi.None;break;case 1:e.pickStroke=gi.Up;break;case 2:e.pickStroke=gi.Down;break}if(this._versionNumber<400){if(t&4)return ne.Natural;if(t&8)return ne.Artificial}return ne.None}readTremoloBarEffect(e){this.data.readByte(),M.readInt32LE(this.data);let t=M.readInt32LE(this.data);if(t>0)for(let r=0;r<t;r++){let n=new $(0,0);n.offset=M.readInt32LE(this.data),n.value=M.readInt32LE(this.data)/Un.BendStep|0,ze.gpReadBool(this.data),e.addWhammyBarPoint(n)}}static toStrokeValue(e){switch(e){case 1:return 30;case 2:return 30;case 3:return 60;case 4:return 120;case 5:return 240;case 6:return 480;default:return 0}}readMixTableChange(e){let t=new Yz;t.instrument=M.readSInt8(this.data),this._versionNumber>=500&&this.data.skip(16),t.volume=M.readSInt8(this.data),t.balance=M.readSInt8(this.data);let r=M.readSInt8(this.data),n=M.readSInt8(this.data),s=M.readSInt8(this.data),a=M.readSInt8(this.data);if(this._versionNumber>=500&&(t.tempoName=ze.gpReadStringIntByte(this.data,this.settings.importer.encoding)),t.tempo=M.readInt32LE(this.data),t.volume>=0&&this.data.readByte(),t.balance>=0&&this.data.readByte(),r>=0&&this.data.readByte(),n>=0&&this.data.readByte(),s>=0&&this.data.readByte(),a>=0&&this.data.readByte(),t.tempo>=0&&(t.duration=M.readSInt8(this.data),this._versionNumber>=510&&this.data.readByte()),this._versionNumber>=400&&this.data.readByte(),this._versionNumber>=500&&this.data.readByte(),this._versionNumber>=510&&(ze.gpReadStringIntByte(this.data,this.settings.importer.encoding),ze.gpReadStringIntByte(this.data,this.settings.importer.encoding)),t.volume>=0){let o=new wi;o.isLinear=!0,o.type=$t.Volume,o.value=t.volume,e.automations.push(o)}if(t.balance>=0){let o=new wi;o.isLinear=!0,o.type=$t.Balance,o.value=t.balance,e.automations.push(o)}if(t.instrument>=0){let o=new wi;o.isLinear=!0,o.type=$t.Instrument,o.value=t.instrument,e.automations.push(o)}if(t.tempo>=0){let o=new wi;o.isLinear=!0,o.type=$t.Tempo,o.value=t.tempo,e.automations.push(o),e.voice.bar.masterBar.tempoAutomations.push(o)}}readNote(e,t,r,n,s){let a=new Nt;a.string=t.staff.tuning.length-s;let o=this.data.readByte();if(o&2?a.accentuated=jt.Heavy:o&64&&(a.accentuated=jt.Normal),a.isGhost=(o&4)!==0,o&32){let u=this.data.readByte();u===3?a.isDead=!0:u===2&&(a.isTieDestination=!0)}if(o&1&&this._versionNumber<500&&(this.data.readByte(),this.data.readByte()),o&16){let u=M.readSInt8(this.data);a.dynamics=this.toDynamicValue(u),n.dynamics=a.dynamics}o&32&&(a.fret=M.readSInt8(this.data)),o&128&&(a.leftHandFinger=M.readSInt8(this.data),a.rightHandFinger=M.readSInt8(this.data),a.isFingering=!0);let l=!1;if(this._versionNumber>=500&&(o&1&&(a.durationPercent=ze.gpReadDouble(this.data)),l=(this.data.readByte()&2)!==0),n.addNote(a),o&8&&this.readNoteEffects(e,r,n,a),t.staff.isPercussion&&(a.percussionArticulation=a.fret,a.string=-1,a.fret=-1),l){const u=F.defaultAccidentals[a.realValueWithoutHarmonic%12];u==="#"?a.accidentalMode=Ft.ForceFlat:u==="b"&&(a.accidentalMode=Ft.ForceSharp)}return a}toDynamicValue(e){switch(e){case 1:return _e.PPP;case 2:return _e.PP;case 3:return _e.P;case 4:return _e.MP;case 5:return _e.MF;case 6:return _e.F;case 7:return _e.FF;case 8:return _e.FFF;default:return _e.F}}readNoteEffects(e,t,r,n){let s=this.data.readByte(),a=0;this._versionNumber>=400&&(a=this.data.readByte()),s&1&&this.readBend(n),s&16&&this.readGrace(t,n),a&4&&this.readTremoloPicking(r),a&8?this.readSlide(n):this._versionNumber<400&&s&4&&(n.slideOutType=xe.Shift),a&16&&this.readArtificialHarmonic(n),a&32&&this.readTrill(n),n.isLetRing=(s&8)!==0,n.isHammerPullOrigin=(s&2)!==0,a&64&&(n.vibrato=Ue.Slight),n.isPalmMute=(a&2)!==0,n.isStaccato=(a&1)!==0}readBend(e){this.data.readByte(),M.readInt32LE(this.data);let t=M.readInt32LE(this.data);if(t>0)for(let r=0;r<t;r++){let n=new $(0,0);n.offset=M.readInt32LE(this.data),n.value=M.readInt32LE(this.data)/Un.BendStep|0,ze.gpReadBool(this.data),e.addBendPoint(n)}}readGrace(e,t){let r=new xi,n=new Nt;switch(n.string=t.string,n.fret=M.readSInt8(this.data),r.duration=_.ThirtySecond,r.dynamics=this.toDynamicValue(M.readSInt8(this.data)),M.readSInt8(this.data)){case 0:break;case 1:n.slideOutType=xe.Legato,n.slideTarget=t;break;case 2:break;case 3:n.isHammerPullOrigin=!0;break}if(n.dynamics=r.dynamics,this.data.skip(1),this._versionNumber<500)r.graceType=ce.BeforeBeat;else{let a=this.data.readByte();n.isDead=(a&1)!==0,r.graceType=a&2?ce.OnBeat:ce.BeforeBeat}e.addGraceBeat(r),r.addNote(n)}readTremoloPicking(e){switch(this.data.readByte()){case 1:e.tremoloSpeed=_.Eighth;break;case 2:e.tremoloSpeed=_.Sixteenth;break;case 3:e.tremoloSpeed=_.ThirtySecond;break}}readSlide(e){if(this._versionNumber>=500){let t=M.readSInt8(this.data);t&1?e.slideOutType=xe.Shift:t&2?e.slideOutType=xe.Legato:t&4?e.slideOutType=xe.OutDown:t&8&&(e.slideOutType=xe.OutUp),t&16?e.slideInType=ri.IntoFromBelow:t&32&&(e.slideInType=ri.IntoFromAbove)}else switch(M.readSInt8(this.data)){case 1:e.slideOutType=xe.Shift;break;case 2:e.slideOutType=xe.Legato;break;case 3:e.slideOutType=xe.OutDown;break;case 4:e.slideOutType=xe.OutUp;break;case-1:e.slideInType=ri.IntoFromBelow;break;case-2:e.slideInType=ri.IntoFromAbove;break}}readArtificialHarmonic(e){let t=this.data.readByte();if(this._versionNumber>=500)switch(t){case 1:e.harmonicType=ne.Natural,e.harmonicValue=this.deltaFretToHarmonicValue(e.fret);break;case 2:this.data.readByte(),this.data.readByte(),this.data.readByte(),e.harmonicType=ne.Artificial;break;case 3:e.harmonicType=ne.Tap,e.harmonicValue=this.deltaFretToHarmonicValue(this.data.readByte());break;case 4:e.harmonicType=ne.Pinch,e.harmonicValue=12;break;case 5:e.harmonicType=ne.Semi,e.harmonicValue=12;break}else if(this._versionNumber>=400)switch(t){case 1:e.harmonicType=ne.Natural;break;case 3:e.harmonicType=ne.Tap;break;case 4:e.harmonicType=ne.Pinch;break;case 5:e.harmonicType=ne.Semi;break;case 15:e.harmonicType=ne.Artificial;break;case 17:e.harmonicType=ne.Artificial;break;case 22:e.harmonicType=ne.Artificial;break}}deltaFretToHarmonicValue(e){switch(e){case 2:return 2.4;case 3:return 3.2;case 4:case 5:case 7:case 9:case 12:case 16:case 17:case 19:case 24:return e;case 8:return 8.2;case 10:return 9.6;case 14:case 15:return 14.7;case 21:case 22:return 21.7;default:return 12}}readTrill(e){switch(e.trillValue=this.data.readByte()+e.stringTuning,this.data.readByte()){case 1:e.trillSpeed=_.Sixteenth;break;case 2:e.trillSpeed=_.ThirtySecond;break;case 3:e.trillSpeed=_.SixtyFourth;break}}}Un.VersionString="FICHIER GUITAR PRO ";Un.BendStep=25;class ze{static gpReadDouble(e){let t=new Uint8Array(8);return e.read(t,0,t.length),new Float64Array(t.buffer)[0]}static gpReadFloat(e){let t=new Uint8Array(4);return t[3]=e.readByte(),t[2]=e.readByte(),t[2]=e.readByte(),t[1]=e.readByte(),new Float32Array(t.buffer)[0]}static gpReadColor(e,t=!1){let r=e.readByte(),n=e.readByte(),s=e.readByte(),a=255;return t?a=e.readByte():e.skip(1),new qe(r,n,s,a)}static gpReadBool(e){return e.readByte()!==0}static gpReadStringIntUnused(e,t){return e.skip(4),ze.gpReadString(e,e.readByte(),t)}static gpReadStringInt(e,t){return ze.gpReadString(e,M.readInt32LE(e),t)}static gpReadStringIntByte(e,t){let r=M.readInt32LE(e)-1;return e.readByte(),ze.gpReadString(e,r,t)}static gpReadString(e,t,r){let n=new Uint8Array(t);return e.read(n,0,n.length),M.toString(n,r)}static gpWriteString(e,t){const r=M.stringToBytes(t);e.writeByte(t.length),e.write(r,0,r.length)}static gpReadStringByteLength(e,t,r){let n=e.readByte(),s=ze.gpReadString(e,n,r);return n<t&&e.skip(t-n),s}}class Yz{constructor(){this.volume=-1,this.balance=-1,this.instrument=-1,this.tempoName="",this.tempo=-1,this.duration=-1}}class ji{constructor(){this.x=0,this.y=0,this.w=0,this.h=0}}var pn;(function(i){i[i.Boolean=0]="Boolean",i[i.Integer=1]="Integer",i[i.Float=2]="Float",i[i.String=3]="String",i[i.Point=4]="Point",i[i.Size=5]="Size",i[i.Rectangle=6]="Rectangle",i[i.Color=7]="Color"})(pn||(pn={}));class dp{constructor(e){this.raw=new Map;let t=ni.fromBuffer(e),r=M.readInt32BE(t);for(let n=0;n<r;n++){let s=ze.gpReadString(t,t.readByte(),"utf-8");switch(t.readByte()){case pn.Boolean:let o=t.readByte()===1;this.addValue(s,o);break;case pn.Integer:let l=M.readInt32BE(t);this.addValue(s,l);break;case pn.Float:let u=ze.gpReadFloat(t);this.addValue(s,u);break;case pn.String:let c=ze.gpReadString(t,M.readInt16BE(t),"utf-8");this.addValue(s,c);break;case pn.Point:let h=M.readInt32BE(t),d=M.readInt32BE(t);this.addValue(s,new $(h,d));break;case pn.Size:let f=M.readInt32BE(t),p=M.readInt32BE(t);this.addValue(s,new $(f,p));break;case pn.Rectangle:let g=new ji;g.x=M.readInt32BE(t),g.y=M.readInt32BE(t),g.w=M.readInt32BE(t),g.h=M.readInt32BE(t),this.addValue(s,g);break;case pn.Color:let y=ze.gpReadColor(t,!0);this.addValue(s,y);break}}}apply(e){for(const[t,r]of this.raw)switch(t){case"StandardNotation/hideDynamics":e.stylesheet.hideDynamics=r;break}}addValue(e,t){this.raw.set(e,t)}static writeForScore(e){const t=ni.withCapacity(128);return M.writeInt32BE(t,1),dp.writeBooleanEntry(t,"StandardNotation/hideDynamics",e.stylesheet.hideDynamics),t.toArray()}static writeBooleanEntry(e,t,r){ze.gpWriteString(e,t),e.writeByte(pn.Boolean),e.writeByte(r?1:0)}}var Bn;(function(i){i[i.Short=0]="Short",i[i.Medium=1]="Medium",i[i.Long=2]="Long"})(Bn||(Bn={}));class F1{constructor(){this.type=Bn.Short,this.length=0}}var I;(function(i){i[i.None=0]="None",i[i.Element=1]="Element",i[i.Text=2]="Text",i[i.CDATA=3]="CDATA",i[i.Document=4]="Document",i[i.DocumentType=5]="DocumentType"})(I||(I={}));class vn{constructor(){this.nodeType=I.None,this.localName=null,this.value=null,this.childNodes=[],this.attributes=new Map,this.firstChild=null,this.firstElement=null}addChild(e){this.childNodes.push(e),this.firstChild=e,(e.nodeType===I.Element||e.nodeType===I.CDATA)&&(this.firstElement=e)}getAttribute(e){return this.attributes.has(e)?this.attributes.get(e):""}getElementsByTagName(e,t=!1){let r=[];return this.searchElementsByTagName(this.childNodes,r,e,t),r}searchElementsByTagName(e,t,r,n=!1){for(let s of e)s&&s.nodeType===I.Element&&s.localName===r&&t.push(s),n&&this.searchElementsByTagName(s.childNodes,t,r,!0)}findChildElement(e){for(let t of this.childNodes)if(t&&t.nodeType===I.Element&&t.localName===e)return t;return null}addElement(e){const t=new vn;return t.nodeType=I.Element,t.localName=e,this.addChild(t),t}get innerText(){var e;if(this.nodeType===I.Element||this.nodeType===I.Document){if(this.firstElement&&this.firstElement.nodeType===I.CDATA)return this.firstElement.innerText;let t="";for(let n of this.childNodes)t+=(e=n.innerText)==null?void 0:e.toString();return t.trim()}return this.value??""}set innerText(e){const t=new vn;t.nodeType=I.Text,t.value=e,this.childNodes=[t]}setCData(e){const t=new vn;t.nodeType=I.CDATA,t.value=e,this.childNodes=[t]}}class Xi extends oi{constructor(e,t,r){super(ai.Format,e),this.pos=0,this.xml=t,this.pos=r,Object.setPrototypeOf(this,Xi.prototype)}}var me;(function(i){i[i.IgnoreSpaces=0]="IgnoreSpaces",i[i.Begin=1]="Begin",i[i.BeginNode=2]="BeginNode",i[i.TagName=3]="TagName",i[i.Body=4]="Body",i[i.AttribName=5]="AttribName",i[i.Equals=6]="Equals",i[i.AttvalBegin=7]="AttvalBegin",i[i.AttribVal=8]="AttribVal",i[i.Childs=9]="Childs",i[i.Close=10]="Close",i[i.WaitEnd=11]="WaitEnd",i[i.WaitEndRet=12]="WaitEndRet",i[i.Pcdata=13]="Pcdata",i[i.Header=14]="Header",i[i.Comment=15]="Comment",i[i.Doctype=16]="Doctype",i[i.Cdata=17]="Cdata",i[i.Escape=18]="Escape"})(me||(me={}));class Q{static parse(e,t,r){let n=e.charCodeAt(t),s=me.Begin,a=me.Begin,o=0,l="",u=me.Begin,c=null,h=null,d=0,f=0;for(;t<e.length;){switch(n=e.charCodeAt(t),s){case me.IgnoreSpaces:switch(n){case Q.CharCodeLF:case Q.CharCodeCR:case Q.CharCodeTab:case Q.CharCodeSpace:break;default:s=a;continue}break;case me.Begin:switch(n){case Q.CharCodeLowerThan:s=me.IgnoreSpaces,a=me.BeginNode;break;default:o=t,s=me.Pcdata;continue}break;case me.Pcdata:if(n===Q.CharCodeLowerThan){l+=e.substr(o,t-o);let p=new vn;p.nodeType=I.Text,p.value=l,l="",r.addChild(p),s=me.IgnoreSpaces,a=me.BeginNode}else n===Q.CharCodeAmp&&(l+=e.substr(o,t-o),s=me.Escape,u=me.Pcdata,o=t+1);break;case me.Cdata:if(n===Q.CharCodeBrackedClose&&e.charCodeAt(t+1)===Q.CharCodeBrackedClose&&e.charCodeAt(t+2)===Q.CharCodeGreaterThan){let p=new vn;p.nodeType=I.CDATA,p.value=e.substr(o,t-o),r.addChild(p),t+=2,s=me.Begin}break;case me.BeginNode:switch(n){case Q.CharCodeExclamation:if(e.charCodeAt(t+1)===Q.CharCodeBrackedOpen){if(t+=2,e.substr(t,6).toUpperCase()!=="CDATA[")throw new Xi("Expected <![CDATA[",e,t);t+=5,s=me.Cdata,o=t+1}else if(e.charCodeAt(t+1)===Q.CharCodeUpperD||e.charCodeAt(t+1)===Q.CharCodeLowerD){if(e.substr(t+2,6).toUpperCase()!=="OCTYPE")throw new Xi("Expected <!DOCTYPE",e,t);t+=8,s=me.Doctype,o=t+1}else{if(e.charCodeAt(t+1)!==Q.CharCodeMinus||e.charCodeAt(t+2)!==Q.CharCodeMinus)throw new Xi("Expected <!--",e,t);t+=2,s=me.Comment,o=t+1}break;case Q.CharCodeQuestion:s=me.Header,o=t;break;case Q.CharCodeSlash:if(!r)throw new Xi("Expected node name",e,t);o=t+1,s=me.IgnoreSpaces,a=me.Close;break;default:s=me.TagName,o=t;continue}break;case me.TagName:if(!Q.isValidChar(n)){if(t===o)throw new Xi("Expected node name",e,t);c=new vn,c.nodeType=I.Element,c.localName=e.substr(o,t-o),r.addChild(c),s=me.IgnoreSpaces,a=me.Body;continue}break;case me.Body:switch(n){case Q.CharCodeSlash:s=me.WaitEnd;break;case Q.CharCodeGreaterThan:s=me.Childs;break;default:s=me.AttribName,o=t;continue}break;case me.AttribName:if(!Q.isValidChar(n)){if(o===t)throw new Xi("Expected attribute name",e,t);if(h=e.substr(o,t-o),c.attributes.has(h))throw new Xi(`Duplicate attribute [${h}]`,e,t);s=me.IgnoreSpaces,a=me.Equals;continue}break;case me.Equals:switch(n){case Q.CharCodeEquals:s=me.IgnoreSpaces,a=me.AttvalBegin;break;default:throw new Xi("Expected =",e,t)}break;case me.AttvalBegin:switch(n){case Q.CharCodeDoubleQuote:case Q.CharCodeSingleQuote:l="",s=me.AttribVal,o=t+1,f=n;break}break;case me.AttribVal:switch(n){case Q.CharCodeAmp:l+=e.substr(o,t-o),s=me.Escape,u=me.AttribVal,o=t+1;break;default:if(n===f){l+=e.substr(o,t-o);let p=l;l="",c.attributes.set(h,p),s=me.IgnoreSpaces,a=me.Body}break}break;case me.Childs:t=Q.parse(e,t,c),o=t,s=me.Begin;break;case me.WaitEnd:switch(n){case Q.CharCodeGreaterThan:s=me.Begin;break;default:throw new Xi("Expected >",e,t)}break;case me.WaitEndRet:switch(n){case Q.CharCodeGreaterThan:return t;default:throw new Xi("Expected >",e,t)}case me.Close:if(!Q.isValidChar(n)){if(o===t)throw new Xi("Expected node name",e,t);if(e.substr(o,t-o)!==r.localName)throw new Xi("Expected </"+r.localName+">",e,t);s=me.IgnoreSpaces,a=me.WaitEndRet;continue}break;case me.Comment:n===Q.CharCodeMinus&&e.charCodeAt(t+1)===Q.CharCodeMinus&&e.charCodeAt(t+2)===Q.CharCodeGreaterThan&&(t+=2,s=me.Begin);break;case me.Doctype:if(n===Q.CharCodeBrackedOpen)d++;else if(n===Q.CharCodeBrackedClose)d--;else if(n===Q.CharCodeGreaterThan&&d===0){let p=new vn;p.nodeType=I.DocumentType,p.value=e.substr(o,t-o),r.addChild(p),s=me.Begin}break;case me.Header:n===Q.CharCodeQuestion&&e.charCodeAt(t+1)===Q.CharCodeGreaterThan&&(t++,s=me.Begin);break;case me.Escape:if(n===Q.CharCodeSemi){let p=e.substr(o,t-o);if(p.charCodeAt(0)===Q.CharCodeSharp){let g=p.charCodeAt(1)===Q.CharCodeLowerX?parseInt("0"+p.substr(1,p.length-1)):parseInt(p.substr(1,p.length-1));l+=String.fromCharCode(g)}else Q.Escapes.has(p)?l+=Q.Escapes.get(p):l+=("&"+p+";").toString();o=t+1,s=u}else!Q.isValidChar(n)&&n!==Q.CharCodeSharp&&(l+="&",l+=e.substr(o,t-o),t--,o=t+1,s=u);break}t++}if(s===me.Begin&&(o=t,s=me.Pcdata),s===me.Pcdata){if(t!==o){l+=e.substr(o,t-o);let p=new vn;p.nodeType=I.Text,p.value=l,r.addChild(p)}return t}if(s===me.Escape&&u===me.Pcdata){l+="&",l+=e.substr(o,t-o);let p=new vn;return p.nodeType=I.Text,p.value=l,r.addChild(p),t}throw new Xi("Unexpected end",e,t)}static isValidChar(e){return e>=Q.CharCodeLowerA&&e<=Q.CharCodeLowerZ||e>=Q.CharCodeUpperA&&e<=Q.CharCodeUpperZ||e>=Q.CharCode0&&e<=Q.CharCode9||e===Q.CharCodeColon||e===Q.CharCodeDot||e===Q.CharCodeUnderscore||e===Q.CharCodeMinus}}Q.CharCodeLF=10;Q.CharCodeTab=9;Q.CharCodeCR=13;Q.CharCodeSpace=32;Q.CharCodeLowerThan=60;Q.CharCodeAmp=38;Q.CharCodeBrackedClose=93;Q.CharCodeBrackedOpen=91;Q.CharCodeGreaterThan=62;Q.CharCodeExclamation=33;Q.CharCodeUpperD=68;Q.CharCodeLowerD=100;Q.CharCodeMinus=45;Q.CharCodeQuestion=63;Q.CharCodeSlash=47;Q.CharCodeEquals=61;Q.CharCodeDoubleQuote=34;Q.CharCodeSingleQuote=39;Q.CharCodeSharp=35;Q.CharCodeLowerX=120;Q.CharCodeLowerA=97;Q.CharCodeLowerZ=122;Q.CharCodeUpperA=65;Q.CharCodeUpperZ=90;Q.CharCode0=48;Q.CharCode9=57;Q.CharCodeColon=58;Q.CharCodeDot=46;Q.CharCodeUnderscore=95;Q.CharCodeSemi=59;Q.Escapes=new Map([["lt","<"],["gt",">"],["amp","&"],["quot",'"'],["apos","'"]]);class A1{static write(e,t,r){const n=new A1(t,r);return n.writeNode(e),n.toString()}constructor(e,t){this._result=[],this._indention=e,this._xmlHeader=t,this._currentIndention="",this._isStartOfLine=!0}writeNode(e){switch(e.nodeType){case I.None:break;case I.Element:this._result.length>0&&this.writeLine(),this.write(`<${e.localName}`);for(const[t,r]of e.attributes)this.write(` ${t}="`),this.writeAttributeValue(r),this.write('"');if(e.childNodes.length===0)this.write("/>");else{if(this.write(">"),e.childNodes.length===1&&!e.firstElement)this.writeNode(e.childNodes[0]);else{this.indent();for(const t of e.childNodes)t.nodeType===I.Element&&this.writeNode(t);this.unindend(),this.writeLine()}this.write(`</${e.localName}>`)}break;case I.Text:e.value&&this.write(e.value);break;case I.CDATA:e.value!==null&&this.write(`<![CDATA[${e.value}]]>`);break;case I.Document:this._xmlHeader&&this.write('<?xml version="1.0" encoding="utf-8"?>');for(const t of e.childNodes)this.writeNode(t);break;case I.DocumentType:this.write(`<!DOCTYPE ${e.value}>`);break}}unindend(){this._currentIndention=this._currentIndention.substr(0,this._currentIndention.length-this._indention.length)}indent(){this._currentIndention+=this._indention}writeAttributeValue(e){for(let t=0;t<e.length;t++){const r=e.charAt(t);switch(r){case"<":this._result.push("&lt;");break;case">":this._result.push("&gt;");break;case"&":this._result.push("&amp;");break;case"'":this._result.push("&apos;");break;case'"':this._result.push("&quot;");break;default:this._result.push(r);break}}}write(e){this._isStartOfLine&&this._result.push(this._currentIndention),this._result.push(e),this._isStartOfLine=!1}writeLine(e=null){e&&this.write(e),this._indention.length>0&&!this._isStartOfLine&&(this._result.push(`
`),this._isStartOfLine=!0)}toString(){return this._result.join("").trimRight()}}class Fd extends vn{constructor(){super(),this.nodeType=I.Document}parse(e){Q.parse(e,0,this)}toString(){return this.toFormattedString()}toFormattedString(e="",t=!1){return A1.write(this,e,t)}}var H;(function(i){i[i.Up=0]="Up",i[i.Down=1]="Down"})(H||(H={}));class Xz{constructor(){this.id="",this.dots=0,this.tupletDenominator=-1,this.tupletNumerator=-1,this.value=_.Quarter}}class Kz{constructor(){this.name="",this.path="",this.role="",this.program=0}get uniqueId(){return this.path+";"+this.name+";"+this.role}}class Qr{constructor(){this._hasAnacrusis=!1,this._skipApplyLyrics=!1}parseXml(e,t){this._masterTrackAutomations=new Map,this._automationsPerTrackIdAndBarIndex=new Map,this._tracksMapping=[],this._tracksById=new Map,this._masterBars=[],this._barsOfMasterBar=[],this._voicesOfBar=new Map,this._barsById=new Map,this._voiceById=new Map,this._beatsOfVoice=new Map,this._beatById=new Map,this._rhythmOfBeat=new Map,this._rhythmById=new Map,this._notesOfBeat=new Map,this._noteById=new Map,this._tappedNotes=new Map,this._lyricsByTrack=new Map,this._soundsByTrack=new Map,this._skipApplyLyrics=!1;let r=new Fd;try{r.parse(e)}catch(n){throw new gt("Could not parse XML",n)}if(this.parseDom(r),this.buildModel(),this.score.finish(t),!this._skipApplyLyrics&&this._lyricsByTrack.size>0)for(const[n,s]of this._lyricsByTrack)this._tracksById.get(n).applyLyrics(s)}parseDom(e){let t=e.firstElement;if(t)if(t.localName==="GPIF"){this.score=new no;for(let r of t.childNodes)if(r.nodeType===I.Element)switch(r.localName){case"Score":this.parseScoreNode(r);break;case"MasterTrack":this.parseMasterTrackNode(r);break;case"Tracks":this.parseTracksNode(r);break;case"MasterBars":this.parseMasterBarsNode(r);break;case"Bars":this.parseBars(r);break;case"Voices":this.parseVoices(r);break;case"Beats":this.parseBeats(r);break;case"Notes":this.parseNotes(r);break;case"Rhythms":this.parseRhythms(r);break}}else throw new gt("Root node of XML was not GPIF")}parseScoreNode(e){for(let t of e.childNodes)if(t.nodeType===I.Element)switch(t.localName){case"Title":this.score.title=t.firstChild.innerText;break;case"SubTitle":this.score.subTitle=t.firstChild.innerText;break;case"Artist":this.score.artist=t.firstChild.innerText;break;case"Album":this.score.album=t.firstChild.innerText;break;case"Words":this.score.words=t.firstChild.innerText;break;case"Music":this.score.music=t.firstChild.innerText;break;case"WordsAndMusic":if(t.firstChild&&t.firstChild.innerText!==""){let r=t.firstChild.innerText;r&&!this.score.words&&(this.score.words=r),r&&!this.score.music&&(this.score.music=r)}break;case"Copyright":this.score.copyright=t.firstChild.innerText;break;case"Tabber":this.score.tab=t.firstChild.innerText;break;case"Instructions":this.score.instructions=t.firstChild.innerText;break;case"Notices":this.score.notices=t.firstChild.innerText;break;case"ScoreSystemsDefaultLayout":this.score.defaultSystemsLayout=parseInt(t.innerText);break;case"ScoreSystemsLayout":this.score.systemsLayout=t.innerText.split(" ").map(r=>parseInt(r));break}}parseMasterTrackNode(e){for(let t of e.childNodes)if(t.nodeType===I.Element)switch(t.localName){case"Automations":this.parseAutomations(t,this._masterTrackAutomations,null);break;case"Tracks":this._tracksMapping=t.innerText.split(" ");break;case"Anacrusis":this._hasAnacrusis=!0;break}}parseAutomations(e,t,r){for(let n of e.childNodes)if(n.nodeType===I.Element)switch(n.localName){case"Automation":this.parseAutomation(n,t,r);break}}parseAutomation(e,t,r){let n=null,s=!1,a=-1,o=0,l=0,u=null,c=0,h=null;for(let f of e.childNodes)if(f.nodeType===I.Element)switch(f.localName){case"Type":n=f.innerText;break;case"Linear":s=f.innerText.toLowerCase()==="true";break;case"Bar":a=parseInt(f.innerText);break;case"Position":o=parseFloat(f.innerText);break;case"Value":if(f.firstElement&&f.firstElement.nodeType===I.CDATA)u=f.innerText;else{let p=f.innerText.split(" ");p.length===1?(l=parseFloat(p[0]),c=1):(l=parseFloat(p[0]),c=parseInt(p[1]))}break;case"Text":h=f.innerText;break}if(!n)return;let d=null;switch(n){case"Tempo":d=wi.buildTempoAutomation(s,o,l,c);break;case"Sound":u&&r&&r.has(u)&&(d=wi.buildInstrumentAutomation(s,o,r.get(u).program));break}d&&(h&&(d.text=h),a>=0&&(t.has(a)||t.set(a,[]),t.get(a).push(d)))}parseTracksNode(e){for(let t of e.childNodes)if(t.nodeType===I.Element)switch(t.localName){case"Track":this.parseTrack(t);break}}parseTrack(e){this._articulationByName=new Map;let t=new Jn;t.ensureStaveCount(1);let r=t.staves[0];r.showStandardNotation=!0;let n=e.getAttribute("id");for(let s of e.childNodes)if(s.nodeType===I.Element)switch(s.localName){case"Name":t.name=s.innerText;break;case"Color":let a=s.innerText.split(" ");if(a.length>=3){let u=parseInt(a[0]),c=parseInt(a[1]),h=parseInt(a[2]);t.color=new qe(u,c,h,255)}break;case"Instrument":let o=s.getAttribute("ref");(o.endsWith("-gs")||o.endsWith("GrandStaff"))&&(t.ensureStaveCount(2),t.staves[1].showStandardNotation=!0);break;case"InstrumentSet":this.parseInstrumentSet(t,s);break;case"NotationPatch":this.parseNotationPatch(t,s);break;case"ShortName":t.shortName=s.innerText;break;case"SystemsDefautLayout":t.defaultSystemsLayout=parseInt(s.innerText);break;case"SystemsLayout":t.systemsLayout=s.innerText.split(" ").map(u=>parseInt(u));break;case"Lyrics":this.parseLyrics(n,s);break;case"Properties":this.parseTrackProperties(t,s);break;case"GeneralMidi":case"MidiConnection":case"MIDISettings":this.parseGeneralMidi(t,s);break;case"Sounds":this.parseSounds(n,t,s);break;case"PlaybackState":let l=s.innerText;t.playbackInfo.isSolo=l==="Solo",t.playbackInfo.isMute=l==="Mute";break;case"PartSounding":this.parsePartSounding(t,s);break;case"Staves":this.parseStaves(t,s);break;case"Transpose":this.parseTranspose(t,s);break;case"RSE":this.parseRSE(t,s);break;case"Automations":this.parseTrackAutomations(n,s);break}this._tracksById.set(n,t)}parseTrackAutomations(e,t){const r=new Map;this._automationsPerTrackIdAndBarIndex.set(e,r),this.parseAutomations(t,r,this._soundsByTrack.get(e))}parseNotationPatch(e,t){for(let r of t.childNodes)if(r.nodeType===I.Element)switch(r.localName){case"LineCount":const n=parseInt(r.innerText);for(let s of e.staves)s.standardNotationLineCount=n;break;case"Elements":this.parseElements(e,r);break}}parseInstrumentSet(e,t){for(let r of t.childNodes)if(r.nodeType===I.Element)switch(r.localName){case"Type":switch(r.innerText){case"drumKit":for(let s of e.staves)s.isPercussion=!0;break}if(r.innerText==="drumKit")for(let s of e.staves)s.isPercussion=!0;break;case"Elements":this.parseElements(e,r);break;case"LineCount":const n=parseInt(r.innerText);for(let s of e.staves)s.standardNotationLineCount=n;break}}parseElements(e,t){for(let r of t.childNodes)if(r.nodeType===I.Element)switch(r.localName){case"Element":this.parseElement(e,r);break}}parseElement(e,t){const r=t.findChildElement("Type"),n=r?r.innerText:"";for(let s of t.childNodes)if(s.nodeType===I.Element)switch(s.localName){case"Name":case"Articulations":this.parseArticulations(e,s,n);break}}parseArticulations(e,t,r){for(let n of t.childNodes)if(n.nodeType===I.Element)switch(n.localName){case"Articulation":this.parseArticulation(e,n,r);break}}parseArticulation(e,t,r){const n=new Y;n.outputMidiNumber=-1,n.elementType=r;let s="";for(let a of t.childNodes)if(a.nodeType===I.Element){const o=a.innerText;switch(a.localName){case"Name":s=a.innerText;break;case"OutputMidiNumber":o.length>0&&(n.outputMidiNumber=parseInt(o));break;case"TechniqueSymbol":n.techniqueSymbol=this.parseTechniqueSymbol(o);break;case"TechniquePlacement":switch(o){case"outside":n.techniqueSymbolPlacement=Se.Bottom;break;case"inside":n.techniqueSymbolPlacement=Se.Middle;break;case"above":n.techniqueSymbolPlacement=Se.Bottom;break;case"below":n.techniqueSymbolPlacement=Se.Top;break}break;case"Noteheads":const l=o.split(" ");l.length>=1&&(n.noteHeadDefault=this.parseNoteHead(l[0])),l.length>=2&&(n.noteHeadHalf=this.parseNoteHead(l[1])),l.length>=3&&(n.noteHeadWhole=this.parseNoteHead(l[2])),n.noteHeadHalf==w.None&&(n.noteHeadHalf=n.noteHeadDefault),n.noteHeadWhole==w.None&&(n.noteHeadWhole=n.noteHeadDefault);break;case"StaffLine":o.length>0&&(n.staffLine=parseInt(o));break}}n.outputMidiNumber!==-1?(e.percussionArticulations.push(n),s.length>0&&this._articulationByName.set(s,n)):s.length>0&&this._articulationByName.has(s)&&(this._articulationByName.get(s).staffLine=n.staffLine)}parseTechniqueSymbol(e){switch(e){case"pictEdgeOfCymbal":return w.PictEdgeOfCymbal;case"articStaccatoAbove":return w.ArticStaccatoAbove;case"noteheadParenthesis":return w.NoteheadParenthesis;case"stringsUpBow":return w.StringsUpBow;case"stringsDownBow":return w.StringsDownBow;case"guitarGolpe":return w.GuitarGolpe;default:return w.None}}parseNoteHead(e){switch(e){case"noteheadDoubleWholeSquare":return w.NoteheadDoubleWholeSquare;case"noteheadDoubleWhole":return w.NoteheadDoubleWhole;case"noteheadWhole":return w.NoteheadWhole;case"noteheadHalf":return w.NoteheadHalf;case"noteheadBlack":return w.NoteheadBlack;case"noteheadNull":return w.NoteheadNull;case"noteheadXOrnate":return w.NoteheadXOrnate;case"noteheadTriangleUpWhole":return w.NoteheadTriangleUpWhole;case"noteheadTriangleUpHalf":return w.NoteheadTriangleUpHalf;case"noteheadTriangleUpBlack":return w.NoteheadTriangleUpBlack;case"noteheadDiamondBlackWide":return w.NoteheadDiamondBlackWide;case"noteheadDiamondWhite":return w.NoteheadDiamondWhite;case"noteheadDiamondWhiteWide":return w.NoteheadDiamondWhiteWide;case"noteheadCircleX":return w.NoteheadCircleX;case"noteheadXWhole":return w.NoteheadXWhole;case"noteheadXHalf":return w.NoteheadXHalf;case"noteheadXBlack":return w.NoteheadXBlack;case"noteheadParenthesis":return w.NoteheadParenthesis;case"noteheadSlashedBlack2":return w.NoteheadSlashedBlack2;case"noteheadCircleSlash":return w.NoteheadCircleSlash;case"noteheadHeavyX":return w.NoteheadHeavyX;case"noteheadHeavyXHat":return w.NoteheadHeavyXHat;default:return V.warning("GPIF","Unknown notehead symbol",e),w.None}}parseStaves(e,t){let r=0;for(let n of t.childNodes)if(n.nodeType===I.Element)switch(n.localName){case"Staff":e.ensureStaveCount(r+1);let s=e.staves[r];this.parseStaff(s,n),r++;break}}parseStaff(e,t){for(let r of t.childNodes)if(r.nodeType===I.Element)switch(r.localName){case"Properties":this.parseStaffProperties(e,r);break}}parseStaffProperties(e,t){for(let r of t.childNodes)if(r.nodeType===I.Element)switch(r.localName){case"Property":this.parseStaffProperty(e,r);break}}parseStaffProperty(e,t){switch(t.getAttribute("name")){case"Tuning":for(let s of t.childNodes)if(s.nodeType===I.Element)switch(s.localName){case"Pitches":let a=t.findChildElement("Pitches").innerText.split(" "),o=new Array(a.length);for(let l=0;l<o.length;l++)o[o.length-1-l]=parseInt(a[l]);e.stringTuning.tunings=o;break;case"Label":e.stringTuning.name=s.innerText;break}e.isPercussion||(e.showTablature=!0);break;case"DiagramCollection":case"ChordCollection":this.parseDiagramCollectionForStaff(e,t);break;case"CapoFret":let n=parseInt(t.findChildElement("Fret").innerText);e.capo=n;break}}parseLyrics(e,t){let r=[];for(let n of t.childNodes)if(n.nodeType===I.Element)switch(n.localName){case"Line":r.push(this.parseLyricsLine(n));break}this._lyricsByTrack.set(e,r)}parseLyricsLine(e){let t=new Ut;for(let r of e.childNodes)if(r.nodeType===I.Element)switch(r.localName){case"Offset":t.startBar=parseInt(r.innerText);break;case"Text":t.text=r.innerText;break}return t}parseDiagramCollectionForTrack(e,t){let r=t.findChildElement("Items");for(let n of r.childNodes)if(n.nodeType===I.Element)switch(n.localName){case"Item":this.parseDiagramItemForTrack(e,n);break}}parseDiagramCollectionForStaff(e,t){let r=t.findChildElement("Items");for(let n of r.childNodes)if(n.nodeType===I.Element)switch(n.localName){case"Item":this.parseDiagramItemForStaff(e,n);break}}parseDiagramItemForTrack(e,t){let r=new ha,n=t.getAttribute("id");for(let s of e.staves)s.addChord(n,r);this.parseDiagramItemForChord(r,t)}parseDiagramItemForStaff(e,t){let r=new ha,n=t.getAttribute("id");e.addChord(n,r),this.parseDiagramItemForChord(r,t)}parseDiagramItemForChord(e,t){e.name=t.getAttribute("name");let r=t.findChildElement("Diagram");if(!r){e.showDiagram=!1,e.showFingering=!1;return}let n=parseInt(r.getAttribute("stringCount")),s=parseInt(r.getAttribute("baseFret"));e.firstFret=s+1;for(let a=0;a<n;a++)e.strings.push(-1);for(let a of r.childNodes)if(a.nodeType===I.Element)switch(a.localName){case"Fret":let o=parseInt(a.getAttribute("string"));e.strings[n-o-1]=s+parseInt(a.getAttribute("fret"));break;case"Fingering":let l=new Map;for(let u of a.childNodes)if(u.nodeType===I.Element)switch(u.localName){case"Position":let c=be.Unknown,h=s+parseInt(u.getAttribute("fret"));switch(u.getAttribute("finger")){case"Index":c=be.IndexFinger;break;case"Middle":c=be.MiddleFinger;break;case"Rank":c=be.AnnularFinger;break;case"Pinky":c=be.LittleFinger;break;case"Thumb":c=be.Thumb;break}c!==be.Unknown&&(l.has(c)?e.barreFrets.push(h):l.set(c,!0));break}break;case"Property":switch(a.getAttribute("name")){case"ShowName":e.showName=a.getAttribute("value")==="true";break;case"ShowDiagram":e.showDiagram=a.getAttribute("value")==="true";break;case"ShowFingering":e.showFingering=a.getAttribute("value")==="true";break}break}}parseTrackProperties(e,t){for(let r of t.childNodes)if(r.nodeType===I.Element)switch(r.localName){case"Property":this.parseTrackProperty(e,r);break}}parseTrackProperty(e,t){switch(t.getAttribute("name")){case"Tuning":let n=t.findChildElement("Pitches").innerText.split(" "),s=new Array(n.length);for(let o=0;o<s.length;o++)s[s.length-1-o]=parseInt(n[o]);for(let o of e.staves)o.stringTuning.tunings=s,o.showStandardNotation=!0,o.showTablature=!0;break;case"DiagramCollection":case"ChordCollection":this.parseDiagramCollectionForTrack(e,t);break;case"CapoFret":let a=parseInt(t.findChildElement("Fret").innerText);for(let o of e.staves)o.capo=a;break}}parseGeneralMidi(e,t){for(let n of t.childNodes)if(n.nodeType===I.Element)switch(n.localName){case"Program":e.playbackInfo.program=parseInt(n.innerText);break;case"Port":e.playbackInfo.port=parseInt(n.innerText);break;case"PrimaryChannel":e.playbackInfo.primaryChannel=parseInt(n.innerText);break;case"SecondaryChannel":e.playbackInfo.secondaryChannel=parseInt(n.innerText);break}if(t.getAttribute("table")==="Percussion")for(let n of e.staves)n.isPercussion=!0}parseSounds(e,t,r){for(let n of r.childNodes)if(n.nodeType===I.Element)switch(n.localName){case"Sound":this.parseSound(e,t,n);break}}parseSound(e,t,r){const n=new Kz;for(let s of r.childNodes)if(s.nodeType===I.Element)switch(s.localName){case"Name":n.name=s.innerText;break;case"Path":n.path=s.innerText;break;case"Role":n.role=s.innerText;break;case"MIDI":this.parseSoundMidi(n,s);break}(n.role==="Factory"||t.playbackInfo.program===0)&&(t.playbackInfo.program=n.program),this._soundsByTrack.has(e)||this._soundsByTrack.set(e,new Map),this._soundsByTrack.get(e).set(n.uniqueId,n)}parseSoundMidi(e,t){for(let r of t.childNodes)if(r.nodeType===I.Element)switch(r.localName){case"Program":e.program=parseInt(r.innerText);break}}parsePartSounding(e,t){for(let r of t.childNodes)if(r.nodeType===I.Element)switch(r.localName){case"TranspositionPitch":for(let n of e.staves)n.displayTranspositionPitch=parseInt(r.innerText);break}}parseTranspose(e,t){let r=0,n=0;for(let s of t.childNodes)if(s.nodeType===I.Element)switch(s.localName){case"Chromatic":n=parseInt(s.innerText);break;case"Octave":r=parseInt(s.innerText);break}for(let s of e.staves)s.displayTranspositionPitch=r*12+n}parseRSE(e,t){for(let r of t.childNodes)if(r.nodeType===I.Element)switch(r.localName){case"ChannelStrip":this.parseChannelStrip(e,r);break}}parseChannelStrip(e,t){for(let r of t.childNodes)if(r.nodeType===I.Element)switch(r.localName){case"Parameters":this.parseChannelStripParameters(e,r);break}}parseChannelStripParameters(e,t){if(t.firstChild&&t.firstChild.value){let r=t.firstChild.value.split(" ");r.length>=12&&(e.playbackInfo.balance=Math.floor(parseFloat(r[11])*16),e.playbackInfo.volume=Math.floor(parseFloat(r[12])*16))}}parseMasterBarsNode(e){for(let t of e.childNodes)if(t.nodeType===I.Element)switch(t.localName){case"MasterBar":this.parseMasterBar(t);break}}parseMasterBar(e){let t=new Ts;this._masterBars.length===0&&this._hasAnacrusis&&(t.isAnacrusis=!0);for(let r of e.childNodes)if(r.nodeType===I.Element)switch(r.localName){case"Time":let n=r.innerText.split("/");t.timeSignatureNumerator=parseInt(n[0]),t.timeSignatureDenominator=parseInt(n[1]);break;case"DoubleBar":t.isDoubleBar=!0;break;case"Section":t.section=new hp,t.section.marker=r.findChildElement("Letter").innerText,t.section.text=r.findChildElement("Text").innerText;break;case"Repeat":r.getAttribute("start").toLowerCase()==="true"&&(t.isRepeatStart=!0),r.getAttribute("end").toLowerCase()==="true"&&r.getAttribute("count")&&(t.repeatCount=parseInt(r.getAttribute("count")));break;case"AlternateEndings":let s=r.innerText.split(" "),a=0;for(let l=0;l<s.length;l++)a=a|1<<-1+parseInt(s[l]);t.alternateEndings=a;break;case"Bars":this._barsOfMasterBar.push(r.innerText.split(" "));break;case"TripletFeel":switch(r.innerText){case"NoTripletFeel":t.tripletFeel=Be.NoTripletFeel;break;case"Triplet8th":t.tripletFeel=Be.Triplet8th;break;case"Triplet16th":t.tripletFeel=Be.Triplet16th;break;case"Dotted8th":t.tripletFeel=Be.Dotted8th;break;case"Dotted16th":t.tripletFeel=Be.Dotted16th;break;case"Scottish8th":t.tripletFeel=Be.Scottish8th;break;case"Scottish16th":t.tripletFeel=Be.Scottish16th;break}break;case"Key":t.keySignature=parseInt(r.findChildElement("AccidentalCount").innerText);let o=r.findChildElement("Mode");if(o)switch(o.innerText.toLowerCase()){case"major":t.keySignatureType=da.Major;break;case"minor":t.keySignatureType=da.Minor;break}break;case"Fermatas":this.parseFermatas(t,r);break;case"XProperties":this.parseMasterBarXProperties(r,t);break}this._masterBars.push(t)}parseFermatas(e,t){for(let r of t.childNodes)if(r.nodeType===I.Element)switch(r.localName){case"Fermata":this.parseFermata(e,r);break}}parseFermata(e,t){let r=0,n=new F1;for(let s of t.childNodes)if(s.nodeType===I.Element)switch(s.localName){case"Type":switch(s.innerText){case"Short":n.type=Bn.Short;break;case"Medium":n.type=Bn.Medium;break;case"Long":n.type=Bn.Long;break}break;case"Length":n.length=parseFloat(s.innerText);break;case"Offset":let a=s.innerText.split("/");if(a.length===2){let o=parseInt(a[0]),l=parseInt(a[1]);r=o/l*we.QuarterTime|0}break}e.addFermata(r,n)}parseBars(e){for(let t of e.childNodes)if(t.nodeType===I.Element)switch(t.localName){case"Bar":this.parseBar(t);break}}parseBar(e){let t=new Ps,r=e.getAttribute("id");for(let n of e.childNodes)if(n.nodeType===I.Element)switch(n.localName){case"Voices":this._voicesOfBar.set(r,n.innerText.split(" "));break;case"Clef":switch(n.innerText){case"Neutral":t.clef=ve.Neutral;break;case"G2":t.clef=ve.G2;break;case"F4":t.clef=ve.F4;break;case"C4":t.clef=ve.C4;break;case"C3":t.clef=ve.C3;break}break;case"Ottavia":switch(n.innerText){case"8va":t.clefOttava=$e._8va;break;case"15ma":t.clefOttava=$e._15ma;break;case"8vb":t.clefOttava=$e._8vb;break;case"15mb":t.clefOttava=$e._15mb;break}break;case"SimileMark":switch(n.innerText){case"Simple":t.simileMark=Fr.Simple;break;case"FirstOfDouble":t.simileMark=Fr.FirstOfDouble;break;case"SecondOfDouble":t.simileMark=Fr.SecondOfDouble;break}break;case"XProperties":this.parseBarXProperties(n,t);break}this._barsById.set(r,t)}parseVoices(e){for(let t of e.childNodes)if(t.nodeType===I.Element)switch(t.localName){case"Voice":this.parseVoice(t);break}}parseVoice(e){let t=new Qn,r=e.getAttribute("id");for(let n of e.childNodes)if(n.nodeType===I.Element)switch(n.localName){case"Beats":this._beatsOfVoice.set(r,n.innerText.split(" "));break}this._voiceById.set(r,t)}parseBeats(e){for(let t of e.childNodes)if(t.nodeType===I.Element)switch(t.localName){case"Beat":this.parseBeat(t);break}}parseBeat(e){let t=new xi,r=e.getAttribute("id");for(let n of e.childNodes)if(n.nodeType===I.Element)switch(n.localName){case"Notes":this._notesOfBeat.set(r,n.innerText.split(" "));break;case"Rhythm":this._rhythmOfBeat.set(r,n.getAttribute("ref"));break;case"Fadding":n.innerText==="FadeIn"&&(t.fadeIn=!0);break;case"Tremolo":switch(n.innerText){case"1/2":t.tremoloSpeed=_.Eighth;break;case"1/4":t.tremoloSpeed=_.Sixteenth;break;case"1/8":t.tremoloSpeed=_.ThirtySecond;break}break;case"Chord":t.chordId=n.innerText;break;case"Hairpin":switch(n.innerText){case"Crescendo":t.crescendo=Zi.Crescendo;break;case"Decrescendo":t.crescendo=Zi.Decrescendo;break}break;case"Arpeggio":n.innerText==="Up"?t.brushType=lt.ArpeggioUp:t.brushType=lt.ArpeggioDown;break;case"Properties":this.parseBeatProperties(n,t);break;case"XProperties":this.parseBeatXProperties(n,t);break;case"FreeText":t.text=n.innerText;break;case"TransposedPitchStemOrientation":switch(n.innerText){case"Upward":t.preferredBeamDirection=H.Up;break;case"Downward":t.preferredBeamDirection=H.Down;break}break;case"Dynamic":switch(n.innerText){case"PPP":t.dynamics=_e.PPP;break;case"PP":t.dynamics=_e.PP;break;case"P":t.dynamics=_e.P;break;case"MP":t.dynamics=_e.MP;break;case"MF":t.dynamics=_e.MF;break;case"F":t.dynamics=_e.F;break;case"FF":t.dynamics=_e.FF;break;case"FFF":t.dynamics=_e.FFF;break}break;case"GraceNotes":switch(n.innerText){case"OnBeat":t.graceType=ce.OnBeat;break;case"BeforeBeat":t.graceType=ce.BeforeBeat;break}break;case"Legato":n.getAttribute("origin")==="true"&&(t.isLegatoOrigin=!0);break;case"Whammy":let s=new $(0,0);s.value=this.toBendValue(parseFloat(n.getAttribute("originValue"))),s.offset=this.toBendOffset(parseFloat(n.getAttribute("originOffset"))),t.addWhammyBarPoint(s);let a=new $(0,0);a.value=this.toBendValue(parseFloat(n.getAttribute("middleValue"))),a.offset=this.toBendOffset(parseFloat(n.getAttribute("middleOffset1"))),t.addWhammyBarPoint(a);let o=new $(0,0);o.value=this.toBendValue(parseFloat(n.getAttribute("middleValue"))),o.offset=this.toBendOffset(parseFloat(n.getAttribute("middleOffset2"))),t.addWhammyBarPoint(o);let l=new $(0,0);l.value=this.toBendValue(parseFloat(n.getAttribute("destinationValue"))),l.offset=this.toBendOffset(parseFloat(n.getAttribute("destinationOffset"))),t.addWhammyBarPoint(l);break;case"Ottavia":switch(n.innerText){case"8va":t.ottava=$e._8va;break;case"8vb":t.ottava=$e._8vb;break;case"15ma":t.ottava=$e._15ma;break;case"15mb":t.ottava=$e._15mb;break}break;case"Lyrics":t.lyrics=this.parseBeatLyrics(n),this._skipApplyLyrics=!0;break}this._beatById.set(r,t)}parseBeatLyrics(e){const t=[];for(let r of e.childNodes)if(r.nodeType===I.Element)switch(r.localName){case"Line":t.push(r.innerText);break}return t}parseBeatXProperties(e,t){for(let r of e.childNodes)if(r.nodeType===I.Element)switch(r.localName){case"XProperty":let n=r.getAttribute("id"),s=0;switch(n){case"1124204545":s=parseInt(r.findChildElement("Int").innerText),t.invertBeamDirection=s===1;break;case"687935489":s=parseInt(r.findChildElement("Int").innerText),t.brushDuration=s;break}break}}parseBarXProperties(e,t){for(let r of e.childNodes)if(r.nodeType===I.Element)switch(r.localName){case"XProperty":switch(r.getAttribute("id")){case"1124139520":const s=r.findChildElement("Double")??r.findChildElement("Float");t.displayScale=parseFloat(s.innerText);break}break}}parseMasterBarXProperties(e,t){for(let r of e.childNodes)if(r.nodeType===I.Element)switch(r.localName){case"XProperty":switch(r.getAttribute("id")){case"1124073984":t.displayScale=parseFloat(r.findChildElement("Double").innerText);break}break}}parseBeatProperties(e,t){let r=!1,n=null,s=null,a=null,o=null,l=null;for(let u of e.childNodes)if(u.nodeType===I.Element)switch(u.localName){case"Property":switch(u.getAttribute("name")){case"Brush":u.findChildElement("Direction").innerText==="Up"?t.brushType=lt.BrushUp:t.brushType=lt.BrushDown;break;case"PickStroke":u.findChildElement("Direction").innerText==="Up"?t.pickStroke=gi.Up:t.pickStroke=gi.Down;break;case"Slapped":u.findChildElement("Enable")&&(t.slap=!0);break;case"Popped":u.findChildElement("Enable")&&(t.pop=!0);break;case"VibratoWTremBar":switch(u.findChildElement("Strength").innerText){case"Wide":t.vibrato=Ue.Wide;break;case"Slight":t.vibrato=Ue.Slight;break}break;case"WhammyBar":r=!0;break;case"WhammyBarExtend":break;case"WhammyBarOriginValue":n||(n=new $(0,0)),n.value=this.toBendValue(parseFloat(u.findChildElement("Float").innerText));break;case"WhammyBarOriginOffset":n||(n=new $(0,0)),n.offset=this.toBendOffset(parseFloat(u.findChildElement("Float").innerText));break;case"WhammyBarMiddleValue":s=this.toBendValue(parseFloat(u.findChildElement("Float").innerText));break;case"WhammyBarMiddleOffset1":a=this.toBendOffset(parseFloat(u.findChildElement("Float").innerText));break;case"WhammyBarMiddleOffset2":o=this.toBendOffset(parseFloat(u.findChildElement("Float").innerText));break;case"WhammyBarDestinationValue":l||(l=new $($.MaxPosition,0)),l.value=this.toBendValue(parseFloat(u.findChildElement("Float").innerText));break;case"WhammyBarDestinationOffset":l||(l=new $(0,0)),l.offset=this.toBendOffset(parseFloat(u.findChildElement("Float").innerText));break}break}r&&(n||(n=new $(0,0)),l||(l=new $($.MaxPosition,0)),t.addWhammyBarPoint(n),a&&s&&t.addWhammyBarPoint(new $(a,s)),o&&s&&t.addWhammyBarPoint(new $(o,s)),!a&&!o&&s&&t.addWhammyBarPoint(new $($.MaxPosition/2|0,s)),t.addWhammyBarPoint(l))}parseNotes(e){for(let t of e.childNodes)if(t.nodeType===I.Element)switch(t.localName){case"Note":this.parseNote(t);break}}parseNote(e){let t=new Nt,r=e.getAttribute("id");for(let n of e.childNodes)if(n.nodeType===I.Element)switch(n.localName){case"Properties":this.parseNoteProperties(n,t,r);break;case"AntiAccent":n.innerText.toLowerCase()==="normal"&&(t.isGhost=!0);break;case"LetRing":t.isLetRing=!0;break;case"Trill":t.trillValue=parseInt(n.innerText),t.trillSpeed=_.Sixteenth;break;case"Accent":let s=parseInt(n.innerText);s&1&&(t.isStaccato=!0),s&4&&(t.accentuated=jt.Heavy),s&8&&(t.accentuated=jt.Normal);break;case"Tie":n.getAttribute("destination").toLowerCase()==="true"&&(t.isTieDestination=!0);break;case"Vibrato":switch(n.innerText){case"Slight":t.vibrato=Ue.Slight;break;case"Wide":t.vibrato=Ue.Wide;break}break;case"LeftFingering":switch(t.isFingering=!0,n.innerText){case"P":t.leftHandFinger=be.Thumb;break;case"I":t.leftHandFinger=be.IndexFinger;break;case"M":t.leftHandFinger=be.MiddleFinger;break;case"A":t.leftHandFinger=be.AnnularFinger;break;case"C":t.leftHandFinger=be.LittleFinger;break}break;case"RightFingering":switch(t.isFingering=!0,n.innerText){case"P":t.rightHandFinger=be.Thumb;break;case"I":t.rightHandFinger=be.IndexFinger;break;case"M":t.rightHandFinger=be.MiddleFinger;break;case"A":t.rightHandFinger=be.AnnularFinger;break;case"C":t.rightHandFinger=be.LittleFinger;break}break;case"InstrumentArticulation":t.percussionArticulation=parseInt(n.innerText);break}this._noteById.set(r,t)}parseNoteProperties(e,t,r){let n=!1,s=null,a=null,o=null,l=null,u=null,c=-1,h=-1;for(let d of e.childNodes)if(d.nodeType===I.Element)switch(d.localName){case"Property":switch(d.getAttribute("name")){case"String":t.string=parseInt(d.findChildElement("String").innerText)+1;break;case"Fret":t.fret=parseInt(d.findChildElement("Fret").innerText);break;case"Element":c=parseInt(d.findChildElement("Element").innerText);break;case"Variation":h=parseInt(d.findChildElement("Variation").innerText);break;case"Tapped":this._tappedNotes.set(r,!0);break;case"HarmonicType":let p=d.findChildElement("HType");if(p)switch(p.innerText){case"NoHarmonic":t.harmonicType=ne.None;break;case"Natural":t.harmonicType=ne.Natural;break;case"Artificial":t.harmonicType=ne.Artificial;break;case"Pinch":t.harmonicType=ne.Pinch;break;case"Tap":t.harmonicType=ne.Tap;break;case"Semi":t.harmonicType=ne.Semi;break;case"Feedback":t.harmonicType=ne.Feedback;break}break;case"HarmonicFret":let g=d.findChildElement("HFret");g&&(t.harmonicValue=parseFloat(g.innerText));break;case"Muted":d.findChildElement("Enable")&&(t.isDead=!0);break;case"PalmMuted":d.findChildElement("Enable")&&(t.isPalmMute=!0);break;case"Octave":t.octave=parseInt(d.findChildElement("Number").innerText),t.tone===-1&&(t.tone=0);break;case"Tone":t.tone=parseInt(d.findChildElement("Step").innerText);break;case"ConcertPitch":this.parseConcertPitch(d,t);break;case"Bended":n=!0;break;case"BendOriginValue":s||(s=new $(0,0)),s.value=this.toBendValue(parseFloat(d.findChildElement("Float").innerText));break;case"BendOriginOffset":s||(s=new $(0,0)),s.offset=this.toBendOffset(parseFloat(d.findChildElement("Float").innerText));break;case"BendMiddleValue":a=this.toBendValue(parseFloat(d.findChildElement("Float").innerText));break;case"BendMiddleOffset1":o=this.toBendOffset(parseFloat(d.findChildElement("Float").innerText));break;case"BendMiddleOffset2":l=this.toBendOffset(parseFloat(d.findChildElement("Float").innerText));break;case"BendDestinationValue":u||(u=new $($.MaxPosition,0)),u.value=this.toBendValue(parseFloat(d.findChildElement("Float").innerText));break;case"BendDestinationOffset":u||(u=new $(0,0)),u.offset=this.toBendOffset(parseFloat(d.findChildElement("Float").innerText));break;case"HopoOrigin":d.findChildElement("Enable")&&(t.isHammerPullOrigin=!0);break;case"HopoDestination":break;case"LeftHandTapped":t.isLeftHandTapped=!0;break;case"Slide":let y=parseInt(d.findChildElement("Flags").innerText);y&1?t.slideOutType=xe.Shift:y&2?t.slideOutType=xe.Legato:y&4?t.slideOutType=xe.OutDown:y&8&&(t.slideOutType=xe.OutUp),y&16?t.slideInType=ri.IntoFromBelow:y&32&&(t.slideInType=ri.IntoFromAbove),y&64?t.slideOutType=xe.PickSlideDown:y&128&&(t.slideOutType=xe.PickSlideUp);break}break}n&&(s||(s=new $(0,0)),u||(u=new $($.MaxPosition,0)),t.addBendPoint(s),o&&a&&t.addBendPoint(new $(o,a)),l&&a&&t.addBendPoint(new $(l,a)),!o&&!l&&a&&t.addBendPoint(new $($.MaxPosition/2|0,a)),t.addBendPoint(u)),c!==-1&&h!==-1&&(t.percussionArticulation=At.articulationFromElementVariation(c,h))}parseConcertPitch(e,t){const r=e.findChildElement("Pitch");if(r){for(let n of r.childNodes)if(n.nodeType===I.Element)switch(n.localName){case"Accidental":switch(n.innerText){case"x":t.accidentalMode=Ft.ForceDoubleSharp;break;case"#":t.accidentalMode=Ft.ForceSharp;break;case"b":t.accidentalMode=Ft.ForceFlat;break;case"bb":t.accidentalMode=Ft.ForceDoubleFlat;break}break}}}toBendValue(e){return e*Qr.BendPointValueFactor|0}toBendOffset(e){return e*Qr.BendPointPositionFactor}parseRhythms(e){for(let t of e.childNodes)if(t.nodeType===I.Element)switch(t.localName){case"Rhythm":this.parseRhythm(t);break}}parseRhythm(e){let t=new Xz,r=e.getAttribute("id");t.id=r;for(let n of e.childNodes)if(n.nodeType===I.Element)switch(n.localName){case"NoteValue":switch(n.innerText){case"Long":t.value=_.QuadrupleWhole;break;case"DoubleWhole":t.value=_.DoubleWhole;break;case"Whole":t.value=_.Whole;break;case"Half":t.value=_.Half;break;case"Quarter":t.value=_.Quarter;break;case"Eighth":t.value=_.Eighth;break;case"16th":t.value=_.Sixteenth;break;case"32nd":t.value=_.ThirtySecond;break;case"64th":t.value=_.SixtyFourth;break;case"128th":t.value=_.OneHundredTwentyEighth;break;case"256th":t.value=_.TwoHundredFiftySixth;break}break;case"PrimaryTuplet":t.tupletNumerator=parseInt(n.getAttribute("num")),t.tupletDenominator=parseInt(n.getAttribute("den"));break;case"AugmentationDot":t.dots=parseInt(n.getAttribute("count"));break}this._rhythmById.set(r,t)}buildModel(){for(let e=0,t=this._masterBars.length;e<t;e++){let r=this._masterBars[e];this.score.addMasterBar(r)}for(let e of this._tracksMapping){if(!e)continue;let t=this._tracksById.get(e);this.score.addTrack(t)}for(let e of this._barsOfMasterBar){let t=0;for(let r=0,n=0;r<e.length&&n<this.score.tracks.length;r++){let s=e[r];if(s!==Qr.InvalidId){let a=this._barsById.get(s),o=this.score.tracks[n],l=o.staves[t];if(l.addBar(a),this._voicesOfBar.has(s))for(let u of this._voicesOfBar.get(s))if(u!==Qr.InvalidId){let c=this._voiceById.get(u);if(a.addVoice(c),this._beatsOfVoice.has(u)){for(let h of this._beatsOfVoice.get(u))if(h!==Qr.InvalidId){let d=D1.clone(this._beatById.get(h));c.addBeat(d);let f=this._rhythmOfBeat.get(h),p=this._rhythmById.get(f);if(d.duration=p.value,d.dots=p.dots,d.tupletNumerator=p.tupletNumerator,d.tupletDenominator=p.tupletDenominator,this._notesOfBeat.has(h)){for(let g of this._notesOfBeat.get(h))if(g!==Qr.InvalidId){const y=cB.clone(this._noteById.get(g));l.isPercussion?(y.fret=-1,y.string=-1):y.percussionArticulation=-1,d.addNote(y),this._tappedNotes.has(g)&&(d.tap=!0)}}}}}else{let c=new Qn;a.addVoice(c);let h=new xi;h.isEmpty=!0,h.duration=_.Quarter,c.addBeat(h)}t===o.staves.length-1?(n++,t=0):t++}else n++}}for(let e of this._tracksMapping){if(!e)continue;let t=this._tracksById.get(e),r=!1;for(const n of t.staves)if(n.isPercussion){r=!0;break}if(r||(t.percussionArticulations=[]),this._automationsPerTrackIdAndBarIndex.has(e)){const n=this._automationsPerTrackIdAndBarIndex.get(e);for(const[s,a]of n)if(t.staves.length>0&&s<t.staves[0].bars.length){const o=t.staves[0].bars[s];if(o.voices.length>0&&o.voices[0].beats.length>0){const l=o.voices[0].beats[0];for(const u of a)l.automations.push(u)}}}}for(const[e,t]of this._masterTrackAutomations){let r=this.score.masterBars[e];for(let n=0,s=t.length;n<s;n++){let a=t[n];a.type===$t.Tempo&&(e===0&&(this.score.tempo=a.value|0,a.text&&(this.score.tempoLabel=a.text)),r.tempoAutomations.push(a))}}}}Qr.InvalidId="-1";Qr.BendPointPositionFactor=$.MaxPosition/100;Qr.BendPointValueFactor=1/25;class pg{constructor(){this.isMultiRest=!1,this.trackViewGroups=[]}}class hS{constructor(){this.showSlash=!1,this.showStandardNotation=!1,this.showTablature=!1}}class pB{apply(e){if(this.scoreViews.length>0){let t=0;for(let r of this.scoreViews[0].trackViewGroups){if(t<e.tracks.length){const n=e.tracks[t];for(const s of n.staves)s.showTablature=r.showTablature,s.showStandardNotation=r.showStandardNotation,s.showSlash=r.showSlash}t++}}}constructor(e){this.scoreViews=[];let t=ni.fromBuffer(e);const r=M.readInt32BE(t);for(let n=0;n<r;n++){const s=new pg;this.scoreViews.push(s),s.isMultiRest=ze.gpReadBool(t);const a=M.readInt32BE(t);for(let o=0;o<a;o++){let l=t.readByte();l===0&&(l=1);let u=new hS;u.showStandardNotation=(l&1)!==0,u.showTablature=(l&2)!==0,u.showSlash=(l&4)!==0,s.trackViewGroups.push(u)}}}static writeForScore(e){const t=ni.withCapacity(128),r=[new pg];for(const n of e.tracks){const s=new hS;s.showStandardNotation=n.staves[0].showStandardNotation,s.showTablature=n.staves[0].showTablature,s.showSlash=n.staves[0].showSlash,r[0].trackViewGroups.push(s);const a=new pg;a.trackViewGroups.push(s),r.push(a)}M.writeInt32BE(t,r.length);for(const n of r){t.writeByte(n.isMultiRest?1:0),M.writeInt32BE(t,n.trackViewGroups.length);for(const s of n.trackViewGroups){let a=0;s.showStandardNotation&&(a=a|1),s.showTablature&&(a=a|2),s.showSlash&&(a=a|4),t.writeByte(a)}}return M.writeInt32BE(t,1),t.toArray()}}class V1{}class Vh extends V1{constructor(e){super(),this.n=e}}class Ca extends V1{constructor(e,t){super(),this.left=e,this.right=t}}class c0 extends V1{constructor(e,t){super(),this.n=e,this.table=t}}class ci{static make(e,t,r,n){let s=[],a=[];if(n>32)throw new zt("Invalid huffman");for(let u=0;u<n;u++)s.push(0),a.push(0);for(let u=0;u<r;u++){let c=e[u+t];if(c>=n)throw new zt("Invalid huffman");s[c]++}let o=0;for(let u=1;u<n-1;u++)o=o+s[u]<<1,a[u]=o;let l=new Map;for(let u=0;u<r;u++){let c=e[u+t];if(c!==0){let h=a[c-1];a[c-1]=h+1,l.set(h<<5|c,u)}}return ci.treeCompress(new Ca(ci.treeMake(l,n,0,1),ci.treeMake(l,n,1,1)))}static treeMake(e,t,r,n){if(n>t)throw new zt("Invalid huffman");let s=r<<5|n;return e.has(s)?new Vh(e.get(s)):(r=r<<1,n+=1,new Ca(ci.treeMake(e,t,r,n),ci.treeMake(e,t,r|1,n)))}static treeCompress(e){let t=ci.treeDepth(e);if(t===0)return e;if(t===1){if(e instanceof Ca)return new Ca(ci.treeCompress(e.left),ci.treeCompress(e.right));throw new zt("assert")}let r=1<<t,n=[];for(let s=0;s<r;s++)n.push(new Vh(-1));return ci.treeWalk(n,0,0,t,e),new c0(t,n)}static treeWalk(e,t,r,n,s){s instanceof Ca&&n>0?(ci.treeWalk(e,t,r+1,n-1,s.left),ci.treeWalk(e,t|1<<r,r+1,n-1,s.right)):e[t]=ci.treeCompress(s)}static treeDepth(e){if(e instanceof Vh)return 0;if(e instanceof c0)throw new zt("assert");if(e instanceof Ca){let t=ci.treeDepth(e.left),r=ci.treeDepth(e.right);return 1+(t<r?t:r)}return 0}}var Lt;(function(i){i[i.Head=0]="Head",i[i.Block=1]="Block",i[i.CData=2]="CData",i[i.Flat=3]="Flat",i[i.Crc=4]="Crc",i[i.Dist=5]="Dist",i[i.DistOne=6]="DistOne",i[i.Done=7]="Done"})(Lt||(Lt={}));class yn{constructor(){this.buffer=new Uint8Array(yn.BufferSize),this.pos=0}slide(){let e=new Uint8Array(yn.BufferSize);this.pos-=yn.Size,e.set(this.buffer.subarray(yn.Size,yn.Size+this.pos),0),this.buffer=e}addBytes(e,t,r){this.pos+r>yn.BufferSize&&this.slide(),this.buffer.set(e.subarray(t,t+r),this.pos),this.pos+=r}addByte(e){this.pos===yn.BufferSize&&this.slide(),this.buffer[this.pos]=e,this.pos++}getLastChar(){return this.buffer[this.pos-1]}available(){return this.pos}}yn.Size=32768;yn.BufferSize=65536;class Ii{static buildFixedHuffman(){let e=[];for(let t=0;t<288;t++)e.push(t<=143?8:t<=255?9:t<=279?7:8);return ci.make(e,0,288,10)}constructor(e){this._nbits=0,this._bits=0,this._state=Lt.Block,this._isFinal=!1,this._huffman=Ii._fixedHuffman,this._huffdist=null,this._len=0,this._dist=0,this._needed=0,this._output=null,this._outpos=0,this._lengths=[],this._window=new yn,this._input=e;for(let t=0;t<19;t++)this._lengths.push(-1)}readBytes(e,t,r){if(this._needed=r,this._outpos=t,this._output=e,r>0)for(;this.inflateLoop(););return r-this._needed}inflateLoop(){switch(this._state){case Lt.Head:let e=this._input.readByte();if((e&15)!==8)throw new zt("Invalid data");let r=this._input.readByte(),n=(r&32)!==0;if(((e<<8)+r)%31!==0)throw new zt("Invalid data");if(n)throw new zt("Unsupported dictionary");return this._state=Lt.Block,!0;case Lt.Crc:return this._state=Lt.Done,!0;case Lt.Done:return!1;case Lt.Block:switch(this._isFinal=this.getBit(),this.getBits(2)){case 0:if(this._len=M.readUInt16LE(this._input),M.readUInt16LE(this._input)!==65535-this._len)throw new zt("Invalid data");this._state=Lt.Flat;let o=this.inflateLoop();return this.resetBits(),o;case 1:return this._huffman=Ii._fixedHuffman,this._huffdist=null,this._state=Lt.CData,!0;case 2:let l=this.getBits(5)+257,u=this.getBits(5)+1,c=this.getBits(4)+4;for(let d=0;d<c;d++)this._lengths[Ii.CodeLengthsPos[d]]=this.getBits(3);for(let d=c;d<19;d++)this._lengths[Ii.CodeLengthsPos[d]]=0;this._huffman=ci.make(this._lengths,0,19,8);let h=[];for(let d=0;d<l+u;d++)h.push(0);return this.inflateLengths(h,l+u),this._huffdist=ci.make(h,l,u,16),this._huffman=ci.make(h,0,l,16),this._state=Lt.CData,!0;default:throw new zt("Invalid data")}case Lt.Flat:{let a=this._len<this._needed?this._len:this._needed,o=M.readByteArray(this._input,a);return this._len-=a,this.addBytes(o,0,a),this._len===0&&(this._state=this._isFinal?Lt.Crc:Lt.Block),this._needed>0}case Lt.DistOne:{let a=this._len<this._needed?this._len:this._needed;return this.addDistOne(a),this._len-=a,this._len===0&&(this._state=Lt.CData),this._needed>0}case Lt.Dist:for(;this._len>0&&this._needed>0;){let a=this._len<this._dist?this._len:this._dist,o=this._needed<a?this._needed:a;this.addDist(this._dist,o),this._len-=o}return this._len===0&&(this._state=Lt.CData),this._needed>0;case Lt.CData:let s=this.applyHuffman(this._huffman);if(s<256)return this.addByte(s),this._needed>0;if(s===256)return this._state=this._isFinal?Lt.Crc:Lt.Block,!0;{s=s-257&255;let a=Ii.LenExtraBitsTbl[s];if(a===-1)throw new zt("Invalid data");this._len=Ii.LenBaseValTbl[s]+this.getBits(a);let o=this._huffdist,l=o?this.applyHuffman(o):this.getRevBits(5);if(a=Ii.DistExtraBitsTbl[l],a===-1)throw new zt("Invalid data");if(this._dist=Ii.DistBaseValTbl[l]+this.getBits(a),this._dist>this._window.available())throw new zt("Invalid data");return this._state=this._dist===1?Lt.DistOne:Lt.Dist,!0}}return!1}addDistOne(e){let t=this._window.getLastChar();for(let r=0;r<e;r++)this.addByte(t)}addByte(e){this._window.addByte(e),this._output[this._outpos]=e,this._needed--,this._outpos++}addDist(e,t){this.addBytes(this._window.buffer,this._window.pos-e,t)}getBit(){this._nbits===0&&(this._nbits=8,this._bits=this._input.readByte());let e=(this._bits&1)===1;return this._nbits--,this._bits=this._bits>>1,e}getBits(e){for(;this._nbits<e;)this._bits=this._bits|this._input.readByte()<<this._nbits,this._nbits+=8;let t=this._bits&(1<<e)-1;return this._nbits-=e,this._bits=this._bits>>e,t}getRevBits(e){return e===0?0:this.getBit()?1<<e-1|this.getRevBits(e-1):this.getRevBits(e-1)}resetBits(){this._bits=0,this._nbits=0}addBytes(e,t,r){this._window.addBytes(e,t,r),this._output.set(e.subarray(t,t+r),this._outpos),this._needed-=r,this._outpos+=r}inflateLengths(e,t){let r=0,n=0;for(;r<t;){let s=this.applyHuffman(this._huffman);switch(s){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:n=s,e[r]=s,r++;break;case 16:let a=r+3+this.getBits(2);if(a>t)throw new zt("Invalid data");for(;r<a;)e[r]=n,r++;break;case 17:if(r+=3+this.getBits(3),r>t)throw new zt("Invalid data");break;case 18:if(r+=11+this.getBits(7),r>t)throw new zt("Invalid data");break;default:throw new zt("Invalid data")}}}applyHuffman(e){if(e instanceof Vh)return e.n;if(e instanceof Ca)return this.applyHuffman(this.getBit()?e.right:e.left);if(e instanceof c0)return this.applyHuffman(e.table[this.getBits(e.n)]);throw new zt("Invalid data")}}Ii.LenExtraBitsTbl=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,-1,-1];Ii.LenBaseValTbl=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258];Ii.DistExtraBitsTbl=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,-1,-1];Ii.DistBaseValTbl=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];Ii.CodeLengthsPos=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];Ii._fixedHuffman=Ii.buildFixedHuffman();class hs{constructor(e,t){this.fullName=e;let r=e.lastIndexOf("/");this.fileName=r===-1||r===e.length-1?this.fullName:e.substr(r+1),this.data=t}}hs.OptionalDataDescriptorSignature=134695760;hs.CompressionMethodDeflate=8;hs.LocalFileHeaderSignature=67324752;hs.CentralFileHeaderSignature=33639248;hs.EndOfCentralDirSignature=101010256;class H1{constructor(e){this._readable=e}read(){let e=[];for(;;){let t=this.readEntry();if(!t)break;e.push(t)}return e}readEntry(){let e=this._readable;if(M.readInt32LE(e)!==hs.LocalFileHeaderSignature)return null;M.readUInt16LE(e);let r=M.readUInt16LE(e),n=M.readUInt16LE(e),s=n!==0;if(s&&n!==hs.CompressionMethodDeflate)return null;M.readInt16LE(this._readable),M.readInt16LE(this._readable),M.readInt32LE(e),M.readInt32LE(e);let a=M.readInt32LE(e),o=M.readInt16LE(e),l=M.readInt16LE(e),u=M.toString(M.readByteArray(e,o),"utf-8");e.skip(l);let c;if(s){let h=ni.empty(),d=new Ii(this._readable),f=new Uint8Array(65536);for(;;){let p=d.readBytes(f,0,f.length);if(h.write(f,0,p),p<f.length)break}c=h.toArray()}else c=M.readByteArray(this._readable,a);return r&8&&(M.readInt32LE(this._readable)===hs.OptionalDataDescriptorSignature&&M.readInt32LE(this._readable),M.readInt32LE(this._readable),M.readInt32LE(this._readable)),new hs(u,c)}}class qz{constructor(){this.trackViewGroups=[]}}class Jz{constructor(){this.isVisible=!1}}var h0;(function(i){i[i.PageVertical=0]="PageVertical",i[i.PageGrid=1]="PageGrid",i[i.PageParchment=2]="PageParchment",i[i.ScreenVertical=3]="ScreenVertical",i[i.ScreenHorizontal=4]="ScreenHorizontal",i[i.PageHorizontal=5]="PageHorizontal"})(h0||(h0={}));class gB{constructor(e,t){this.zoomLevel=4,this.view=h0.PageVertical,this.muiltiVoiceCursor=!1,this.scoreViews=[];const r=ni.fromBuffer(t);this.zoomLevel=M.readInt32BE(r),this.view=r.readByte(),this.muiltiVoiceCursor=r.readByte()!=0;const n=e.scoreViews.length;for(let s=0;s<n;s++){const a=new qz;this.scoreViews.push(a);const o=e.scoreViews[s];for(let l=0;l<o.trackViewGroups.length;l++){const u=new Jz;u.isVisible=r.readByte()!=0,a.trackViewGroups.push(u)}}}apply(e){if(this.scoreViews.length>0){let t=0;for(let r of this.scoreViews[0].trackViewGroups){if(t<e.tracks.length){const n=e.tracks[t];n.isVisibleOnMultiTrack=r.isVisible}t++}}}static writeForScore(e){const t=ni.withCapacity(128);M.writeInt32BE(t,4),t.writeByte(0);const r=e.tracks.length>0&&e.tracks[0].staves[0].bars[0].isMultiVoice;t.writeByte(r?255:0);for(const n of e.tracks)t.writeByte(n.isVisibleOnMultiTrack?255:0);for(const n of e.tracks)t.writeByte(255);return t.toArray()}}class Qz extends bl{get name(){return"Guitar Pro 7-8"}constructor(){super()}readScore(){V.debug(this.name,"Loading ZIP entries");let e=new H1(this.data),t;try{t=e.read()}catch(c){throw new gt("No Zip archive",c)}V.debug(this.name,"Zip entries loaded");let r=null,n=null,s=null,a=null;for(let c of t)switch(c.fileName){case"score.gpif":r=M.toString(c.data,this.settings.importer.encoding);break;case"BinaryStylesheet":n=c.data;break;case"PartConfiguration":s=c.data;break;case"LayoutConfiguration":a=c.data;break}if(!r)throw new gt("No score.gpif found in zip archive");V.debug(this.name,"Start Parsing score.gpif");let o=new Qr;o.parseXml(r,this.settings),V.debug(this.name,"score.gpif parsed");let l=o.score;n&&(V.debug(this.name,"Start Parsing BinaryStylesheet"),new dp(n).apply(l),V.debug(this.name,"BinaryStylesheet parsed"));let u=null;return s&&(V.debug(this.name,"Start Parsing Part Configuration"),u=new pB(s),u.apply(l),V.debug(this.name,"Part Configuration parsed")),a&&u!=null&&(V.debug(this.name,"Start Parsing Layout Configuration"),new gB(u,a).apply(l),V.debug(this.name,"Layout Configuration parsed")),l}}class Hu extends oi{constructor(){super(ai.Format,"Unexpected end of data within reader"),Object.setPrototypeOf(this,Hu.prototype)}}class zu{constructor(e){this._currentByte=0,this._position=zu.ByteSize,this._source=e}readByte(){return this.readBits(8)}readBytes(e){const t=new Uint8Array(e);for(let r=0;r<e;r++)t[r]=this.readByte()&255;return t}readBits(e){let t=0,r=e-1;for(;r>=0;)t=t|this.readBit()<<r,r--;return t}readBitsReversed(e){let t=0;for(let r=0;r<e;r++)t=t|this.readBit()<<r;return t}readBit(){if(this._position>=8){if(this._currentByte=this._source.readByte(),this._currentByte===-1)throw new Hu;this._position=0}const e=this._currentByte>>zu.ByteSize-this._position-1&1;return this._position++,e}readAll(){let e=ni.empty();try{for(;;)e.writeByte(this.readByte()&255)}catch(t){if(!(t instanceof Hu))throw t}return e.toArray()}}zu.ByteSize=8;class Zz{constructor(){this.fileName="",this.fileSize=0,this.data=null}}class z1{constructor(){this.files=[],this.files=[],this.fileFilter=e=>!0}load(e){let t=new zu(e);this.readBlock(t)}readHeader(e){return this.getString(e.readBytes(4),0,4)}decompress(e,t=!1){let r=ni.empty(),n,s=this.getInteger(e.readBytes(4),0);try{for(;r.length<s;)if(e.readBits(1)===1){let h=e.readBits(4),d=e.readBitsReversed(h),f=e.readBitsReversed(h),p=r.length-d,g=Math.min(d,f);n=r.getBuffer(),r.write(n,p,g)}else{let h=e.readBitsReversed(2);for(let d=0;d<h;d++)r.writeByte(e.readByte())}}catch(c){if(!(c instanceof Hu))throw c}n=r.getBuffer();let a=t?4:0,o=r.length-a,l=new Uint8Array(o),u=o;return l.set(n.subarray(a,a+u),0),l}readBlock(e){let t=this.readHeader(e);if(t==="BCFZ")this.readUncompressedBlock(this.decompress(e,!0));else if(t==="BCFS")this.readUncompressedBlock(e.readAll());else throw new gt("Unsupported format")}readUncompressedBlock(e){let t=4096,r=t;for(;r+3<e.length;){if(this.getInteger(e,r)===2){let s=new Zz;s.fileName=this.getString(e,r+4,127),s.fileSize=this.getInteger(e,r+140);let a=!this.fileFilter||this.fileFilter(s.fileName);a&&this.files.push(s);let o=r+148,l=0,u=0,c=a?ni.withCapacity(s.fileSize):null;for(;l=this.getInteger(e,o+4*u++),l!==0;)r=l*t,a&&c.write(e,r,t);if(a){s.data=new Uint8Array(Math.min(s.fileSize,c.length));let h=c.toArray();s.data.set(h.subarray(0,0+s.data.length),0)}}r+=t}}getString(e,t,r){let n="";for(let s=0;s<r;s++){let a=e[t+s]&255;if(a===0)break;n+=String.fromCharCode(a)}return n}getInteger(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}}z1.HeaderBcFs="BCFS";z1.HeaderBcFz="BCFZ";class eU extends bl{get name(){return"Guitar Pro 6"}constructor(){super()}readScore(){V.debug(this.name,"Loading GPX filesystem");let e=new z1;e.fileFilter=u=>u.endsWith("score.gpif")||u.endsWith("BinaryStylesheet")||u.endsWith("PartConfiguration")||u.endsWith("LayoutConfiguration"),e.load(this.data),V.debug(this.name,"GPX filesystem loaded");let t=null,r=null,n=null,s=null;for(let u of e.files)switch(u.fileName){case"score.gpif":t=M.toString(u.data,this.settings.importer.encoding);break;case"BinaryStylesheet":r=u.data;break;case"PartConfiguration":n=u.data;break;case"LayoutConfiguration":s=u.data;break}if(!t)throw new gt("No score.gpif found in GPX");V.debug(this.name,"Start Parsing score.gpif");let a=new Qr;a.parseXml(t,this.settings),V.debug(this.name,"score.gpif parsed");let o=a.score;r&&(V.debug(this.name,"Start Parsing BinaryStylesheet"),new dp(r).apply(o),V.debug(this.name,"BinaryStylesheet parsed"));let l=null;return n&&(V.debug(this.name,"Start Parsing Part Configuration"),l=new pB(n),l.apply(o),V.debug(this.name,"Part Configuration parsed")),s&&l!=null&&(V.debug(this.name,"Start Parsing Layout Configuration"),new gB(l,s).apply(o),V.debug(this.name,"Layout Configuration parsed")),o}}class tU extends bl{get name(){return"MusicXML"}constructor(){super(),this._currentPartGroup=null,this._trackFirstMeasureNumber=0,this._maxVoices=0,this._currentDirection=null,this._currentChord=null,this._divisionsPerQuarterNote=0,this._voiceOfStaff=new Map,this._isBeamContinue=!1,this._previousBeatWasPulled=!1,this._previousBeat=null}readScore(){this._trackById=new Map,this._partGroups=new Map,this._tieStarts=[],this._tieStartIds=new Map,this._slurStarts=new Map;let e=this.extractMusicXml(),t=new Fd;try{t.parse(e)}catch{throw new gt("Unsupported format")}return this._score=new no,this._score.tempo=120,this.parseDom(t),this.settings.importer.mergePartGroupsInMusicXml&&this.mergePartGroups(),this._score.finish(this.settings),this._score.rebuildRepeatGroups(),this._score}extractMusicXml(){const e=new H1(this.data);let t;try{t=e.read()}catch{t=[]}if(t.length===0)return this.data.reset(),M.toString(this.data.readAll(),this.settings.importer.encoding);const r=t.find(u=>u.fullName==="META-INF/container.xml");if(!r)throw new gt("No compressed MusicXML");const n=new Fd;try{n.parse(M.toString(r.data,this.settings.importer.encoding))}catch(u){throw new gt("Malformed container.xml, could not parse as XML",u)}let s=n.firstElement;if(!s||s.localName!=="container")throw new gt("Malformed container.xml, root element not 'container'");const a=s.findChildElement("rootfiles");if(!a)throw new gt("Malformed container.xml, 'container/rootfiles' not found");let o="";for(const u of a.childNodes)if(u.nodeType==I.Element&&u.localName==="rootfile"){o=u.getAttribute("full-path");break}if(!o)throw new gt("Unsupported compressed MusicXML, missing rootfile");const l=t.find(u=>u.fullName===o);if(!l)throw new gt(`Malformed container.xml, '${o}' not contained in zip`);return M.toString(l.data,this.settings.importer.encoding)}mergePartGroups(){let e=!1;for(const t of this._partGroups.values())t.length>1&&(this.mergeGroup(t),e=!0);if(e)for(let t=0;t<this._score.tracks.length;t++)this._score.tracks[t].index=t}mergeGroup(e){let t=e[0];for(let r=1;r<e.length;r++){let n=e[r];for(let a of n.staves)t.addStaff(a);let s=this._score.tracks.indexOf(n);this._score.tracks.splice(s,1)}}parseDom(e){let t=e.firstElement;if(!t)throw new gt("Unsupported format");switch(t.localName){case"score-partwise":this.parsePartwise(t);break;case"score-timewise":break;default:throw new gt("Unsupported format")}}parsePartwise(e){for(let t of e.childNodes)if(t.nodeType===I.Element)switch(t.localName){case"work":this.parseWork(t);break;case"movement-title":this._score.title=t.innerText;break;case"identification":this.parseIdentification(t);break;case"part-list":this.parsePartList(t);break;case"part":this.parsePart(t);break}}parseWork(e){for(let t of e.childNodes)if(t.nodeType===I.Element)switch(t.localName){case"work-title":this._score.title=t.innerText;break}}parsePart(e){let t=e.getAttribute("id");if(!this._trackById.has(t))if(this._trackById.size===1){for(const[s,a]of this._trackById)(a.staves.length===0||a.staves[0].bars.length===0)&&(t=s);if(!this._trackById.has(t))return}else return;let r=this._trackById.get(t),n=!0;this._maxVoices=0;for(let s of e.childNodes)if(s.nodeType===I.Element)switch(s.localName){case"measure":this.parseMeasure(s,r,n)&&(n=!1);break}for(let s of r.staves)for(let a of s.bars)this.ensureVoices(a)}parseMeasure(e,t,r){if(e.getAttribute("implicit")==="yes"&&e.getElementsByTagName("note",!1).length===0)return!1;let n=0;if(r)this._divisionsPerQuarterNote=0,this._trackFirstMeasureNumber=parseInt(e.getAttribute("number")),this._trackFirstMeasureNumber||(this._trackFirstMeasureNumber=0),n=0;else{if(n=parseInt(e.getAttribute("number")),!n)return!1;n-=this._trackFirstMeasureNumber}if(r){let l=e.getElementsByTagName("attributes",!1);if(l.length>0){let u=l[0].getElementsByTagName("staves",!1);if(u.length>0){let c=parseInt(u[0].innerText);t.ensureStaveCount(c)}}}let s=new Array(t.staves.length),a=null;for(let l=t.staves[0].bars.length;l<=n;l++)for(let u=0;u<t.staves.length;u++){let c=new Ps;if(s[u]=c,t.staves[u].bars.length>0){let h=t.staves[u].bars[t.staves[u].bars.length-1];c.clef=h.clef}a=this.getOrCreateMasterBar(n),t.staves[u].addBar(c),this.ensureVoices(c)}let o=new Map;if(a){let l=!1;for(let u of e.childNodes)if(u.nodeType===I.Element)switch(u.localName){case"note":this.parseNoteBeat(u,s);break;case"forward":this.parseForward(u,s);break;case"direction":this.parseDirection(u,a);break;case"attributes":l||(this.parseAttributes(u,s,a,t),l=!0);break;case"harmony":this.parseHarmony(u,t,o);break;case"sound":break;case"barline":this.parseBarline(u,a);break}}return!0}ensureVoices(e){for(;e.voices.length<this._maxVoices;){let t=new Qn;e.addVoice(t);let r=new xi;r.isEmpty=!0,r.chordId=this._currentChord,t.addBeat(r)}}getOrCreateBeat(e,t,r){let n=0,s=e.getElementsByTagName("voice",!1);s.length>0&&(n=parseInt(s[0].innerText)-1);let a=this._previousBeatWasPulled;this._previousBeatWasPulled=!1;let o=e.getElementsByTagName("staff",!1),l=1;if(o.length>0){l=parseInt(o[0].innerText),(this._isBeamContinue||a)&&this._previousBeat.voice.bar.staff.index!==l-1&&(l=this._previousBeat.voice.bar.staff.index+1,this._previousBeatWasPulled=!0);let d=t[0].staff.track.index+"-"+l;this._voiceOfStaff.has(d)||this._voiceOfStaff.set(d,n)}l--;let u;l<0?u=t[0]:l>=t.length?u=t[t.length-1]:u=t[l];let c,h=this.getOrCreateVoice(u,n);return r&&h.beats.length>0||h.beats.length===1&&h.isEmpty?c=h.beats[h.beats.length-1]:(c=new xi,c.isEmpty=!1,h.addBeat(c)),this._isBeamContinue=!1,this._previousBeat=c,c}parseForward(e,t){let r=this.getOrCreateBeat(e,t,!1),s=parseInt(e.findChildElement("duration").innerText)*_.Quarter/this._divisionsPerQuarterNote,a=[_.SixtyFourth,_.ThirtySecond,_.Sixteenth,_.Eighth,_.Quarter,_.Half,_.Whole];for(let o of a)if(s>=o){r.duration=o,s-=o;break}r.isEmpty=!1}parseStaffDetails(e,t){for(let r of e.childNodes)if(r.nodeType===I.Element)switch(r.localName){case"staff-lines":for(let n of t.staves)n.stringTuning.tunings=new Array(parseInt(r.innerText)).fill(0);break;case"staff-tuning":this.parseStaffTuning(r,t);break}for(let r of t.staves)this.isEmptyTuning(r.tuning)&&(r.stringTuning.tunings=[])}parseStaffTuning(e,t){let r=parseInt(e.getAttribute("line")),n="C",s="",a=0;for(let l of e.childNodes)if(l.nodeType===I.Element)switch(l.localName){case"tuning-step":n=l.innerText;break;case"tuning-alter":a=parseInt(l.innerText);break;case"tuning-octave":s=l.innerText;break}let o=ct.getTuningForText(n+s)+a;for(let l of t.staves)l.tuning[l.tuning.length-r]=o}parseHarmony(e,t,r){let n=new ha;for(let a of e.childNodes)if(a.nodeType===I.Element)switch(a.localName){case"root":n.name=this.parseHarmonyRoot(a);break;case"kind":n.name=n.name+this.parseHarmonyKind(a);break;case"frame":this.parseHarmonyFrame(a,n);break}this._currentChord=ct.newGuid();const s=n.uniqueId;r.has(s)&&(n.showDiagram=!1);for(let a of t.staves)a.addChord(this._currentChord,n);r.set(s,n)}parseHarmonyRoot(e){let t="",r="";for(let n of e.childNodes)if(n.nodeType===I.Element)switch(n.localName){case"root-step":t=n.innerText;break;case"root-alter":switch(parseInt(e.innerText)){case-2:r="bb";break;case-1:r="b";break;case 0:r="";break;case 1:r="#";break;case 2:r="##";break}break}return t+r}parseHarmonyKind(e){const t=e.getAttribute("text");let r="";if(t)r=t;else switch(e.innerText){case"major":r="";break;case"minor":r="m";break;case"augmented":r="+";break;case"diminished":r="○";break;case"dominant":r="7";break;case"major-seventh":r="7M";break;case"minor-seventh":r="m7";break;case"diminished-seventh":r="○7";break;case"augmented-seventh":r="+7";break;case"half-diminished":r="⍉";break;case"major-minor":r="mMaj";break;case"major-sixth":r="maj6";break;case"minor-sixth":r="m6";break;case"dominant-ninth":r="9";break;case"major-ninth":r="maj9";break;case"minor-ninth":r="m9";break;case"dominant-11th":r="11";break;case"major-11th":r="maj11";break;case"minor-11th":r="m11";break;case"dominant-13th":r="13";break;case"major-13th":r="maj13";break;case"minor-13th":r="m13";break;case"suspended-second":r="sus2";break;case"suspended-fourth":r="sus4";break}return r}parseHarmonyFrame(e,t){for(let r of e.childNodes)if(r.nodeType===I.Element)switch(r.localName){case"frame-strings":const n=parseInt(r.innerText);t.strings=new Array(n);for(let o=0;o<n;o++)t.strings[o]=-1;break;case"first-fret":t.firstFret=parseInt(r.innerText);break;case"frame-note":let s=null,a=null;for(let o of r.childNodes)switch(o.localName){case"string":s=parseInt(o.innerText);break;case"fret":a=parseInt(o.innerText),s&&a>=0&&(t.strings[s-1]=a);break;case"barre":s&&a&&o.getAttribute("type")==="start"&&t.barreFrets.push(a);break}break}}parseBarline(e,t){for(let r of e.childNodes)if(r.nodeType===I.Element)switch(r.localName){case"repeat":this.parseRepeat(r,t);break;case"ending":this.parseEnding(r,t);break}}parseEnding(e,t){let r=parseInt(e.getAttribute("number"));r>0&&(--r,t.alternateEndings=t.alternateEndings|1<<r&255)}parseRepeat(e,t){let r=e.getAttribute("direction"),n=parseInt(e.getAttribute("times"));(n<0||isNaN(n))&&(n=2),r==="backward"?t.repeatCount=n:r==="forward"&&(t.isRepeatStart=!0)}parseNoteBeat(e,t){let r=e.getElementsByTagName("chord",!1).length>0,n=this.getOrCreateBeat(e,t,r);!n.chordId&&this._currentChord&&(n.chordId=this._currentChord,this._currentChord=null),this._currentDirection&&(n.text=this._currentDirection,this._currentDirection=null);let s=new Nt;n.voice.isEmpty=!1,n.isEmpty=!1,n.addNote(s),n.dots=0;let a=!1;for(let o of e.childNodes)if(o.nodeType===I.Element)switch(o.localName){case"grace":n.graceType=ce.BeforeBeat,n.duration=_.ThirtySecond;break;case"duration":if(n.isRest&&!a)switch(parseInt(o.innerText)){case 1:n.duration=_.Whole;break;case 2:n.duration=_.Half;break;case 4:n.duration=_.Quarter;break;case 8:n.duration=_.Eighth;break;case 16:n.duration=_.Sixteenth;break;case 32:n.duration=_.ThirtySecond;break;case 64:n.duration=_.SixtyFourth;break;default:n.duration=_.Quarter;break}break;case"tie":this.parseTied(o,s);break;case"cue":break;case"instrument":break;case"type":n.duration=this.getDuration(o.innerText),n.graceType!==ce.None&&n.duration<_.Sixteenth&&(n.duration=_.Eighth);break;case"dot":n.dots++;break;case"accidental":this.parseAccidental(o,s);break;case"time-modification":this.parseTimeModification(o,n);break;case"stem":break;case"notehead":o.getAttribute("parentheses")==="yes"&&(s.isGhost=!0);break;case"beam":o.innerText==="continue"&&(this._isBeamContinue=!0);break;case"notations":this.parseNotations(o,n,s);break;case"lyric":this.parseLyric(o,n);break;case"pitch":this.parsePitch(o,s);break;case"unpitched":this.parseUnpitched(o,s);break;case"rest":a=o.getAttribute("measure")==="yes",n.isEmpty=!1,n.notes=[],n.duration=_.Whole;break}if(s.isStringed){for(let o=0;o<n.notes.length;o++)if(n.notes[o].string===s.string&&n.notes[o]!==s){n.removeNote(s);break}}}getDuration(e){switch(e){case"256th":case"128th":case"64th":return _.SixtyFourth;case"32nd":return _.ThirtySecond;case"16th":return _.Sixteenth;case"eighth":return _.Eighth;case"quarter":return _.Quarter;case"half":return _.Half;case"long":case"breve":case"whole":return _.Whole}return _.Quarter}parseLyric(e,t){for(let r of e.childNodes)if(r.nodeType===I.Element)switch(r.localName){case"text":t.text?t.text+=" "+r.innerText:t.text=r.innerText;break}}parseAccidental(e,t){switch(e.innerText){case"sharp":t.accidentalMode=Ft.ForceSharp;break;case"natural":t.accidentalMode=Ft.ForceNatural;break;case"flat":t.accidentalMode=Ft.ForceFlat;break}}parseTied(e,t){if(e.getAttribute("type")==="start")this._tieStartIds.has(t.id)||(this._tieStartIds.set(t.id,!0),this._tieStarts.push(t));else if(e.getAttribute("type")==="stop"&&this._tieStarts.length>0&&!t.isTieDestination){const r=this._tieStarts[0];r.beat.voice.index===t.beat.voice.index&&r.beat.voice.bar.staff.index===t.beat.voice.bar.staff.index&&r.beat.voice.bar.staff.track.index===t.beat.voice.bar.staff.track.index&&(t.isTieDestination=!0,t.tieOrigin=this._tieStarts[0]),this._tieStarts.splice(0,1),this._tieStartIds.delete(t.id)}}parseNotations(e,t,r){for(let n of e.childNodes)if(n.nodeType===I.Element)switch(n.localName){case"articulations":this.parseArticulations(n,r);break;case"tied":this.parseTied(n,r);break;case"slide":case"glissando":n.getAttribute("type")==="start"&&(r.slideOutType=xe.Shift);break;case"dynamics":this.parseDynamics(n,t);break;case"technical":this.parseTechnical(n,r);break;case"ornaments":this.parseOrnaments(n,r);break;case"slur":let s=n.getAttribute("number");switch(s||(s="1"),s=t.voice.bar.staff.index+"_"+s,n.getAttribute("type")){case"start":this._slurStarts.set(s,r);break;case"stop":if(this._slurStarts.has(s)){r.isSlurDestination=!0;let a=this._slurStarts.get(s);a.slurDestination=r,r.slurOrigin=a}break}break}}parseOrnaments(e,t){for(let r of e.childNodes)if(r.nodeType===I.Element)switch(r.localName){case"tremolo":switch(parseInt(r.innerText)){case 1:t.beat.tremoloSpeed=_.Eighth;break;case 2:t.beat.tremoloSpeed=_.Sixteenth;break;case 3:t.beat.tremoloSpeed=_.ThirtySecond;break}break}}parseTechnical(e,t){let r=[];for(let n of e.childNodes)if(n.nodeType===I.Element)switch(n.localName){case"string":t.string=parseInt(n.innerText),t.string!==-2147483648&&(t.string=t.beat.voice.bar.staff.tuning.length-t.string+1);break;case"fret":t.fret=parseInt(n.innerText);break;case"down-bow":t.beat.pickStroke=gi.Down;break;case"up-bow":t.beat.pickStroke=gi.Up;break;case"bend":r.push(n);break}r.length>0&&this.parseBends(r,t),(t.string===-2147483648||t.fret===-2147483648)&&(t.string=-1,t.fret=-1)}parseBends(e,t){let r=$.MaxPosition/e.length,n=0,s=0,a=!0;for(let o of e){let l=o.findChildElement("bend-alter");if(l){let u=Math.round(Math.abs(parseFloat(l.innerText))*2);o.findChildElement("pre-bend")?a?(n+=u,t.addBendPoint(new $(s,n)),s+=r,t.addBendPoint(new $(s,n)),a=!1):s+=r:o.findChildElement("release")?(a&&(n+=u),t.addBendPoint(new $(s,n)),s+=r,n-=u,t.addBendPoint(new $(s,n)),a=!1):(t.addBendPoint(new $(s,n)),n+=u,s+=r,t.addBendPoint(new $(s,n)),a=!1)}}}parseArticulations(e,t){for(let r of e.childNodes)switch(r.localName){case"accent":t.accentuated=jt.Normal;break;case"strong-accent":t.accentuated=jt.Heavy;break;case"staccato":case"detached-legato":t.isStaccato=!0;break}}parseDynamics(e,t){for(let r of e.childNodes)if(r.nodeType===I.Element)switch(r.localName){case"p":t.dynamics=_e.P;break;case"pp":t.dynamics=_e.PP;break;case"ppp":t.dynamics=_e.PPP;break;case"f":t.dynamics=_e.F;break;case"ff":t.dynamics=_e.FF;break;case"fff":t.dynamics=_e.FFF;break;case"mp":t.dynamics=_e.MP;break;case"mf":t.dynamics=_e.MF;break}}parseTimeModification(e,t){for(let r of e.childNodes)if(r.nodeType===I.Element)switch(r.localName){case"actual-notes":t.tupletNumerator=parseInt(r.innerText);break;case"normal-notes":t.tupletDenominator=parseInt(r.innerText);break}}parseUnpitched(e,t){let r="",n=0,s=0;for(let o of e.childNodes)if(o.nodeType===I.Element)switch(o.localName){case"display-step":r=o.innerText;break;case"display-alter":n=parseInt(o.innerText);break;case"display-octave":s=parseInt(o.innerText);break}let a=s*12+ct.getToneForText(r)+n;t.octave=a/12|0,t.tone=a-t.octave*12}parsePitch(e,t){let r="",n=0,s=0;for(let o of e.childNodes)if(o.nodeType===I.Element)switch(o.localName){case"step":r=o.innerText;break;case"alter":n=parseFloat(o.innerText),isNaN(n)&&(n=0);break;case"octave":s=parseInt(o.innerText)+1;break}let a=s*12+ct.getToneForText(r)+(n|0);t.octave=a/12|0,t.tone=a-t.octave*12}getOrCreateVoice(e,t){if(t<e.voices.length)return e.voices[t];for(let r=e.voices.length;r<=t;r++)e.addVoice(new Qn);return this._maxVoices=Math.max(this._maxVoices,e.voices.length),e.voices[t]}parseDirection(e,t){for(let r of e.childNodes)if(r.nodeType===I.Element)switch(r.localName){case"sound":let n=r.getAttribute("tempo");if(n){let a=new wi;a.isLinear=!0,a.type=$t.Tempo,a.value=parseInt(n),t.tempoAutomations.push(a),t.index===0&&(t.score.tempo=a.value)}break;case"direction-type":let s=r.firstElement;switch(s.localName){case"words":this._currentDirection=s.innerText;break;case"metronome":this.parseMetronome(s,t);break}break}}parseMetronome(e,t){let r=_.Quarter,n=120;for(let a of e.childNodes)if(a.nodeType===I.Element)switch(a.localName){case"beat-unit":r=this.getDuration(a.innerText);break;case"per-minute":n=parseInt(a.innerText);break}let s=new wi;s.type=$t.Tempo,s.value=n*(r/4)|0,this.hasSameTempo(t,s)||(t.tempoAutomations.push(s),t.index===0&&(t.score.tempo=s.value))}hasSameTempo(e,t){for(const r of e.tempoAutomations)if(t.ratioPosition===r.ratioPosition&&t.value==r.value)return!0;return!1}parseAttributes(e,t,r,n){let s=0,a=!1;for(let o of e.childNodes)if(o.nodeType===I.Element)switch(o.localName){case"divisions":this._divisionsPerQuarterNote=parseInt(o.innerText);break;case"key":this.parseKey(o,r);break;case"time":this.parseTime(o,r),a=!0;break;case"clef":s=parseInt(o.getAttribute("number")),isNaN(s)&&(s=1),this.parseClef(o,t[s-1]);break;case"staff-details":this.parseStaffDetails(o,n);break;case"transpose":this.parseTranspose(o,n);break}a||(r.timeSignatureCommon=!0)}parseTranspose(e,t){let r=0;for(let n of e.childNodes)if(n.nodeType===I.Element)switch(n.localName){case"chromatic":r+=parseInt(n.innerText);break;case"octave-change":r+=parseInt(n.innerText)*12;break}for(let n of t.staves)n.transpositionPitch=r}parseClef(e,t){let r="s",n=0;for(let s of e.childNodes)if(s.nodeType===I.Element)switch(s.localName){case"sign":r=s.innerText.toLowerCase();break;case"line":n=parseInt(s.innerText);break;case"clef-octave-change":switch(parseInt(s.innerText)){case-2:t.clefOttava=$e._15mb;break;case-1:t.clefOttava=$e._8vb;break;case 1:t.clefOttava=$e._8va;break;case 2:t.clefOttava=$e._15mb;break}break}switch(r){case"g":t.clef=ve.G2;break;case"f":t.clef=ve.F4;break;case"c":n===3?t.clef=ve.C3:t.clef=ve.C4;break;case"percussion":t.clef=ve.Neutral,t.staff.isPercussion=!0;break;case"tab":t.clef=ve.G2,t.staff.showTablature=!0;break;default:t.clef=ve.G2;break}}parseTime(e,t){e.getAttribute("symbol")==="common"&&(t.timeSignatureCommon=!0);let r=!1,n=!1;for(let s of e.childNodes)if(s.nodeType===I.Element){let a=s.innerText;switch(s.localName){case"beats":r||(a.indexOf("+")===-1?t.timeSignatureNumerator=parseInt(a):t.timeSignatureNumerator=4,r=!0);break;case"beat-type":n||(a.indexOf("+")===-1?t.timeSignatureDenominator=parseInt(a):t.timeSignatureDenominator=4,n=!0);break}}}parseKey(e,t){let r=-2147483648,n="";for(let s of e.childNodes)if(s.nodeType===I.Element)switch(s.localName){case"fifths":r=parseInt(s.innerText);break;case"key-step":break;case"key-alter":break;case"mode":n=s.innerText;break}-7<=r&&r<=7?t.keySignature=r:t.keySignature=qt.C,n==="minor"?t.keySignatureType=da.Minor:t.keySignatureType=da.Major}getOrCreateMasterBar(e){if(e<this._score.masterBars.length)return this._score.masterBars[e];for(let t=this._score.masterBars.length;t<=e;t++){let r=new Ts;if(this._score.masterBars.length>0){let n=this._score.masterBars[this._score.masterBars.length-1];r.timeSignatureDenominator=n.timeSignatureDenominator,r.timeSignatureNumerator=n.timeSignatureNumerator,r.keySignature=n.keySignature,r.keySignatureType=n.keySignatureType}this._score.addMasterBar(r)}return this._score.masterBars[e]}parseIdentification(e){for(let t of e.childNodes)if(t.nodeType===I.Element)switch(t.localName){case"creator":t.getAttribute("type")==="composer"&&(this._score.music=t.innerText);break;case"rights":this._score.copyright&&(this._score.copyright+=`
`),this._score.copyright+=t.innerText;break}}parsePartList(e){for(let t of e.childNodes)if(t.nodeType===I.Element)switch(t.localName){case"part-group":this.parsePartGroup(t);break;case"score-part":this.parseScorePart(t);break}}parsePartGroup(e){switch(e.getAttribute("type")){case"start":this._currentPartGroup=e.getAttribute("number"),this._partGroups.set(this._currentPartGroup,[]);break;case"stop":this._currentPartGroup=null;break}}parseScorePart(e){let t=e.getAttribute("id"),r=new Jn;r.ensureStaveCount(1);let n=r.staves[0];n.showStandardNotation=!0,this._trackById.set(t,r),this._score.addTrack(r),this._currentPartGroup&&this._partGroups.get(this._currentPartGroup).push(r);for(let s of e.childNodes)if(s.nodeType===I.Element)switch(s.localName){case"part-name":r.name=s.innerText;break;case"part-abbreviation":r.shortName=s.innerText;break;case"midi-instrument":this.parseMidiInstrument(s,r);break}this.isEmptyTuning(r.staves[0].tuning)&&(r.staves[0].stringTuning.tunings=[])}isEmptyTuning(e){if(!e)return!0;for(let t=0;t<e.length;t++)if(e[t]!==0)return!1;return!0}parseMidiInstrument(e,t){for(let r of e.childNodes)if(r.nodeType===I.Element)switch(r.localName){case"midi-channel":t.playbackInfo.primaryChannel=parseInt(r.innerText);break;case"midi-program":t.playbackInfo.program=parseInt(r.innerText);break;case"volume":t.playbackInfo.volume=Math.floor(parseInt(r.innerText)/100*16);break;case"pan":t.playbackInfo.balance=Math.max(0,Math.min(16,Math.floor((parseInt(r.innerText)+90)/180*16)));break}}}var nl;(function(i){i[i.SingleTrackMultiChannel=0]="SingleTrackMultiChannel",i[i.MultiTrack=1]="MultiTrack"})(nl||(nl={}));class mB{constructor(){this.events=[]}addEvent(e){if(this.events.length===0||e.tick>=this.events[this.events.length-1].tick)this.events.push(e);else{let t=this.events.length;for(;t>0&&this.events[t-1].tick>e.tick;)t--;this.events.splice(t,0,e)}}writeTo(e){let t=ni.empty(),r=0;for(let a of this.events){let o=a.tick-r;ia.writeVariableInt(t,o),a.writeTo(t),r=a.tick}const n=new Uint8Array([77,84,114,107]);e.write(n,0,n.length);let s=t.toArray();M.writeInt32BE(e,s.length),e.write(s,0,s.length)}}class ia{constructor(){this.format=nl.SingleTrackMultiChannel,this.division=we.QuarterTime,this.tracks=[]}get events(){if(this.tracks.length==1)return this.tracks[0].events;{const e=[];for(const t of this.tracks)this.events.push(...t.events);return e.sort((t,r)=>t.tick-r.tick),e}}ensureTracks(e){for(;this.tracks.length<e;)this.tracks.push(new mB)}addEvent(e){this.format==nl.SingleTrackMultiChannel?(this.ensureTracks(1),this.tracks[0].addEvent(e)):(this.ensureTracks(e.track+1),this.tracks[e.track].addEvent(e))}toBinary(){let e=ni.empty();return this.writeTo(e),e.toArray()}writeTo(e){let t=new Uint8Array([77,84,104,100]);e.write(t,0,t.length),M.writeInt32BE(e,6),M.writeInt16BE(e,this.format),M.writeInt16BE(e,this.tracks.length),M.writeInt16BE(e,this.division);for(const r of this.tracks)r.writeTo(e)}static writeVariableInt(e,t){let r=new Uint8Array(4),n=0;do r[n++]=t&127,t>>=7;while(t>0);for(;n>0;)n--,n>0?e.writeByte(r[n]|128):e.writeByte(r[n])}}var Le;(function(i){i[i.TimeSignature=88]="TimeSignature",i[i.NoteOn=128]="NoteOn",i[i.NoteOff=144]="NoteOff",i[i.ControlChange=176]="ControlChange",i[i.ProgramChange=192]="ProgramChange",i[i.TempoChange=81]="TempoChange",i[i.PitchBend=224]="PitchBend",i[i.PerNotePitchBend=96]="PerNotePitchBend",i[i.EndOfTrack=47]="EndOfTrack",i[i.AlphaTabRest=241]="AlphaTabRest",i[i.AlphaTabMetronome=242]="AlphaTabMetronome",i[i.SystemExclusive=240]="SystemExclusive",i[i.SystemExclusive2=247]="SystemExclusive2",i[i.Meta=255]="Meta"})(Le||(Le={}));class Rs{constructor(e,t,r){this.track=e,this.tick=t,this.type=r}get command(){return this.type}get message(){return 0}get data1(){return 0}get data2(){return 0}}class yB extends Rs{constructor(e,t,r,n,s,a){super(e,t,Le.TimeSignature),this.track=e,this.tick=t,this.numerator=r,this.denominatorIndex=n,this.midiClocksPerMetronomeClick=s,this.thirtySecondNodesInQuarter=a}writeTo(e){e.writeByte(255),e.writeByte(88),ia.writeVariableInt(e,4),e.writeByte(this.numerator&255),e.writeByte(this.denominatorIndex&255),e.writeByte(this.midiClocksPerMetronomeClick&255),e.writeByte(this.thirtySecondNodesInQuarter&255)}}class Cs extends Rs{constructor(e,t,r){super(e,t,r)}writeTo(e){e.writeByte(240);const t=ni.withCapacity(16);t.writeByte(Cs.AlphaTabManufacturerId),this.writeEventData(t),t.writeByte(247),ia.writeVariableInt(e,t.length),t.copyTo(e)}}Cs.AlphaTabManufacturerId=125;Cs.MetronomeEventId=0;Cs.RestEventId=1;class bB extends Cs{constructor(e,t,r,n,s){super(e,t,Le.AlphaTabMetronome),this.isMetronome=!0,this.metronomeNumerator=r,this.metronomeDurationInMilliseconds=s,this.metronomeDurationInTicks=n}writeEventData(e){e.writeByte(Cs.MetronomeEventId),e.writeByte(this.metronomeNumerator),M.writeInt32LE(e,this.metronomeDurationInTicks),M.writeInt32LE(e,this.metronomeDurationInMilliseconds)}}class vB extends Cs{constructor(e,t,r){super(e,t,Le.AlphaTabRest),this.channel=r}writeEventData(e){e.writeByte(Cs.RestEventId),e.writeByte(this.channel)}}class wB extends Rs{constructor(e,t,r,n,s,a){super(e,t,r),this.channel=n,this.noteKey=s,this.noteVelocity=a}get data1(){return this.noteKey}get data2(){return this.noteVelocity}}class SB extends wB{constructor(e,t,r,n,s){super(e,t,Le.NoteOn,r,n,s)}writeTo(e){e.writeByte(this.channel&15|144),e.writeByte(this.noteKey&255),e.writeByte(this.noteVelocity&255)}}class xB extends wB{constructor(e,t,r,n,s){super(e,t,Le.NoteOff,r,n,s)}writeTo(e){e.writeByte(this.channel&15|128),e.writeByte(this.noteKey&255),e.writeByte(this.noteVelocity&255)}}class kB extends Rs{constructor(e,t,r,n,s){super(e,t,Le.ControlChange),this.channel=r,this.controller=n,this.value=s}writeTo(e){e.writeByte(this.channel&15|176),e.writeByte(this.controller&255),e.writeByte(this.value&255)}get data1(){return this.controller}get data2(){return this.value}}class TB extends Rs{constructor(e,t,r,n){super(e,t,Le.ProgramChange),this.channel=r,this.program=n}writeTo(e){e.writeByte(this.channel&15|192),e.writeByte(this.program&255)}get data1(){return this.program}}class CB extends Rs{constructor(e,t){super(0,e,Le.TempoChange),this.microSecondsPerQuarterNote=t}writeTo(e){e.writeByte(255),e.writeByte(81),e.writeByte(3),e.writeByte(this.microSecondsPerQuarterNote>>16&255),e.writeByte(this.microSecondsPerQuarterNote>>8&255),e.writeByte(this.microSecondsPerQuarterNote&255)}}class NB extends Rs{constructor(e,t,r,n){super(e,t,Le.PitchBend),this.channel=r,this.value=n}writeTo(e){e.writeByte(this.channel&15|224),e.writeByte(this.value&127),e.writeByte(this.value>>7&127)}get data1(){return this.value&127}get data2(){return this.value>>7&127}}class BB extends Rs{constructor(e,t,r,n,s){super(e,t,Le.PerNotePitchBend),this.channel=r,this.noteKey=n,this.value=s}writeTo(e){throw new oi(ai.General,"Note Bend (Midi2.0) events cannot be exported to SMF1.0")}}class _B extends Rs{constructor(e,t){super(e,t,Le.EndOfTrack)}writeTo(e){e.writeByte(255),e.writeByte(47),e.writeByte(0)}}class ou{constructor(e,t){this.time=0,this.eventIndex=e,this.event=t,this.isMetronome=this.event.type==Le.AlphaTabMetronome}static newMetronomeEvent(e,t,r,n,s){const a=new bB(0,t,r,n,s);return new ou(e,a)}}class Te{}Te.DefaultChannelCount=17;Te.MetronomeChannel=Te.DefaultChannelCount-1;Te.AudioChannels=2;Te.MinVolume=0;Te.MinProgram=0;Te.MaxProgram=127;Te.MinPlaybackSpeed=.125;Te.MaxPlaybackSpeed=8;Te.MaxPitchWheel=16384;Te.MaxPitchWheel20=4294967296;Te.DefaultPitchWheel=Te.MaxPitchWheel/2;Te.MicroBufferCount=32;Te.MicroBufferSize=64;class dS{constructor(e,t,r){this.bpm=e,this.ticks=t,this.time=r}}class gg{constructor(){this.tempoChanges=[],this.firstProgramEventPerChannel=new Map,this.firstTimeSignatureNumerator=0,this.firstTimeSignatureDenominator=0,this.synthData=[],this.division=we.QuarterTime,this.eventIndex=0,this.currentTime=0,this.playbackRange=null,this.playbackRangeStartTime=0,this.playbackRangeEndTime=0,this.endTick=0,this.endTime=0}}class iU{get isPlayingMain(){return this._currentState==this._mainState}get isPlayingOneTimeMidi(){return this._currentState==this._oneTimeState}get isPlayingCountIn(){return this._currentState==this._countInState}constructor(e){this._oneTimeState=null,this._countInState=null,this.isLooping=!1,this.playbackSpeed=1,this._synthesizer=e,this._mainState=new gg,this._currentState=this._mainState}get mainPlaybackRange(){return this._mainState.playbackRange}set mainPlaybackRange(e){this._mainState.playbackRange=e,e&&(this._mainState.playbackRangeStartTime=this.tickPositionToTimePositionWithSpeed(this._mainState,e.startTick,1),this._mainState.playbackRangeEndTime=this.tickPositionToTimePositionWithSpeed(this._mainState,e.endTick,1))}get currentTime(){return this._currentState.currentTime/this.playbackSpeed}get currentEndTick(){return this._currentState.endTick}get currentEndTime(){return this._currentState.endTime/this.playbackSpeed}mainSeek(e){if(e*=this.playbackSpeed,this.mainPlaybackRange&&(e<this._mainState.playbackRangeStartTime?e=this._mainState.playbackRangeStartTime:e>this._mainState.playbackRangeEndTime&&(e=this._mainState.playbackRangeEndTime)),e>this._mainState.currentTime)this.mainSilentProcess(e-this._mainState.currentTime);else if(e<this._mainState.currentTime){if(this._mainState.currentTime=0,this._mainState.eventIndex=0,this.isPlayingMain){let t=this._synthesizer.metronomeVolume;this._synthesizer.noteOffAll(!0),this._synthesizer.resetSoft(),this._synthesizer.setupMetronomeChannel(t)}this.mainSilentProcess(e)}}mainSilentProcess(e){if(e<=0)return;let t=Date.now(),r=this._mainState.currentTime+e;if(this.isPlayingMain)for(;this._mainState.currentTime<r;)this.fillMidiEventQueueLimited(r-this._mainState.currentTime)&&this._synthesizer.synthesizeSilent(Te.MicroBufferSize);this._mainState.currentTime=r;let n=Date.now()-t;V.debug("Sequencer","Silent seek finished in "+n+"ms (main)")}loadOneTimeMidi(e){this._oneTimeState=this.createStateFromFile(e),this._currentState=this._oneTimeState}loadMidi(e){this._mainState=this.createStateFromFile(e),this._currentState=this._mainState}createStateFromFile(e){const t=new gg;t.tempoChanges=[],t.division=e.division,t.eventIndex=0,t.currentTime=0,t.synthData=[];let r=120,n=0,s=0,a=0,o=0,l=0,u=0,c=0,h=0;for(let d of e.events){let f=new ou(t.synthData.length,d);t.synthData.push(f);let p=d.tick-h;if(n+=p,s+=p*(6e4/(r*e.division)),f.time=s,h=d.tick,o>0)for(;u<n;){let g=ou.newMetronomeEvent(t.synthData.length,u,Math.floor(u/o)%a,o,l);t.synthData.push(g),g.time=c,u+=o,c+=l}if(d.type===Le.TempoChange)r=6e7/d.microSecondsPerQuarterNote,t.tempoChanges.push(new dS(r,n,s)),l=o*(6e4/(r*e.division));else if(d.type===Le.TimeSignature){let g=d,y=Math.pow(2,g.denominatorIndex);a=g.numerator,o=t.division*(4/y)|0,l=o*(6e4/(r*e.division)),t.firstTimeSignatureDenominator===0&&(t.firstTimeSignatureNumerator=g.numerator,t.firstTimeSignatureDenominator=y)}else if(d.type===Le.ProgramChange){let g=d.channel;t.firstProgramEventPerChannel.has(g)||t.firstProgramEventPerChannel.set(g,f)}}return t.synthData.sort((d,f)=>d.time>f.time?1:d.time<f.time?-1:d.eventIndex-f.eventIndex),t.endTime=s,t.endTick=n,t}fillMidiEventQueue(){return this.fillMidiEventQueueLimited(-1)}fillMidiEventQueueLimited(e){let t=Te.MicroBufferSize/this._synthesizer.outSampleRate*1e3*this.playbackSpeed,r=this.internalEndTime;e>0&&(e<t&&(t=e),r=Math.min(this.internalEndTime,this._currentState.currentTime+e));let n=!1;for(this._currentState.currentTime+=t;this._currentState.eventIndex<this._currentState.synthData.length&&this._currentState.synthData[this._currentState.eventIndex].time<this._currentState.currentTime&&this._currentState.currentTime<r;)this._synthesizer.dispatchEvent(this._currentState.synthData[this._currentState.eventIndex]),this._currentState.eventIndex++,n=!0;return n}mainTickPositionToTimePosition(e){return this.tickPositionToTimePositionWithSpeed(this._mainState,e,this.playbackSpeed)}mainTimePositionToTickPosition(e){return this.timePositionToTickPositionWithSpeed(this._mainState,e,this.playbackSpeed)}currentTimePositionToTickPosition(e){return this.timePositionToTickPositionWithSpeed(this._currentState,e,this.playbackSpeed)}tickPositionToTimePositionWithSpeed(e,t,r){let n=0,s=120,a=0;for(const o of e.tempoChanges){if(t<o.ticks)break;n=o.time,s=o.bpm,a=o.ticks}return t-=a,n+=t*(6e4/(s*e.division)),n/r}timePositionToTickPositionWithSpeed(e,t,r){t*=r;let n=0,s=120,a=0;for(const o of e.tempoChanges){if(t<o.time)break;n=o.ticks,s=o.bpm,a=o.time}return t-=a,n+=t/(6e4/(s*e.division))|0,n+1}get internalEndTime(){return this.isPlayingMain?this.mainPlaybackRange?this._currentState.playbackRangeEndTime:this._currentState.endTime:this._currentState.endTime}get isFinished(){return this._currentState.currentTime>=this.internalEndTime}stop(){this.isPlayingMain&&this.mainPlaybackRange?this._currentState.currentTime=this.mainPlaybackRange.startTick:this._currentState.currentTime=0,this._currentState.eventIndex=0}resetOneTimeMidi(){this._oneTimeState=null,this._currentState=this._mainState}resetCountIn(){this._countInState=null,this._currentState=this._mainState}startCountIn(){this.generateCountInMidi(),this._currentState=this._countInState,this.stop(),this._synthesizer.noteOffAll(!0)}generateCountInMidi(){const e=new gg;e.division=this._mainState.division;let t=120,r=4,n=4;this._mainState.eventIndex===0?(t=this._mainState.tempoChanges[0].bpm,r=this._mainState.firstTimeSignatureNumerator,n=this._mainState.firstTimeSignatureDenominator):(t=this._synthesizer.currentTempo,r=this._synthesizer.timeSignatureNumerator,n=this._synthesizer.timeSignatureDenominator),e.tempoChanges.push(new dS(t,0,0));let s=e.division*(4/n)|0,a=s*(6e4/(t*this._mainState.division)),o=0,l=0;for(let u=0;u<r;u++){let c=ou.newMetronomeEvent(e.synthData.length,o,u,s,a);e.synthData.push(c),c.time=l,o+=s,l+=a}e.synthData.sort((u,c)=>u.time>c.time?1:u.time<c.time?-1:u.eventIndex-c.eventIndex),e.endTime=l,e.endTick=o,this._countInState=e}}var Wt;(function(i){i[i.Paused=0]="Paused",i[i.Playing=1]="Playing"})(Wt||(Wt={}));class lu{constructor(e,t){this.state=e,this.stopped=t}}class Uu{constructor(e,t,r,n,s){this.currentTime=e,this.endTime=t,this.currentTick=r,this.endTick=n,this.isSeek=s}}class _r{constructor(){this.id="",this.size=0}static load(e,t,r){if(e&&_r.HeaderSize>e.size||r.position+_r.HeaderSize>=r.length||(t.id=M.read8BitStringLength(r,4),t.id.charCodeAt(0)<=32||t.id.charCodeAt(0)>=122)||(t.size=M.readUInt32LE(r),e&&_r.HeaderSize+t.size>e.size))return!1;e&&(e.size-=_r.HeaderSize+t.size);let n=t.id==="RIFF",s=t.id==="LIST";return n&&e?!1:!n&&!s?!0:(t.id=M.read8BitStringLength(r,4),t.id.charCodeAt(0)<=32||t.id.charCodeAt(0)>=122?!1:(t.size-=4,!0))}}_r.HeaderSize=8;class U1{constructor(){this.phdrs=[],this.pbags=[],this.pmods=[],this.pgens=[],this.insts=[],this.ibags=[],this.imods=[],this.igens=[],this.sHdrs=[],this.fontSamples=new Float32Array(0)}load(e){const t=new _r,r=new _r;if(!_r.load(null,t,e)||t.id!=="sfbk")throw new zt("Soundfont is not a valid Soundfont2 file");for(;_r.load(t,r,e);){let n=new _r;if(r.id==="pdta")for(;_r.load(r,n,e);)switch(n.id){case"phdr":for(let s=0,a=n.size/y0.SizeInFile|0;s<a;s++)this.phdrs.push(new y0(e));break;case"pbag":for(let s=0,a=n.size/m0.SizeInFile|0;s<a;s++)this.pbags.push(new m0(e));break;case"pmod":for(let s=0,a=n.size/b0.SizeInFile|0;s<a;s++)this.pmods.push(new b0(e));break;case"pgen":for(let s=0,a=n.size/or.SizeInFile|0;s<a;s++)this.pgens.push(new or(e));break;case"inst":for(let s=0,a=n.size/g0.SizeInFile|0;s<a;s++)this.insts.push(new g0(e));break;case"ibag":for(let s=0,a=n.size/d0.SizeInFile|0;s<a;s++)this.ibags.push(new d0(e));break;case"imod":for(let s=0,a=n.size/f0.SizeInFile|0;s<a;s++)this.imods.push(new f0(e));break;case"igen":for(let s=0,a=n.size/p0.SizeInFile|0;s<a;s++)this.igens.push(new p0(e));break;case"shdr":for(let s=0,a=n.size/v0.SizeInFile|0;s<a;s++)this.sHdrs.push(new v0(e));break;default:e.position+=n.size;break}else if(r.id==="sdta")for(;_r.load(r,n,e);)switch(n.id){case"smpl":this.fontSamples=U1.loadSamples(n,e);break;default:e.position+=n.size;break}else e.position+=r.size}}static loadSamples(e,t){let r=e.size/2|0;const n=new Float32Array(r);let s=0;const a=new Uint8Array(16*1024);for(;r>0;){let o=Math.min(r,a.length/2|0);t.read(a,0,o*2);for(let l=0;l<o;l++){const u=Ne.int32ToInt16(a[l*2+1]<<8|a[l*2]);n[s+l]=u/32767}r-=o,s+=o}return n}}class d0{constructor(e){this.instGenNdx=M.readUInt16LE(e),this.instModNdx=M.readUInt16LE(e)}}d0.SizeInFile=4;class f0{constructor(e){this.modSrcOper=M.readUInt16LE(e),this.modDestOper=M.readUInt16LE(e),this.modAmount=M.readInt16LE(e),this.modAmtSrcOper=M.readUInt16LE(e),this.modTransOper=M.readUInt16LE(e)}}f0.SizeInFile=10;class p0{constructor(e){this.genOper=M.readUInt16LE(e),this.genAmount=new PB(e)}}p0.SizeInFile=4;class g0{constructor(e){this.instName=M.read8BitStringLength(e,20),this.instBagNdx=M.readUInt16LE(e)}}g0.SizeInFile=22;class m0{constructor(e){this.genNdx=M.readUInt16LE(e),this.modNdx=M.readUInt16LE(e)}}m0.SizeInFile=4;class or{constructor(e){this.genOper=M.readUInt16LE(e),this.genAmount=new PB(e)}}or.SizeInFile=4;or.GenInstrument=41;or.GenKeyRange=43;or.GenVelRange=44;or.GenSampleId=53;class y0{constructor(e){this.presetName=M.read8BitStringLength(e,20),this.preset=M.readUInt16LE(e),this.bank=M.readUInt16LE(e),this.presetBagNdx=M.readUInt16LE(e),this.library=M.readUInt32LE(e),this.genre=M.readUInt32LE(e),this.morphology=M.readUInt32LE(e)}}y0.SizeInFile=38;class b0{constructor(e){this.modSrcOper=M.readUInt16LE(e),this.modDestOper=M.readUInt16LE(e),this.modAmount=M.readUInt16LE(e),this.modAmtSrcOper=M.readUInt16LE(e),this.modTransOper=M.readUInt16LE(e)}}b0.SizeInFile=10;class v0{constructor(e){this.sampleName=M.read8BitStringLength(e,20),this.start=M.readUInt32LE(e),this.end=M.readUInt32LE(e),this.startLoop=M.readUInt32LE(e),this.endLoop=M.readUInt32LE(e),this.sampleRate=M.readUInt32LE(e),this.originalPitch=e.readByte(),this.pitchCorrection=M.readSInt8(e),this.sampleLink=M.readUInt16LE(e),this.sampleType=M.readUInt16LE(e)}}v0.SizeInFile=46;class PB{get shortAmount(){return Ne.uint16ToInt16(this.wordAmount)}get lowByteAmount(){return this.wordAmount&255}get highByteAmount(){return(this.wordAmount&65280)>>8&255}constructor(e){this.wordAmount=M.readUInt16LE(e)}}class rU{constructor(){this.presetIndex=0,this.bank=0,this.pitchWheel=0,this.perNotePitchWheel=new Map,this.midiPan=0,this.midiVolume=0,this.midiExpression=0,this.midiRpn=0,this.midiData=0,this.panOffset=0,this.gainDb=0,this.pitchRange=0,this.tuning=0,this.mixVolume=0,this.mute=!1,this.solo=!1}}class nU{constructor(){this.activeChannel=0,this.channelList=[]}setupVoice(e,t){const r=this.channelList[this.activeChannel],n=t.region.pan+r.panOffset;t.playingChannel=this.activeChannel,t.mixVolume=r.mixVolume,t.noteGainDb+=r.gainDb,t.updatePitchRatio(r,e.outSampleRate),n<=-.5?(t.panFactorLeft=1,t.panFactorRight=0):n>=.5?(t.panFactorLeft=0,t.panFactorRight=1):(t.panFactorLeft=Math.sqrt(.5-n),t.panFactorRight=Math.sqrt(.5+n))}}var ss;(function(i){i[i.None=0]="None",i[i.Continuous=1]="Continuous",i[i.Sustain=2]="Sustain"})(ss||(ss={}));var Ma;(function(i){i[i.StereoInterleaved=0]="StereoInterleaved",i[i.StereoUnweaved=1]="StereoUnweaved",i[i.Mono=2]="Mono"})(Ma||(Ma={}));class sU{constructor(){this.name="",this.presetNumber=0,this.bank=0,this.regions=null,this.fontSamples=null}}class Rt{static timecents2Secs(e){return Math.pow(2,e/1200)}static decibelsToGain(e){return e>-100?Math.pow(10,e*.05):0}static gainToDecibels(e){return e<=1e-5?-100:20*Math.log10(e)}static cents2Hertz(e){return 8.176*Math.pow(2,e/1200)}static clamp(e,t,r){return e<=t?t:e>=r?r:e}}class Ul{constructor(e){this.delay=0,this.attack=0,this.hold=0,this.decay=0,this.sustain=0,this.release=0,this.keynumToHold=0,this.keynumToDecay=0,e&&(this.delay=e.delay,this.attack=e.attack,this.hold=e.hold,this.decay=e.decay,this.sustain=e.sustain,this.release=e.release,this.keynumToHold=e.keynumToHold,this.keynumToDecay=e.keynumToDecay)}clear(){this.delay=0,this.attack=0,this.hold=0,this.decay=0,this.sustain=0,this.release=0,this.keynumToHold=0,this.keynumToDecay=0}envToSecs(e){this.delay=this.delay<-11950?0:Rt.timecents2Secs(this.delay),this.attack=this.attack<-11950?0:Rt.timecents2Secs(this.attack),this.release=this.release<-11950?0:Rt.timecents2Secs(this.release),this.keynumToHold===0&&(this.hold=this.hold<-11950?0:Rt.timecents2Secs(this.hold)),this.keynumToDecay===0&&(this.decay=this.decay<-11950?0:Rt.timecents2Secs(this.decay)),this.sustain<0?this.sustain=0:e?this.sustain=Rt.decibelsToGain(-this.sustain/10):this.sustain=1-this.sustain/1e3}}var Ie;(function(i){i[i.StartAddrsOffset=0]="StartAddrsOffset",i[i.EndAddrsOffset=1]="EndAddrsOffset",i[i.StartloopAddrsOffset=2]="StartloopAddrsOffset",i[i.EndloopAddrsOffset=3]="EndloopAddrsOffset",i[i.StartAddrsCoarseOffset=4]="StartAddrsCoarseOffset",i[i.ModLfoToPitch=5]="ModLfoToPitch",i[i.VibLfoToPitch=6]="VibLfoToPitch",i[i.ModEnvToPitch=7]="ModEnvToPitch",i[i.InitialFilterFc=8]="InitialFilterFc",i[i.InitialFilterQ=9]="InitialFilterQ",i[i.ModLfoToFilterFc=10]="ModLfoToFilterFc",i[i.ModEnvToFilterFc=11]="ModEnvToFilterFc",i[i.EndAddrsCoarseOffset=12]="EndAddrsCoarseOffset",i[i.ModLfoToVolume=13]="ModLfoToVolume",i[i.Unused1=14]="Unused1",i[i.ChorusEffectsSend=15]="ChorusEffectsSend",i[i.ReverbEffectsSend=16]="ReverbEffectsSend",i[i.Pan=17]="Pan",i[i.Unused2=18]="Unused2",i[i.Unused3=19]="Unused3",i[i.Unused4=20]="Unused4",i[i.DelayModLFO=21]="DelayModLFO",i[i.FreqModLFO=22]="FreqModLFO",i[i.DelayVibLFO=23]="DelayVibLFO",i[i.FreqVibLFO=24]="FreqVibLFO",i[i.DelayModEnv=25]="DelayModEnv",i[i.AttackModEnv=26]="AttackModEnv",i[i.HoldModEnv=27]="HoldModEnv",i[i.DecayModEnv=28]="DecayModEnv",i[i.SustainModEnv=29]="SustainModEnv",i[i.ReleaseModEnv=30]="ReleaseModEnv",i[i.KeynumToModEnvHold=31]="KeynumToModEnvHold",i[i.KeynumToModEnvDecay=32]="KeynumToModEnvDecay",i[i.DelayVolEnv=33]="DelayVolEnv",i[i.AttackVolEnv=34]="AttackVolEnv",i[i.HoldVolEnv=35]="HoldVolEnv",i[i.DecayVolEnv=36]="DecayVolEnv",i[i.SustainVolEnv=37]="SustainVolEnv",i[i.ReleaseVolEnv=38]="ReleaseVolEnv",i[i.KeynumToVolEnvHold=39]="KeynumToVolEnvHold",i[i.KeynumToVolEnvDecay=40]="KeynumToVolEnvDecay",i[i.Instrument=41]="Instrument",i[i.Reserved1=42]="Reserved1",i[i.KeyRange=43]="KeyRange",i[i.VelRange=44]="VelRange",i[i.StartloopAddrsCoarseOffset=45]="StartloopAddrsCoarseOffset",i[i.Keynum=46]="Keynum",i[i.Velocity=47]="Velocity",i[i.InitialAttenuation=48]="InitialAttenuation",i[i.Reserved2=49]="Reserved2",i[i.EndloopAddrsCoarseOffset=50]="EndloopAddrsCoarseOffset",i[i.CoarseTune=51]="CoarseTune",i[i.FineTune=52]="FineTune",i[i.SampleID=53]="SampleID",i[i.SampleModes=54]="SampleModes",i[i.Reserved3=55]="Reserved3",i[i.ScaleTuning=56]="ScaleTuning",i[i.ExclusiveClass=57]="ExclusiveClass",i[i.OverridingRootKey=58]="OverridingRootKey",i[i.Unused5=59]="Unused5",i[i.EndOper=60]="EndOper"})(Ie||(Ie={}));class fo{constructor(e){this.loopMode=ss.None,this.sampleRate=0,this.loKey=0,this.hiKey=0,this.loVel=0,this.hiVel=0,this.group=0,this.offset=0,this.end=0,this.loopStart=0,this.loopEnd=0,this.transpose=0,this.tune=0,this.pitchKeyCenter=0,this.pitchKeyTrack=0,this.attenuation=0,this.pan=0,this.ampEnv=new Ul,this.modEnv=new Ul,this.initialFilterQ=0,this.initialFilterFc=0,this.modEnvToPitch=0,this.modEnvToFilterFc=0,this.modLfoToFilterFc=0,this.modLfoToVolume=0,this.delayModLFO=0,this.freqModLFO=0,this.modLfoToPitch=0,this.delayVibLFO=0,this.freqVibLFO=0,this.vibLfoToPitch=0,e&&(this.loopMode=e.loopMode,this.sampleRate=e.sampleRate,this.loKey=e.loKey,this.hiKey=e.hiKey,this.loVel=e.loVel,this.hiVel=e.hiVel,this.group=e.group,this.offset=e.offset,this.end=e.end,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.transpose=e.transpose,this.tune=e.tune,this.pitchKeyCenter=e.pitchKeyCenter,this.pitchKeyTrack=e.pitchKeyTrack,this.attenuation=e.attenuation,this.pan=e.pan,this.ampEnv=new Ul(e.ampEnv),this.modEnv=new Ul(e.modEnv),this.initialFilterQ=e.initialFilterQ,this.initialFilterFc=e.initialFilterFc,this.modEnvToPitch=e.modEnvToPitch,this.modEnvToFilterFc=e.modEnvToFilterFc,this.modLfoToFilterFc=e.modLfoToFilterFc,this.modLfoToVolume=e.modLfoToVolume,this.delayModLFO=e.delayModLFO,this.freqModLFO=e.freqModLFO,this.modLfoToPitch=e.modLfoToPitch,this.delayVibLFO=e.delayVibLFO,this.freqVibLFO=e.freqVibLFO,this.vibLfoToPitch=e.vibLfoToPitch)}clear(e){this.loopMode=ss.None,this.sampleRate=0,this.loKey=0,this.hiKey=0,this.loVel=0,this.hiVel=0,this.group=0,this.offset=0,this.end=0,this.loopStart=0,this.loopEnd=0,this.transpose=0,this.tune=0,this.pitchKeyCenter=0,this.pitchKeyTrack=0,this.attenuation=0,this.pan=0,this.ampEnv.clear(),this.modEnv.clear(),this.initialFilterQ=0,this.initialFilterFc=0,this.modEnvToPitch=0,this.modEnvToFilterFc=0,this.modLfoToFilterFc=0,this.modLfoToVolume=0,this.delayModLFO=0,this.freqModLFO=0,this.modLfoToPitch=0,this.delayVibLFO=0,this.freqVibLFO=0,this.vibLfoToPitch=0,this.hiKey=127,this.hiVel=127,this.pitchKeyCenter=60,!e&&(this.pitchKeyTrack=100,this.pitchKeyCenter=-1,this.ampEnv.delay=-12e3,this.ampEnv.attack=-12e3,this.ampEnv.hold=-12e3,this.ampEnv.decay=-12e3,this.ampEnv.release=-12e3,this.modEnv.delay=-12e3,this.modEnv.attack=-12e3,this.modEnv.hold=-12e3,this.modEnv.decay=-12e3,this.modEnv.release=-12e3,this.initialFilterFc=13500,this.delayModLFO=-12e3,this.delayVibLFO=-12e3)}operator(e,t){switch(e){case Ie.StartAddrsOffset:this.offset+=Ne.int16ToUint32(t.shortAmount);break;case Ie.EndAddrsOffset:this.end+=Ne.int16ToUint32(t.shortAmount);break;case Ie.StartloopAddrsOffset:this.loopStart+=Ne.int16ToUint32(t.shortAmount);break;case Ie.EndloopAddrsOffset:this.loopEnd+=Ne.int16ToUint32(t.shortAmount);break;case Ie.StartAddrsCoarseOffset:this.offset+=Ne.int16ToUint32(t.shortAmount)*32768;break;case Ie.ModLfoToPitch:this.modLfoToPitch=t.shortAmount;break;case Ie.VibLfoToPitch:this.vibLfoToPitch=t.shortAmount;break;case Ie.ModEnvToPitch:this.modEnvToPitch=t.shortAmount;break;case Ie.InitialFilterFc:this.initialFilterFc=t.shortAmount;break;case Ie.InitialFilterQ:this.initialFilterQ=t.shortAmount;break;case Ie.ModLfoToFilterFc:this.modLfoToFilterFc=t.shortAmount;break;case Ie.ModEnvToFilterFc:this.modEnvToFilterFc=t.shortAmount;break;case Ie.EndAddrsCoarseOffset:this.end+=Ne.int16ToUint32(t.shortAmount)*32768;break;case Ie.ModLfoToVolume:this.modLfoToVolume=t.shortAmount;break;case Ie.Pan:this.pan=t.shortAmount/1e3;break;case Ie.DelayModLFO:this.delayModLFO=t.shortAmount;break;case Ie.FreqModLFO:this.freqModLFO=t.shortAmount;break;case Ie.DelayVibLFO:this.delayVibLFO=t.shortAmount;break;case Ie.FreqVibLFO:this.freqVibLFO=t.shortAmount;break;case Ie.DelayModEnv:this.modEnv.delay=t.shortAmount;break;case Ie.AttackModEnv:this.modEnv.attack=t.shortAmount;break;case Ie.HoldModEnv:this.modEnv.hold=t.shortAmount;break;case Ie.DecayModEnv:this.modEnv.decay=t.shortAmount;break;case Ie.SustainModEnv:this.modEnv.sustain=t.shortAmount;break;case Ie.ReleaseModEnv:this.modEnv.release=t.shortAmount;break;case Ie.KeynumToModEnvHold:this.modEnv.keynumToHold=t.shortAmount;break;case Ie.KeynumToModEnvDecay:this.modEnv.keynumToDecay=t.shortAmount;break;case Ie.DelayVolEnv:this.ampEnv.delay=t.shortAmount;break;case Ie.AttackVolEnv:this.ampEnv.attack=t.shortAmount;break;case Ie.HoldVolEnv:this.ampEnv.hold=t.shortAmount;break;case Ie.DecayVolEnv:this.ampEnv.decay=t.shortAmount;break;case Ie.SustainVolEnv:this.ampEnv.sustain=t.shortAmount;break;case Ie.ReleaseVolEnv:this.ampEnv.release=t.shortAmount;break;case Ie.KeynumToVolEnvHold:this.ampEnv.keynumToHold=t.shortAmount;break;case Ie.KeynumToVolEnvDecay:this.ampEnv.keynumToDecay=t.shortAmount;break;case Ie.KeyRange:this.loKey=t.lowByteAmount,this.hiKey=t.highByteAmount;break;case Ie.VelRange:this.loVel=t.lowByteAmount,this.hiVel=t.highByteAmount;break;case Ie.StartloopAddrsCoarseOffset:this.loopStart+=Ne.int16ToUint32(t.shortAmount)*32768;break;case Ie.InitialAttenuation:this.attenuation+=t.shortAmount*.1;break;case Ie.EndloopAddrsCoarseOffset:this.loopEnd+=Ne.int16ToUint32(t.shortAmount)*32768;break;case Ie.CoarseTune:this.transpose+=t.shortAmount;break;case Ie.FineTune:this.tune+=t.shortAmount;break;case Ie.SampleModes:this.loopMode=(t.wordAmount&3)===3?ss.Sustain:(t.wordAmount&3)===1?ss.Continuous:ss.None;break;case Ie.ScaleTuning:this.pitchKeyTrack=t.shortAmount;break;case Ie.ExclusiveClass:this.group=t.wordAmount;break;case Ie.OverridingRootKey:this.pitchKeyCenter=t.shortAmount;break}}}var it;(function(i){i[i.None=0]="None",i[i.Delay=1]="Delay",i[i.Attack=2]="Attack",i[i.Hold=3]="Hold",i[i.Decay=4]="Decay",i[i.Sustain=5]="Sustain",i[i.Release=6]="Release",i[i.Done=7]="Done"})(it||(it={}));class Wu{constructor(){this.level=0,this.slope=0,this.samplesUntilNextSegment=0,this.segment=it.None,this.midiVelocity=0,this.parameters=null,this.segmentIsExponential=!1,this.isAmpEnv=!1}nextSegment(e,t){if(this.parameters)for(;;)switch(e){case it.None:if(this.samplesUntilNextSegment=this.parameters.delay*t|0,this.samplesUntilNextSegment>0){this.segment=it.Delay,this.segmentIsExponential=!1,this.level=0,this.slope=0;return}e=it.Delay;break;case it.Delay:if(this.samplesUntilNextSegment=this.parameters.attack*t|0,this.samplesUntilNextSegment>0){this.isAmpEnv||(this.samplesUntilNextSegment=this.parameters.attack*((145-this.midiVelocity)/144)*t|0),this.segment=it.Attack,this.segmentIsExponential=!1,this.level=0,this.slope=1/this.samplesUntilNextSegment;return}e=it.Attack;break;case it.Attack:if(this.samplesUntilNextSegment=this.parameters.hold*t|0,this.samplesUntilNextSegment>0){this.segment=it.Hold,this.segmentIsExponential=!1,this.level=1,this.slope=0;return}e=it.Hold;break;case it.Hold:if(this.samplesUntilNextSegment=this.parameters.decay*t|0,this.samplesUntilNextSegment>0){if(this.segment=it.Decay,this.level=1,this.isAmpEnv){let r=-9.226/this.samplesUntilNextSegment;this.slope=Math.exp(r),this.segmentIsExponential=!0,this.parameters.sustain>0&&(this.samplesUntilNextSegment=Math.log(this.parameters.sustain)/r|0)}else this.slope=-1/this.samplesUntilNextSegment,this.samplesUntilNextSegment=this.parameters.decay*(1-this.parameters.sustain)*t|0,this.segmentIsExponential=!1;return}e=it.Decay;break;case it.Decay:this.segment=it.Sustain,this.level=this.parameters.sustain,this.slope=0,this.samplesUntilNextSegment=2147483647,this.segmentIsExponential=!1;return;case it.Sustain:if(this.segment=it.Release,this.samplesUntilNextSegment=(this.parameters.release<=0?Wu.FastReleaseTime:this.parameters.release)*t|0,this.isAmpEnv){let r=-9.226/this.samplesUntilNextSegment;this.slope=Math.exp(r),this.segmentIsExponential=!0}else this.slope=-this.level/this.samplesUntilNextSegment,this.segmentIsExponential=!1;return;default:this.segment=it.Done,this.segmentIsExponential=!1,this.level=0,this.slope=0,this.samplesUntilNextSegment=134217727;return}}setup(e,t,r,n,s){this.parameters=new Ul(e),this.parameters.keynumToHold>0&&(this.parameters.hold+=this.parameters.keynumToHold*(60-t),this.parameters.hold=this.parameters.hold<-1e4?0:Rt.timecents2Secs(this.parameters.hold)),this.parameters.keynumToDecay>0&&(this.parameters.decay+=this.parameters.keynumToDecay*(60-t),this.parameters.decay=this.parameters.decay<-1e4?0:Rt.timecents2Secs(this.parameters.decay)),this.midiVelocity=r|0,this.isAmpEnv=n,this.nextSegment(it.None,s)}process(e,t){this.slope>0&&(this.segmentIsExponential?this.level*=Math.pow(this.slope,e):this.level+=this.slope*e),this.samplesUntilNextSegment-=e,this.samplesUntilNextSegment<=0&&this.nextSegment(this.segment,t)}}Wu.FastReleaseTime=.01;class fS{constructor(){this.samplesUntil=0,this.level=0,this.delta=0}setup(e,t,r){this.samplesUntil=e*r|0,this.delta=4*Rt.cents2Hertz(t)/r,this.level=0}process(e){if(this.samplesUntil>e){this.samplesUntil-=e;return}this.level+=this.delta*e,this.level>1?(this.delta=-this.delta,this.level=2-this.level):this.level<-1&&(this.delta=-this.delta,this.level=-2-this.level)}}class pS{constructor(e){this.qInv=0,this.a0=0,this.a1=0,this.b1=0,this.b2=0,this.z1=0,this.z2=0,this.active=!1,e&&(this.qInv=e.qInv,this.a0=e.a0,this.a1=e.a1,this.b1=e.b1,this.b2=e.b2,this.z1=e.z1,this.z2=e.z2,this.active=e.active)}setup(e){let t=Math.tan(Math.PI*e),r=t*t,n=1/(1+t*this.qInv+r);this.a0=r*n,this.a1=2*this.a0,this.b1=2*(r-1)*n,this.b2=(1-t*this.qInv+r)*n}process(e){let t=e*this.a0+this.z1;return this.z1=e*this.a1+this.z2-this.b1*t,this.z2=e*this.a0-this.b2*t,t}}class Gu{constructor(){this.playingPreset=0,this.playingKey=0,this.playingChannel=0,this.region=null,this.pitchInputTimecents=0,this.pitchOutputFactor=0,this.sourceSamplePosition=0,this.noteGainDb=0,this.panFactorLeft=0,this.panFactorRight=0,this.playIndex=0,this.loopStart=0,this.loopEnd=0,this.ampEnv=new Wu,this.modEnv=new Wu,this.lowPass=new pS,this.modLfo=new fS,this.vibLfo=new fS,this.mixVolume=0,this.mute=!1}updatePitchRatio(e,t){let r=e.pitchWheel;e.perNotePitchWheel.has(this.playingKey)&&(r+=e.perNotePitchWheel.get(this.playingKey)-8192);const n=r===8192?e.tuning:r/16383*e.pitchRange*2-e.pitchRange+e.tuning;this.calcPitchRatio(n,t)}calcPitchRatio(e,t){if(!this.region)return;const r=this.playingKey+this.region.transpose+this.region.tune/100;let n=this.region.pitchKeyCenter+(r-this.region.pitchKeyCenter)*(this.region.pitchKeyTrack/100);e!==0&&(n+=e),this.pitchInputTimecents=n*100,this.pitchOutputFactor=this.region.sampleRate/(Rt.timecents2Secs(this.region.pitchKeyCenter*100)*t)}end(e){this.region&&(this.ampEnv.nextSegment(it.Sustain,e),this.modEnv.nextSegment(it.Sustain,e),this.region.loopMode===ss.Sustain&&(this.loopEnd=this.loopStart))}endQuick(e){this.ampEnv.parameters.release=0,this.ampEnv.nextSegment(it.Sustain,e),this.modEnv.parameters.release=0,this.modEnv.nextSegment(it.Sustain,e)}render(e,t,r,n,s){if(!this.region)return;let a=this.region,l=e.presets[this.playingPreset].fontSamples,u=0,c=e.outputMode===Ma.StereoUnweaved?n:-1,h=a.modEnvToPitch!==0||a.modEnvToFilterFc!==0,d=this.modLfo.delta>0&&(a.modLfoToPitch!==0||a.modLfoToFilterFc!==0||a.modLfoToVolume!==0),f=this.vibLfo.delta>0&&a.vibLfoToPitch!==0,p=this.loopStart<this.loopEnd,g=this.loopStart,y=this.loopEnd,b=a.end,m=y+1,v=this.sourceSamplePosition,k=new pS(this.lowPass),x=a.modLfoToFilterFc!==0||a.modEnvToFilterFc!==0,C=0,N=0,B=0,E=0,O=a.modLfoToPitch!==0||a.modEnvToPitch!==0||a.vibLfoToPitch!==0,z=0,J=0,he=0,oe=0,ye=a.modLfoToVolume!==0,se=0,K=0;for(x?(C=e.outSampleRate,N=a.initialFilterFc,B=a.modLfoToFilterFc,E=a.modEnvToFilterFc):(C=0,N=0,B=0,E=0),O?(z=0,J=a.modLfoToPitch,he=a.vibLfoToPitch,oe=a.modEnvToPitch):(z=Rt.timecents2Secs(this.pitchInputTimecents)*this.pitchOutputFactor,J=0,he=0,oe=0),ye?K=a.modLfoToVolume*.1:(se=Rt.decibelsToGain(this.noteGainDb),K=0);n>0;){let U,Z,re=0,ge=n>Gu.RenderEffectSampleBlock?Gu.RenderEffectSampleBlock:n;if(n-=ge,x){let G=N+this.modLfo.level*B+this.modEnv.level*E;k.active=G<=13500,k.active&&k.setup(Rt.cents2Hertz(G)/C)}switch(O&&(z=Rt.timecents2Secs(this.pitchInputTimecents+(this.modLfo.level*J+this.vibLfo.level*he+this.modEnv.level*oe))*this.pitchOutputFactor),ye&&(se=Rt.decibelsToGain(this.noteGainDb+this.modLfo.level*K)),U=se*this.ampEnv.level,s?U=0:U*=this.mixVolume,this.ampEnv.process(ge,e.outSampleRate),h&&this.modEnv.process(ge,e.outSampleRate),d&&this.modLfo.process(ge),f&&this.vibLfo.process(ge),e.outputMode){case Ma.StereoInterleaved:for(Z=U*this.panFactorLeft,re=U*this.panFactorRight;ge-- >0&&v<b;){let G=v|0,q=G>=y&&p?g:G+1,ie=v-G,ae=l[G]*(1-ie)+l[q]*ie;k.active&&(ae=k.process(ae)),t[r+u]+=ae*Z,u++,t[r+u]+=ae*re,u++,v+=z,v>=m&&p&&(v-=y-g+1)}break;case Ma.StereoUnweaved:for(Z=U*this.panFactorLeft,re=U*this.panFactorRight;ge-- >0&&v<b;){let G=v|0,q=G>=y&&p?g:G+1,ie=v-G,ae=l[G]*(1-ie)+l[q]*ie;k.active&&(ae=k.process(ae)),t[r+u]+=ae*Z,u++,t[r+c]+=ae*re,c++,v+=z,v>=m&&p&&(v-=y-g+1)}break;case Ma.Mono:for(;ge-- >0&&v<b;){let G=v|0,q=G>=y&&p?g:G+1,ie=v-G,ae=l[G]*(1-ie)+l[q]*ie;k.active&&(ae=k.process(ae)),t[r+u]=ae*U,u++,v+=z,v>=m&&p&&(v-=y-g+1)}break}if(v>=b||this.ampEnv.segment===it.Done){this.kill();return}}this.sourceSamplePosition=v,(k.active||x)&&(this.lowPass=k)}kill(){this.playingPreset=-1}}Gu.RenderEffectSampleBlock=Te.MicroBufferSize;class w0{constructor(){this._items=[],this._position=0,this.isEmpty=!0}clear(){this._items=[],this._position=0,this.isEmpty=!0}enqueue(e){this.isEmpty=!1,this._items.push(e)}peek(){return this._items[this._position]}dequeue(){const e=this._items[this._position];return this._position++,this._position>=this._items.length/2&&(this._items=this._items.slice(this._position),this._position=0),this.isEmpty=this._items.length==0,e}toArray(){const e=this._items.slice(this._position);return e.reverse(),e}}var Qe;(function(i){i[i.BankSelectCoarse=0]="BankSelectCoarse",i[i.ModulationCoarse=1]="ModulationCoarse",i[i.DataEntryCoarse=6]="DataEntryCoarse",i[i.VolumeCoarse=7]="VolumeCoarse",i[i.PanCoarse=10]="PanCoarse",i[i.ExpressionControllerCoarse=11]="ExpressionControllerCoarse",i[i.BankSelectFine=32]="BankSelectFine",i[i.ModulationFine=33]="ModulationFine",i[i.DataEntryFine=38]="DataEntryFine",i[i.VolumeFine=39]="VolumeFine",i[i.PanFine=42]="PanFine",i[i.ExpressionControllerFine=43]="ExpressionControllerFine",i[i.HoldPedal=64]="HoldPedal",i[i.LegatoPedal=68]="LegatoPedal",i[i.NonRegisteredParameterFine=98]="NonRegisteredParameterFine",i[i.NonRegisteredParameterCourse=99]="NonRegisteredParameterCourse",i[i.RegisteredParameterFine=100]="RegisteredParameterFine",i[i.RegisteredParameterCourse=101]="RegisteredParameterCourse",i[i.AllSoundOff=120]="AllSoundOff",i[i.ResetControllers=121]="ResetControllers",i[i.AllNotesOff=123]="AllNotesOff"})(Qe||(Qe={}));class aU{constructor(e){this._midiEventQueue=new w0,this._mutedChannels=new Map,this._soloChannels=new Map,this._isAnySolo=!1,this._transpositionPitches=new Map,this.currentTempo=0,this.timeSignatureNumerator=0,this.timeSignatureDenominator=0,this.presets=null,this._voices=[],this._channels=null,this._voicePlayIndex=0,this.outputMode=Ma.StereoInterleaved,this.outSampleRate=0,this.globalGainDb=0,this.outSampleRate=e}synthesize(e,t,r){return this.fillWorkingBuffer(e,t,r)}synthesizeSilent(e){this.fillWorkingBuffer(null,0,e)}channelGetMixVolume(e){return this._channels&&e<this._channels.channelList.length?this._channels.channelList[e].mixVolume:1}channelSetMixVolume(e,t){let r=this.channelInit(e);for(let n of this._voices)n.playingChannel===e&&n.playingPreset!==-1&&(n.mixVolume=t);r.mixVolume=t}channelSetMute(e,t){t?this._mutedChannels.set(e,!0):this._mutedChannels.delete(e)}channelSetSolo(e,t){t?this._soloChannels.set(e,!0):this._soloChannels.delete(e),this._isAnySolo=this._soloChannels.size>0}resetChannelStates(){this._mutedChannels=new Map,this._soloChannels=new Map,this.applyTranspositionPitches(new Map),this._isAnySolo=!1}applyTranspositionPitches(e){const t=this._transpositionPitches;for(const r of this._voices)if(r.playingChannel>=0&&r.playingChannel!==9){let n=0;t.has(r.playingChannel)&&(n-=t.get(r.playingChannel)),e.has(r.playingChannel)&&(n+=e.get(r.playingChannel)),r.playingKey+=n,this._channels&&r.updatePitchRatio(this._channels.channelList[r.playingChannel],this.outSampleRate)}this._transpositionPitches=e}dispatchEvent(e){this._midiEventQueue.enqueue(e)}fillWorkingBuffer(e,t,r){const n=this._isAnySolo,s=[];for(;!this._midiEventQueue.isEmpty;){let a=this._midiEventQueue.dequeue();a.isMetronome&&this.metronomeVolume>0?(this.channelNoteOff(Te.MetronomeChannel,33),this.channelNoteOn(Te.MetronomeChannel,33,95/127)):a.event&&this.processMidiMessage(a.event),s.push(a)}for(const a of this._voices)if(a.playingPreset!==-1){const o=a.playingChannel,l=this._mutedChannels.has(o)||n&&o!=Te.MetronomeChannel&&!this._soloChannels.has(o);e?a.render(this,e,t,r,l):a.kill()}return s}processMidiMessage(e){switch(V.debug("MIdi","Processing Midi message "+Le[e.type]+"/"+e.tick),e.type){case Le.TimeSignature:const r=e;this.timeSignatureNumerator=r.numerator,this.timeSignatureDenominator=Math.pow(2,r.denominatorIndex);break;case Le.NoteOn:const n=e;this.channelNoteOn(n.channel,n.noteKey,n.noteVelocity/127);break;case Le.NoteOff:const s=e;this.channelNoteOff(s.channel,s.noteKey);break;case Le.ControlChange:const a=e;this.channelMidiControl(a.channel,a.controller,a.value);break;case Le.ProgramChange:const o=e;this.channelSetPresetNumber(o.channel,o.program,o.channel===9);break;case Le.TempoChange:const l=e;this.currentTempo=6e7/l.microSecondsPerQuarterNote;break;case Le.PitchBend:const u=e;this.channelSetPitchWheel(u.channel,u.value);break;case Le.PerNotePitchBend:const c=e;let h=c.value;h=h*Te.MaxPitchWheel/Te.MaxPitchWheel20,this.channelSetPerNotePitchWheel(c.channel,c.noteKey,h);break}}get metronomeVolume(){return this.channelGetMixVolume(Te.MetronomeChannel)}set metronomeVolume(e){this.setupMetronomeChannel(e)}setupMetronomeChannel(e){this.channelSetMixVolume(Te.MetronomeChannel,e),e>0&&(this.channelSetVolume(Te.MetronomeChannel,1),this.channelSetPresetNumber(Te.MetronomeChannel,0,!0))}get masterVolume(){return Rt.decibelsToGain(this.globalGainDb)}set masterVolume(e){var t=Rt.gainToDecibels(e);const r=t-this.globalGainDb;if(r!==0){for(const n of this._voices)n.playingPreset!==-1&&(n.noteGainDb+=r);this.globalGainDb=t}}resetSoft(){for(const e of this._voices)e.playingPreset!==-1&&(e.ampEnv.segment<it.Release||e.ampEnv.parameters.release!==0)&&e.endQuick(this.outSampleRate);if(this._channels)for(const e of this._channels.channelList)e.presetIndex=0,e.bank=0,e.pitchWheel=8192,e.midiPan=8192,e.perNotePitchWheel.clear(),e.midiVolume=16383,e.midiExpression=16383,e.midiRpn=65535,e.midiData=0,e.panOffset=0,e.gainDb=0,e.pitchRange=2,e.tuning=0}get presetCount(){var e;return((e=this.presets)==null?void 0:e.length)??0}reset(){for(let e of this._voices)e.playingPreset!==-1&&(e.ampEnv.segment<it.Release||e.ampEnv.parameters.release!==0)&&e.endQuick(this.outSampleRate);this._channels=null}setOutput(e,t,r){this.outputMode=e,this.outSampleRate=t>=1?t:44100,this.globalGainDb=r}noteOn(e,t,r){if(!this.presets)return;const n=r*127|0;if(e<0||e>=this.presets.length)return;if(r<=0){this.noteOff(e,t);return}const s=this._voicePlayIndex++;for(const a of this.presets[e].regions){if(t<a.loKey||t>a.hiKey||n<a.loVel||n>a.hiVel)continue;let o=null;if(a.group!==0)for(const c of this._voices)c.playingPreset===e&&c.region.group===a.group?c.endQuick(this.outSampleRate):c.playingPreset===-1&&!o&&(o=c);else for(let c of this._voices)c.playingPreset===-1&&(o=c);if(!o){for(let c=0;c<4;c++){const h=new Gu;h.playingPreset=-1,this._voices.push(h)}o=this._voices[this._voices.length-4]}o.region=a,o.playingPreset=e,o.playingKey=t,o.playIndex=s,o.noteGainDb=this.globalGainDb-a.attenuation-Rt.gainToDecibels(1/r),this._channels?this._channels.setupVoice(this,o):(o.calcPitchRatio(0,this.outSampleRate),o.panFactorLeft=Math.sqrt(.5-a.pan),o.panFactorRight=Math.sqrt(.5+a.pan)),o.sourceSamplePosition=a.offset;const l=a.loopMode!==ss.None&&a.loopStart<a.loopEnd;o.loopStart=l?a.loopStart:0,o.loopEnd=l?a.loopEnd:0,o.ampEnv.setup(a.ampEnv,t,n,!0,this.outSampleRate),o.modEnv.setup(a.modEnv,t,n,!1,this.outSampleRate);const u=a.initialFilterQ/10;o.lowPass.qInv=1/Math.pow(10,u/20),o.lowPass.z1=0,o.lowPass.z2=0,o.lowPass.active=a.initialFilterFc<=13500,o.lowPass.active&&o.lowPass.setup(Rt.cents2Hertz(a.initialFilterFc)/this.outSampleRate),o.modLfo.setup(a.delayModLFO,a.freqModLFO,this.outSampleRate),o.vibLfo.setup(a.delayVibLFO,a.freqVibLFO,this.outSampleRate)}}bankNoteOn(e,t,r,n){let s=this.getPresetIndex(e,t);return s===-1?!1:(this.noteOn(s,r,n),!0)}noteOff(e,t){let r=null,n=null,s=[];for(let a of this._voices)a.playingPreset!==e||a.playingKey!==t||a.ampEnv.segment>=it.Release||(!r||a.playIndex<r.playIndex?(r=a,n=a,s.push(a)):a.playIndex===r.playIndex&&(n=a,s.push(a)));if(r)for(const a of s)a!==r&&a!==n&&(a.playIndex!==r.playIndex||a.playingPreset!==e||a.playingKey!==t||a.ampEnv.segment>=it.Release)||a.end(this.outSampleRate)}bankNoteOff(e,t,r){const n=this.getPresetIndex(e,t);return n===-1?!1:(this.noteOff(n,r),!0)}noteOffAll(e){for(const t of this._voices)t.playingPreset!==-1&&(e?t.endQuick(this.outSampleRate):t.ampEnv.segment<it.Release&&t.end(this.outSampleRate))}get activeVoiceCount(){let e=0;for(const t of this._voices)t.playingPreset!==-1&&e++;return e}channelInit(e){if(this._channels&&e<this._channels.channelList.length)return this._channels.channelList[e];this._channels||(this._channels=new nU);for(let t=this._channels.channelList.length;t<=e;t++){let r=new rU;r.presetIndex=0,r.bank=0,r.pitchWheel=8192,r.midiPan=8192,r.midiVolume=16383,r.midiExpression=16383,r.midiRpn=65535,r.midiData=0,r.panOffset=0,r.gainDb=0,r.pitchRange=2,r.tuning=0,r.mixVolume=1,this._channels.channelList.push(r)}return this._channels.channelList[e]}getPresetIndex(e,t){if(!this.presets)return-1;for(let r=this.presets.length-1;r>=0;r--){let n=this.presets[r];if(n.presetNumber===t&&n.bank===e)return r}return-1}getPresetName(e){return this.presets?e<0||e>=this.presets.length?null:this.presets[e].name:null}bankGetPresetName(e,t){return this.getPresetName(this.getPresetIndex(e,t))}channelNoteOn(e,t,r){!this._channels||e>this._channels.channelList.length||(this._transpositionPitches.has(e)&&(t+=this._transpositionPitches.get(e)),this._channels.activeChannel=e,this.noteOn(this._channels.channelList[e].presetIndex,t,r))}channelNoteOff(e,t){this._transpositionPitches.has(e)&&(t+=this._transpositionPitches.get(e));const r=[];let n=null,s=null;for(const o of this._voices)o.playingPreset===-1||o.playingChannel!==e||o.playingKey!==t||o.ampEnv.segment>=it.Release||(!n||o.playIndex<n.playIndex?(n=o,s=o,r.push(o)):o.playIndex===n.playIndex&&(s=o,r.push(o)));if(this.channelInit(e).perNotePitchWheel.delete(t),!!n)for(const o of r)o!==n&&o!==s&&(o.playIndex!==n.playIndex||o.playingPreset===-1||o.playingChannel!==e||o.playingKey!==t||o.ampEnv.segment>=it.Release)||o.end(this.outSampleRate)}channelNoteOffAll(e){this.channelInit(e).perNotePitchWheel.clear();for(const r of this._voices)r.playingPreset!==-1&&r.playingChannel===e&&r.ampEnv.segment<it.Release&&r.end(this.outSampleRate)}channelSoundsOffAll(e){this.channelInit(e).perNotePitchWheel.clear();for(let r of this._voices)r.playingPreset!==-1&&r.playingChannel===e&&(r.ampEnv.segment<it.Release||r.ampEnv.parameters.release===0)&&r.endQuick(this.outSampleRate)}channelSetPresetIndex(e,t){this.channelInit(e).presetIndex=Ne.int32ToUint16(t)}channelSetPresetNumber(e,t,r=!1){const n=this.channelInit(e);let s=0;return r?(s=this.getPresetIndex(128|n.bank&32767,t),s===-1&&(s=this.getPresetIndex(128,t)),s===-1&&(s=this.getPresetIndex(128,0)),s===-1&&(s=this.getPresetIndex(n.bank&2047,t))):s=this.getPresetIndex(n.bank&2047,t),n.presetIndex=s,s!==-1}channelSetBank(e,t){this.channelInit(e).bank=Ne.int32ToUint16(t)}channelSetBankPreset(e,t,r){const n=this.channelInit(e),s=this.getPresetIndex(t,r);return s===-1?!1:(n.presetIndex=Ne.int32ToUint16(s),n.bank=Ne.int32ToUint16(t),!0)}channelSetPan(e,t){for(const r of this._voices)if(r.playingChannel===e&&r.playingPreset!==-1){let n=r.region.pan+t-.5;n<=-.5?(r.panFactorLeft=1,r.panFactorRight=0):n>=.5?(r.panFactorLeft=0,r.panFactorRight=1):(r.panFactorLeft=Math.sqrt(.5-n),r.panFactorRight=Math.sqrt(.5+n))}this.channelInit(e).panOffset=t-.5}channelSetVolume(e,t){const r=this.channelInit(e),n=Rt.gainToDecibels(t),s=n-r.gainDb;if(s!==0){for(const a of this._voices)a.playingChannel===e&&a.playingPreset!==-1&&(a.noteGainDb+=s);r.gainDb=n}}channelSetPitchWheel(e,t){const r=this.channelInit(e);r.pitchWheel!==t&&(r.pitchWheel=Ne.int32ToUint16(t),this.channelApplyPitch(e,r))}channelSetPerNotePitchWheel(e,t,r){this._transpositionPitches.has(e)&&(t+=this._transpositionPitches.get(e));const n=this.channelInit(e);n.perNotePitchWheel.has(t)&&n.perNotePitchWheel.get(t)===r||(n.perNotePitchWheel.set(t,r),this.channelApplyPitch(e,n,t))}channelApplyPitch(e,t,r=-1){for(const n of this._voices)n.playingChannel===e&&n.playingPreset!==-1&&(r==-1||n.playingKey===r)&&n.updatePitchRatio(t,this.outSampleRate)}channelSetPitchRange(e,t){const r=this.channelInit(e);r.pitchRange!==t&&(r.pitchRange=t,r.pitchWheel!==8192&&this.channelApplyPitch(e,r))}channelSetTuning(e,t){const r=this.channelInit(e);r.tuning!==t&&(r.tuning=t,this.channelApplyPitch(e,r))}channelMidiControl(e,t,r){let n=this.channelInit(e);switch(t){case Qe.DataEntryFine:n.midiData=Ne.int32ToUint16(n.midiData&16256|r),n.midiRpn===0?this.channelSetPitchRange(e,(n.midiData>>7)+.01*(n.midiData&127)):n.midiRpn===1?this.channelSetTuning(e,(n.tuning|0)+(n.midiData-8192)/8192):n.midiRpn===2&&this.channelSetTuning(e,r-64+(n.tuning-(n.tuning|0)));return;case Qe.VolumeCoarse:n.midiVolume=Ne.int32ToUint16(n.midiVolume&127|r<<7),this.channelSetVolume(e,Math.pow(n.midiVolume/16383*(n.midiExpression/16383),3));return;case Qe.VolumeFine:n.midiVolume=Ne.int32ToUint16(n.midiVolume&16256|r),this.channelSetVolume(e,Math.pow(n.midiVolume/16383*(n.midiExpression/16383),3));return;case Qe.ExpressionControllerCoarse:n.midiExpression=Ne.int32ToUint16(n.midiExpression&127|r<<7),this.channelSetVolume(e,Math.pow(n.midiVolume/16383*(n.midiExpression/16383),3));return;case Qe.ExpressionControllerFine:n.midiExpression=Ne.int32ToUint16(n.midiExpression&16256|r),this.channelSetVolume(e,Math.pow(n.midiVolume/16383*(n.midiExpression/16383),3));return;case Qe.PanCoarse:n.midiPan=Ne.int32ToUint16(n.midiPan&127|r<<7),this.channelSetPan(e,n.midiPan/16383);return;case Qe.PanFine:n.midiPan=Ne.int32ToUint16(n.midiPan&16256|r),this.channelSetPan(e,n.midiPan/16383);return;case Qe.DataEntryCoarse:n.midiData=Ne.int32ToUint16(n.midiData&127|r<<7),n.midiRpn===0?this.channelSetPitchRange(e,(n.midiData>>7)+.01*(n.midiData&127)):n.midiRpn===1?this.channelSetTuning(e,(n.tuning|0)+(n.midiData-8192)/8192):n.midiRpn===2&&t===Qe.DataEntryCoarse&&this.channelSetTuning(e,r-64+(n.tuning-(n.tuning|0)));return;case Qe.BankSelectCoarse:n.bank=Ne.int32ToUint16(32768|r);return;case Qe.BankSelectFine:n.bank=Ne.int32ToUint16((n.bank&32768?(n.bank&127)<<7:0)|r);return;case Qe.RegisteredParameterCourse:n.midiRpn=Ne.int32ToUint16((n.midiRpn===65535?0:n.midiRpn)&127|r<<7);return;case Qe.RegisteredParameterFine:n.midiRpn=Ne.int32ToUint16((n.midiRpn===65535?0:n.midiRpn)&16256|r);return;case Qe.NonRegisteredParameterFine:n.midiRpn=65535;return;case Qe.NonRegisteredParameterCourse:n.midiRpn=65535;return;case Qe.AllSoundOff:this.channelSoundsOffAll(e);return;case Qe.AllNotesOff:this.channelNoteOffAll(e);return;case Qe.ResetControllers:n.midiVolume=16383,n.midiExpression=16383,n.midiPan=8192,n.bank=0,this.channelSetVolume(e,1),this.channelSetPan(e,.5),this.channelSetPitchRange(e,2);return}}channelGetPresetIndex(e){return this._channels&&e<this._channels.channelList.length?this._channels.channelList[e].presetIndex:0}channelGetPresetBank(e){return this._channels&&e<this._channels.channelList.length?this._channels.channelList[e].bank&32767:0}channelGetPan(e){return this._channels&&e<this._channels.channelList.length?this._channels.channelList[e].panOffset-.5:.5}channelGetVolume(e){return this._channels&&e<this._channels.channelList.length?Rt.decibelsToGain(this._channels.channelList[e].gainDb):1}channelGetPitchWheel(e){return this._channels&&e<this._channels.channelList.length?this._channels.channelList[e].pitchWheel:8192}channelGetPitchRange(e){return this._channels&&e<this._channels.channelList.length?this._channels.channelList[e].pitchRange:2}channelGetTuning(e){return this._channels&&e<this._channels.channelList.length?this._channels.channelList[e].tuning:0}resetPresets(){this.presets=[]}loadPresets(e,t){const r=[];for(let n=0;n<e.phdrs.length-1;n++){const s=e.phdrs[n];let a=0;const o=new sU;r.push(o),o.name=s.presetName,o.bank=s.bank,o.presetNumber=s.preset,o.fontSamples=e.fontSamples;let l=0;for(let c=s.presetBagNdx;c<e.phdrs[n+1].presetBagNdx;c++){const h=e.pbags[c];let d=0,f=127,p=0,g=127;for(let y=h.genNdx;y<e.pbags[c+1].genNdx;y++){let b=e.pgens[y];if(b.genOper===or.GenKeyRange){d=b.genAmount.lowByteAmount,f=b.genAmount.highByteAmount;continue}if(b.genOper===or.GenVelRange){p=b.genAmount.lowByteAmount,g=b.genAmount.highByteAmount;continue}if(b.genOper!==or.GenInstrument||b.genAmount.wordAmount>=e.insts.length)continue;let m=e.insts[b.genAmount.wordAmount];for(let v=m.instBagNdx;v<e.insts[b.genAmount.wordAmount+1].instBagNdx;v++){let k=e.ibags[v],x=0,C=127,N=0,B=127;for(let E=k.instGenNdx;E<e.ibags[v+1].instGenNdx;E++){let O=e.igens[E];if(O.genOper===or.GenKeyRange){x=O.genAmount.lowByteAmount,C=O.genAmount.highByteAmount;continue}if(O.genOper===or.GenVelRange){N=O.genAmount.lowByteAmount,B=O.genAmount.highByteAmount;continue}O.genOper===53&&C>=d&&x<=f&&B>=p&&N<=g&&l++}}}}o.regions=new Array(l);let u=new fo;u.clear(!0);for(let c=s.presetBagNdx;c<e.phdrs[n+1].presetBagNdx;c++){const h=e.pbags[c],d=new fo(u);let f=!1;for(let p=h.genNdx;p<e.pbags[c+1].genNdx;p++){const g=e.pgens[p];if(g.genOper===or.GenInstrument){let y=g.genAmount.wordAmount;if(y>=e.insts.length)continue;let b=new fo;b.clear(!1);let m=e.insts[y];for(let v=m.instBagNdx;v<e.insts[y+1].instBagNdx;v++){let k=e.ibags[v],x=new fo(b),C=!1;for(let N=k.instGenNdx;N<e.ibags[v+1].instGenNdx;N++){let B=e.igens[N];if(B.genOper===or.GenSampleId){if(x.hiKey<d.loKey||x.loKey>d.hiKey||x.hiVel<d.loVel||x.loVel>d.hiVel)continue;d.loKey>x.loKey&&(x.loKey=d.loKey),d.hiKey<x.hiKey&&(x.hiKey=d.hiKey),d.loVel>x.loVel&&(x.loVel=d.loVel),d.hiVel<x.hiVel&&(x.hiVel=d.hiVel),x.offset+=d.offset,x.end+=d.end,x.loopStart+=d.loopStart,x.loopEnd+=d.loopEnd,x.transpose+=d.transpose,x.tune+=d.tune,x.pitchKeyTrack+=d.pitchKeyTrack,x.attenuation+=d.attenuation,x.pan+=d.pan,x.ampEnv.delay+=d.ampEnv.delay,x.ampEnv.attack+=d.ampEnv.attack,x.ampEnv.hold+=d.ampEnv.hold,x.ampEnv.decay+=d.ampEnv.decay,x.ampEnv.sustain+=d.ampEnv.sustain,x.ampEnv.release+=d.ampEnv.release,x.modEnv.delay+=d.modEnv.delay,x.modEnv.attack+=d.modEnv.attack,x.modEnv.hold+=d.modEnv.hold,x.modEnv.decay+=d.modEnv.decay,x.modEnv.sustain+=d.modEnv.sustain,x.modEnv.release+=d.modEnv.release,x.initialFilterQ+=d.initialFilterQ,x.initialFilterFc+=d.initialFilterFc,x.modEnvToPitch+=d.modEnvToPitch,x.modEnvToFilterFc+=d.modEnvToFilterFc,x.delayModLFO+=d.delayModLFO,x.freqModLFO+=d.freqModLFO,x.modLfoToPitch+=d.modLfoToPitch,x.modLfoToFilterFc+=d.modLfoToFilterFc,x.modLfoToVolume+=d.modLfoToVolume,x.delayVibLFO+=d.delayVibLFO,x.freqVibLFO+=d.freqVibLFO,x.vibLfoToPitch+=d.vibLfoToPitch,x.ampEnv.envToSecs(!0),x.modEnv.envToSecs(!1),x.delayModLFO=x.delayModLFO<-11950?0:Rt.timecents2Secs(x.delayModLFO),x.delayVibLFO=x.delayVibLFO<-11950?0:Rt.timecents2Secs(x.delayVibLFO),x.pan<-.5?x.pan=-.5:x.pan>.5&&(x.pan=.5),(x.initialFilterQ<1500||x.initialFilterQ>13500)&&(x.initialFilterQ=0);let E=e.sHdrs[B.genAmount.wordAmount];x.offset+=E.start,x.end+=E.end,x.loopStart+=E.startLoop,x.loopEnd+=E.endLoop,E.endLoop>0&&(x.loopEnd-=1),x.pitchKeyCenter===-1&&(x.pitchKeyCenter=E.originalPitch),x.tune+=E.pitchCorrection,x.sampleRate=E.sampleRate,x.end!==0&&x.end<o.fontSamples.length?x.end++:x.end=o.fontSamples.length,o.regions[a]=new fo(x),a++,C=!0}else x.operator(B.genOper,B.genAmount)}k===e.ibags[m.instBagNdx]&&!C&&(b=new fo(x))}f=!0}else d.operator(g.genOper,g.genAmount)}h===e.pbags[s.presetBagNdx]&&!f&&(u=d)}}if(!t||!this.presets)this.presets=r;else for(const n of r)this.presets.push(n)}}let ei=class{constructor(){this._listeners=[]}on(e){this._listeners.push(e)}off(e){this._listeners=this._listeners.filter(t=>t!==e)}trigger(){for(const e of this._listeners)e()}};class Fe{constructor(){this._listeners=[]}on(e){this._listeners.push(e)}off(e){this._listeners=this._listeners.filter(t=>t!==e)}trigger(e){for(const t of this._listeners)t(e)}}class W1{constructor(e){this.events=e}}class G1{constructor(e){this.playbackRange=e}}class RB{get isReadyForPlayback(){return this.isReady&&this._isSoundFontLoaded&&this._isMidiLoaded}get logLevel(){return V.logLevel}set logLevel(e){V.logLevel=e}get masterVolume(){return this._synthesizer.masterVolume}set masterVolume(e){e=Math.max(e,Te.MinVolume),this._synthesizer.masterVolume=e}get metronomeVolume(){return this._metronomeVolume}set metronomeVolume(e){e=Math.max(e,Te.MinVolume),this._metronomeVolume=e,this._synthesizer.metronomeVolume=e}get countInVolume(){return this._countInVolume}set countInVolume(e){e=Math.max(e,Te.MinVolume),this._countInVolume=e}get midiEventsPlayedFilter(){return Array.from(this._midiEventsPlayedFilter)}set midiEventsPlayedFilter(e){this._midiEventsPlayedFilter=new Set(e)}get playbackSpeed(){return this._sequencer.playbackSpeed}set playbackSpeed(e){e=Rt.clamp(e,Te.MinPlaybackSpeed,Te.MaxPlaybackSpeed);let t=this._sequencer.playbackSpeed;this._sequencer.playbackSpeed=e,this.timePosition=this.timePosition*(t/e)}get tickPosition(){return this._tickPosition}set tickPosition(e){this.timePosition=this._sequencer.mainTickPositionToTimePosition(e)}get timePosition(){return this._timePosition}set timePosition(e){V.debug("AlphaSynth",`Seeking to position ${e}ms (main)`),this._sequencer.mainSeek(e),this.updateTimePosition(e,!0),this._sequencer.isPlayingMain&&(this._notPlayedSamples=0,this.output.resetSamples())}get playbackRange(){return this._sequencer.mainPlaybackRange}set playbackRange(e){this._sequencer.mainPlaybackRange=e,e&&(this.tickPosition=e.startTick),this.playbackRangeChanged.trigger(new G1(e))}get isLooping(){return this._sequencer.isLooping}set isLooping(e){this._sequencer.isLooping=e}destroy(){V.debug("AlphaSynth","Destroying player"),this.stop(),this.output.destroy()}constructor(e,t){this._isSoundFontLoaded=!1,this._isMidiLoaded=!1,this._tickPosition=0,this._timePosition=0,this._metronomeVolume=0,this._countInVolume=0,this._playedEventsQueue=new w0,this._midiEventsPlayedFilter=new Set,this._notPlayedSamples=0,this._synthStopping=!1,this.isReady=!1,this.state=Wt.Paused,this.ready=new ei,this.readyForPlayback=new ei,this.finished=new ei,this.soundFontLoaded=new ei,this.soundFontLoadFailed=new Fe,this.midiLoaded=new Fe,this.midiLoadFailed=new Fe,this.stateChanged=new Fe,this.positionChanged=new Fe,this.midiEventsPlayed=new Fe,this.playbackRangeChanged=new Fe,V.debug("AlphaSynth","Initializing player"),this.state=Wt.Paused,V.debug("AlphaSynth","Creating output"),this.output=e,V.debug("AlphaSynth","Creating synthesizer"),this._synthesizer=new aU(this.output.sampleRate),this._sequencer=new iU(this._synthesizer),V.debug("AlphaSynth","Opening output"),this.output.ready.on(()=>{this.isReady=!0,this.ready.trigger(),this.checkReadyForPlayback()}),this.output.sampleRequest.on(()=>{if(this.state==Wt.Playing&&(!this._sequencer.isFinished||this._synthesizer.activeVoiceCount>0)){let r=new Float32Array(Te.MicroBufferSize*Te.MicroBufferCount*Te.AudioChannels),n=0;for(let s=0;s<Te.MicroBufferCount;s++){this._sequencer.fillMidiEventQueue();const a=this._synthesizer.synthesize(r,n,Te.MicroBufferSize);n+=Te.MicroBufferSize*Te.AudioChannels;for(const o of a)this._midiEventsPlayedFilter.has(o.event.type)&&this._playedEventsQueue.enqueue(o);if(this._sequencer.isFinished)break}n<r.length&&(r=r.subarray(0,n)),this._notPlayedSamples+=r.length,this.output.addSamples(r)}else{let r=new Float32Array(0);this.output.addSamples(r)}}),this.output.samplesPlayed.on(this.onSamplesPlayed.bind(this)),this.output.open(t)}play(){return this.state!==Wt.Paused||!this._isMidiLoaded?!1:(this.output.activate(),this.playInternal(),this._countInVolume>0&&(V.debug("AlphaSynth","Starting countin"),this._sequencer.startCountIn(),this._synthesizer.setupMetronomeChannel(this._countInVolume),this.updateTimePosition(0,!0)),this.output.play(),!0)}playInternal(){this._sequencer.isPlayingOneTimeMidi&&(V.debug("AlphaSynth","Cancelling one time midi"),this.stopOneTimeMidi()),V.debug("AlphaSynth","Starting playback"),this._synthesizer.setupMetronomeChannel(this.metronomeVolume),this._synthStopping=!1,this.state=Wt.Playing,this.stateChanged.trigger(new lu(this.state,!1))}pause(){this.state===Wt.Paused||!this._isMidiLoaded||(V.debug("AlphaSynth","Pausing playback"),this.state=Wt.Paused,this.stateChanged.trigger(new lu(this.state,!1)),this.output.pause(),this._synthesizer.noteOffAll(!1))}playPause(){this.state!==Wt.Paused||!this._isMidiLoaded?this.pause():this.play()}stop(){this._isMidiLoaded&&(V.debug("AlphaSynth","Stopping playback"),this.state=Wt.Paused,this.output.pause(),this._notPlayedSamples=0,this._sequencer.stop(),this._synthesizer.noteOffAll(!0),this.tickPosition=this._sequencer.mainPlaybackRange?this._sequencer.mainPlaybackRange.startTick:0,this.stateChanged.trigger(new lu(this.state,!0)))}playOneTimeMidiFile(e){this._sequencer.isPlayingOneTimeMidi?this.stopOneTimeMidi():this.pause(),this._sequencer.loadOneTimeMidi(e),this._synthesizer.noteOffAll(!0),this.updateTimePosition(0,!0),this._notPlayedSamples=0,this.output.resetSamples(),this.output.play()}resetSoundFonts(){this.stop(),this._synthesizer.resetPresets(),this._isSoundFontLoaded=!1,this.soundFontLoaded.trigger()}loadSoundFont(e,t){this.pause();let r=ni.fromBuffer(e);try{V.debug("AlphaSynth","Loading soundfont from bytes");let n=new U1;n.load(r),this._synthesizer.loadPresets(n,t),this._isSoundFontLoaded=!0,this.soundFontLoaded.trigger(),V.debug("AlphaSynth","soundFont successfully loaded"),this.checkReadyForPlayback()}catch(n){V.error("AlphaSynth","Could not load soundfont from bytes "+n),this.soundFontLoadFailed.trigger(n)}}checkReadyForPlayback(){this.isReadyForPlayback&&(this._synthesizer.setupMetronomeChannel(this.metronomeVolume),this.readyForPlayback.trigger())}loadMidiFile(e){this.stop();try{V.debug("AlphaSynth","Loading midi from model"),this._sequencer.loadMidi(e),this._isMidiLoaded=!0,this.midiLoaded.trigger(new Uu(0,this._sequencer.currentEndTime,0,this._sequencer.currentEndTick,!1)),V.debug("AlphaSynth","Midi successfully loaded"),this.checkReadyForPlayback(),this.tickPosition=0}catch(t){V.error("AlphaSynth","Could not load midi from model "+t),this.midiLoadFailed.trigger(t)}}applyTranspositionPitches(e){this._synthesizer.applyTranspositionPitches(e)}setChannelMute(e,t){this._synthesizer.channelSetMute(e,t)}resetChannelStates(){this._synthesizer.resetChannelStates()}setChannelSolo(e,t){this._synthesizer.channelSetSolo(e,t)}setChannelVolume(e,t){t=Math.max(t,Te.MinVolume),this._synthesizer.channelSetMixVolume(e,t)}onSamplesPlayed(e){if(e===0)return;let t=e/this._synthesizer.outSampleRate*1e3;this._notPlayedSamples-=e*Te.AudioChannels,this.updateTimePosition(this._timePosition+t,!1),this.checkForFinish()}checkForFinish(){let e=0,t=0;this.playbackRange&&this._sequencer.isPlayingMain?(e=this.playbackRange.startTick,t=this.playbackRange.endTick):t=this._sequencer.currentEndTick,this._tickPosition>=t&&this._notPlayedSamples<=0&&(this._notPlayedSamples=0,this._sequencer.isPlayingCountIn?(V.debug("AlphaSynth","Finished playback (count-in)"),this._sequencer.resetCountIn(),this.timePosition=this._sequencer.currentTime,this.playInternal(),this.output.resetSamples()):this._sequencer.isPlayingOneTimeMidi?(V.debug("AlphaSynth","Finished playback (one time)"),this.output.resetSamples(),this.state=Wt.Paused,this.stopOneTimeMidi()):this.isLooping?(V.debug("AlphaSynth","Finished playback (main looping)"),this.finished.trigger(),this.tickPosition=e,this._synthStopping=!1):this._synthesizer.activeVoiceCount>0?this._synthStopping||(this._synthesizer.noteOffAll(!0),this._synthStopping=!0):(this._synthStopping=!1,V.debug("AlphaSynth","Finished playback (main)"),this.finished.trigger(),this.stop()))}stopOneTimeMidi(){this.output.pause(),this._synthesizer.noteOffAll(!0),this._sequencer.resetOneTimeMidi(),this.timePosition=this._sequencer.currentTime}updateTimePosition(e,t){let r=e;this._timePosition=r;let n=this._sequencer.currentTimePositionToTickPosition(r);this._tickPosition=n;const s=this._sequencer.currentEndTime,a=this._sequencer.currentEndTick;r>s&&(r=s,n=a);const o=this._sequencer.isPlayingMain?"main":this._sequencer.isPlayingCountIn?"count-in":"one-time";if(V.debug("AlphaSynth",`Position changed: (time: ${r}/${s}, tick: ${n}/${a}, Active Voices: ${this._synthesizer.activeVoiceCount} (${o})`),this._sequencer.isPlayingMain&&this.positionChanged.trigger(new Uu(r,s,n,a,t)),t)this._playedEventsQueue.clear();else{const l=new w0;for(;!this._playedEventsQueue.isEmpty&&this._playedEventsQueue.peek().time<r;){const u=this._playedEventsQueue.dequeue();l.enqueue(u.event)}l.isEmpty||this.midiEventsPlayed.trigger(new W1(l.toArray()))}}}class j{static parseEnum(e,t){switch(typeof e){case"string":const r=parseInt(e);return isNaN(r)?t[Object.keys(t).find(n=>n.toLowerCase()===e.toLowerCase())]:r;case"number":return e;case"undefined":case"object":return null}throw new oi(ai.Format,`Could not parse enum value '${e}'`)}static forEach(e,t){if(e instanceof Map)e.forEach(t);else if(typeof e=="object")for(const r in e)t(e[r],r)}static getValue(e,t){return e instanceof Map?e.get(t):typeof e=="object"?e[t]:null}}class oU{constructor(e,t,r){this.text=e,this.startPos=t,this.endPos=r}}class Mo{constructor(e){this.style="normal",this.variant="normal",this.weight="normal",this.stretch="normal",this.lineHeight="normal",this.size="1rem",this.families=[],this.parseOnlyFamilies=!1,this._currentTokenIndex=-1,this._input="",this._currentToken=null,this._input=e,this._tokens=this.splitToTokens(e)}splitToTokens(e){const t=[];let r=0;for(;r<e.length;){let n=r;for(;n<e.length&&e.charAt(n)!==" ";)n++;n>r&&t.push(new oU(e.substring(r,n),r,n)),r=n+1}return t}parse(){var e;if(this.reset(),this._tokens.length===1)switch((e=this._currentToken)==null?void 0:e.text){case"caption":case"icon":case"menu":case"message-box":case"small-caption":case"status-bar":case"inherit":return}this.parseOnlyFamilies||(this.fontStyleVariantWeight(),this.fontSizeLineHeight()),this.fontFamily()}static parseFamilies(e){const t=new Mo(e);return t.parseOnlyFamilies=!0,t.parse(),t.families}fontFamily(){if(!this._currentToken){if(this.parseOnlyFamilies)return;throw new Error("Missing font list")}const e=this._input.substr(this._currentToken.startPos).trim();let t=0;for(;t<e.length;){let r=e.charAt(t);if(r===" "||r==",")t++;else if(r==='"'||r==="'"){const n=this.findEndOfQuote(e,t+1,r);this.families.push(e.substring(t+1,n).split("\\"+r).join(r)),t=n+1}else{const n=this.findEndOfQuote(e,t+1,",");this.families.push(e.substring(t,n).trim()),t=n+1}}}findEndOfQuote(e,t,r){let n=!1;for(;t<e.length;){const s=e.charAt(t);if(!n&&s===r)return t;!n&&s==="\\"?n=!0:n=!1,t+=1}return e.length}fontSizeLineHeight(){if(!this._currentToken)throw new Error("Missing font size");const e=this._currentToken.text.split("/");if(e.length>=3)throw new Error(`Invalid font size '${this._currentToken}' specified`);if(this.nextToken(),e.length>=2)if(e[1]==="/"){if(!this._currentToken)throw new Error("Missing line-height after font size");this.lineHeight=this._currentToken.text,this.nextToken()}else this.size=e[0],this.lineHeight=e[1];else if(e.length>=1){if(this.size=e[0],this._currentToken&&this._currentToken.text.indexOf("/")===0)if(this._currentToken.text==="/"){if(this.nextToken(),!this._currentToken)throw new Error("Missing line-height after font size");this.lineHeight=this._currentToken.text,this.nextToken()}else this.lineHeight=this._currentToken.text.substr(1),this.nextToken()}else throw new Error("Missing font size")}nextToken(){this._currentTokenIndex++,this._currentTokenIndex<this._tokens.length?this._currentToken=this._tokens[this._currentTokenIndex]:this._currentToken=null}fontStyleVariantWeight(){let e=!1,t=!1,r=!1,n=3,s=[];for(;;){if(!this._currentToken)return;let a=this._currentToken.text;switch(a){case"normal":case"inherit":s.push(a),n--,this.nextToken();break;case"italic":case"oblique":this.style=a,e=!0,n--,this.nextToken();break;case"small-caps":this.variant=a,t=!0,n--,this.nextToken();break;case"bold":case"bolder":case"lighter":case"100":case"200":case"300":case"400":case"500":case"600":case"700":case"800":case"900":this.weight=a,r=!0,n--,this.nextToken();break;default:return}if(n===0)break}for(;s.length>0;){const a=s.pop();r?t?e||(this.style=a):this.variant=a:this.weight=a}}reset(){this._currentTokenIndex=-1,this.nextToken()}static quoteFont(e){return e.indexOf(" ")===-1?e:`"${e.replaceAll('"','\\"')}"`}}var St;(function(i){i[i.Plain=0]="Plain",i[i.Italic=1]="Italic"})(St||(St={}));var cr;(function(i){i[i.Regular=0]="Regular",i[i.Bold=1]="Bold"})(cr||(cr={}));class He{reset(){this._cssScale=0,this._css=this.toCssString()}get family(){return this._families[0]}set family(e){this.families=Mo.parseFamilies(e)}get families(){return this._families}set families(e){this._families=e,this.reset()}get size(){return this._size}set size(e){this._size=e,this.reset()}get style(){return this._style}set style(e){this._style=e,this.reset()}get weight(){return this._weight}set weight(e){this._weight=e,this.reset()}get isBold(){return this.weight===cr.Bold}get isItalic(){return this.style===St.Italic}constructor(e,t,r=St.Plain,n=cr.Regular){this._cssScale=0,this._families=Mo.parseFamilies(e),this._size=t,this._style=r,this._weight=n,this._css=this.toCssString()}static withFamilyList(e,t,r=St.Plain,n=cr.Regular){const s=new He("",t,r,n);return s.families=e,s}toCssString(e=1){if(!this._css||!(Math.abs(e-this._cssScale)<.01)){let t="";this.isBold&&(t+="bold "),this.isItalic&&(t+="italic "),t+=this.size*e,t+="px ",t+=this.families.map(r=>Mo.quoteFont(r)).join(", "),this._css=t,this._cssScale=e}return this._css}static fromJson(e){if(e instanceof He)return e;switch(typeof e){case"undefined":return null;case"object":{const t=e;let r=t.get("families"),n=t.get("size"),s=j.parseEnum(t.get("style"),St),a=j.parseEnum(t.get("weight"),cr);return He.withFamilyList(r,n,s,a)}case"string":{const t=new Mo(e);t.parse();let r=t.families,n=t.size.toLowerCase(),s=0;switch(n){case"xx-small":s=7;break;case"x-small":s=10;break;case"small":case"smaller":s=13;break;case"medium":s=16;break;case"large":case"larger":s=18;break;case"x-large":s=24;break;case"xx-large":s=32;break;default:try{n.endsWith("em")?s=parseFloat(n.substr(0,n.length-2))*16:n.endsWith("pt")?s=parseFloat(n.substr(0,n.length-2))*16/12:n.endsWith("px")?s=parseFloat(n.substr(0,n.length-2)):s=12}catch{s=12}break}let a=St.Plain;t.style==="italic"&&(a=St.Italic);let o=cr.Regular;switch(t.weight.toLowerCase()){case"normal":case"lighter":break;default:o=cr.Bold;break}return He.withFamilyList(r,s,a,o)}default:return null}}static toJson(e){const t=new Map;return t.set("families",e.families),t.set("size",e.size),t.set("style",e.style),t.set("weight",e.weight),t}}class Ki{constructor(){this.copyrightFont=new He(Ki.sansFont,12,St.Plain,cr.Bold),this.titleFont=new He(Ki.serifFont,32,St.Plain),this.subTitleFont=new He(Ki.serifFont,20,St.Plain),this.wordsFont=new He(Ki.serifFont,15,St.Plain),this.effectFont=new He(Ki.serifFont,12,St.Italic),this.fretboardNumberFont=new He(Ki.sansFont,11,St.Plain),this.tablatureFont=new He(Ki.sansFont,13,St.Plain),this.graceFont=new He(Ki.sansFont,11,St.Plain),this.staffLineColor=new qe(165,165,165,255),this.barSeparatorColor=new qe(34,34,17,255),this.barNumberFont=new He(Ki.sansFont,11,St.Plain),this.barNumberColor=new qe(200,0,0,255),this.fingeringFont=new He(Ki.serifFont,14,St.Plain),this.markerFont=new He(Ki.serifFont,14,St.Plain,cr.Bold),this.mainGlyphColor=new qe(0,0,0,255),this.secondaryGlyphColor=new qe(0,0,0,100),this.scoreInfoColor=new qe(0,0,0,255)}}Ki.sansFont="Arial, sans-serif";Ki.serifFont="Georgia, serif";var fa;(function(i){i[i.Automatic=0]="Automatic",i[i.UseModelLayout=1]="UseModelLayout"})(fa||(fa={}));class lU{constructor(){this.scale=1,this.stretchForce=1,this.layoutMode=ps.Page,this.staveProfile=ur.Default,this.barsPerRow=-1,this.startBar=1,this.barCount=-1,this.barCountPerPartial=10,this.justifyLastSystem=!1,this.resources=new Ki,this.padding=[35,35],this.firstSystemPaddingTop=5,this.systemPaddingTop=10,this.systemPaddingBottom=20,this.lastSystemPaddingBottom=0,this.systemLabelPaddingLeft=0,this.systemLabelPaddingRight=5,this.accoladeBarPaddingRight=3,this.notationStaffPaddingTop=5,this.notationStaffPaddingBottom=5,this.effectStaffPaddingTop=0,this.effectStaffPaddingBottom=0,this.systemsLayoutMode=fa.Automatic}}class uU{constructor(){this.encoding="utf-8",this.mergePartGroupsInMusicXml=!1,this.beatTextAsLyrics=!1}}var as;(function(i){i[i.Off=0]="Off",i[i.Continuous=1]="Continuous",i[i.OffScreen=2]="OffScreen"})(as||(as={}));class cU{constructor(){this.noteWideLength=480,this.noteWideAmplitude=2,this.noteSlightLength=480,this.noteSlightAmplitude=2,this.beatWideLength=240,this.beatWideAmplitude=3,this.beatSlightLength=240,this.beatSlightAmplitude=3}}class hU{constructor(){this.simpleSlidePitchOffset=6,this.simpleSlideDurationRatio=.25,this.shiftSlideDurationRatio=.5}}var $u;(function(i){i[i.WebAudioAudioWorklets=0]="WebAudioAudioWorklets",i[i.WebAudioScriptProcessor=1]="WebAudioScriptProcessor"})($u||($u={}));class dU{constructor(){this.soundFont=null,this.scrollElement="html,body",this.outputMode=$u.WebAudioAudioWorklets,this.enablePlayer=!1,this.enableCursor=!0,this.enableAnimatedBeatCursor=!0,this.enableElementHighlighting=!0,this.enableUserInteraction=!0,this.scrollOffsetX=0,this.scrollOffsetY=0,this.scrollMode=as.Continuous,this.scrollSpeed=300,this.nativeBrowserSmoothScroll=!0,this.songBookBendDuration=75,this.songBookDipDuration=150,this.vibrato=new cU,this.slide=new hU,this.playTripletFeel=!0,this.bufferTimeInMilliseconds=500}}class mg{static fromJson(e,t){t&&j.forEach(t,(r,n)=>this.setProperty(e,n.toLowerCase(),r))}static toJson(e){if(!e)return null;const t=new Map;return t.set("scriptfile",e.scriptFile),t.set("fontdirectory",e.fontDirectory),t.set("file",e.file),t.set("tex",e.tex),t.set("tracks",e.tracks),t.set("enablelazyloading",e.enableLazyLoading),t.set("engine",e.engine),t.set("loglevel",e.logLevel),t.set("useworkers",e.useWorkers),t.set("includenotebounds",e.includeNoteBounds),t}static setProperty(e,t,r){switch(t){case"scriptfile":return e.scriptFile=r,!0;case"fontdirectory":return e.fontDirectory=r,!0;case"file":return e.file=r,!0;case"tex":return e.tex=r,!0;case"tracks":return e.tracks=r,!0;case"enablelazyloading":return e.enableLazyLoading=r,!0;case"engine":return e.engine=r,!0;case"loglevel":return e.logLevel=j.parseEnum(r,xn),!0;case"useworkers":return e.useWorkers=r,!0;case"includenotebounds":return e.includeNoteBounds=r,!0}return!1}}class yg{static fromJson(e,t){t&&j.forEach(t,(r,n)=>this.setProperty(e,n.toLowerCase(),r))}static toJson(e){if(!e)return null;const t=new Map;return t.set("copyrightfont",He.toJson(e.copyrightFont)),t.set("titlefont",He.toJson(e.titleFont)),t.set("subtitlefont",He.toJson(e.subTitleFont)),t.set("wordsfont",He.toJson(e.wordsFont)),t.set("effectfont",He.toJson(e.effectFont)),t.set("fretboardnumberfont",He.toJson(e.fretboardNumberFont)),t.set("tablaturefont",He.toJson(e.tablatureFont)),t.set("gracefont",He.toJson(e.graceFont)),t.set("stafflinecolor",qe.toJson(e.staffLineColor)),t.set("barseparatorcolor",qe.toJson(e.barSeparatorColor)),t.set("barnumberfont",He.toJson(e.barNumberFont)),t.set("barnumbercolor",qe.toJson(e.barNumberColor)),t.set("fingeringfont",He.toJson(e.fingeringFont)),t.set("markerfont",He.toJson(e.markerFont)),t.set("mainglyphcolor",qe.toJson(e.mainGlyphColor)),t.set("secondaryglyphcolor",qe.toJson(e.secondaryGlyphColor)),t.set("scoreinfocolor",qe.toJson(e.scoreInfoColor)),t}static setProperty(e,t,r){switch(t){case"copyrightfont":return e.copyrightFont=He.fromJson(r),!0;case"titlefont":return e.titleFont=He.fromJson(r),!0;case"subtitlefont":return e.subTitleFont=He.fromJson(r),!0;case"wordsfont":return e.wordsFont=He.fromJson(r),!0;case"effectfont":return e.effectFont=He.fromJson(r),!0;case"fretboardnumberfont":return e.fretboardNumberFont=He.fromJson(r),!0;case"tablaturefont":return e.tablatureFont=He.fromJson(r),!0;case"gracefont":return e.graceFont=He.fromJson(r),!0;case"stafflinecolor":return e.staffLineColor=qe.fromJson(r),!0;case"barseparatorcolor":return e.barSeparatorColor=qe.fromJson(r),!0;case"barnumberfont":return e.barNumberFont=He.fromJson(r),!0;case"barnumbercolor":return e.barNumberColor=qe.fromJson(r),!0;case"fingeringfont":return e.fingeringFont=He.fromJson(r),!0;case"markerfont":return e.markerFont=He.fromJson(r),!0;case"mainglyphcolor":return e.mainGlyphColor=qe.fromJson(r),!0;case"secondaryglyphcolor":return e.secondaryGlyphColor=qe.fromJson(r),!0;case"scoreinfocolor":return e.scoreInfoColor=qe.fromJson(r),!0}return!1}}class bg{static fromJson(e,t){t&&j.forEach(t,(r,n)=>this.setProperty(e,n.toLowerCase(),r))}static toJson(e){if(!e)return null;const t=new Map;return t.set("scale",e.scale),t.set("stretchforce",e.stretchForce),t.set("layoutmode",e.layoutMode),t.set("staveprofile",e.staveProfile),t.set("barsperrow",e.barsPerRow),t.set("startbar",e.startBar),t.set("barcount",e.barCount),t.set("barcountperpartial",e.barCountPerPartial),t.set("justifylastsystem",e.justifyLastSystem),t.set("resources",yg.toJson(e.resources)),t.set("padding",e.padding),t.set("firstsystempaddingtop",e.firstSystemPaddingTop),t.set("systempaddingtop",e.systemPaddingTop),t.set("systempaddingbottom",e.systemPaddingBottom),t.set("lastsystempaddingbottom",e.lastSystemPaddingBottom),t.set("systemlabelpaddingleft",e.systemLabelPaddingLeft),t.set("systemlabelpaddingright",e.systemLabelPaddingRight),t.set("accoladebarpaddingright",e.accoladeBarPaddingRight),t.set("notationstaffpaddingtop",e.notationStaffPaddingTop),t.set("notationstaffpaddingbottom",e.notationStaffPaddingBottom),t.set("effectstaffpaddingtop",e.effectStaffPaddingTop),t.set("effectstaffpaddingbottom",e.effectStaffPaddingBottom),t.set("systemslayoutmode",e.systemsLayoutMode),t}static setProperty(e,t,r){switch(t){case"scale":return e.scale=r,!0;case"stretchforce":return e.stretchForce=r,!0;case"layoutmode":return e.layoutMode=j.parseEnum(r,ps),!0;case"staveprofile":return e.staveProfile=j.parseEnum(r,ur),!0;case"barsperrow":return e.barsPerRow=r,!0;case"startbar":return e.startBar=r,!0;case"barcount":return e.barCount=r,!0;case"barcountperpartial":return e.barCountPerPartial=r,!0;case"justifylastsystem":return e.justifyLastSystem=r,!0;case"padding":return e.padding=r,!0;case"firstsystempaddingtop":return e.firstSystemPaddingTop=r,!0;case"systempaddingtop":return e.systemPaddingTop=r,!0;case"systempaddingbottom":return e.systemPaddingBottom=r,!0;case"lastsystempaddingbottom":return e.lastSystemPaddingBottom=r,!0;case"systemlabelpaddingleft":return e.systemLabelPaddingLeft=r,!0;case"systemlabelpaddingright":return e.systemLabelPaddingRight=r,!0;case"accoladebarpaddingright":return e.accoladeBarPaddingRight=r,!0;case"notationstaffpaddingtop":return e.notationStaffPaddingTop=r,!0;case"notationstaffpaddingbottom":return e.notationStaffPaddingBottom=r,!0;case"effectstaffpaddingtop":return e.effectStaffPaddingTop=r,!0;case"effectstaffpaddingbottom":return e.effectStaffPaddingBottom=r,!0;case"systemslayoutmode":return e.systemsLayoutMode=j.parseEnum(r,fa),!0}if(["resources"].indexOf(t)>=0)return yg.fromJson(e.resources,r),!0;for(const n of["resources"])if(t.indexOf(n)===0&&yg.setProperty(e.resources,t.substring(n.length),r))return!0;return!1}}class vg{static fromJson(e,t){t&&j.forEach(t,(r,n)=>this.setProperty(e,n.toLowerCase(),r))}static toJson(e){if(!e)return null;const t=new Map;t.set("notationmode",e.notationMode),t.set("fingeringmode",e.fingeringMode);{const r=new Map;t.set("elements",r);for(const[n,s]of e.elements)r.set(n.toString(),s)}return t.set("rhythmmode",e.rhythmMode),t.set("rhythmheight",e.rhythmHeight),t.set("transpositionpitches",e.transpositionPitches),t.set("displaytranspositionpitches",e.displayTranspositionPitches),t.set("smallgracetabnotes",e.smallGraceTabNotes),t.set("extendbendarrowsontiednotes",e.extendBendArrowsOnTiedNotes),t.set("extendlineeffectstobeatend",e.extendLineEffectsToBeatEnd),t.set("slurheight",e.slurHeight),t}static setProperty(e,t,r){switch(t){case"notationmode":return e.notationMode=j.parseEnum(r,Zt),!0;case"fingeringmode":return e.fingeringMode=j.parseEnum(r,En),!0;case"elements":return e.elements=new Map,j.forEach(r,(n,s)=>{e.elements.set(j.parseEnum(s,pe),n)}),!0;case"rhythmmode":return e.rhythmMode=j.parseEnum(r,cs),!0;case"rhythmheight":return e.rhythmHeight=r,!0;case"transpositionpitches":return e.transpositionPitches=r,!0;case"displaytranspositionpitches":return e.displayTranspositionPitches=r,!0;case"smallgracetabnotes":return e.smallGraceTabNotes=r,!0;case"extendbendarrowsontiednotes":return e.extendBendArrowsOnTiedNotes=r,!0;case"extendlineeffectstobeatend":return e.extendLineEffectsToBeatEnd=r,!0;case"slurheight":return e.slurHeight=r,!0}return!1}}class wg{static fromJson(e,t){t&&j.forEach(t,(r,n)=>this.setProperty(e,n.toLowerCase(),r))}static toJson(e){if(!e)return null;const t=new Map;return t.set("encoding",e.encoding),t.set("mergepartgroupsinmusicxml",e.mergePartGroupsInMusicXml),t.set("beattextaslyrics",e.beatTextAsLyrics),t}static setProperty(e,t,r){switch(t){case"encoding":return e.encoding=r,!0;case"mergepartgroupsinmusicxml":return e.mergePartGroupsInMusicXml=r,!0;case"beattextaslyrics":return e.beatTextAsLyrics=r,!0}return!1}}class Sg{static fromJson(e,t){t&&j.forEach(t,(r,n)=>this.setProperty(e,n.toLowerCase(),r))}static toJson(e){if(!e)return null;const t=new Map;return t.set("notewidelength",e.noteWideLength),t.set("notewideamplitude",e.noteWideAmplitude),t.set("noteslightlength",e.noteSlightLength),t.set("noteslightamplitude",e.noteSlightAmplitude),t.set("beatwidelength",e.beatWideLength),t.set("beatwideamplitude",e.beatWideAmplitude),t.set("beatslightlength",e.beatSlightLength),t.set("beatslightamplitude",e.beatSlightAmplitude),t}static setProperty(e,t,r){switch(t){case"notewidelength":return e.noteWideLength=r,!0;case"notewideamplitude":return e.noteWideAmplitude=r,!0;case"noteslightlength":return e.noteSlightLength=r,!0;case"noteslightamplitude":return e.noteSlightAmplitude=r,!0;case"beatwidelength":return e.beatWideLength=r,!0;case"beatwideamplitude":return e.beatWideAmplitude=r,!0;case"beatslightlength":return e.beatSlightLength=r,!0;case"beatslightamplitude":return e.beatSlightAmplitude=r,!0}return!1}}class xg{static fromJson(e,t){t&&j.forEach(t,(r,n)=>this.setProperty(e,n.toLowerCase(),r))}static toJson(e){if(!e)return null;const t=new Map;return t.set("simpleslidepitchoffset",e.simpleSlidePitchOffset),t.set("simpleslidedurationratio",e.simpleSlideDurationRatio),t.set("shiftslidedurationratio",e.shiftSlideDurationRatio),t}static setProperty(e,t,r){switch(t){case"simpleslidepitchoffset":return e.simpleSlidePitchOffset=r,!0;case"simpleslidedurationratio":return e.simpleSlideDurationRatio=r,!0;case"shiftslidedurationratio":return e.shiftSlideDurationRatio=r,!0}return!1}}class kg{static fromJson(e,t){t&&j.forEach(t,(r,n)=>this.setProperty(e,n.toLowerCase(),r))}static toJson(e){if(!e)return null;const t=new Map;return t.set("soundfont",e.soundFont),t.set("outputmode",e.outputMode),t.set("enableplayer",e.enablePlayer),t.set("enablecursor",e.enableCursor),t.set("enableanimatedbeatcursor",e.enableAnimatedBeatCursor),t.set("enableelementhighlighting",e.enableElementHighlighting),t.set("enableuserinteraction",e.enableUserInteraction),t.set("scrolloffsetx",e.scrollOffsetX),t.set("scrolloffsety",e.scrollOffsetY),t.set("scrollmode",e.scrollMode),t.set("scrollspeed",e.scrollSpeed),t.set("nativebrowsersmoothscroll",e.nativeBrowserSmoothScroll),t.set("songbookbendduration",e.songBookBendDuration),t.set("songbookdipduration",e.songBookDipDuration),t.set("vibrato",Sg.toJson(e.vibrato)),t.set("slide",xg.toJson(e.slide)),t.set("playtripletfeel",e.playTripletFeel),t.set("buffertimeinmilliseconds",e.bufferTimeInMilliseconds),t}static setProperty(e,t,r){switch(t){case"soundfont":return e.soundFont=r,!0;case"scrollelement":return e.scrollElement=r,!0;case"outputmode":return e.outputMode=j.parseEnum(r,$u),!0;case"enableplayer":return e.enablePlayer=r,!0;case"enablecursor":return e.enableCursor=r,!0;case"enableanimatedbeatcursor":return e.enableAnimatedBeatCursor=r,!0;case"enableelementhighlighting":return e.enableElementHighlighting=r,!0;case"enableuserinteraction":return e.enableUserInteraction=r,!0;case"scrolloffsetx":return e.scrollOffsetX=r,!0;case"scrolloffsety":return e.scrollOffsetY=r,!0;case"scrollmode":return e.scrollMode=j.parseEnum(r,as),!0;case"scrollspeed":return e.scrollSpeed=r,!0;case"nativebrowsersmoothscroll":return e.nativeBrowserSmoothScroll=r,!0;case"songbookbendduration":return e.songBookBendDuration=r,!0;case"songbookdipduration":return e.songBookDipDuration=r,!0;case"playtripletfeel":return e.playTripletFeel=r,!0;case"buffertimeinmilliseconds":return e.bufferTimeInMilliseconds=r,!0}if(["vibrato"].indexOf(t)>=0)return Sg.fromJson(e.vibrato,r),!0;for(const n of["vibrato"])if(t.indexOf(n)===0&&Sg.setProperty(e.vibrato,t.substring(n.length),r))return!0;if(["slide"].indexOf(t)>=0)return xg.fromJson(e.slide,r),!0;for(const n of["slide"])if(t.indexOf(n)===0&&xg.setProperty(e.slide,t.substring(n.length),r))return!0;return!1}}class sl{static fromJson(e,t){t&&j.forEach(t,(r,n)=>this.setProperty(e,n.toLowerCase(),r))}static toJson(e){if(!e)return null;const t=new Map;return t.set("core",mg.toJson(e.core)),t.set("display",bg.toJson(e.display)),t.set("notation",vg.toJson(e.notation)),t.set("importer",wg.toJson(e.importer)),t.set("player",kg.toJson(e.player)),t}static setProperty(e,t,r){if(["core",""].indexOf(t)>=0)return mg.fromJson(e.core,r),!0;for(const n of["core",""])if(t.indexOf(n)===0&&mg.setProperty(e.core,t.substring(n.length),r))return!0;if(["display",""].indexOf(t)>=0)return bg.fromJson(e.display,r),!0;for(const n of["display",""])if(t.indexOf(n)===0&&bg.setProperty(e.display,t.substring(n.length),r))return!0;if(["notation"].indexOf(t)>=0)return vg.fromJson(e.notation,r),!0;for(const n of["notation"])if(t.indexOf(n)===0&&vg.setProperty(e.notation,t.substring(n.length),r))return!0;if(["importer"].indexOf(t)>=0)return wg.fromJson(e.importer,r),!0;for(const n of["importer"])if(t.indexOf(n)===0&&wg.setProperty(e.importer,t.substring(n.length),r))return!0;if(["player"].indexOf(t)>=0)return kg.fromJson(e.player,r),!0;for(const n of["player"])if(t.indexOf(n)===0&&kg.setProperty(e.player,t.substring(n.length),r))return!0;return!1}}class qa{constructor(){this.core=new XB,this.display=new lU,this.notation=new Vu,this.importer=new uU,this.player=new dU}setSongBookModeSettings(){this.notation.notationMode=Zt.SongBook,this.notation.smallGraceTabNotes=!1,this.notation.fingeringMode=En.SingleNoteEffectBand,this.notation.extendBendArrowsOnTiedNotes=!1,this.notation.elements.set(pe.ParenthesisOnTiedBends,!1),this.notation.elements.set(pe.TabNotesOnTiedBends,!1),this.notation.elements.set(pe.ZerosOnDiveWhammys,!0)}static get songBook(){let e=new qa;return e.setSongBookModeSettings(),e}fillFromJson(e){sl.fromJson(this,e)}}class gS{static fromJson(e,t){t&&j.forEach(t,(r,n)=>this.setProperty(e,n,r))}static toJson(e){if(!e)return null;const t=new Map;return t.set("marker",e.marker),t.set("text",e.text),t}static setProperty(e,t,r){switch(t){case"marker":return e.marker=r,!0;case"text":return e.text=r,!0}return!1}}class Ad{static fromJson(e,t){t&&j.forEach(t,(r,n)=>this.setProperty(e,n,r))}static toJson(e){if(!e)return null;const t=new Map;return t.set("islinear",e.isLinear),t.set("type",e.type),t.set("value",e.value),t.set("ratioposition",e.ratioPosition),t.set("text",e.text),t}static setProperty(e,t,r){switch(t){case"islinear":return e.isLinear=r,!0;case"type":return e.type=j.parseEnum(r,$t),!0;case"value":return e.value=r,!0;case"ratioposition":return e.ratioPosition=r,!0;case"text":return e.text=r,!0}return!1}}class mS{static fromJson(e,t){t&&j.forEach(t,(r,n)=>this.setProperty(e,n,r))}static toJson(e){if(!e)return null;const t=new Map;return t.set("type",e.type),t.set("length",e.length),t}static setProperty(e,t,r){switch(t){case"type":return e.type=j.parseEnum(r,Bn),!0;case"length":return e.length=r,!0}return!1}}class yS{static fromJson(e,t){t&&j.forEach(t,(r,n)=>this.setProperty(e,n,r))}static toJson(e){if(!e)return null;const t=new Map;if(t.set("alternateendings",e.alternateEndings),t.set("keysignature",e.keySignature),t.set("keysignaturetype",e.keySignatureType),t.set("isdoublebar",e.isDoubleBar),t.set("isrepeatstart",e.isRepeatStart),t.set("repeatcount",e.repeatCount),t.set("timesignaturenumerator",e.timeSignatureNumerator),t.set("timesignaturedenominator",e.timeSignatureDenominator),t.set("timesignaturecommon",e.timeSignatureCommon),t.set("tripletfeel",e.tripletFeel),t.set("section",gS.toJson(e.section)),t.set("tempoautomations",e.tempoAutomations.map(r=>Ad.toJson(r))),e.fermata!==null){const r=new Map;t.set("fermata",r);for(const[n,s]of e.fermata)r.set(n.toString(),mS.toJson(s))}return t.set("start",e.start),t.set("isanacrusis",e.isAnacrusis),t.set("displayscale",e.displayScale),t.set("displaywidth",e.displayWidth),t}static setProperty(e,t,r){switch(t){case"alternateendings":return e.alternateEndings=r,!0;case"keysignature":return e.keySignature=j.parseEnum(r,qt),!0;case"keysignaturetype":return e.keySignatureType=j.parseEnum(r,da),!0;case"isdoublebar":return e.isDoubleBar=r,!0;case"isrepeatstart":return e.isRepeatStart=r,!0;case"repeatcount":return e.repeatCount=r,!0;case"timesignaturenumerator":return e.timeSignatureNumerator=r,!0;case"timesignaturedenominator":return e.timeSignatureDenominator=r,!0;case"timesignaturecommon":return e.timeSignatureCommon=r,!0;case"tripletfeel":return e.tripletFeel=j.parseEnum(r,Be),!0;case"tempoautomations":e.tempoAutomations=[];for(const n of r){const s=new wi;Ad.fromJson(s,n),e.tempoAutomations.push(s)}return!0;case"fermata":return e.fermata=new Map,j.forEach(r,(n,s)=>{const a=new F1;mS.fromJson(a,n),e.addFermata(parseInt(s),a)}),!0;case"start":return e.start=r,!0;case"isanacrusis":return e.isAnacrusis=r,!0;case"displayscale":return e.displayScale=r,!0;case"displaywidth":return e.displayWidth=r,!0}return["section"].indexOf(t)>=0?(r?(e.section=new hp,gS.fromJson(e.section,r)):e.section=null,!0):!1}}class Vd{static fromJson(e,t){t&&j.forEach(t,(r,n)=>this.setProperty(e,n,r))}static toJson(e){if(!e)return null;const t=new Map;return t.set("offset",e.offset),t.set("value",e.value),t}static setProperty(e,t,r){switch(t){case"offset":return e.offset=r,!0;case"value":return e.value=r,!0}return!1}}class bS{static fromJson(e,t){t&&j.forEach(t,(r,n)=>this.setProperty(e,n,r))}static toJson(e){var r;if(!e)return null;const t=new Map;return t.set("id",e.id),t.set("accentuated",e.accentuated),t.set("bendtype",e.bendType),t.set("bendstyle",e.bendStyle),t.set("iscontinuedbend",e.isContinuedBend),e.bendPoints!==null&&t.set("bendpoints",(r=e.bendPoints)==null?void 0:r.map(n=>Vd.toJson(n))),t.set("fret",e.fret),t.set("string",e.string),t.set("octave",e.octave),t.set("tone",e.tone),t.set("percussionarticulation",e.percussionArticulation),t.set("isvisible",e.isVisible),t.set("islefthandtapped",e.isLeftHandTapped),t.set("ishammerpullorigin",e.isHammerPullOrigin),t.set("isslurdestination",e.isSlurDestination),t.set("harmonictype",e.harmonicType),t.set("harmonicvalue",e.harmonicValue),t.set("isghost",e.isGhost),t.set("isletring",e.isLetRing),t.set("ispalmmute",e.isPalmMute),t.set("isdead",e.isDead),t.set("isstaccato",e.isStaccato),t.set("slideintype",e.slideInType),t.set("slideouttype",e.slideOutType),t.set("vibrato",e.vibrato),t.set("istiedestination",e.isTieDestination),t.set("lefthandfinger",e.leftHandFinger),t.set("righthandfinger",e.rightHandFinger),t.set("isfingering",e.isFingering),t.set("trillvalue",e.trillValue),t.set("trillspeed",e.trillSpeed),t.set("durationpercent",e.durationPercent),t.set("accidentalmode",e.accidentalMode),t.set("dynamics",e.dynamics),e.toJson(t),t}static setProperty(e,t,r){switch(t){case"id":return e.id=r,!0;case"accentuated":return e.accentuated=j.parseEnum(r,jt),!0;case"bendtype":return e.bendType=j.parseEnum(r,ee),!0;case"bendstyle":return e.bendStyle=j.parseEnum(r,Je),!0;case"iscontinuedbend":return e.isContinuedBend=r,!0;case"bendpoints":if(r){e.bendPoints=[];for(const n of r){const s=new $;Vd.fromJson(s,n),e.addBendPoint(s)}}return!0;case"fret":return e.fret=r,!0;case"string":return e.string=r,!0;case"octave":return e.octave=r,!0;case"tone":return e.tone=r,!0;case"percussionarticulation":return e.percussionArticulation=r,!0;case"isvisible":return e.isVisible=r,!0;case"islefthandtapped":return e.isLeftHandTapped=r,!0;case"ishammerpullorigin":return e.isHammerPullOrigin=r,!0;case"isslurdestination":return e.isSlurDestination=r,!0;case"harmonictype":return e.harmonicType=j.parseEnum(r,ne),!0;case"harmonicvalue":return e.harmonicValue=r,!0;case"isghost":return e.isGhost=r,!0;case"isletring":return e.isLetRing=r,!0;case"ispalmmute":return e.isPalmMute=r,!0;case"isdead":return e.isDead=r,!0;case"isstaccato":return e.isStaccato=r,!0;case"slideintype":return e.slideInType=j.parseEnum(r,ri),!0;case"slideouttype":return e.slideOutType=j.parseEnum(r,xe),!0;case"vibrato":return e.vibrato=j.parseEnum(r,Ue),!0;case"istiedestination":return e.isTieDestination=r,!0;case"lefthandfinger":return e.leftHandFinger=j.parseEnum(r,be),!0;case"righthandfinger":return e.rightHandFinger=j.parseEnum(r,be),!0;case"isfingering":return e.isFingering=r,!0;case"trillvalue":return e.trillValue=r,!0;case"trillspeed":return e.trillSpeed=j.parseEnum(r,_),!0;case"durationpercent":return e.durationPercent=r,!0;case"accidentalmode":return e.accidentalMode=j.parseEnum(r,Ft),!0;case"dynamics":return e.dynamics=j.parseEnum(r,_e),!0}return e.setProperty(t,r)}}class vS{static fromJson(e,t){t&&j.forEach(t,(r,n)=>this.setProperty(e,n,r))}static toJson(e){var r;if(!e)return null;const t=new Map;return t.set("id",e.id),t.set("notes",e.notes.map(n=>bS.toJson(n))),t.set("isempty",e.isEmpty),t.set("whammystyle",e.whammyStyle),t.set("ottava",e.ottava),t.set("islegatoorigin",e.isLegatoOrigin),t.set("duration",e.duration),t.set("automations",e.automations.map(n=>Ad.toJson(n))),t.set("dots",e.dots),t.set("fadein",e.fadeIn),t.set("lyrics",e.lyrics),t.set("hasrasgueado",e.hasRasgueado),t.set("pop",e.pop),t.set("slap",e.slap),t.set("tap",e.tap),t.set("text",e.text),t.set("brushtype",e.brushType),t.set("brushduration",e.brushDuration),t.set("tupletdenominator",e.tupletDenominator),t.set("tupletnumerator",e.tupletNumerator),t.set("iscontinuedwhammy",e.isContinuedWhammy),t.set("whammybartype",e.whammyBarType),e.whammyBarPoints!==null&&t.set("whammybarpoints",(r=e.whammyBarPoints)==null?void 0:r.map(n=>Vd.toJson(n))),t.set("vibrato",e.vibrato),t.set("chordid",e.chordId),t.set("gracetype",e.graceType),t.set("pickstroke",e.pickStroke),t.set("tremolospeed",e.tremoloSpeed),t.set("crescendo",e.crescendo),t.set("displaystart",e.displayStart),t.set("playbackstart",e.playbackStart),t.set("displayduration",e.displayDuration),t.set("playbackduration",e.playbackDuration),t.set("dynamics",e.dynamics),t.set("invertbeamdirection",e.invertBeamDirection),t.set("preferredbeamdirection",e.preferredBeamDirection),t.set("beamingmode",e.beamingMode),t}static setProperty(e,t,r){switch(t){case"id":return e.id=r,!0;case"notes":e.notes=[];for(const n of r){const s=new Nt;bS.fromJson(s,n),e.addNote(s)}return!0;case"isempty":return e.isEmpty=r,!0;case"whammystyle":return e.whammyStyle=j.parseEnum(r,Je),!0;case"ottava":return e.ottava=j.parseEnum(r,$e),!0;case"islegatoorigin":return e.isLegatoOrigin=r,!0;case"duration":return e.duration=j.parseEnum(r,_),!0;case"automations":e.automations=[];for(const n of r){const s=new wi;Ad.fromJson(s,n),e.automations.push(s)}return!0;case"dots":return e.dots=r,!0;case"fadein":return e.fadeIn=r,!0;case"lyrics":return e.lyrics=r,!0;case"hasrasgueado":return e.hasRasgueado=r,!0;case"pop":return e.pop=r,!0;case"slap":return e.slap=r,!0;case"tap":return e.tap=r,!0;case"text":return e.text=r,!0;case"brushtype":return e.brushType=j.parseEnum(r,lt),!0;case"brushduration":return e.brushDuration=r,!0;case"tupletdenominator":return e.tupletDenominator=r,!0;case"tupletnumerator":return e.tupletNumerator=r,!0;case"iscontinuedwhammy":return e.isContinuedWhammy=r,!0;case"whammybartype":return e.whammyBarType=j.parseEnum(r,Ge),!0;case"whammybarpoints":if(r){e.whammyBarPoints=[];for(const n of r){const s=new $;Vd.fromJson(s,n),e.addWhammyBarPoint(s)}}return!0;case"vibrato":return e.vibrato=j.parseEnum(r,Ue),!0;case"chordid":return e.chordId=r,!0;case"gracetype":return e.graceType=j.parseEnum(r,ce),!0;case"pickstroke":return e.pickStroke=j.parseEnum(r,gi),!0;case"tremolospeed":return e.tremoloSpeed=j.parseEnum(r,_),!0;case"crescendo":return e.crescendo=j.parseEnum(r,Zi),!0;case"displaystart":return e.displayStart=r,!0;case"playbackstart":return e.playbackStart=r,!0;case"displayduration":return e.displayDuration=r,!0;case"playbackduration":return e.playbackDuration=r,!0;case"dynamics":return e.dynamics=j.parseEnum(r,_e),!0;case"invertbeamdirection":return e.invertBeamDirection=r,!0;case"preferredbeamdirection":return e.preferredBeamDirection=j.parseEnum(r,H),!0;case"beamingmode":return e.beamingMode=j.parseEnum(r,kn),!0}return!1}}class wS{static fromJson(e,t){t&&j.forEach(t,(r,n)=>this.setProperty(e,n,r))}static toJson(e){if(!e)return null;const t=new Map;return t.set("id",e.id),t.set("beats",e.beats.map(r=>vS.toJson(r))),t.set("isempty",e.isEmpty),t}static setProperty(e,t,r){switch(t){case"id":return e.id=r,!0;case"beats":e.beats=[];for(const n of r){const s=new xi;vS.fromJson(s,n),e.addBeat(s)}return!0;case"isempty":return e.isEmpty=r,!0}return!1}}class SS{static fromJson(e,t){t&&j.forEach(t,(r,n)=>this.setProperty(e,n,r))}static toJson(e){if(!e)return null;const t=new Map;return t.set("id",e.id),t.set("clef",e.clef),t.set("clefottava",e.clefOttava),t.set("voices",e.voices.map(r=>wS.toJson(r))),t.set("similemark",e.simileMark),t.set("displayscale",e.displayScale),t.set("displaywidth",e.displayWidth),t}static setProperty(e,t,r){switch(t){case"id":return e.id=r,!0;case"clef":return e.clef=j.parseEnum(r,ve),!0;case"clefottava":return e.clefOttava=j.parseEnum(r,$e),!0;case"voices":e.voices=[];for(const n of r){const s=new Qn;wS.fromJson(s,n),e.addVoice(s)}return!0;case"similemark":return e.simileMark=j.parseEnum(r,Fr),!0;case"displayscale":return e.displayScale=r,!0;case"displaywidth":return e.displayWidth=r,!0}return!1}}class xS{static fromJson(e,t){t&&j.forEach(t,(r,n)=>this.setProperty(e,n,r))}static toJson(e){if(!e)return null;const t=new Map;return t.set("name",e.name),t.set("firstfret",e.firstFret),t.set("strings",e.strings),t.set("barrefrets",e.barreFrets),t.set("showname",e.showName),t.set("showdiagram",e.showDiagram),t.set("showfingering",e.showFingering),t}static setProperty(e,t,r){switch(t){case"name":return e.name=r,!0;case"firstfret":return e.firstFret=r,!0;case"strings":return e.strings=r,!0;case"barrefrets":return e.barreFrets=r,!0;case"showname":return e.showName=r,!0;case"showdiagram":return e.showDiagram=r,!0;case"showfingering":return e.showFingering=r,!0}return!1}}class kS{static fromJson(e,t){t&&j.forEach(t,(r,n)=>this.setProperty(e,n,r))}static toJson(e){if(!e)return null;const t=new Map;return t.set("isstandard",e.isStandard),t.set("name",e.name),t.set("tunings",e.tunings),t}static setProperty(e,t,r){switch(t){case"isstandard":return e.isStandard=r,!0;case"name":return e.name=r,!0;case"tunings":return e.tunings=r,!0}return!1}}class TS{static fromJson(e,t){t&&j.forEach(t,(r,n)=>this.setProperty(e,n,r))}static toJson(e){if(!e)return null;const t=new Map;if(t.set("bars",e.bars.map(r=>SS.toJson(r))),e.chords!==null){const r=new Map;t.set("chords",r);for(const[n,s]of e.chords)r.set(n.toString(),xS.toJson(s))}return t.set("capo",e.capo),t.set("transpositionpitch",e.transpositionPitch),t.set("displaytranspositionpitch",e.displayTranspositionPitch),t.set("stringtuning",kS.toJson(e.stringTuning)),t.set("showslash",e.showSlash),t.set("showtablature",e.showTablature),t.set("showstandardnotation",e.showStandardNotation),t.set("ispercussion",e.isPercussion),t.set("standardnotationlinecount",e.standardNotationLineCount),t}static setProperty(e,t,r){switch(t){case"bars":e.bars=[];for(const n of r){const s=new Ps;SS.fromJson(s,n),e.addBar(s)}return!0;case"chords":return e.chords=new Map,j.forEach(r,(n,s)=>{const a=new ha;xS.fromJson(a,n),e.addChord(s,a)}),!0;case"capo":return e.capo=r,!0;case"transpositionpitch":return e.transpositionPitch=r,!0;case"displaytranspositionpitch":return e.displayTranspositionPitch=r,!0;case"showslash":return e.showSlash=r,!0;case"showtablature":return e.showTablature=r,!0;case"showstandardnotation":return e.showStandardNotation=r,!0;case"ispercussion":return e.isPercussion=r,!0;case"standardnotationlinecount":return e.standardNotationLineCount=r,!0}return["stringtuning"].indexOf(t)>=0?(kS.fromJson(e.stringTuning,r),!0):!1}}class CS{static fromJson(e,t){t&&j.forEach(t,(r,n)=>this.setProperty(e,n,r))}static toJson(e){if(!e)return null;const t=new Map;return t.set("volume",e.volume),t.set("balance",e.balance),t.set("port",e.port),t.set("program",e.program),t.set("primarychannel",e.primaryChannel),t.set("secondarychannel",e.secondaryChannel),t.set("ismute",e.isMute),t.set("issolo",e.isSolo),t}static setProperty(e,t,r){switch(t){case"volume":return e.volume=r,!0;case"balance":return e.balance=r,!0;case"port":return e.port=r,!0;case"program":return e.program=r,!0;case"primarychannel":return e.primaryChannel=r,!0;case"secondarychannel":return e.secondaryChannel=r,!0;case"ismute":return e.isMute=r,!0;case"issolo":return e.isSolo=r,!0}return!1}}class NS{static fromJson(e,t){t&&j.forEach(t,(r,n)=>this.setProperty(e,n,r))}static toJson(e){if(!e)return null;const t=new Map;return t.set("elementtype",e.elementType),t.set("staffline",e.staffLine),t.set("noteheaddefault",e.noteHeadDefault),t.set("noteheadhalf",e.noteHeadHalf),t.set("noteheadwhole",e.noteHeadWhole),t.set("techniquesymbol",e.techniqueSymbol),t.set("techniquesymbolplacement",e.techniqueSymbolPlacement),t.set("outputmidinumber",e.outputMidiNumber),t}static setProperty(e,t,r){switch(t){case"elementtype":return e.elementType=r,!0;case"staffline":return e.staffLine=r,!0;case"noteheaddefault":return e.noteHeadDefault=j.parseEnum(r,w),!0;case"noteheadhalf":return e.noteHeadHalf=j.parseEnum(r,w),!0;case"noteheadwhole":return e.noteHeadWhole=j.parseEnum(r,w),!0;case"techniquesymbol":return e.techniqueSymbol=j.parseEnum(r,w),!0;case"techniquesymbolplacement":return e.techniqueSymbolPlacement=j.parseEnum(r,Se),!0;case"outputmidinumber":return e.outputMidiNumber=r,!0}return!1}}class BS{static fromJson(e,t){t&&j.forEach(t,(r,n)=>this.setProperty(e,n,r))}static toJson(e){if(!e)return null;const t=new Map;return t.set("staves",e.staves.map(r=>TS.toJson(r))),t.set("playbackinfo",CS.toJson(e.playbackInfo)),t.set("color",qe.toJson(e.color)),t.set("name",e.name),t.set("isvisibleonmultitrack",e.isVisibleOnMultiTrack),t.set("shortname",e.shortName),t.set("defaultsystemslayout",e.defaultSystemsLayout),t.set("systemslayout",e.systemsLayout),t.set("percussionarticulations",e.percussionArticulations.map(r=>NS.toJson(r))),t}static setProperty(e,t,r){switch(t){case"staves":e.staves=[];for(const n of r){const s=new dB;TS.fromJson(s,n),e.addStaff(s)}return!0;case"color":return e.color=qe.fromJson(r),!0;case"name":return e.name=r,!0;case"isvisibleonmultitrack":return e.isVisibleOnMultiTrack=r,!0;case"shortname":return e.shortName=r,!0;case"defaultsystemslayout":return e.defaultSystemsLayout=r,!0;case"systemslayout":return e.systemsLayout=r,!0;case"percussionarticulations":e.percussionArticulations=[];for(const n of r){const s=new Y;NS.fromJson(s,n),e.percussionArticulations.push(s)}return!0}return["playbackinfo"].indexOf(t)>=0?(CS.fromJson(e.playbackInfo,r),!0):!1}}class _S{static fromJson(e,t){t&&j.forEach(t,(r,n)=>this.setProperty(e,n,r))}static toJson(e){if(!e)return null;const t=new Map;return t.set("hidedynamics",e.hideDynamics),t}static setProperty(e,t,r){switch(t){case"hidedynamics":return e.hideDynamics=r,!0}return!1}}class PS{static fromJson(e,t){t&&j.forEach(t,(r,n)=>this.setProperty(e,n,r))}static toJson(e){if(!e)return null;const t=new Map;return t.set("album",e.album),t.set("artist",e.artist),t.set("copyright",e.copyright),t.set("instructions",e.instructions),t.set("music",e.music),t.set("notices",e.notices),t.set("subtitle",e.subTitle),t.set("title",e.title),t.set("words",e.words),t.set("tab",e.tab),t.set("tempo",e.tempo),t.set("tempolabel",e.tempoLabel),t.set("masterbars",e.masterBars.map(r=>yS.toJson(r))),t.set("tracks",e.tracks.map(r=>BS.toJson(r))),t.set("defaultsystemslayout",e.defaultSystemsLayout),t.set("systemslayout",e.systemsLayout),t.set("stylesheet",_S.toJson(e.stylesheet)),t}static setProperty(e,t,r){switch(t){case"album":return e.album=r,!0;case"artist":return e.artist=r,!0;case"copyright":return e.copyright=r,!0;case"instructions":return e.instructions=r,!0;case"music":return e.music=r,!0;case"notices":return e.notices=r,!0;case"subtitle":return e.subTitle=r,!0;case"title":return e.title=r,!0;case"words":return e.words=r,!0;case"tab":return e.tab=r,!0;case"tempo":return e.tempo=r,!0;case"tempolabel":return e.tempoLabel=r,!0;case"masterbars":e.masterBars=[];for(const n of r){const s=new Ts;yS.fromJson(s,n),e.addMasterBar(s)}return!0;case"tracks":e.tracks=[];for(const n of r){const s=new Jn;BS.fromJson(s,n),e.addTrack(s)}return!0;case"defaultsystemslayout":return e.defaultSystemsLayout=r,!0;case"systemslayout":return e.systemsLayout=r,!0}return["stylesheet"].indexOf(t)>=0?(_S.fromJson(e.stylesheet,r),!0):!1}}class Vt{static jsonReplacer(e,t){if(t instanceof Map){if("fromEntries"in Object)return Object.fromEntries(t);{const r={};for(const[n,s]of t)r[n]=s;return r}}else if(ArrayBuffer.isView(t))return Array.apply([],[t]);return t}static scoreToJson(e){let t=Vt.scoreToJsObject(e);return JSON.stringify(t,Vt.jsonReplacer)}static jsonToScore(e,t){return Vt.jsObjectToScore(JSON.parse(e),t)}static scoreToJsObject(e){return PS.toJson(e)}static jsObjectToScore(e,t){let r=new no;return PS.fromJson(r,e),r.finish(t??new qa),r}static settingsToJson(e){let t=Vt.settingsToJsObject(e);return JSON.stringify(t,Vt.jsonReplacer)}static jsonToSettings(e){return Vt.jsObjectToSettings(JSON.parse(e))}static settingsToJsObject(e){return sl.toJson(e)}static jsObjectToSettings(e){let t=new qa;return sl.fromJson(t,e),t}static jsObjectToMidiFile(e){let t=new ia;return j.forEach(e,(r,n)=>{switch(n){case"division":t.division=r;break;case"tracks":for(let s of r){let a=Vt.jsObjectToMidiTrack(s);t.tracks.push(a)}break}}),t}static jsObjectToMidiTrack(e){let t=new mB;return j.forEach(e,(r,n)=>{switch(n){case"events":for(let s of r){let a=Vt.jsObjectToMidiEvent(s);t.events.push(a)}break}}),t}static jsObjectToMidiEvent(e){let t=j.getValue(e,"track"),r=j.getValue(e,"tick"),n=j.getValue(e,"type");switch(n){case Le.TimeSignature:return new yB(t,r,j.getValue(e,"numerator"),j.getValue(e,"denominatorIndex"),j.getValue(e,"midiClocksPerMetronomeClick"),j.getValue(e,"thirdySecondNodesInQuarter"));case Le.AlphaTabRest:return new vB(t,r,j.getValue(e,"channel"));case Le.AlphaTabMetronome:return new bB(t,r,j.getValue(e,"metronomeNumerator"),j.getValue(e,"metronomeDurationInTicks"),j.getValue(e,"metronomeDurationInMilliseconds"));case Le.NoteOn:return new SB(t,r,j.getValue(e,"channel"),j.getValue(e,"noteKey"),j.getValue(e,"noteVelocity"));case Le.NoteOff:return new xB(t,r,j.getValue(e,"channel"),j.getValue(e,"noteKey"),j.getValue(e,"noteVelocity"));case Le.ControlChange:return new kB(t,r,j.getValue(e,"channel"),j.getValue(e,"controller"),j.getValue(e,"value"));case Le.ProgramChange:return new TB(t,r,j.getValue(e,"channel"),j.getValue(e,"program"));case Le.TempoChange:return new CB(r,j.getValue(e,"microSecondsPerQuarterNote"));case Le.PitchBend:return new NB(t,r,j.getValue(e,"channel"),j.getValue(e,"value"));case Le.PerNotePitchBend:return new BB(t,r,j.getValue(e,"channel"),j.getValue(e,"noteKey"),j.getValue(e,"value"));case Le.EndOfTrack:return new _B(t,r)}throw new oi(ai.Format,"Unknown Midi Event type: "+n)}static midiFileToJsObject(e){const t=new Map;t.set("division",e.division);const r=[];for(let n of e.tracks)r.push(Vt.midiTrackToJsObject(n));return t.set("tracks",r),t}static midiTrackToJsObject(e){const t=new Map,r=[];for(let n of e.events)r.push(Vt.midiEventToJsObject(n));return t.set("events",r),t}static midiEventToJsObject(e){const t=new Map;switch(t.set("track",e.track),t.set("tick",e.tick),t.set("type",e.type),e.type){case Le.TimeSignature:t.set("numerator",e.numerator),t.set("denominatorIndex",e.denominatorIndex),t.set("midiClocksPerMetronomeClick",e.midiClocksPerMetronomeClick),t.set("thirdySecondNodesInQuarter",e.thirtySecondNodesInQuarter);break;case Le.AlphaTabRest:t.set("channel",e.channel);break;case Le.AlphaTabMetronome:t.set("metronomeNumerator",e.metronomeNumerator),t.set("metronomeDurationInMilliseconds",e.metronomeDurationInMilliseconds),t.set("metronomeDurationInTicks",e.metronomeDurationInTicks);break;case Le.NoteOn:case Le.NoteOff:t.set("channel",e.channel),t.set("noteKey",e.noteKey),t.set("noteVelocity",e.noteVelocity);break;case Le.ControlChange:t.set("channel",e.channel),t.set("controller",e.controller),t.set("value",e.value);break;case Le.ProgramChange:t.set("channel",e.channel),t.set("program",e.program);break;case Le.TempoChange:t.set("microSecondsPerQuarterNote",e.microSecondsPerQuarterNote);break;case Le.PitchBend:t.set("channel",e.channel),t.set("value",e.value);break;case Le.PerNotePitchBend:t.set("channel",e.channel),t.set("noteKey",e.noteKey),t.set("value",e.value);break;case Le.EndOfTrack:break}return t}}class ut{constructor(){this.ready=new ei,this.samplesPlayed=new Fe,this.sampleRequest=new ei}get sampleRate(){return ut.preferredSampleRate}open(){V.debug("AlphaSynth","Initializing synth worker"),this._worker=W.globalThis,this._worker.addEventListener("message",this.handleMessage.bind(this)),this.ready.trigger()}destroy(){this._worker.postMessage({cmd:"alphaSynth.output.destroy"})}handleMessage(e){let t=e.data;switch(t.cmd){case ut.CmdOutputSampleRequest:this.sampleRequest.trigger();break;case ut.CmdOutputSamplesPlayed:this.samplesPlayed.trigger(t.samples);break}}addSamples(e){this._worker.postMessage({cmd:"alphaSynth.output.addSamples",samples:e})}play(){this._worker.postMessage({cmd:"alphaSynth.output.play"})}pause(){this._worker.postMessage({cmd:"alphaSynth.output.pause"})}resetSamples(){this._worker.postMessage({cmd:"alphaSynth.output.resetSamples"})}activate(){}}ut.CmdOutputPrefix="alphaSynth.output.";ut.CmdOutputAddSamples=ut.CmdOutputPrefix+"addSamples";ut.CmdOutputPlay=ut.CmdOutputPrefix+"play";ut.CmdOutputPause=ut.CmdOutputPrefix+"pause";ut.CmdOutputResetSamples=ut.CmdOutputPrefix+"resetSamples";ut.CmdOutputStop=ut.CmdOutputPrefix+"stop";ut.CmdOutputSampleRequest=ut.CmdOutputPrefix+"sampleRequest";ut.CmdOutputSamplesPlayed=ut.CmdOutputPrefix+"samplesPlayed";ut.preferredSampleRate=0;class $1{constructor(e,t){this._main=e,this._main.addEventListener("message",this.handleMessage.bind(this)),this._player=new RB(new ut,t),this._player.positionChanged.on(this.onPositionChanged.bind(this)),this._player.stateChanged.on(this.onPlayerStateChanged.bind(this)),this._player.finished.on(this.onFinished.bind(this)),this._player.soundFontLoaded.on(this.onSoundFontLoaded.bind(this)),this._player.soundFontLoadFailed.on(this.onSoundFontLoadFailed.bind(this)),this._player.soundFontLoadFailed.on(this.onSoundFontLoadFailed.bind(this)),this._player.midiLoaded.on(this.onMidiLoaded.bind(this)),this._player.midiLoadFailed.on(this.onMidiLoadFailed.bind(this)),this._player.readyForPlayback.on(this.onReadyForPlayback.bind(this)),this._player.midiEventsPlayed.on(this.onMidiEventsPlayed.bind(this)),this._player.playbackRangeChanged.on(this.onPlaybackRangeChanged.bind(this)),this._main.postMessage({cmd:"alphaSynth.ready"})}static init(){let e=W.globalThis;e.addEventListener("message",t=>{let r=t.data;switch(r.cmd){case"alphaSynth.initialize":ut.preferredSampleRate=r.sampleRate,V.logLevel=r.logLevel,W.globalThis.alphaSynthWebWorker=new $1(e,r.bufferTimeInMilliseconds);break}})}handleMessage(e){let t=e.data;switch(t.cmd){case"alphaSynth.setLogLevel":V.logLevel=t.value;break;case"alphaSynth.setMasterVolume":this._player.masterVolume=t.value;break;case"alphaSynth.setMetronomeVolume":this._player.metronomeVolume=t.value;break;case"alphaSynth.setPlaybackSpeed":this._player.playbackSpeed=t.value;break;case"alphaSynth.setTickPosition":this._player.tickPosition=t.value;break;case"alphaSynth.setTimePosition":this._player.timePosition=t.value;break;case"alphaSynth.setPlaybackRange":this._player.playbackRange=t.value;break;case"alphaSynth.setIsLooping":this._player.isLooping=t.value;break;case"alphaSynth.setCountInVolume":this._player.countInVolume=t.value;break;case"alphaSynth.setMidiEventsPlayedFilter":this._player.midiEventsPlayedFilter=t.value;break;case"alphaSynth.play":this._player.play();break;case"alphaSynth.pause":this._player.pause();break;case"alphaSynth.playPause":this._player.playPause();break;case"alphaSynth.stop":this._player.stop();break;case"alphaSynth.playOneTimeMidiFile":this._player.playOneTimeMidiFile(Vt.jsObjectToMidiFile(t.midi));break;case"alphaSynth.loadSoundFontBytes":this._player.loadSoundFont(t.data,t.append);break;case"alphaSynth.resetSoundFonts":this._player.resetSoundFonts();break;case"alphaSynth.loadMidi":this._player.loadMidiFile(Vt.jsObjectToMidiFile(t.midi));break;case"alphaSynth.setChannelMute":this._player.setChannelMute(t.channel,t.mute);break;case"alphaSynth.setChannelSolo":this._player.setChannelSolo(t.channel,t.solo);break;case"alphaSynth.setChannelVolume":this._player.setChannelVolume(t.channel,t.volume);break;case"alphaSynth.resetChannelStates":this._player.resetChannelStates();break;case"alphaSynth.destroy":this._player.destroy(),this._main.postMessage({cmd:"alphaSynth.destroyed"});break;case"alphaSynth.applyTranspositionPitches":this._player.applyTranspositionPitches(new Map(JSON.parse(t.transpositionPitches)));break}}onPositionChanged(e){this._main.postMessage({cmd:"alphaSynth.positionChanged",currentTime:e.currentTime,endTime:e.endTime,currentTick:e.currentTick,endTick:e.endTick,isSeek:e.isSeek})}onPlayerStateChanged(e){this._main.postMessage({cmd:"alphaSynth.playerStateChanged",state:e.state,stopped:e.stopped})}onFinished(){this._main.postMessage({cmd:"alphaSynth.finished"})}onSoundFontLoaded(){this._main.postMessage({cmd:"alphaSynth.soundFontLoaded"})}onSoundFontLoadFailed(e){this._main.postMessage({cmd:"alphaSynth.soundFontLoadFailed",error:this.serializeException(e)})}serializeException(e){let t=JSON.parse(JSON.stringify(e));return e.message&&(t.message=e.message),e.stack&&(t.stack=e.stack),e.constructor&&e.constructor.name&&(t.type=e.constructor.name),t}onMidiLoaded(e){this._main.postMessage({cmd:"alphaSynth.midiLoaded",currentTime:e.currentTime,endTime:e.endTime,currentTick:e.currentTick,endTick:e.endTick,isSeek:e.isSeek})}onMidiLoadFailed(e){this._main.postMessage({cmd:"alphaSynth.midiLoaded",error:this.serializeException(e)})}onReadyForPlayback(){this._main.postMessage({cmd:"alphaSynth.readyForPlayback"})}onMidiEventsPlayed(e){this._main.postMessage({cmd:"alphaSynth.midiEventsPlayed",events:e.events.map(Vt.midiEventToJsObject)})}onPlaybackRangeChanged(e){this._main.postMessage({cmd:"alphaSynth.playbackRangeChanged",playbackRange:e.playbackRange})}}var hr;(function(i){i[i.Browser=0]="Browser",i[i.NodeJs=1]="NodeJs",i[i.BrowserModule=2]="BrowserModule"})(hr||(hr={}));class RS{constructor(e,t){this.characterWidths=e,this.fontSizeToHeight=t}}class Ci{static generateFontLookup(e){if(!Ci.FontSizeLookupTables.has(e))if(!W.isRunningInWorker&&W.webPlatform!=hr.NodeJs){let r=document.createElement("canvas").getContext("2d");const n=11;r.font=`${n}px ${e}`;const s=[];let a="";for(let d=Ci.ControlChars;d<255;d++){let f=String.fromCharCode(d);a+=f;const p=r.measureText(f);s.push(p.width)}const o=r.measureText(a+"ÄÖÜÁÈ"),l=0-Math.abs(o.fontBoundingBoxAscent),c=0+Math.abs(o.fontBoundingBoxDescent)-l,h=new RS(new Uint8Array(s),c/n);Ci.FontSizeLookupTables.set(e,h)}else{const t=new RS(new Uint8Array([8]),1.2);Ci.FontSizeLookupTables.set(e,t)}}static measureString(e,t,r,n,s){let a,o=11,l=t[0];for(let h=0;h<t.length;h++)if(Ci.FontSizeLookupTables.has(t[h])){l=t[h];break}Ci.FontSizeLookupTables.has(l)||Ci.generateFontLookup(l),a=Ci.FontSizeLookupTables.get(l);let u=1;n===St.Italic&&(u*=1.1),s===cr.Bold&&(u*=1.1);let c=0;for(let h=0;h<e.length;h++){let d=Math.min(a.characterWidths.length-1,e.charCodeAt(h)-Ci.ControlChars);d>=0&&(c+=a.characterWidths[d]*r/o)}return u*=1.07,new cp(c*u,r*a.fontSizeToHeight)}}Ci.FontSizeLookupTables=new Map;Ci.ControlChars=32;class Oa{constructor(){this.id=ct.newGuid(),this.x=0,this.y=0,this.width=0,this.height=0,this.totalWidth=0,this.totalHeight=0,this.firstMasterBarIndex=-1,this.lastMasterBarIndex=-1,this.renderResult=null}}class EB{constructor(){this.beats=[]}addBeat(e){e.barBounds=this,this.beats.push(e),this.masterBarBounds.addBeat(e)}findBeatAtPos(e){let t=null;for(let r of this.beats)if(!t||r.realBounds.x<e)t=r;else if(r.realBounds.x>e)break;return t}finish(){this.beats.sort((e,t)=>e.realBounds.x-t.realBounds.x)}}class MB{constructor(){this.notes=null}addNote(e){this.notes||(this.notes=[]),e.beatBounds=this,this.notes.push(e)}findNoteAtPos(e,t){const r=this.notes;if(!r)return null;for(let n of r){let s=n.noteHeadBounds.y+n.noteHeadBounds.h,a=n.noteHeadBounds.x+n.noteHeadBounds.w;if(n.noteHeadBounds.x<=e&&n.noteHeadBounds.y<=t&&e<=a&&t<=s)return n.note}return null}}class OB{constructor(){this.index=0,this.isFirstOfLine=!1,this.bars=[],this.staffSystemBounds=null}get staveGroupBounds(){return this.staffSystemBounds}addBar(e){e.masterBarBounds=this,this.bars.push(e)}findBeatAtPos(e,t){let r=null,n=1e7;for(let s of this.bars){let a=s.findBeatAtPos(e);if(a&&(!r||r.realBounds.x<a.realBounds.x)){const o=Math.abs(a.realBounds.x-e);(!r||o<n)&&(r=a)}}return r?r.beat:null}finish(){this.bars.sort((e,t)=>e.realBounds.y<t.realBounds.y?-1:e.realBounds.y>t.realBounds.y?1:e.realBounds.x<t.realBounds.x?-1:e.realBounds.x>t.realBounds.x?1:0);for(const e of this.bars)e.finish()}addBeat(e){this.staffSystemBounds.boundsLookup.addBeat(e)}}class fp{}class IB{constructor(){this.index=0,this.bars=[]}finish(){for(let e of this.bars)e.finish()}addBar(e){this.boundsLookup.addMasterBar(e),e.staffSystemBounds=this,this.bars.push(e)}findBarAtPos(e){let t=null;for(let r of this.bars)if(!t||r.realBounds.x<e)t=r;else if(e>r.realBounds.x+r.realBounds.w)break;return t}}class ju{constructor(){this._beatLookup=new Map,this._masterBarLookup=new Map,this._currentStaffSystem=null,this.staffSystems=[],this.isFinished=!1}toJson(){let e={},t=[];e.staffSystems=t;for(let r of this.staffSystems){let n={};n.visualBounds=this.boundsToJson(r.visualBounds),n.realBounds=this.boundsToJson(r.realBounds),n.bars=[];for(let s of r.bars){let a={};a.lineAlignedBounds=this.boundsToJson(s.lineAlignedBounds),a.visualBounds=this.boundsToJson(s.visualBounds),a.realBounds=this.boundsToJson(s.realBounds),a.index=s.index,a.bars=[];for(let o of s.bars){let l={};l.visualBounds=this.boundsToJson(o.visualBounds),l.realBounds=this.boundsToJson(o.realBounds),l.beats=[];for(let u of o.beats){let c={};c.visualBounds=this.boundsToJson(u.visualBounds),c.realBounds=this.boundsToJson(u.realBounds);let h=c;if(h.beatIndex=u.beat.index,h.voiceIndex=u.beat.voice.index,h.barIndex=u.beat.voice.bar.index,h.staffIndex=u.beat.voice.bar.staff.index,h.trackIndex=u.beat.voice.bar.staff.track.index,u.notes){let d=c.notes=[];for(let f of u.notes){let p={},g=p;g.index=f.note.index,p.noteHeadBounds=this.boundsToJson(f.noteHeadBounds),d.push(p)}}l.beats.push(c)}a.bars.push(l)}n.bars.push(a)}t.push(n)}return e}static fromJson(e,t){let r=new ju,n=e.staffSystems;for(let s of n){let a=new IB;a.visualBounds=s.visualBounds,a.realBounds=s.realBounds,r.addStaffSystem(a);for(let o of s.bars){let l=new OB;l.index=o.index,l.isFirstOfLine=o.isFirstOfLine,l.lineAlignedBounds=o.lineAlignedBounds,l.visualBounds=o.visualBounds,l.realBounds=o.realBounds,a.addBar(l);for(let u of o.bars){let c=new EB;c.visualBounds=u.visualBounds,c.realBounds=u.realBounds,l.addBar(c);for(let h of u.beats){let d=new MB;d.visualBounds=h.visualBounds,d.realBounds=h.realBounds;let f=h;if(d.beat=t.tracks[f.trackIndex].staves[f.staffIndex].bars[f.barIndex].voices[f.voiceIndex].beats[f.beatIndex],h.notes){d.notes=[];for(let p of h.notes){let g=new fp,y=p;g.note=d.beat.notes[y.index],g.noteHeadBounds=p.noteHeadBounds,d.addNote(g)}}c.addBeat(d)}}}}return r}boundsToJson(e){let t={};return t.x=e.x,t.y=e.y,t.w=e.w,t.h=e.h,t}finish(){for(let e of this.staffSystems)e.finish();this.isFinished=!0}addStaffSystem(e){e.index=this.staffSystems.length,e.boundsLookup=this,this.staffSystems.push(e),this._currentStaffSystem=e}addMasterBar(e){e.staffSystemBounds?this._masterBarLookup.set(e.index,e):(e.staffSystemBounds=this._currentStaffSystem,this._masterBarLookup.set(e.index,e),this._currentStaffSystem.addBar(e))}addBeat(e){var t;this._beatLookup.has(e.beat.id)||this._beatLookup.set(e.beat.id,[]),(t=this._beatLookup.get(e.beat.id))==null||t.push(e)}findMasterBarByIndex(e){return this._masterBarLookup.has(e)?this._masterBarLookup.get(e):null}findMasterBar(e){let t=e.index;return this._masterBarLookup.has(t)?this._masterBarLookup.get(t):null}findBeat(e){const t=this.findBeats(e);return t?t[0]:null}findBeats(e){let t=e.id;return this._beatLookup.has(t)?this._beatLookup.get(t):null}getBeatAtPos(e,t){let r=0,n=this.staffSystems.length-1,s=-1;for(;r<=n;){let l=(n+r)/2|0,u=this.staffSystems[l];if(t>=u.realBounds.y&&t<=u.realBounds.y+u.realBounds.h){s=l;break}t<u.realBounds.y?n=l-1:r=l+1}if(s===-1)return null;let o=this.staffSystems[s].findBarAtPos(e);return o?o.findBeatAtPos(e,t):null}getNoteAtPos(e,t,r){const n=this.findBeats(e);if(n)for(const s of n){const a=s.findNoteAtPos(t,r);if(a)return a}return null}}class LB{constructor(e){this._currentLayoutMode=ps.Page,this._currentRenderEngine=null,this._renderedTracks=null,this.canvas=null,this.score=null,this.tracks=null,this.layout=null,this.boundsLookup=null,this.width=0,this.preRender=new Fe,this.renderFinished=new Fe,this.partialRenderFinished=new Fe,this.partialLayoutFinished=new Fe,this.postRenderFinished=new ei,this.error=new Fe,this.settings=e,this.recreateCanvas(),this.recreateLayout()}destroy(){var e;this.score=null,(e=this.canvas)==null||e.destroy(),this.canvas=null,this.layout=null,this.boundsLookup=null,this.tracks=null}recreateCanvas(){var e;return this._currentRenderEngine!==this.settings.core.engine?((e=this.canvas)==null||e.destroy(),this.canvas=W.getRenderEngineFactory(this.settings.core.engine).createCanvas(),this._currentRenderEngine=this.settings.core.engine,!0):!1}recreateLayout(){return!this.layout||this._currentLayoutMode!==this.settings.display.layoutMode?(this.layout=W.getLayoutEngineFactory(this.settings.display.layoutMode).createLayout(this),this._currentLayoutMode=this.settings.display.layoutMode,!0):!1}renderScore(e,t){try{this.score=e;let r=null;if(e!=null&&t!=null){if(!t)r=e.tracks.slice(0);else{r=[];for(let n of t)n>=0&&n<e.tracks.length&&r.push(e.tracks[n])}r.length===0&&e.tracks.length>0&&r.push(e.tracks[0])}this.tracks=r,this.render()}catch(r){this.error.trigger(r)}}renderTracks(e){e.length===0?this.score=null:this.score=e[0].score,this.tracks=e,this.render()}updateSettings(e){this.settings=e}renderResult(e){try{const t=this.layout;t?(V.debug("Rendering","Request render of lazy partial "+e),t.renderLazyPartial(e)):V.warning("Rendering","Request render of lazy partial "+e+" ignored, no layout exists")}catch(t){this.error.trigger(t)}}render(){if(this.width===0){V.warning("Rendering","AlphaTab skipped rendering because of width=0 (element invisible)",null);return}if(this.boundsLookup=new ju,this.recreateCanvas(),this.canvas.lineWidth=this.settings.display.scale,this.canvas.settings=this.settings,!this.tracks||this.tracks.length===0||!this.score)V.debug("Rendering","Clearing rendered tracks because no score or tracks are set"),this.preRender.trigger(!1),this._renderedTracks=null,this.onRenderFinished(),this.postRenderFinished.trigger(),V.debug("Rendering","Clearing finished");else{V.debug("Rendering","Rendering "+this.tracks.length+" tracks");for(let e=0;e<this.tracks.length;e++){let t=this.tracks[e];V.debug("Rendering","Track "+e+": "+t.name)}this.preRender.trigger(!1),this.recreateLayout(),this.layoutAndRender(),V.debug("Rendering","Rendering finished")}}resizeRender(){this.recreateLayout()||this.recreateCanvas()||this._renderedTracks!==this.tracks||!this.tracks?(V.debug("Rendering","Starting full rerendering due to layout or canvas change",null),this.render()):this.layout.supportsResize?(V.debug("Rendering","Starting optimized rerendering for resize"),this.boundsLookup=new ju,this.preRender.trigger(!0),this.canvas.settings=this.settings,this.layout.resize(),this.onRenderFinished(),this.postRenderFinished.trigger()):V.debug("Rendering","Current layout does not support dynamic resizing, nothing was done",null),V.debug("Rendering","Resize finished")}layoutAndRender(){V.debug("Rendering","Rendering at scale "+this.settings.display.scale+" with layout "+this.layout.name,null),this.layout.layoutAndRender(),this._renderedTracks=this.tracks,this.onRenderFinished(),this.postRenderFinished.trigger()}onRenderFinished(){var t;(t=this.boundsLookup)==null||t.finish();const e=new Oa;e.totalHeight=this.layout.height,e.totalWidth=this.layout.width,e.renderResult=this.canvas.onRenderFinished(),this.renderFinished.trigger(e)}}class j1{constructor(e){this._main=e,this._main.addEventListener("message",this.handleMessage.bind(this),!1)}static init(){W.globalThis.alphaTabWebWorker=new j1(W.globalThis)}handleMessage(e){let t=e.data;switch(t?t.cmd:""){case"alphaTab.initialize":let n=Vt.jsObjectToSettings(t.settings);V.logLevel=n.core.logLevel,this._renderer=new LB(n),this._renderer.partialRenderFinished.on(a=>{this._main.postMessage({cmd:"alphaTab.partialRenderFinished",result:a})}),this._renderer.partialLayoutFinished.on(a=>{this._main.postMessage({cmd:"alphaTab.partialLayoutFinished",result:a})}),this._renderer.renderFinished.on(a=>{this._main.postMessage({cmd:"alphaTab.renderFinished",result:a})}),this._renderer.postRenderFinished.on(()=>{var a;this._main.postMessage({cmd:"alphaTab.postRenderFinished",boundsLookup:((a=this._renderer.boundsLookup)==null?void 0:a.toJson())??null})}),this._renderer.preRender.on(a=>{this._main.postMessage({cmd:"alphaTab.preRender",resize:a})}),this._renderer.error.on(this.error.bind(this));break;case"alphaTab.invalidate":this._renderer.render();break;case"alphaTab.resizeRender":this._renderer.resizeRender();break;case"alphaTab.renderResult":this._renderer.renderResult(t.resultId);break;case"alphaTab.setWidth":this._renderer.width=t.width;break;case"alphaTab.renderScore":this.updateFontSizes(t.fontSizes);let s=t.score==null?null:Vt.jsObjectToScore(t.score,this._renderer.settings);this.renderMultiple(s,t.trackIndexes);break;case"alphaTab.updateSettings":this.updateSettings(t.settings);break}}updateFontSizes(e){if(!(e instanceof Map)){const t=e;e=new Map;for(const r in t)e.set(r,t[r])}if(e){Ci.FontSizeLookupTables||(Ci.FontSizeLookupTables=new Map);for(let[t,r]of e)Ci.FontSizeLookupTables.set(t,r)}}updateSettings(e){sl.fromJson(this._renderer.settings,e)}renderMultiple(e,t){try{this._renderer.renderScore(e,t)}catch(r){this.error(r)}}error(e){V.error("Worker","An unexpected error occurred in worker",e),this._main.postMessage({cmd:"alphaTab.error",error:e})}}class fU{constructor(){this._canvas=null,this._color=new qe(0,0,0,255),this._font=new He("Arial",10,St.Plain),this._lineWidth=0;let e=document.createElement("span");e.classList.add("at"),document.body.appendChild(e);let t=window.getComputedStyle(e),r=t.fontFamily;(r.startsWith('"')||r.startsWith("'"))&&(r=r.substr(1,r.length-2)),this._musicFont=new He(r,parseFloat(t.fontSize),St.Plain),this._measureCanvas=document.createElement("canvas"),this._measureCanvas.width=10,this._measureCanvas.height=10,this._measureCanvas.style.width="10px",this._measureCanvas.style.height="10px",this._measureContext=this._measureCanvas.getContext("2d"),this._measureContext.textBaseline="hanging"}destroy(){}onRenderFinished(){return null}beginRender(e,t){this._canvas=document.createElement("canvas"),this._canvas.width=e*W.HighDpiFactor|0,this._canvas.height=t*W.HighDpiFactor|0,this._canvas.style.width=e+"px",this._canvas.style.height=t+"px",this._context=this._canvas.getContext("2d"),this._context.textBaseline="hanging",this._context.scale(W.HighDpiFactor,W.HighDpiFactor),this._context.lineWidth=this._lineWidth}endRender(){let e=this._canvas;return this._canvas=null,e}get color(){return this._color}set color(e){this._color.rgba!==e.rgba&&(this._color=e,this._context.strokeStyle=e.rgba,this._context.fillStyle=e.rgba)}get lineWidth(){return this._lineWidth}set lineWidth(e){this._lineWidth=e,this._context&&(this._context.lineWidth=e)}fillRect(e,t,r,n){r>0&&this._context.fillRect(e|0,t|0,r,n)}strokeRect(e,t,r,n){this._context.strokeRect(e|0,t|0,r,n)}beginPath(){this._context.beginPath()}closePath(){this._context.closePath()}moveTo(e,t){this._context.moveTo(e,t)}lineTo(e,t){this._context.lineTo(e,t)}quadraticCurveTo(e,t,r,n){this._context.quadraticCurveTo(e,t,r,n)}bezierCurveTo(e,t,r,n,s,a){this._context.bezierCurveTo(e,t,r,n,s,a)}fillCircle(e,t,r){this._context.beginPath(),this._context.arc(e,t,r,0,Math.PI*2,!0),this.fill()}strokeCircle(e,t,r){this._context.beginPath(),this._context.arc(e,t,r,0,Math.PI*2,!0),this.stroke()}fill(){this._context.fill(),this._context.beginPath()}stroke(){this._context.stroke(),this._context.beginPath()}get font(){return this._font}set font(e){this._font=e,this._context&&(this._context.font=e.toCssString(this.settings.display.scale)),this._measureContext.font=e.toCssString(this.settings.display.scale)}get textAlign(){switch(this._context.textAlign){case"left":return ue.Left;case"center":return ue.Center;case"right":return ue.Right;default:return ue.Left}}set textAlign(e){switch(e){case ue.Left:this._context.textAlign="left";break;case ue.Center:this._context.textAlign="center";break;case ue.Right:this._context.textAlign="right";break}}get textBaseline(){switch(this._context.textBaseline){case"hanging":return Se.Top;case"middle":return Se.Middle;case"bottom":return Se.Bottom;default:return Se.Top}}set textBaseline(e){switch(e){case Se.Top:this._context.textBaseline="hanging";break;case Se.Middle:this._context.textBaseline="middle";break;case Se.Bottom:this._context.textBaseline="bottom";break}}beginGroup(e){}endGroup(){}fillText(e,t,r){this._context.fillText(e,t,r)}measureText(e){const t=this._measureContext.measureText(e);return new cp(t.width,t.actualBoundingBoxDescent-t.actualBoundingBoxAscent)}fillMusicFontSymbol(e,t,r,n,s=!1){n!==w.None&&this.fillMusicFontSymbolText(e,t,r,String.fromCharCode(n),s)}fillMusicFontSymbols(e,t,r,n,s=!1){let a="";for(let o of n)o!==w.None&&(a+=String.fromCharCode(o));this.fillMusicFontSymbolText(e,t,r,a,s)}fillMusicFontSymbolText(e,t,r,n,s=!1){let a=this._context.textAlign,o=this._context.textBaseline,l=this._context.font;this._context.font=this._musicFont.toCssString(r),this._context.textBaseline="middle",s?this._context.textAlign="center":this._context.textAlign="left",this._context.fillText(n,e,t),this._context.textBaseline=o,this._context.font=l,this._context.textAlign=a}beginRotate(e,t,r){this._context.save(),this._context.translate(e,t),this._context.rotate(r*Math.PI/180)}endRotate(){this._context.restore()}}class Gn{constructor(e,t=!1){this._midiFile=e,this._smf1Mode=t}addTimeSignature(e,t,r){let n=0,s=r;for(;s=s>>1,s>0;)n++;this._midiFile.addEvent(new yB(0,e,t,n,48,8))}addRest(e,t,r){this._smf1Mode||this._midiFile.addEvent(new vB(e,t,r))}addNote(e,t,r,n,s,a){this._midiFile.addEvent(new SB(e,t,a,Gn.fixValue(n),Gn.fixValue(s))),this._midiFile.addEvent(new xB(e,t+r,a,Gn.fixValue(n),Gn.fixValue(s)))}static fixValue(e){return e>127?127:e<0?0:e}addControlChange(e,t,r,n,s){this._midiFile.addEvent(new kB(e,t,r,n,Gn.fixValue(s)))}addProgramChange(e,t,r,n){this._midiFile.addEvent(new TB(e,t,r,n))}addTempo(e,t){const r=6e7/t|0;this._midiFile.addEvent(new CB(e,r))}addBend(e,t,r,n){n>=Te.MaxPitchWheel?n=Te.MaxPitchWheel:n=Math.floor(n),this._midiFile.addEvent(new NB(e,t,r,n))}addNoteBend(e,t,r,n,s){this._smf1Mode?this.addBend(e,t,r,s):(s=s*Te.MaxPitchWheel20/Te.MaxPitchWheel,this._midiFile.addEvent(new BB(e,t,r,n,s)))}finishTrack(e,t){(this._midiFile.format==nl.MultiTrack||e==0)&&this._midiFile.addEvent(new _B(e,t))}}class pU{constructor(e,t){this.closingIndex=0,this.group=e,this.opening=t,e.closings=e.closings.sort((r,n)=>r.index-n.index),this.iterations=e.closings.map(r=>0)}}class gU{get finished(){return this.index>=this._score.masterBars.length}constructor(e){this._repeatStack=[],this._groupsOnStack=new Set,this._previousAlternateEndings=0,this.shouldPlay=!0,this.index=0,this.currentTick=0,this._score=e}processCurrent(){const e=this._score.masterBars[this.index];let t=e.alternateEndings;if(t===0&&(t=this._previousAlternateEndings),e===e.repeatGroup.opening&&e.repeatGroup.isClosed&&!this._groupsOnStack.has(e.repeatGroup)){const r=new pU(e.repeatGroup,e);this._repeatStack.push(r),this._groupsOnStack.add(e.repeatGroup),this._previousAlternateEndings=0,t=e.alternateEndings}if(this._repeatStack.length===0||t===0)this.shouldPlay=!0;else{const r=this._repeatStack[this._repeatStack.length-1],n=r.iterations[r.closingIndex];this._previousAlternateEndings=t,t&1<<n?this.shouldPlay=!0:this.shouldPlay=!1}this.shouldPlay&&(this.currentTick+=e.calculateDuration())}moveNext(){const t=this._score.masterBars[this.index].repeatCount-1;if(this._repeatStack.length>0&&t>0){const r=this._repeatStack[this._repeatStack.length-1];if(r.iterations[r.closingIndex]<t){this.index=r.opening.index,r.iterations[r.closingIndex]++;for(let s=0;s<r.closingIndex;s++)r.iterations[s]=0;r.closingIndex=0,this._previousAlternateEndings=0}else r.closingIndex<r.group.closings.length-1?(r.closingIndex++,this.index++):(this._repeatStack.pop(),this._groupsOnStack.delete(r.group),this.index++)}else this.index++}}class mU{constructor(e,t){this.beat=e,this.playbackStart=t}}class Yr{get duration(){return this.end-this.start}constructor(e,t){this._highlightedBeats=new Map,this.highlightedBeats=[],this.nextBeat=null,this.previousBeat=null,this.start=e,this.end=t}highlightBeat(e,t){e.isEmpty&&!e.voice.isEmpty||this._highlightedBeats.has(e.id)||(this._highlightedBeats.set(e.id,!0),this.highlightedBeats.push(new mU(e,t)))}getVisibleBeatAtStart(e){for(const t of this.highlightedBeats)if(t.playbackStart==this.start&&e.has(t.beat.voice.bar.staff.track.index))return t.beat;return null}}class ih{constructor(e,t){this.tick=e,this.tempo=t}}class DB{constructor(){this.start=0,this.end=0,this.tempoChanges=[],this.firstBeat=null,this.lastBeat=null,this.nextMasterBar=null,this.previousMasterBar=null}get tempo(){return this.tempoChanges[0].tempo}insertAfter(e,t){this.firstBeat==null||e==null||this.lastBeat==null?(this.firstBeat=t,this.lastBeat=t):(t.nextBeat=e.nextBeat,t.previousBeat=e,e.nextBeat&&(e.nextBeat.previousBeat=t),e.nextBeat=t,e==this.lastBeat&&(this.lastBeat=t))}insertBefore(e,t){this.firstBeat==null||e==null||this.lastBeat==null?(this.firstBeat=t,this.lastBeat=t):(t.previousBeat=e.previousBeat,t.nextBeat=e,e.previousBeat&&(e.previousBeat.nextBeat=t),e.previousBeat=t,e==this.firstBeat&&(this.firstBeat=t))}addBeat(e,t,r,n){const s=r+n;if(this.firstBeat==null){const a=new Yr(r,s);a.highlightBeat(e,t),this.insertAfter(this.firstBeat,a)}else if(r>=this.lastBeat.end){const a=new Yr(this.lastBeat.end,s);a.highlightBeat(e,t),this.insertAfter(this.lastBeat,a)}else{let a=null;if(r<this.firstBeat.start)a=this.firstBeat;else{let o=this.firstBeat;for(;o!=null;){if(r>=o.start&&r<o.end){a=o;break}o=o.nextBeat}if(a===null)throw new oi(ai.General,"Error on building lookup, unknown variant")}if(r<a.start)if(s==a.start){const o=new Yr(r,a.start);o.highlightBeat(e,t),this.insertBefore(this.firstBeat,o)}else if(s<a.end){const o=new Yr(r,a.start);o.highlightBeat(e,t),this.insertBefore(a,o);const l=new Yr(a.start,s);for(const u of a.highlightedBeats)l.highlightBeat(u.beat,u.playbackStart);l.highlightBeat(e,t),this.insertBefore(a,l),a.start=s}else if(s==a.end){const o=new Yr(r,a.start);o.highlightBeat(e,t),a.highlightBeat(e,t),this.insertBefore(a,o)}else{const o=new Yr(r,a.start);o.highlightBeat(e,t),a.highlightBeat(e,t),this.insertBefore(a,o),this.addBeat(e,t,a.end,s-a.end)}else if(r>a.start)if(s==a.end){const o=new Yr(a.start,r);for(const l of a.highlightedBeats)o.highlightBeat(l.beat,l.playbackStart);a.start=r,a.highlightBeat(e,t),this.insertBefore(a,o)}else if(s<a.end){const o=new Yr(a.start,r);this.insertBefore(a,o);const l=new Yr(r,s);this.insertBefore(a,l);for(const u of a.highlightedBeats)o.highlightBeat(u.beat,u.playbackStart),l.highlightBeat(u.beat,u.playbackStart);l.highlightBeat(e,t),a.start=s}else{const o=new Yr(a.start,r);for(const l of a.highlightedBeats)o.highlightBeat(l.beat,l.playbackStart);a.start=r,a.highlightBeat(e,t),this.insertBefore(a,o),this.addBeat(e,t,a.end,s-a.end)}else if(s===a.end)a.highlightBeat(e,t);else if(s<a.end){const o=new Yr(a.start,s);for(const l of a.highlightedBeats)o.highlightBeat(l.beat,l.playbackStart);o.highlightBeat(e,t),a.start=s,this.insertBefore(a,o)}else a.highlightBeat(e,t),this.addBeat(e,t,a.end,s-a.end)}}}class yU{get start(){return this.masterBar.start+this.beatLookup.start}get end(){return this.start+this.tickDuration}constructor(e){this.nextBeat=null,this.tickDuration=0,this.duration=0,this.masterBar=e}calculateDuration(){if(this.masterBar.tempoChanges.length===1)this.duration=we.ticksToMillis(this.tickDuration,this.masterBar.tempoChanges[0].tempo);else{let e=0,t=this.start,r=this.masterBar.tempoChanges[0].tempo;const n=this.end;for(const s of this.masterBar.tempoChanges)if(s.tick<t)r=s.tempo;else{if(s.tick>n)break;e+=we.ticksToMillis(s.tick-t,r),r=s.tempo,t=s.tick}n>t&&(e+=we.ticksToMillis(n-t,r)),this.duration=e}}}class bU{constructor(){this._currentMasterBar=null,this.masterBarLookup=new Map,this.masterBars=[]}findBeat(e,t,r=null){let n=null;return r&&(n=this.findBeatFast(e,r,t)),n||(n=this.findBeatSlow(e,r,t,!1)),n}findBeatFast(e,t,r){if(r>=t.start&&r<t.end)return t;if(t.nextBeat&&r>=t.nextBeat.start&&r<t.nextBeat.end){const n=t.nextBeat;return this.fillNextBeat(n,e),n}return null}fillNextBeat(e,t){e.nextBeat=this.findBeatInMasterBar(e.masterBar,e.beatLookup.nextBeat,e.end,t,!1,!0),e.nextBeat==null&&(e.nextBeat=this.findBeatSlow(t,e,e.end,!0)),e.nextBeat&&(e.tickDuration=e.nextBeat.start-e.start,e.calculateDuration()),e.nextBeat||(e.tickDuration=e.masterBar.end-e.start,e.calculateDuration())}findBeatSlow(e,t,r,n){let s=null;if(t!=null&&(t.masterBar.start<=r&&t.masterBar.end>r?s=t.masterBar:t.masterBar.nextMasterBar&&t.masterBar.nextMasterBar.start<=r&&t.masterBar.nextMasterBar.end>r&&(s=t.masterBar.nextMasterBar)),s||(s=this.findMasterBar(r)),!s)return null;for(;s;){if(s.firstBeat){let a=this.findBeatInMasterBar(s,s.firstBeat,r,e,!0,n);if(a)return a}s=s.nextMasterBar}return null}findBeatInMasterBar(e,t,r,n,s,a){if(!t)return null;let o=null,l=null;const u=r-e.start;for(;t!=null&&l==null;){if(t.start<=u&&u<t.end){if(o=t,l=t.getVisibleBeatAtStart(n),!l)if(a){let h=e;for(;h!=null&&l==null;){for(;t!=null;){if(l=t.getVisibleBeatAtStart(n),l){o=t,e=h;break}t=t.nextBeat}(!l||!o)&&(h=h.nextMasterBar,t=(h==null?void 0:h.firstBeat)??null)}}else{let h=e;for(;h!=null&&l==null;){for(;t!=null;){if(l=t.getVisibleBeatAtStart(n),l){o=t,e=h;break}t=t.previousBeat}(!l||!o)&&(h=h.previousMasterBar,t=(h==null?void 0:h.firstBeat)??null)}}}else if(t.end>u)break;t=(t==null?void 0:t.nextBeat)??null}return l==null?null:this.createResult(e,o,l,s,n)}createResult(e,t,r,n,s){const a=new yU(e);return a.beat=r,a.beatLookup=t,a.tickDuration=t.end-t.start,n&&this.fillNextBeat(a,s),a.calculateDuration(),a}findMasterBar(e){const t=this.masterBars;let r=0,n=t.length-1;for(;r<=n;){const s=(n+r)/2|0,a=t[s];if(e>=a.start&&e<a.end)return a;e<a.start?n=s-1:r=s+1}return null}getMasterBar(e){if(!this.masterBarLookup.has(e.index)){const t=new DB;return t.masterBar=e,t}return this.masterBarLookup.get(e.index)}getMasterBarStart(e){return this.masterBarLookup.has(e.index)?this.masterBarLookup.get(e.index).start:0}getBeatStart(e){return this.masterBarLookup.has(e.voice.bar.index)?this.masterBarLookup.get(e.voice.bar.index).start+e.playbackStart:0}addMasterBar(e){this.masterBars.push(e),this._currentMasterBar&&(e.previousMasterBar=this._currentMasterBar,this._currentMasterBar.nextMasterBar=e),this._currentMasterBar=e,this.masterBarLookup.has(e.masterBar.index)||this.masterBarLookup.set(e.masterBar.index,e)}addBeat(e,t,r){const n=this._currentMasterBar;if(n)if(t<0&&n.previousMasterBar){const s=n.previousMasterBar.end-n.previousMasterBar.start,a=s+t,o=a+r;if(n.previousMasterBar.addBeat(e,a,a,r),o>s){const l=r+t;n.addBeat(e,t,0,l)}}else n.addBeat(e,t,t,r)}}class vU{constructor(){this.noteOnly=0,this.untilTieOrSlideEnd=0,this.letRingEnd=0}}class wU{constructor(){this.firstBeatDuration=0,this.secondBeatStartOffset=0,this.secondBeatDuration=0}}class je{constructor(e,t,r){this._programsPerChannel=new Map,this.tickLookup=new bU,this.applyTranspositionPitches=!0,this.transpositionPitches=new Map,this._currentTripletFeel=null,this.vibratoResolution=16,this._score=e,this._settings=t||new qa,this._handler=r}generate(){this.transpositionPitches.clear();for(const n of this._score.tracks)this.generateTrack(n);V.debug("Midi","Begin midi generation");const e=new gU(this._score);let t=null,r=this._score.tempo;for(;!e.finished;){const n=e.index,s=this._score.masterBars[n],a=e.currentTick;if(e.processCurrent(),e.shouldPlay){this.generateMasterBar(s,t,a,r),s.tempoAutomations.length>0&&(r=s.tempoAutomations[0].value);for(const o of this._score.tracks)for(const l of o.staves)n<l.bars.length&&this.generateBar(l.bars[n],a,r);s.tempoAutomations.length>0&&(r=s.tempoAutomations[s.tempoAutomations.length-1].value)}e.moveNext(),t=s}for(const n of this._score.tracks)this._handler.finishTrack(n.index,e.currentTick);V.debug("Midi","Midi generation done")}generateTrack(e){this.generateChannel(e,e.playbackInfo.primaryChannel,e.playbackInfo),e.playbackInfo.primaryChannel!==e.playbackInfo.secondaryChannel&&this.generateChannel(e,e.playbackInfo.secondaryChannel,e.playbackInfo)}addProgramChange(e,t,r,n){(!this._programsPerChannel.has(r)||this._programsPerChannel.get(r)!==n)&&(this._handler.addProgramChange(e.index,t,r,n),this._programsPerChannel.set(r,n))}static buildTranspositionPitches(e,t){const r=new Map;for(const n of e.tracks){const s=n.index<t.notation.transpositionPitches.length?t.notation.transpositionPitches[n.index]:0;r.set(n.playbackInfo.primaryChannel,s),r.set(n.playbackInfo.secondaryChannel,s)}return r}generateChannel(e,t,r){const n=e.index<this._settings.notation.transpositionPitches.length?this._settings.notation.transpositionPitches[e.index]:0;this.transpositionPitches.set(t,n);let s=je.toChannelShort(r.volume),a=je.toChannelShort(r.balance);this._handler.addControlChange(e.index,0,t,Qe.VolumeCoarse,s),this._handler.addControlChange(e.index,0,t,Qe.PanCoarse,a),this._handler.addControlChange(e.index,0,t,Qe.ExpressionControllerCoarse,127),this._handler.addControlChange(e.index,0,t,Qe.RegisteredParameterFine,0),this._handler.addControlChange(e.index,0,t,Qe.RegisteredParameterCourse,0),this._handler.addControlChange(e.index,0,t,Qe.DataEntryFine,0),this._handler.addControlChange(e.index,0,t,Qe.DataEntryCoarse,je.PitchBendRangeInSemitones),this.addProgramChange(e,0,t,r.program)}static toChannelShort(e){const t=Math.max(-32768,Math.min(32767,e*8-1));return Math.max(t,-1)+1}generateMasterBar(e,t,r,n){(!t||t.timeSignatureDenominator!==e.timeSignatureDenominator||t.timeSignatureNumerator!==e.timeSignatureNumerator)&&this._handler.addTimeSignature(r,e.timeSignatureNumerator,e.timeSignatureDenominator);const s=e.calculateDuration(),a=new DB;if(e.tempoAutomations.length>0){e.tempoAutomations[0].ratioPosition>0&&a.tempoChanges.push(new ih(r,n));for(const o of e.tempoAutomations){const l=r+s*o.ratioPosition;this._handler.addTempo(l,o.value),a.tempoChanges.push(new ih(l,o.value))}}else t?a.tempoChanges.push(new ih(r,n)):(this._handler.addTempo(r,e.score.tempo),a.tempoChanges.push(new ih(r,e.score.tempo)));a.masterBar=e,a.start=r,a.end=a.start+s,this.tickLookup.addMasterBar(a)}generateBar(e,t,r){let n=this.getPlaybackBar(e);for(const s of n.voices)this.generateVoice(s,t,e,r)}getPlaybackBar(e){switch(e.simileMark){case Fr.Simple:e.previousBar&&(e=this.getPlaybackBar(e.previousBar));break;case Fr.FirstOfDouble:e.previousBar&&e.previousBar.previousBar&&(e=this.getPlaybackBar(e.previousBar.previousBar));break;case Fr.SecondOfDouble:e.previousBar&&e.previousBar.previousBar&&(e=this.getPlaybackBar(e.previousBar.previousBar));break}return e}generateVoice(e,t,r,n){if(e.isEmpty&&(!e.bar.isEmpty||e.index!==0))return;const s=r.masterBar.tempoAutomations.slice();let a=n;const o=r.masterBar.calculateDuration();for(const l of e.beats){const u=l.playbackStart/o;for(;s.length>0&&s[0].ratioPosition<=u;)a=s.shift().value;this.generateBeat(l,t,r,a)}}generateBeat(e,t,r,n){let s=e.playbackStart,a=e.playbackDuration;const o=e.voice.bar.masterBar.calculateDuration();e.voice.bar.isEmpty?a=o:e.voice.bar.masterBar.tripletFeel!==Be.NoTripletFeel&&this._settings.player.playTripletFeel&&(this._currentTripletFeel?(s-=this._currentTripletFeel.secondBeatStartOffset,a=this._currentTripletFeel.secondBeatDuration,this._currentTripletFeel=null):(this._currentTripletFeel=je.calculateTripletFeelInfo(s,a,e),this._currentTripletFeel&&(a=this._currentTripletFeel.firstBeatDuration))),r===e.voice.bar?this.tickLookup.addBeat(e,s,a):this.tickLookup.addBeat(e,0,a);const l=e.voice.bar.staff.track;for(const u of e.automations)this.generateNonTempoAutomation(e,u,t);if(e.isRest)this._handler.addRest(l.index,t+s,l.playbackInfo.primaryChannel);else{let u=this.getBrushInfo(e);for(const c of e.notes)this.generateNote(c,t+s,a,n,u)}if(e.vibrato!==Ue.None){let u=240,c=3;switch(e.vibrato){case Ue.Slight:u=this._settings.player.vibrato.beatSlightLength,c=this._settings.player.vibrato.beatSlightAmplitude;break;case Ue.Wide:u=this._settings.player.vibrato.beatWideLength,c=this._settings.player.vibrato.beatWideAmplitude;break}this.generateVibratorWithParams(t+s,e.playbackDuration,u,c,(h,d)=>{this._handler.addBend(e.voice.bar.staff.track.index,h,l.playbackInfo.secondaryChannel,d)})}}static calculateTripletFeelInfo(e,t,r){let n;switch(r.voice.bar.masterBar.tripletFeel){case Be.Triplet8th:case Be.Dotted8th:case Be.Scottish8th:n=_.Eighth;break;case Be.Triplet16th:case Be.Dotted16th:case Be.Scottish16th:n=_.Sixteenth;break;default:return null}const s=we.toTicks(n);if(t!==s||e%s!==0||!r.nextBeat||r.nextBeat.voice!==r.voice||r.playbackDuration!==s)return null;const a=new wU;switch(r.voice.bar.masterBar.tripletFeel){case Be.Triplet8th:a.firstBeatDuration=we.applyTuplet(we.toTicks(_.Quarter),3,2),a.secondBeatDuration=we.applyTuplet(we.toTicks(_.Eighth),3,2);break;case Be.Dotted8th:a.firstBeatDuration=we.applyDot(we.toTicks(_.Eighth),!1),a.secondBeatDuration=we.toTicks(_.Sixteenth);break;case Be.Scottish8th:a.firstBeatDuration=we.toTicks(_.Sixteenth),a.secondBeatDuration=we.applyDot(we.toTicks(_.Eighth),!1);break;case Be.Triplet16th:a.firstBeatDuration=we.applyTuplet(we.toTicks(_.Eighth),3,2),a.secondBeatDuration=we.applyTuplet(we.toTicks(_.Sixteenth),3,2);break;case Be.Dotted16th:a.firstBeatDuration=we.applyDot(we.toTicks(_.Sixteenth),!1),a.secondBeatDuration=we.toTicks(_.ThirtySecond);break;case Be.Scottish16th:a.firstBeatDuration=we.toTicks(_.ThirtySecond),a.secondBeatDuration=we.applyDot(we.toTicks(_.Sixteenth),!1);break}return a.secondBeatStartOffset=t-a.firstBeatDuration,a}generateNote(e,t,r,n,s){const a=e.beat.voice.bar.staff.track,o=e.beat.voice.bar.staff;let l=e.calculateRealValue(this.applyTranspositionPitches,!0);if(e.isPercussion){const g=At.getArticulation(e);g&&(l=g.outputMidiNumber)}const u=e.isStringed&&e.string<=s.length?s[e.string-1]:0,c=t+u,h=this.getNoteDuration(e,r,n);h.untilTieOrSlideEnd-=u,h.noteOnly-=u,h.letRingEnd-=u;const d=je.getNoteVelocity(e),f=e.hasBend||e.beat.hasWhammyBar||e.beat.vibrato!==Ue.None?a.playbackInfo.secondaryChannel:a.playbackInfo.primaryChannel;let p=0;if(e.hasBend?p=je.getPitchWheel(e.bendPoints[0].value):e.beat.hasWhammyBar?p=je.getPitchWheel(e.beat.whammyBarPoints[0].value):e.isTieDestination||e.slideOrigin&&e.slideOrigin.slideOutType===xe.Legato?p=-1:p=je.getPitchWheel(0),p>=0&&this._handler.addNoteBend(a.index,c,f,l,p),e.beat.fadeIn&&this.generateFadeIn(e,c,h),e.isTrill&&!o.isPercussion){this.generateTrill(e,c,h,l,d,f);return}if(e.beat.isTremolo){this.generateTremoloPicking(e,c,h,l,d,f);return}if(e.hasBend?this.generateBend(e,c,h,l,f,n):e.beat.hasWhammyBar&&e.index===0?this.generateWhammy(e.beat,c,h,f,n):e.slideInType!==ri.None||e.slideOutType!==xe.None?this.generateSlide(e,c,h,l,f,n):(e.vibrato!==Ue.None||e.isTieDestination&&e.tieOrigin.vibrato!==Ue.None)&&this.generateVibrato(e,c,h,l,f),!e.isTieDestination&&(!e.slideOrigin||e.slideOrigin.slideOutType!==xe.Legato)){let g=Math.max(h.untilTieOrSlideEnd,h.letRingEnd);this._handler.addNote(a.index,c,g,l,d,f)}}getNoteDuration(e,t,r){const n=new vU;if(n.noteOnly=t,n.untilTieOrSlideEnd=t,n.letRingEnd=t,e.isDead)return n.noteOnly=this.applyStaticDuration(je.DefaultDurationDead,t,r),n.untilTieOrSlideEnd=n.noteOnly,n.letRingEnd=n.noteOnly,n;if(e.isPalmMute)return n.noteOnly=this.applyStaticDuration(je.DefaultDurationPalmMute,t,r),n.untilTieOrSlideEnd=n.noteOnly,n.letRingEnd=n.noteOnly,n;if(e.isStaccato)return n.noteOnly=t/2|0,n.untilTieOrSlideEnd=n.noteOnly,n.letRingEnd=n.noteOnly,n;if(e.isTieOrigin){const s=e.tieDestination;if(s)if(e.isTieDestination){const a=this.getNoteDuration(s,s.beat.playbackDuration,r);n.untilTieOrSlideEnd=t+a.untilTieOrSlideEnd}else{const a=e.beat.absolutePlaybackStart,o=this.getNoteDuration(s,s.beat.playbackDuration,r),l=s.beat.absolutePlaybackStart+o.untilTieOrSlideEnd;n.untilTieOrSlideEnd=l-a}}else if(e.slideOutType===xe.Legato){const s=e.slideTarget;if(s){const a=e.beat.absolutePlaybackStart,o=this.getNoteDuration(s,s.beat.playbackDuration,r),l=s.beat.absolutePlaybackStart+o.untilTieOrSlideEnd;n.untilTieOrSlideEnd=l-a}}if(e.isLetRing&&this._settings.notation.notationMode===Zt.GuitarPro){let s=e.beat,a=0;const o=e.beat.voice.bar.masterBar.calculateDuration();for(;s.nextBeat;){let l=s.nextBeat;if(l.isRest||e.isStringed&&l.hasNoteOnString(e.string))break;if(s=s.nextBeat,a=s.absolutePlaybackStart-e.beat.absolutePlaybackStart+s.playbackDuration,a>o){a=o;break}}s===e.beat?n.letRingEnd=t:n.letRingEnd=a}else n.letRingEnd=n.untilTieOrSlideEnd;return n}applyStaticDuration(e,t,r){const n=r*e/$.MaxPosition|0;return Math.min(n,t)}static getNoteVelocity(e){let t=e.dynamics;switch(!e.beat.voice.bar.staff.isPercussion&&e.hammerPullOrigin&&t--,e.isGhost&&t--,e.accentuated){case jt.Normal:t++;break;case jt.Heavy:t+=2;break}return we.dynamicToVelocity(t)}generateFadeIn(e,t,r){const n=e.beat.voice.bar.staff.track,a=je.toChannelShort(n.playbackInfo.volume)/r.noteOnly,o=120,l=r.noteOnly/o|0,u=t+r.noteOnly;for(let c=l-1;c>=0;c--){const h=u-c*o,d=(h-t)*a;c===l-1&&(this._handler.addControlChange(n.index,t,n.playbackInfo.primaryChannel,Qe.VolumeCoarse,d),this._handler.addControlChange(n.index,t,n.playbackInfo.secondaryChannel,Qe.VolumeCoarse,d)),this._handler.addControlChange(n.index,h,n.playbackInfo.primaryChannel,Qe.VolumeCoarse,d),this._handler.addControlChange(n.index,h,n.playbackInfo.secondaryChannel,Qe.VolumeCoarse,d)}}generateVibrato(e,t,r,n,s){let a=0,o=0;switch(e.vibrato!==Ue.None?e.vibrato:e.isTieDestination?e.tieOrigin.vibrato:Ue.Slight){case Ue.Slight:a=this._settings.player.vibrato.noteSlightLength,o=this._settings.player.vibrato.noteSlightAmplitude;break;case Ue.Wide:a=this._settings.player.vibrato.noteWideLength,o=this._settings.player.vibrato.noteWideAmplitude;break;default:return}const u=e.beat.voice.bar.staff.track;this.generateVibratorWithParams(t,r.noteOnly,a,o,(c,h)=>{this._handler.addNoteBend(u.index,c,s,n,h)})}generateVibratorWithParams(e,t,r,n,s){const a=this.vibratoResolution,o=r/2|0;e+=r;const l=e+t;for(;e<l;){let u=0;const c=e+r<l?r:l-e;for(;u<c;){let h=n*Math.sin(u*Math.PI/o);s(e+u|0,je.getPitchWheel(h)),u+=a}e+=r}}static getPitchWheel(e){return Te.DefaultPitchWheel+e/2*je.PitchValuePerSemitone}generateSlide(e,t,r,n,s,a){let o=e.slideOutType===xe.Legato?r.noteOnly:r.untilTieOrSlideEnd,l=[],u=e.beat.voice.bar.staff.track;const c=this._settings.player.slide.simpleSlidePitchOffset,h=Math.floor($.MaxPosition*this._settings.player.slide.simpleSlideDurationRatio),d=Math.floor($.MaxPosition*this._settings.player.slide.shiftSlideDurationRatio);switch(e.slideInType){case ri.IntoFromAbove:l.push(new $(0,c)),l.push(new $(h,0));break;case ri.IntoFromBelow:l.push(new $(0,-c)),l.push(new $(h,0));break}switch(e.slideOutType){case xe.Legato:case xe.Shift:l.push(new $(d,0));const f=(e.slideTarget.calculateRealValue(this.applyTranspositionPitches,!0)-e.calculateRealValue(this.applyTranspositionPitches,!0))*2;l.push(new $($.MaxPosition,f));break;case xe.OutDown:l.push(new $($.MaxPosition-h,0)),l.push(new $($.MaxPosition,-c));break;case xe.OutUp:l.push(new $($.MaxPosition-h,0)),l.push(new $($.MaxPosition,c));break}this.generateWhammyOrBend(t,o,l,a,(f,p)=>{this._handler.addNoteBend(u.index,f,s,n,p)})}generateBend(e,t,r,n,s,a){let o=e.bendPoints,l=e.beat.voice.bar.staff.track;const u=(p,g)=>{this._handler.addNoteBend(l.index,p,s,n,g)};let c=null,h;if(e.isTieOrigin&&this._settings.notation.extendBendArrowsOnTiedNotes){let p=e;for(;p.isTieOrigin&&!p.tieDestination.hasBend;)p=p.tieDestination;h=p.beat.absolutePlaybackStart-e.beat.absolutePlaybackStart+this.getNoteDuration(p,p.beat.playbackDuration,a).noteOnly}else if(e.isTieOrigin&&e.beat.graceType!==ce.None){switch(e.tieDestination.bendType){case ee.Bend:case ee.BendRelease:case ee.PrebendBend:c=e.tieDestination.bendPoints[1].value;break;case ee.Prebend:case ee.PrebendRelease:c=e.tieDestination.bendPoints[0].value;break}h=Math.max(r.noteOnly,we.millisToTicks(this._settings.player.songBookBendDuration,a))}else h=r.noteOnly;o[0].value>0&&!e.isContinuedBend&&t>0&&t--;const d=Math.min(h,we.millisToTicks(this._settings.player.songBookBendDuration,a));let f=[];switch(e.bendType){case ee.Custom:f=o;break;case ee.Bend:case ee.Release:switch(e.bendStyle){case Je.Default:f=o;break;case Je.Gradual:f.push(new $(0,e.bendPoints[0].value)),(!c||c<e.bendPoints[1].value)&&(c=e.bendPoints[1].value),f.push(new $($.MaxPosition,c));break;case Je.Fast:(!c||c<e.bendPoints[1].value)&&(c=e.bendPoints[1].value),e.beat.graceType===ce.BendGrace?this.generateSongBookWhammyOrBend(t,h,!0,[e.bendPoints[0].value,c],d,a,u):this.generateSongBookWhammyOrBend(t,h,!1,[e.bendPoints[0].value,c],d,a,u);return}break;case ee.BendRelease:switch(e.bendStyle){case Je.Default:f=o;break;case Je.Gradual:f.push(new $(0,e.bendPoints[0].value)),f.push(new $($.MaxPosition/2|0,e.bendPoints[1].value)),f.push(new $($.MaxPosition,e.bendPoints[2].value));break;case Je.Fast:this.generateSongBookWhammyOrBend(t,h,!1,[e.bendPoints[0].value,e.bendPoints[1].value,e.bendPoints[2].value],d,a,u);return}break;case ee.Hold:f=o;break;case ee.Prebend:f=o;break;case ee.PrebendBend:switch(e.bendStyle){case Je.Default:f=o;break;case Je.Gradual:f.push(new $(0,e.bendPoints[0].value)),f.push(new $($.MaxPosition,e.bendPoints[1].value));break;case Je.Fast:const p=je.getPitchWheel(e.bendPoints[0].value);u(t,p|0),(!c||c<e.bendPoints[1].value)&&(c=e.bendPoints[1].value),this.generateSongBookWhammyOrBend(t,h,!1,[e.bendPoints[0].value,c],d,a,u);return}break;case ee.PrebendRelease:switch(e.bendStyle){case Je.Default:f=o;break;case Je.Gradual:f.push(new $(0,e.bendPoints[0].value)),f.push(new $($.MaxPosition,e.bendPoints[1].value));break;case Je.Fast:const p=je.getPitchWheel(e.bendPoints[0].value);u(t,p|0),this.generateSongBookWhammyOrBend(t,h,!1,[e.bendPoints[0].value,e.bendPoints[1].value],d,a,u);return}break}this.generateWhammyOrBend(t,h,f,a,u)}generateSongBookWhammyOrBend(e,t,r,n,s,a,o){const l=r?e:e+t-s,u=s/(n.length-1);for(let c=0;c<n.length-1;c++){const h=je.getPitchWheel(n[c]),d=je.getPitchWheel(n[c+1]),f=l+u*c;this.generateBendValues(f,u,h,d,a,o)}}generateWhammy(e,t,r,n,s){const a=e.whammyBarPoints,o=e.voice.bar.staff.track,l=r.noteOnly;a[0].value>0&&!e.isContinuedWhammy&&t--;const u=(h,d)=>{this._handler.addBend(o.index,h,n,d)};let c=[];switch(e.whammyBarType){case Ge.Custom:c=a;break;case Ge.Dive:switch(e.whammyStyle){case Je.Default:c=a;break;case Je.Gradual:c.push(new $(0,a[0].value)),c.push(new $($.MaxPosition,a[1].value));break;case Je.Fast:const h=Math.min(l,we.millisToTicks(this._settings.player.songBookBendDuration,s));this.generateSongBookWhammyOrBend(t,l,!1,[a[0].value,a[1].value],h,s,u);return}break;case Ge.Dip:switch(e.whammyStyle){case Je.Default:c=a;break;case Je.Gradual:c.push(new $(0,a[0].value)),c.push(new $($.MaxPosition/2|0,a[1].value)),c.push(new $($.MaxPosition,a[2].value));break;case Je.Fast:const h=Math.min(l,we.millisToTicks(this._settings.player.songBookDipDuration,s));this.generateSongBookWhammyOrBend(t,l,!0,[a[0].value,a[1].value,a[2].value],h,s,u);return}break;case Ge.Hold:c=a;break;case Ge.Predive:c=a;break;case Ge.PrediveDive:switch(e.whammyStyle){case Je.Default:c=a;break;case Je.Gradual:c.push(new $(0,a[0].value)),c.push(new $($.MaxPosition/2|0,a[0].value)),c.push(new $($.MaxPosition,a[1].value));break;case Je.Fast:const h=je.getPitchWheel(a[0].value);this._handler.addBend(o.index,t,n,h|0);const d=Math.min(l,we.millisToTicks(this._settings.player.songBookBendDuration,s));this.generateSongBookWhammyOrBend(t,l,!1,[a[0].value,a[1].value],d,s,u);return}break}this.generateWhammyOrBend(t,l,c,s,u)}generateWhammyOrBend(e,t,r,n,s){const a=t/$.MaxPosition;for(let o=0;o<r.length-1;o++){const l=r[o],u=r[o+1],c=je.getPitchWheel(l.value),h=je.getPitchWheel(u.value),d=a*(u.offset-l.offset),f=e+a*l.offset;this.generateBendValues(f,d,c,h,n,s)}}generateBendValues(e,t,r,n,s,a){const o=we.ticksToMillis(t,s),l=Math.abs(n-r)/je.PitchValuePerSemitone,u=Math.max(je.MinBreakpointsPerSemitone*l,o/je.MillisecondsPerBreakpoint),c=t/u,h=(n-r)/u;for(let d=0;d<u;d++)a(e|0,Math.round(r)),r+=h,e+=c;r<n&&a(e|0,n)}generateTrill(e,t,r,n,s,a){const o=e.beat.voice.bar.staff.track,l=e.stringTuning+e.trillFret;let u=we.toTicks(e.trillSpeed),c=!0,h=t,d=t+r.untilTieOrSlideEnd;for(;h+10<d;)h+u>=d&&(u=d-h),this._handler.addNote(o.index,h,u,c?l:n,s,a),c=!c,h+=u}generateTremoloPicking(e,t,r,n,s,a){const o=e.beat.voice.bar.staff.track;let l=we.toTicks(e.beat.tremoloSpeed),u=t;const c=t+r.untilTieOrSlideEnd;for(;u+10<c;)u+l>=c&&(l=c-u),this._handler.addNote(o.index,u,l,n,s,a),u+=l}getBrushInfo(e){const t=new Int32Array(e.voice.bar.staff.tuning.length);if(e.brushType!==lt.None){let r=0,n=0;for(const s of e.notes)s.isTieDestination||(r|=1<<s.string-1,n++);if(e.notes.length>0){let s=0;const a=e.brushDuration/(n-1)|0;for(let o=0;o<e.voice.bar.staff.tuning.length;o++){let l=e.brushType===lt.ArpeggioDown||e.brushType===lt.BrushDown?o:t.length-1-o;r&1<<l&&(t[l]=s,s+=a)}}}return t}generateNonTempoAutomation(e,t,r){switch(t.type){case $t.Instrument:this.addProgramChange(e.voice.bar.staff.track,e.playbackStart+r,e.voice.bar.staff.track.playbackInfo.primaryChannel,(t.value|0)&255),this.addProgramChange(e.voice.bar.staff.track,e.playbackStart+r,e.voice.bar.staff.track.playbackInfo.secondaryChannel,(t.value|0)&255);break;case $t.Balance:let n=je.toChannelShort(t.value);this._handler.addControlChange(e.voice.bar.staff.track.index,e.playbackStart+r,e.voice.bar.staff.track.playbackInfo.primaryChannel,Qe.PanCoarse,n),this._handler.addControlChange(e.voice.bar.staff.track.index,e.playbackStart+r,e.voice.bar.staff.track.playbackInfo.secondaryChannel,Qe.PanCoarse,n);break;case $t.Volume:let s=je.toChannelShort(t.value);this._handler.addControlChange(e.voice.bar.staff.track.index,e.playbackStart+r,e.voice.bar.staff.track.playbackInfo.primaryChannel,Qe.VolumeCoarse,s),this._handler.addControlChange(e.voice.bar.staff.track.index,e.playbackStart+r,e.voice.bar.staff.track.playbackInfo.secondaryChannel,Qe.VolumeCoarse,s);break}}prepareSingleBeat(e){let t=-1,r=-1,n=e;for(;n&&(t===-1||r===-1);){for(const c of e.automations)switch(c.type){case $t.Instrument:r=c.value;break;case $t.Tempo:t=c.value;break}n=n.previousBeat}const s=e.voice.bar.staff.track,a=e.voice.bar.masterBar;t===-1&&(t=a.score.tempo);const o=e.playbackStart/a.calculateDuration();for(const c of a.tempoAutomations)if(c.ratioPosition<=o)t=c.value;else break;r===-1&&(r=s.playbackInfo.program);const l=s.playbackInfo.volume;this.generateTrack(s),this._handler.addTimeSignature(0,a.timeSignatureNumerator,a.timeSignatureDenominator),this._handler.addTempo(0,t);let u=je.toChannelShort(l);return this._handler.addControlChange(0,0,s.playbackInfo.primaryChannel,Qe.VolumeCoarse,u),this._handler.addControlChange(0,0,s.playbackInfo.secondaryChannel,Qe.VolumeCoarse,u),t}generateSingleBeat(e){const t=this.prepareSingleBeat(e);this.generateBeat(e,-e.playbackStart,e.voice.bar,t)}generateSingleNote(e){const t=this.prepareSingleBeat(e.beat);this.generateNote(e,0,e.beat.playbackDuration,t,new Int32Array(e.beat.voice.bar.staff.tuning.length))}}je.DefaultDurationDead=30;je.DefaultDurationPalmMute=80;je.PitchBendRangeInSemitones=8*2;je.PitchValuePerSemitone=Te.DefaultPitchWheel/je.PitchBendRangeInSemitones;je.MinBreakpointsPerSemitone=6;je.MillisecondsPerBreakpoint=150;class FB{constructor(){this.startTick=0,this.endTick=0}}class Mt{constructor(e,t){this.width=0,this.height=0,this.x=e,this.y=t}get scale(){return this.renderer.scale}doLayout(){}paint(e,t,r){}}class In extends Mt{constructor(e=0,t=0){super(e,t),this.beat=null,this.nextGlyph=null,this.previousGlyph=null}}class _t extends In{constructor(e,t,r,n){super(e,t),this.glyphScale=0,this.glyphScale=r,this.symbol=n}paint(e,t,r){r.fillMusicFontSymbol(e+this.x,t+this.y,this.glyphScale*this.scale,this.symbol,!1)}}class ke extends _t{constructor(e,t,r,n){super(e,t,n?ke.GraceScale:1,ke.getSymbol(r)),this._isGrace=n,this._duration=r}paint(e,t,r){let n=this._isGrace?this.scale:0;r.fillMusicFontSymbol(e+this.x,t+this.y+n,this.glyphScale*this.scale,this.symbol,!1)}doLayout(){let e=(this._isGrace?ke.GraceScale:1)*this.scale;switch(this._duration){case _.QuadrupleWhole:this.width=14*e;break;case _.DoubleWhole:this.width=14*(this._isGrace?ke.GraceScale:1)*this.scale;break;case _.Whole:this.width=14*(this._isGrace?ke.GraceScale:1)*this.scale;break;default:this.width=ke.QuarterNoteHeadWidth*(this._isGrace?ke.GraceScale:1)*this.scale;break}this.height=ke.NoteHeadHeight*e}static getSymbol(e){switch(e){case _.QuadrupleWhole:return w.NoteheadDoubleWholeSquare;case _.DoubleWhole:return w.NoteheadDoubleWhole;case _.Whole:return w.NoteheadWhole;case _.Half:return w.NoteheadHalf;default:return w.NoteheadBlack}}}ke.GraceScale=.75;ke.NoteHeadHeight=8;ke.QuarterNoteHeadWidth=9;class bc extends _t{constructor(e,t,r,n,s){super(e,t,s?ke.GraceScale:1,bc.getSymbol(r,n,s))}doLayout(){this.width=0}static getSymbol(e,t,r){if(r&&(e=_.Eighth),t===H.Up)switch(e){case _.Eighth:return w.FlagEighthUp;case _.Sixteenth:return w.FlagSixteenthUp;case _.ThirtySecond:return w.FlagThirtySecondUp;case _.SixtyFourth:return w.FlagSixtyFourthUp;case _.OneHundredTwentyEighth:return w.FlagOneHundredTwentyEighthUp;case _.TwoHundredFiftySixth:return w.FlagTwoHundredFiftySixthUp;default:return w.FlagEighthUp}switch(e){case _.Eighth:return w.FlagEighthDown;case _.Sixteenth:return w.FlagSixteenthDown;case _.ThirtySecond:return w.FlagThirtySecondDown;case _.SixtyFourth:return w.FlagSixtyFourthDown;case _.OneHundredTwentyEighth:return w.FlagOneHundredTwentyEighthDown;case _.TwoHundredFiftySixth:return w.FlagOneHundredTwentyEighthDown;default:return w.FlagEighthDown}}}bc.FlagWidth=11;class tn extends Mt{get onTimeX(){return this.onNotes.x+this.onNotes.centerX}constructor(e,t){super(0,0),this.ties=[],this.minWidth=0,this.beat=e,this.ties=[],this.voiceContainer=t}addTie(e){e.renderer=this.renderer,this.ties.push(e)}drawBeamHelperAsFlags(e){return e.hasFlag(!1,void 0)}registerLayoutingInfo(e){let t=this.preNotes.computedWidth+this.onNotes.centerX;this.beat.graceGroup&&!this.beat.graceGroup.isComplete&&(t+=tn.GraceBeatPadding*this.renderer.scale);let r=this.onNotes.computedWidth-this.onNotes.centerX;const n=this.renderer.helpers.getBeamingHelperForBeat(this.beat);(n&&this.drawBeamHelperAsFlags(n)||this.beat.graceType!==ce.None)&&(r+=bc.FlagWidth*this.scale*(this.beat.graceType!==ce.None?ke.GraceScale:1));for(const s of this.ties)r+=s.width;this.beat.graceType!==ce.None&&(r+=tn.GraceBeatPadding*this.renderer.scale),e.addBeatSpring(this.beat,t,r),e.setPreBeatSize(this.beat,this.preNotes.computedWidth),e.setOnBeatSize(this.beat,this.onNotes.computedWidth),e.setBeatCenterX(this.beat,this.onNotes.centerX)}applyLayoutingInfo(e){let t=e.getBeatCenterX(this.beat)-this.onNotes.centerX;this.beat.graceGroup&&!this.beat.graceGroup.isComplete&&(t+=tn.GraceBeatPadding*this.renderer.scale),this.preNotes.x=t,this.preNotes.width=e.getPreBeatSize(this.beat),this.onNotes.width=e.getOnBeatSize(this.beat),this.onNotes.x=this.preNotes.x+this.preNotes.width,this.onNotes.updateBeamingHelper(),this.updateWidth()}doLayout(){this.preNotes.x=0,this.preNotes.renderer=this.renderer,this.preNotes.container=this,this.preNotes.doLayout(),this.onNotes.x=this.preNotes.x+this.preNotes.width,this.onNotes.renderer=this.renderer,this.onNotes.container=this,this.onNotes.doLayout();let e=this.beat.notes.length-1;for(;e>=0;)this.createTies(this.beat.notes[e--]);this.renderer.registerTies(this.ties),this.updateWidth()}updateWidth(){if(this.minWidth=this.preNotes.width+this.onNotes.width,!this.beat.isRest)if(this.onNotes.beamingHelper.beats.length===1)this.beat.duration>=_.Eighth&&(this.minWidth+=20*this.scale);else switch(this.beat.duration){case _.OneHundredTwentyEighth:case _.TwoHundredFiftySixth:this.minWidth+=10*this.scale;break}let e=0;for(let t of this.ties)t.width>e&&(e=t.width);this.minWidth+=e,this.width=this.minWidth}scaleToWidth(e){this.onNotes.updateBeamingHelper(),this.width=e}createTies(e){}static getGroupId(e){return"b"+e.id}paint(e,t,r){if(this.beat.voice.isEmpty||this.preNotes.isEmpty&&this.onNotes.isEmpty&&this.ties.length===0)return;r.beginGroup(tn.getGroupId(this.beat)),this.preNotes.paint(e+this.x,t+this.y,r),this.onNotes.paint(e+this.x,t+this.y,r);let s=e-this.voiceContainer.x-this.renderer.x,a=t-this.voiceContainer.y-this.renderer.y;for(let o=0,l=this.ties.length;o<l;o++){let u=this.ties[o];u.renderer=this.renderer,u.paint(s,a,r)}r.endGroup()}buildBoundingsLookup(e,t,r,n){let s=new MB;s.beat=this.beat,s.visualBounds=new ji,s.visualBounds.x=t+this.x+this.onNotes.x,s.visualBounds.y=e.visualBounds.y,s.visualBounds.w=this.onNotes.width,s.visualBounds.h=e.visualBounds.h,s.realBounds=new ji,s.realBounds.x=t+this.x,s.realBounds.y=e.realBounds.y,s.realBounds.w=this.width,s.realBounds.h=e.realBounds.h,n&&(s.visualBounds.x=t+this.x,s.realBounds.x=s.visualBounds.x),e.addBeat(s),this.renderer.settings.core.includeNoteBounds&&this.onNotes.buildBoundingsLookup(s,t+this.x,r+this.y)}}tn.GraceBeatPadding=3;class ES{constructor(){this.oldWidth=0,this.newWidth=0,this.settings=null}core(){return this.settings&&this.causeIssue()?this.settings.core:new XB}causeIssue(){return this.settings=null,!0}}class AB{constructor(e){this.activeBeats=e}}class rh{constructor(e){this.bounds=null,this.beat=e}}class SU{constructor(e,t){this._startTime=0,this._trackIndexes=null,this._trackIndexLookup=null,this._isDestroyed=!1,this.score=null,this.tracks=[],this._tickCache=null,this.player=null,this._cursorWrapper=null,this._barCursor=null,this._beatCursor=null,this._selectionWrapper=null,this._previousTick=0,this._playerState=Wt.Paused,this._currentBeat=null,this._currentBarBounds=null,this._previousStateForCursor=Wt.Paused,this._previousCursorCache=null,this._lastScroll=0,this.playedBeatChanged=new Fe,this.activeBeatsChanged=new Fe,this._beatMouseDown=!1,this._noteMouseDown=!1,this._selectionStart=null,this._selectionEnd=null,this.beatMouseDown=new Fe,this.beatMouseMove=new Fe,this.beatMouseUp=new Fe,this.noteMouseDown=new Fe,this.noteMouseMove=new Fe,this.noteMouseUp=new Fe,this.scoreLoaded=new Fe,this.resize=new Fe,this.renderStarted=new Fe,this.renderFinished=new Fe,this.postRenderFinished=new ei,this.error=new Fe,this.playerReady=new ei,this.playerFinished=new ei,this.soundFontLoaded=new ei,this.midiLoad=new Fe,this.midiLoaded=new Fe,this.playerStateChanged=new Fe,this.playerPositionChanged=new Fe,this.midiEventsPlayed=new Fe,this.playbackRangeChanged=new Fe,this.settingsUpdated=new ei,this.uiFacade=e,this.container=e.rootContainer,e.initialize(this,t),V.logLevel=this.settings.core.logLevel,this.canvasElement=e.createCanvasElement(),this.container.appendChild(this.canvasElement),this.settings.core.useWorkers&&this.uiFacade.areWorkersSupported&&W.getRenderEngineFactory(this.settings.core.engine).supportsWorkers?this.renderer=this.uiFacade.createWorkerRenderer():this.renderer=new LB(this.settings),this.container.resize.on(W.throttle(()=>{this._isDestroyed||this.container.width!==this.renderer.width&&this.triggerResize()},e.resizeThrottle));let r=new ES;r.oldWidth=this.renderer.width,r.newWidth=this.container.width|0,r.settings=this.settings,this.onResize(r),this.renderer.preRender.on(this.onRenderStarted.bind(this)),this.renderer.renderFinished.on(n=>{this.onRenderFinished(n)}),this.renderer.postRenderFinished.on(()=>{let n=Date.now()-this._startTime;V.debug("rendering","Rendering completed in "+n+"ms"),this.onPostRenderFinished()}),this.renderer.preRender.on(n=>{this._startTime=Date.now()}),this.renderer.partialLayoutFinished.on(this.appendRenderResult.bind(this)),this.renderer.partialRenderFinished.on(this.updateRenderResult.bind(this)),this.renderer.renderFinished.on(n=>{this.appendRenderResult(n),this.appendRenderResult(null)}),this.renderer.error.on(this.onError.bind(this)),this.settings.player.enablePlayer&&this.setupPlayer(),this.setupClickHandling(),this.uiFacade.beginInvoke(()=>{this.uiFacade.initialRender()})}destroy(){this._isDestroyed=!0,this.player&&this.player.destroy(),this.uiFacade.destroy(),this.renderer.destroy()}updateSettings(){var t;const e=this.score;e&&ct.applyPitchOffsets(this.settings,e),this.renderer.updateSettings(this.settings),this.settings.player.enablePlayer?(this.setupPlayer(),e&&((t=this.player)==null||t.applyTranspositionPitches(je.buildTranspositionPitches(e,this.settings)))):this.destroyPlayer(),this.onSettingsUpdated()}load(e,t){try{return this.uiFacade.load(e,r=>{this.renderScore(r,t)},r=>{this.onError(r)})}catch(r){return this.onError(r),!1}}renderScore(e,t){let r=[];if(!t)e.tracks.length>0&&r.push(e.tracks[0]);else if(t.length===0)e.tracks.length>0&&r.push(e.tracks[0]);else if(t.length===1&&t[0]===-1)for(let n of e.tracks)r.push(n);else for(let n of t)n>=0&&n<=e.tracks.length&&r.push(e.tracks[n]);this.internalRenderTracks(e,r)}renderTracks(e){if(e.length>0){let t=e[0].score;for(let r of e)if(r.score!==t){this.onError(new oi(ai.General,"All rendered tracks must belong to the same score."));return}this.internalRenderTracks(t,e)}}internalRenderTracks(e,t){if(ct.applyPitchOffsets(this.settings,e),e!==this.score){this.score=e,this.tracks=t,this._trackIndexes=[];for(let r of t)this._trackIndexes.push(r.index);this._trackIndexLookup=new Set(this._trackIndexes),this.onScoreLoaded(e),this.loadMidiForScore(),this.render()}else{this.tracks=t,this._trackIndexes=[];for(let r of t)this._trackIndexes.push(r.index);this._trackIndexLookup=new Set(this._trackIndexes),this.render()}}triggerResize(){if(!this.container.isVisible)V.warning("Rendering","AlphaTab container was invisible while autosizing, waiting for element to become visible",null),this.uiFacade.rootContainerBecameVisible.on(()=>{V.debug("Rendering","AlphaTab container became visible, doing autosizing",null),this.triggerResize()});else{let e=new ES;e.oldWidth=this.renderer.width,e.newWidth=this.container.width,e.settings=this.settings,this.onResize(e),this.renderer.updateSettings(this.settings),this.renderer.width=this.container.width,this.renderer.resizeRender()}}appendRenderResult(e){e?(this.canvasElement.width=e.totalWidth,this.canvasElement.height=e.totalHeight,this._cursorWrapper&&(this._cursorWrapper.width=e.totalWidth,this._cursorWrapper.height=e.totalHeight),(e.width>0||e.height>0)&&this.uiFacade.beginAppendRenderResults(e)):this.uiFacade.beginAppendRenderResults(e)}updateRenderResult(e){e&&e.renderResult&&this.uiFacade.beginUpdateRenderResults(e)}tex(e,t){try{let r=new Ti;r.logErrors=!0,r.initFromString(e,this.settings);let n=r.readScore();this.renderScore(n,t)}catch(r){this.onError(r)}}loadSoundFont(e,t=!1){return this.player?this.uiFacade.loadSoundFont(e,t):!1}resetSoundFonts(){this.player&&this.player.resetSoundFonts()}render(){this.renderer&&(this.uiFacade.canRender?(this.renderer.width=this.container.width,this.renderer.renderScore(this.score,this._trackIndexes)):this.uiFacade.canRenderChanged.on(()=>this.render()))}get tickCache(){return this._tickCache}get isReadyForPlayback(){return this.player?this.player.isReadyForPlayback:!1}get playerState(){return this.player?this.player.state:Wt.Paused}get masterVolume(){return this.player?this.player.masterVolume:0}set masterVolume(e){this.player&&(this.player.masterVolume=e)}get metronomeVolume(){return this.player?this.player.metronomeVolume:0}set metronomeVolume(e){this.player&&(this.player.metronomeVolume=e)}get countInVolume(){return this.player?this.player.countInVolume:0}set countInVolume(e){this.player&&(this.player.countInVolume=e)}get midiEventsPlayedFilter(){return this.player?this.player.midiEventsPlayedFilter:[]}set midiEventsPlayedFilter(e){this.player&&(this.player.midiEventsPlayedFilter=e)}get tickPosition(){return this.player?this.player.tickPosition:0}set tickPosition(e){this.player&&(this.player.tickPosition=e)}get timePosition(){return this.player?this.player.timePosition:0}set timePosition(e){this.player&&(this.player.timePosition=e)}get playbackRange(){return this.player?this.player.playbackRange:null}set playbackRange(e){this.player&&(this.player.playbackRange=e,this.settings.player.enableCursor&&this.updateSelectionCursor(e))}get playbackSpeed(){return this.player?this.player.playbackSpeed:0}set playbackSpeed(e){this.player&&(this.player.playbackSpeed=e)}get isLooping(){return this.player?this.player.isLooping:!1}set isLooping(e){this.player&&(this.player.isLooping=e)}destroyPlayer(){this.player&&(this.player.destroy(),this.player=null,this._previousTick=0,this._playerState=Wt.Paused,this.destroyCursors())}setupPlayer(){this.updateCursors(),!this.player&&(this.player=this.uiFacade.createWorkerPlayer(),this.player&&(this.player.ready.on(()=>{this.loadMidiForScore()}),this.player.readyForPlayback.on(()=>{if(this.onPlayerReady(),this.tracks)for(let e of this.tracks){let t=e.playbackInfo.volume/16;this.player.setChannelVolume(e.playbackInfo.primaryChannel,t),this.player.setChannelVolume(e.playbackInfo.secondaryChannel,t)}}),this.player.soundFontLoaded.on(this.onSoundFontLoaded.bind(this)),this.player.soundFontLoadFailed.on(e=>{this.onError(e)}),this.player.midiLoaded.on(this.onMidiLoaded.bind(this)),this.player.midiLoadFailed.on(e=>{this.onError(e)}),this.player.stateChanged.on(this.onPlayerStateChanged.bind(this)),this.player.positionChanged.on(this.onPlayerPositionChanged.bind(this)),this.player.midiEventsPlayed.on(this.onMidiEventsPlayed.bind(this)),this.player.playbackRangeChanged.on(this.onPlaybackRangeChanged.bind(this)),this.player.finished.on(this.onPlayerFinished.bind(this)),this.setupPlayerEvents()))}loadMidiForScore(){if(!this.player||!this.score||!this.player.isReady)return;V.debug("AlphaTab","Generating Midi");let e=new ia,t=new Gn(e),r=new je(this.score,this.settings,t);r.applyTranspositionPitches=!1,r.generate(),this._tickCache=r.tickLookup,this.onMidiLoad(e),this.player.loadMidiFile(e),this.player.applyTranspositionPitches(r.transpositionPitches)}changeTrackVolume(e,t){if(this.player)for(let r of e)this.player.setChannelVolume(r.playbackInfo.primaryChannel,t),this.player.setChannelVolume(r.playbackInfo.secondaryChannel,t)}changeTrackSolo(e,t){if(this.player)for(let r of e)this.player.setChannelSolo(r.playbackInfo.primaryChannel,t),this.player.setChannelSolo(r.playbackInfo.secondaryChannel,t)}changeTrackMute(e,t){if(this.player)for(let r of e)this.player.setChannelMute(r.playbackInfo.primaryChannel,t),this.player.setChannelMute(r.playbackInfo.secondaryChannel,t)}play(){return this.player?this.player.play():!1}pause(){this.player&&this.player.pause()}playPause(){this.player&&this.player.playPause()}stop(){this.player&&this.player.stop()}playBeat(e){if(!this.player)return;let t=new ia,r=new Gn(t);new je(e.voice.bar.staff.track.score,this.settings,r).generateSingleBeat(e),this.player.playOneTimeMidiFile(t)}playNote(e){if(!this.player)return;let t=new ia,r=new Gn(t);new je(e.beat.voice.bar.staff.track.score,this.settings,r).generateSingleNote(e),this.player.playOneTimeMidiFile(t)}destroyCursors(){this._cursorWrapper&&(this.uiFacade.destroyCursors(),this._cursorWrapper=null,this._barCursor=null,this._beatCursor=null,this._selectionWrapper=null)}updateCursors(){if(this.settings.player.enableCursor&&!this._cursorWrapper){let e=this.uiFacade.createCursors();e&&(this._cursorWrapper=e.cursorWrapper,this._barCursor=e.barCursor,this._beatCursor=e.beatCursor,this._selectionWrapper=e.selectionWrapper),this._currentBeat!==null&&this.cursorUpdateBeat(this._currentBeat,!1,this._previousTick>10,!0)}else!this.settings.player.enableCursor&&this._cursorWrapper&&this.destroyCursors()}setupPlayerEvents(){this._previousTick=0,this._playerState=Wt.Paused,this.renderer.postRenderFinished.on(()=>{this._currentBeat=null,this.cursorUpdateTick(this._previousTick,!1,this._previousTick>10)}),this.player&&(this.player.positionChanged.on(e=>{this._previousTick=e.currentTick,this.uiFacade.beginInvoke(()=>{this.cursorUpdateTick(e.currentTick,!1)})}),this.player.stateChanged.on(e=>{if(this._playerState=e.state,!e.stopped&&e.state===Wt.Paused){let t=this._currentBeat,r=this._tickCache;t&&r&&(this.player.tickPosition=r.getBeatStart(t.beat))}}))}cursorUpdateTick(e,t,r=!1){let n=this._tickCache;if(n){let s=this._trackIndexLookup;if(s!=null&&s.size>0){let a=n.findBeat(s,e,this._currentBeat);a&&this.cursorUpdateBeat(a,t,r)}}}cursorUpdateBeat(e,t,r,n=!1){var p;const s=e.beat,a=((p=e.nextBeat)==null?void 0:p.beat)??null,o=e.duration,l=e.beatLookup.highlightedBeats;if(!s)return;let u=this.renderer.boundsLookup;if(!u)return;let c=this._currentBeat,h=this._previousCursorCache,d=this._previousStateForCursor;if(!n&&s===(c==null?void 0:c.beat)&&u===h&&d===this._playerState)return;let f=u.findBeat(s);f&&(this._currentBeat=e,this._previousCursorCache=u,this._previousStateForCursor=this._playerState,this.uiFacade.beginInvoke(()=>{this.internalCursorUpdateBeat(s,a,o,t,l,u,f,r)}))}scrollToCursor(){const e=this._currentBarBounds;e&&this.internalScrollToCursor(e)}internalScrollToCursor(e){let t=this.uiFacade.getScrollContainer(),r=W.getLayoutEngineFactory(this.settings.display.layoutMode).vertical,n=this.settings.player.scrollMode;if(r){let s=e.realBounds.y+this.settings.player.scrollOffsetY;if(s!==this._lastScroll)switch(this._lastScroll=s,n){case as.Continuous:let a=this.uiFacade.getOffset(t,this.container);this.uiFacade.scrollToY(t,a.y+s,this.settings.player.scrollSpeed);break;case as.OffScreen:let o=t.scrollTop+this.uiFacade.getOffset(null,t).h;if(e.visualBounds.y+e.visualBounds.h>=o||e.visualBounds.y<t.scrollTop){let l=e.realBounds.y+this.settings.player.scrollOffsetY;this.uiFacade.scrollToY(t,l,this.settings.player.scrollSpeed)}break}}else{let s=e.visualBounds.x;if(s!==this._lastScroll)switch(this._lastScroll=s,n){case as.Continuous:let a=e.realBounds.x+this.settings.player.scrollOffsetX;this._lastScroll=e.visualBounds.x,this.uiFacade.scrollToX(t,a,this.settings.player.scrollSpeed);break;case as.OffScreen:let o=t.scrollLeft+this.uiFacade.getOffset(null,t).w;if(e.visualBounds.x+e.visualBounds.w>=o||e.visualBounds.x<t.scrollLeft){let l=e.realBounds.x+this.settings.player.scrollOffsetX;this._lastScroll=e.visualBounds.x,this.uiFacade.scrollToX(t,l,this.settings.player.scrollSpeed)}break}}}internalCursorUpdateBeat(e,t,r,n,s,a,o,l){const u=this._barCursor,c=this._beatCursor;let h=o.barBounds.masterBarBounds,d=h.visualBounds;this._currentBarBounds=h,u&&u.setBounds(d.x,d.y,d.w,d.h),c&&(this.settings.player.enableAnimatedBeatCursor&&c.stopAnimation(),c.setBounds(o.visualBounds.x,d.y,1,d.h)),this.settings.player.enableElementHighlighting&&this.uiFacade.removeHighlights();let f=!1;if(this._playerState===Wt.Playing&&!n){if(this.settings.player.enableElementHighlighting)for(let p of s){let g=tn.getGroupId(p.beat);this.uiFacade.highlightElements(g,e.voice.bar.index)}if(this.settings.player.enableAnimatedBeatCursor){let p=h.visualBounds.x+h.visualBounds.w;if(t){let g=a.findBeat(t);g&&g.barBounds.masterBarBounds.staffSystemBounds===h.staffSystemBounds&&(p=g.visualBounds.x)}this.uiFacade.beginInvoke(()=>{c&&c.transitionToX(r/this.playbackSpeed,p)})}l=!n,f=!0}l&&!this._beatMouseDown&&this.settings.player.scrollMode!==as.Off&&this.internalScrollToCursor(h),f&&(this.onPlayedBeatChanged(e),this.onActiveBeatsChanged(new AB(s.map(p=>p.beat))))}onPlayedBeatChanged(e){this._isDestroyed||(this.playedBeatChanged.trigger(e),this.uiFacade.triggerEvent(this.container,"playedBeatChanged",e))}onActiveBeatsChanged(e){this._isDestroyed||(this.activeBeatsChanged.trigger(e),this.uiFacade.triggerEvent(this.container,"activeBeatsChanged",e))}onBeatMouseDown(e,t){this._isDestroyed||(this.settings.player.enablePlayer&&this.settings.player.enableCursor&&this.settings.player.enableUserInteraction&&(this._selectionStart=new rh(t),this._selectionEnd=null),this._beatMouseDown=!0,this.beatMouseDown.trigger(t),this.uiFacade.triggerEvent(this.container,"beatMouseDown",t,e))}onNoteMouseDown(e,t){this._isDestroyed||(this._noteMouseDown=!0,this.noteMouseDown.trigger(t),this.uiFacade.triggerEvent(this.container,"noteMouseDown",t,e))}onBeatMouseMove(e,t){this._isDestroyed||(this.settings.player.enableUserInteraction&&(!this._selectionEnd||this._selectionEnd.beat!==t)&&(this._selectionEnd=new rh(t),this.cursorSelectRange(this._selectionStart,this._selectionEnd)),this.beatMouseMove.trigger(t),this.uiFacade.triggerEvent(this.container,"beatMouseMove",t,e))}onNoteMouseMove(e,t){this._isDestroyed||(this.noteMouseMove.trigger(t),this.uiFacade.triggerEvent(this.container,"noteMouseMove",t,e))}onBeatMouseUp(e,t){var r,n;if(!this._isDestroyed){if(this.settings.player.enablePlayer&&this.settings.player.enableCursor&&this.settings.player.enableUserInteraction){if(this._selectionEnd){let s=((r=this._tickCache)==null?void 0:r.getBeatStart(this._selectionStart.beat))??this._selectionStart.beat.absolutePlaybackStart;if((((n=this._tickCache)==null?void 0:n.getBeatStart(this._selectionEnd.beat))??this._selectionEnd.beat.absolutePlaybackStart)<s){let o=this._selectionStart;this._selectionStart=this._selectionEnd,this._selectionEnd=o}}if(this._selectionStart&&this._tickCache){let s=this._tickCache,a=s.getMasterBarStart(this._selectionStart.beat.voice.bar.masterBar);if(this._currentBeat=null,this._playerState===Wt.Paused&&this.cursorUpdateTick(this._tickCache.getBeatStart(this._selectionStart.beat),!1),this.tickPosition=a+this._selectionStart.beat.playbackStart,this._selectionEnd&&this._selectionStart.beat!==this._selectionEnd.beat){let o=s.getMasterBarStart(this._selectionEnd.beat.voice.bar.masterBar),l=new FB;l.startTick=a+this._selectionStart.beat.playbackStart,l.endTick=o+this._selectionEnd.beat.playbackStart+this._selectionEnd.beat.playbackDuration-50,this.playbackRange=l}else this._selectionStart=null,this.playbackRange=null,this.cursorSelectRange(this._selectionStart,this._selectionEnd)}}this.beatMouseUp.trigger(t),this.uiFacade.triggerEvent(this.container,"beatMouseUp",t,e),this._beatMouseDown=!1}}onNoteMouseUp(e,t){this._isDestroyed||(this.noteMouseUp.trigger(t),this.uiFacade.triggerEvent(this.container,"noteMouseUp",t,e),this._noteMouseDown=!1)}updateSelectionCursor(e){if(this._tickCache)if(e){const t=this._tickCache.findBeat(this._trackIndexLookup,e.startTick),r=this._tickCache.findBeat(this._trackIndexLookup,e.endTick);if(t&&r){const n=new rh(t.beat),s=new rh(r.beat);this.cursorSelectRange(n,s)}}else this.cursorSelectRange(null,null)}setupClickHandling(){this.canvasElement.mouseDown.on(e=>{var s,a;if(!e.isLeftMouseButton)return;this.settings.player.enableUserInteraction&&e.preventDefault();let t=e.getX(this.canvasElement),r=e.getY(this.canvasElement),n=((s=this.renderer.boundsLookup)==null?void 0:s.getBeatAtPos(t,r))??null;if(n&&(this.onBeatMouseDown(e,n),this.settings.core.includeNoteBounds)){const o=(a=this.renderer.boundsLookup)==null?void 0:a.getNoteAtPos(n,t,r);o&&this.onNoteMouseDown(e,o)}}),this.canvasElement.mouseMove.on(e=>{var s,a;if(!this._beatMouseDown)return;let t=e.getX(this.canvasElement),r=e.getY(this.canvasElement),n=((s=this.renderer.boundsLookup)==null?void 0:s.getBeatAtPos(t,r))??null;if(n&&(this.onBeatMouseMove(e,n),this._noteMouseDown)){const o=(a=this.renderer.boundsLookup)==null?void 0:a.getNoteAtPos(n,t,r);o&&this.onNoteMouseMove(e,o)}}),this.canvasElement.mouseUp.on(e=>{var s,a;if(!this._beatMouseDown)return;this.settings.player.enableUserInteraction&&e.preventDefault();let t=e.getX(this.canvasElement),r=e.getY(this.canvasElement),n=((s=this.renderer.boundsLookup)==null?void 0:s.getBeatAtPos(t,r))??null;if(this.onBeatMouseUp(e,n),this._noteMouseDown)if(n){const o=((a=this.renderer.boundsLookup)==null?void 0:a.getNoteAtPos(n,t,r))??null;this.onNoteMouseUp(e,o)}else this.onNoteMouseUp(e,null)}),this.renderer.postRenderFinished.on(()=>{!this._selectionStart||!this.settings.player.enablePlayer||!this.settings.player.enableCursor||!this.settings.player.enableUserInteraction||this.cursorSelectRange(this._selectionStart,this._selectionEnd)})}cursorSelectRange(e,t){var u,c;let r=this.renderer.boundsLookup;if(!r)return;let n=this._selectionWrapper;if(!n||(n.clear(),!e||!t||e.beat===t.beat))return;e.bounds||(e.bounds=r.findBeat(e.beat)),t.bounds||(t.bounds=r.findBeat(t.beat));let s=((u=this._tickCache)==null?void 0:u.getBeatStart(e.beat))??e.beat.absolutePlaybackStart;if((((c=this._tickCache)==null?void 0:c.getBeatStart(t.beat))??t.beat.absolutePlaybackStart)<s){let h=e;e=t,t=h}let o=e.bounds.realBounds.x,l=t.bounds.realBounds.x+t.bounds.realBounds.w;if(t.beat.index===t.beat.voice.beats.length-1&&(l=t.bounds.barBounds.masterBarBounds.realBounds.x+t.bounds.barBounds.masterBarBounds.realBounds.w),e.bounds.barBounds.masterBarBounds.staffSystemBounds!==t.bounds.barBounds.masterBarBounds.staffSystemBounds){let h=e.bounds.barBounds.masterBarBounds.staffSystemBounds.visualBounds.x,d=e.bounds.barBounds.masterBarBounds.staffSystemBounds.visualBounds.x+e.bounds.barBounds.masterBarBounds.staffSystemBounds.visualBounds.w,f=this.uiFacade.createSelectionElement();f.setBounds(o,e.bounds.barBounds.masterBarBounds.visualBounds.y,d-o,e.bounds.barBounds.masterBarBounds.visualBounds.h),n.appendChild(f);let p=e.bounds.barBounds.masterBarBounds.staffSystemBounds.index+1,g=t.bounds.barBounds.masterBarBounds.staffSystemBounds.index;for(let b=p;b<g;b++){let m=r.staffSystems[b],v=this.uiFacade.createSelectionElement();v.setBounds(h,m.visualBounds.y,d-h,m.visualBounds.h),n.appendChild(v)}let y=this.uiFacade.createSelectionElement();y.setBounds(h,t.bounds.barBounds.masterBarBounds.visualBounds.y,l-h,t.bounds.barBounds.masterBarBounds.visualBounds.h),n.appendChild(y)}else{let h=this.uiFacade.createSelectionElement();h.setBounds(o,e.bounds.barBounds.masterBarBounds.visualBounds.y,l-o,e.bounds.barBounds.masterBarBounds.visualBounds.h),n.appendChild(h)}}onScoreLoaded(e){this._isDestroyed||(this.scoreLoaded.trigger(e),this.uiFacade.triggerEvent(this.container,"scoreLoaded",e))}onResize(e){this._isDestroyed||(this.resize.trigger(e),this.uiFacade.triggerEvent(this.container,"resize",e))}onRenderStarted(e){this._isDestroyed||(this.renderStarted.trigger(e),this.uiFacade.triggerEvent(this.container,"renderStarted",e))}onRenderFinished(e){this._isDestroyed||(this.renderFinished.trigger(e),this.uiFacade.triggerEvent(this.container,"renderFinished",e))}onPostRenderFinished(){this._isDestroyed||(this.postRenderFinished.trigger(),this.uiFacade.triggerEvent(this.container,"postRenderFinished",null))}onError(e){this._isDestroyed||(V.error("API","An unexpected error occurred",e),this.error.trigger(e),this.uiFacade.triggerEvent(this.container,"error",e))}onPlayerReady(){this._isDestroyed||(this.playerReady.trigger(),this.uiFacade.triggerEvent(this.container,"playerReady",null))}onPlayerFinished(){this._isDestroyed||(this.playerFinished.trigger(),this.uiFacade.triggerEvent(this.container,"playerFinished",null))}onSoundFontLoaded(){this._isDestroyed||(this.soundFontLoaded.trigger(),this.uiFacade.triggerEvent(this.container,"soundFontLoaded",null))}onMidiLoad(e){this._isDestroyed||(this.midiLoad.trigger(e),this.uiFacade.triggerEvent(this.container,"midiLoad",e))}onMidiLoaded(e){this._isDestroyed||(this.midiLoaded.trigger(e),this.uiFacade.triggerEvent(this.container,"midiFileLoaded",e))}onPlayerStateChanged(e){this._isDestroyed||(this.playerStateChanged.trigger(e),this.uiFacade.triggerEvent(this.container,"playerStateChanged",e))}onPlayerPositionChanged(e){this._isDestroyed||this.score!==null&&this.tracks.length>0&&(this.playerPositionChanged.trigger(e),this.uiFacade.triggerEvent(this.container,"playerPositionChanged",e))}onMidiEventsPlayed(e){this._isDestroyed||(this.midiEventsPlayed.trigger(e),this.uiFacade.triggerEvent(this.container,"midiEventsPlayed",e))}onPlaybackRangeChanged(e){this._isDestroyed||(this.playbackRangeChanged.trigger(e),this.uiFacade.triggerEvent(this.container,"playbackRangeChanged",e))}onSettingsUpdated(){this._isDestroyed||(this.settingsUpdated.trigger(),this.uiFacade.triggerEvent(this.container,"settingsUpdated",null))}}class ns extends oi{constructor(e,t){super(ai.General,e),this.xhr=t,Object.setPrototypeOf(this,ns.prototype)}}class Oo{static loadScoreAsync(e,t,r,n){let s=new XMLHttpRequest;s.open("GET",e,!0,null,null),s.responseType="arraybuffer",s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){let a=s.response;if(s.status===200||s.status===0&&a)try{let o=s.response,l=new Uint8Array(o),u=Oo.loadScoreFromBytes(l,n);t(u)}catch(o){r(o)}else s.status===0?r(new ns(`You are offline!!
 Please Check Your Network.`,s)):s.status===404?r(new ns("Requested URL not found.",s)):s.status===500?r(new ns("Internel Server Error.",s)):s.statusText==="parsererror"?r(new ns(`Error.
Parsing JSON Request failed.`,s)):s.statusText==="timeout"?r(new ns("Request Time out.",s)):r(new ns("Unknow Error: "+s.responseText,s))}},s.send()}static loadScoreFromBytes(e,t){t||(t=new qa);let r=W.buildImporters();V.debug("ScoreLoader",`Loading score from ${e.length} bytes using ${r.length} importers`);let n=null,s=ni.fromBuffer(e);for(let a of r){s.reset();try{V.debug("ScoreLoader","Importing using importer "+a.name),a.init(s,t),n=a.readScore(),V.debug("ScoreLoader","Score imported using "+a.name);break}catch(o){if(o instanceof gt)V.debug("ScoreLoader",a.name+" does not support the file");else throw V.error("ScoreLoader","Score import failed due to unexpected error: ",o),o}}if(n)return n;throw new gt("No compatible importer found for file")}}class Tg{get isLeftMouseButton(){return this.mouseEvent.button===0}getX(e){let t=e.element,n=t.getBoundingClientRect().left+t.ownerDocument.defaultView.pageXOffset;return this.mouseEvent.pageX-n}getY(e){let t=e.element,n=t.getBoundingClientRect().top+t.ownerDocument.defaultView.pageYOffset;return this.mouseEvent.pageY-n}preventDefault(){this.mouseEvent.preventDefault()}constructor(e){this.mouseEvent=e}}class $n{get width(){return this.element.offsetWidth}set width(e){this.element.style.width=e+"px"}get scrollLeft(){return this.element.scrollLeft}set scrollLeft(e){this.element.scrollTop=e}get scrollTop(){return this.element.scrollLeft}set scrollTop(e){this.element.scrollTop=e}get height(){return this.element.offsetHeight}set height(e){e>=0?this.element.style.height=e+"px":this.element.style.height="100%"}get isVisible(){return!!this.element.offsetWidth||!!this.element.offsetHeight||!!this.element.getClientRects().length}constructor(e){this._resizeListeners=0,this.lastBounds=new ji,this.element=e,this.mouseDown={on:t=>{this.element.addEventListener("mousedown",r=>{t(new Tg(r))},!0)},off:t=>{}},this.mouseUp={on:t=>{this.element.addEventListener("mouseup",r=>{t(new Tg(r))},!0)},off:t=>{}},this.mouseMove={on:t=>{this.element.addEventListener("mousemove",r=>{t(new Tg(r))},!0)},off:t=>{}},this.resize={on:t=>{this._resizeListeners===0&&$n.resizeObserver.value.observe(this.element),this.element.addEventListener("resize",t,!0),this._resizeListeners++},off:t=>{this.element.removeEventListener("resize",t,!0),this._resizeListeners--,this._resizeListeners<=0&&(this._resizeListeners=0,$n.resizeObserver.value.unobserve(this.element))}}}stopAnimation(){this.element.style.transition="none"}transitionToX(e,t){this.element.style.transition=`transform ${e}ms linear`,this.setBounds(t,NaN,NaN,NaN)}setBounds(e,t,r,n){isNaN(e)&&(e=this.lastBounds.x),isNaN(t)&&(t=this.lastBounds.y),isNaN(r)&&(r=this.lastBounds.w),isNaN(n)&&(n=this.lastBounds.h),this.element.style.transform=`translate(${e}px, ${t}px) scale(${r}, ${n})`,this.element.style.transformOrigin="top left",this.lastBounds.x=e,this.lastBounds.y=t,this.lastBounds.w=r,this.lastBounds.h=n}appendChild(e){this.element.appendChild(e.element)}clear(){this.element.innerHTML=""}}$n.resizeObserver=new lB(()=>new ResizeObserver(i=>{for(const e of i){let t=new CustomEvent("resize",{detail:e});e.target.dispatchEvent(t)}}));class VB{constructor(e){this._isStarted=!1,this.isFontLoaded=!1,this.fontLoaded=new Fe,this._originalFamilies=e,this._families=e}checkForFontAvailability(){if(W.isRunningInWorker){this.isFontLoaded=!1;return}if(this._isStarted)return;this._isStarted=!0;let e=0,t=window.setInterval(()=>{V.warning("Rendering",`Could not load font '${this._families[0]}' within ${(e+1)*5} seconds`,null),this._families.length>1?(this._families.shift(),e=0):e++},5e3);V.debug("Font",`Start checking for font availablility: ${this._families.join(", ")}`);let r=a=>{this._families.length>1?(V.debug("Font",`[${this._families[0]}] Loading Failed, switching to ${this._families[1]}`,a),this._families.shift(),window.setTimeout(()=>{s()},0)):(V.error("Font",`[${this._originalFamilies.join(",")}] Loading Failed, rendering cannot start`,a),window.clearInterval(t))},n=a=>{V.debug("Font",`[${a}] Font API signaled available`),this.isFontLoaded=!0,window.clearInterval(t),this.fontLoaded.trigger(this._families[0])},s=async()=>{for(const a of this._families)if(await this.isFontAvailable(a,!1)){n(a);return}try{await document.fonts.load(`1em ${this._families[0]}`)}catch(a){r(a)}return V.debug("Font",`[${this._families[0]}] Font API signaled loaded`),await this.isFontAvailable(this._families[0],!0)?n(this._families[0]):r("Font not available"),!0};document.fonts.ready.then(()=>{s()})}isFontAvailable(e,t){return new Promise(r=>{const n="1em "+e;if(document.fonts.check(n))r(!0);else if(t){V.debug("Font",`Font ${e} not available, creating test element to trigger load`);const s=document.createElement("div");s.style.font=n,s.style.opacity="0",s.style.position="absolute",s.style.top="0",s.style.left="0",s.innerText=`Trigger ${e} load`,document.body.appendChild(s),setTimeout(()=>{document.body.removeChild(s),document.fonts.check(n)?r(!0):r(!1)},200)}else r(!1)})}}class Y1{constructor(e){this._writePosition=0,this._readPosition=0,this.count=0,this._buffer=new Float32Array(e)}clear(){this._readPosition=0,this._writePosition=0,this.count=0,this._buffer=new Float32Array(this._buffer.length)}write(e,t,r){let n=0;r>this._buffer.length-this.count&&(r=this._buffer.length-this.count);const s=Math.min(this._buffer.length-this._writePosition,r);return this._buffer.set(e.subarray(t,t+s),this._writePosition),this._writePosition+=s,this._writePosition%=this._buffer.length,n+=s,n<r&&(this._buffer.set(e.subarray(t+n,t+n+r-n),this._writePosition),this._writePosition+=r-n,n=r),this.count+=n,n}read(e,t,r){r>this.count&&(r=this.count);let n=0;const s=Math.min(this._buffer.length-this._readPosition,r);return e.set(this._buffer.subarray(this._readPosition,this._readPosition+s),t),n+=s,this._readPosition+=s,this._readPosition%=this._buffer.length,n<r&&(e.set(this._buffer.subarray(this._readPosition,this._readPosition+r-n),t+n),this._readPosition+=r-n,n=r),this.count-=n,n}}class Er{constructor(){this._context=null,this._buffer=null,this._source=null,this.ready=new ei,this.samplesPlayed=new Fe,this.sampleRequest=new ei}get sampleRate(){return this._context?this._context.sampleRate:Er.PreferredSampleRate}activate(e){this._context||(this._context=this.createAudioContext()),(this._context.state==="suspended"||this._context.state==="interrupted")&&(V.debug("WebAudio","Audio Context is suspended, trying resume"),this._context.resume().then(()=>{var t,r;V.debug("WebAudio",`Audio Context resume success: state=${(t=this._context)==null?void 0:t.state}, sampleRate:${(r=this._context)==null?void 0:r.sampleRate}`),e&&e()},t=>{var r,n;V.warning("WebAudio",`Audio Context resume failed: state=${(r=this._context)==null?void 0:r.state}, sampleRate:${(n=this._context)==null?void 0:n.sampleRate}, reason=${t}`)}))}patchIosSampleRate(){let e=navigator.userAgent;if(e.indexOf("iPhone")!==-1||e.indexOf("iPad")!==-1){let t=this.createAudioContext(),r=t.createBuffer(1,1,Er.PreferredSampleRate),n=t.createBufferSource();n.buffer=r,n.connect(t.destination),n.start(0),n.disconnect(0),t.close()}}createAudioContext(){if("AudioContext"in W.globalThis)return new AudioContext;if("webkitAudioContext"in W.globalThis)return new webkitAudioContext;throw new oi(ai.General,"AudioContext not found")}open(e){this.patchIosSampleRate(),this._context=this.createAudioContext(),this._context.state==="suspended"&&this.registerResumeHandler()}registerResumeHandler(){this._resumeHandler=(()=>{this.activate(()=>{this.unregisterResumeHandler()})}).bind(this),document.body.addEventListener("touchend",this._resumeHandler,!1),document.body.addEventListener("click",this._resumeHandler,!1)}unregisterResumeHandler(){const e=this._resumeHandler;e&&(document.body.removeEventListener("touchend",e,!1),document.body.removeEventListener("click",e,!1))}play(){let e=this._context;this.activate(),this._buffer=e.createBuffer(2,Er.BufferSize,e.sampleRate),this._source=e.createBufferSource(),this._source.buffer=this._buffer,this._source.loop=!0}pause(){this._source&&(this._source.stop(0),this._source.disconnect()),this._source=null}destroy(){var e;this.pause(),(e=this._context)==null||e.close(),this._context=null,this.unregisterResumeHandler()}onSamplesPlayed(e){this.samplesPlayed.trigger(e)}onSampleRequest(){this.sampleRequest.trigger()}onReady(){this.ready.trigger()}}Er.BufferSize=4096;Er.PreferredSampleRate=44100;class HB extends Er{constructor(){super(...arguments),this._audioNode=null,this._bufferCount=0,this._requestedBufferCount=0,this._outputBuffer=new Float32Array(0)}open(e){super.open(e),this._bufferCount=Math.floor(e*this.sampleRate/1e3/Er.BufferSize),this._circularBuffer=new Y1(Er.BufferSize*this._bufferCount),this.onReady()}play(){super.play();let e=this._context;this._audioNode=e.createScriptProcessor(4096,0,2),this._audioNode.onaudioprocess=this.generateSound.bind(this),this._circularBuffer.clear(),this.requestBuffers(),this._source=e.createBufferSource(),this._source.buffer=this._buffer,this._source.loop=!0,this._source.connect(this._audioNode,0,0),this._source.start(0),this._audioNode.connect(e.destination,0,0)}pause(){super.pause(),this._audioNode&&this._audioNode.disconnect(0),this._audioNode=null}addSamples(e){this._circularBuffer.write(e,0,e.length),this._requestedBufferCount--}resetSamples(){this._circularBuffer.clear()}requestBuffers(){const e=this._bufferCount/2|0;let t=e*Er.BufferSize;if(this._circularBuffer.count+this._requestedBufferCount*Er.BufferSize<t){for(let n=0;n<e;n++)this.onSampleRequest();this._requestedBufferCount+=e}}generateSound(e){let t=e.outputBuffer.getChannelData(0),r=e.outputBuffer.getChannelData(1),n=t.length+r.length,s=this._outputBuffer;s.length!==n&&(s=new Float32Array(n),this._outputBuffer=s);const a=this._circularBuffer.read(s,0,Math.min(s.length,this._circularBuffer.count));let o=0;const l=Math.min(t.length,a);for(let u=0;u<l;u++)t[u]=s[o++],r[u]=s[o++];if(a<t.length)for(let u=a;u<t.length;u++)t[u]=0,r[u]=0;this.onSamplesPlayed(a/Te.AudioChannels),this.requestBuffers()}}class xU{constructor(e,t){this.loaded=e,this.total=t}}class S0{get isReady(){return this._workerIsReady&&this._outputIsReady}get isReadyForPlayback(){return this._workerIsReadyForPlayback}get state(){return this._state}get logLevel(){return V.logLevel}set logLevel(e){V.logLevel=e,this._synth.postMessage({cmd:"alphaSynth.setLogLevel",value:e})}get masterVolume(){return this._masterVolume}set masterVolume(e){e=Math.max(e,Te.MinVolume),this._masterVolume=e,this._synth.postMessage({cmd:"alphaSynth.setMasterVolume",value:e})}get metronomeVolume(){return this._metronomeVolume}set metronomeVolume(e){e=Math.max(e,Te.MinVolume),this._metronomeVolume=e,this._synth.postMessage({cmd:"alphaSynth.setMetronomeVolume",value:e})}get countInVolume(){return this._countInVolume}set countInVolume(e){e=Math.max(e,Te.MinVolume),this._countInVolume=e,this._synth.postMessage({cmd:"alphaSynth.setCountInVolume",value:e})}get midiEventsPlayedFilter(){return this._midiEventsPlayedFilter}set midiEventsPlayedFilter(e){this._midiEventsPlayedFilter=e,this._synth.postMessage({cmd:"alphaSynth.setMidiEventsPlayedFilter",value:e})}get playbackSpeed(){return this._playbackSpeed}set playbackSpeed(e){e=Rt.clamp(e,Te.MinPlaybackSpeed,Te.MaxPlaybackSpeed),this._playbackSpeed=e,this._synth.postMessage({cmd:"alphaSynth.setPlaybackSpeed",value:e})}get tickPosition(){return this._tickPosition}set tickPosition(e){e<0&&(e=0),this._tickPosition=e,this._synth.postMessage({cmd:"alphaSynth.setTickPosition",value:e})}get timePosition(){return this._timePosition}set timePosition(e){e<0&&(e=0),this._timePosition=e,this._synth.postMessage({cmd:"alphaSynth.setTimePosition",value:e})}get isLooping(){return this._isLooping}set isLooping(e){this._isLooping=e,this._synth.postMessage({cmd:"alphaSynth.setIsLooping",value:e})}get playbackRange(){return this._playbackRange}set playbackRange(e){e&&(e.startTick<0&&(e.startTick=0),e.endTick<0&&(e.endTick=0)),this._playbackRange=e,this._synth.postMessage({cmd:"alphaSynth.setPlaybackRange",value:e})}constructor(e,t){this._workerIsReadyForPlayback=!1,this._workerIsReady=!1,this._outputIsReady=!1,this._state=Wt.Paused,this._masterVolume=0,this._metronomeVolume=0,this._countInVolume=0,this._playbackSpeed=0,this._tickPosition=0,this._timePosition=0,this._isLooping=!1,this._playbackRange=null,this._midiEventsPlayedFilter=[],this.ready=new ei,this.readyForPlayback=new ei,this.finished=new ei,this.soundFontLoaded=new ei,this.soundFontLoadFailed=new Fe,this.midiLoaded=new Fe,this.midiLoadFailed=new Fe,this.stateChanged=new Fe,this.positionChanged=new Fe,this.midiEventsPlayed=new Fe,this.playbackRangeChanged=new Fe,this._workerIsReadyForPlayback=!1,this._workerIsReady=!1,this._outputIsReady=!1,this._state=Wt.Paused,this._masterVolume=0,this._metronomeVolume=0,this._playbackSpeed=0,this._tickPosition=0,this._timePosition=0,this._isLooping=!1,this._playbackRange=null,this._output=e,this._output.ready.on(this.onOutputReady.bind(this)),this._output.samplesPlayed.on(this.onOutputSamplesPlayed.bind(this)),this._output.sampleRequest.on(this.onOutputSampleRequest.bind(this)),this._output.open(t.player.bufferTimeInMilliseconds);try{this._synth=W.createWebWorker(t)}catch(r){V.error("AlphaSynth","Failed to create WebWorker: "+r)}this._synth.addEventListener("message",this.handleWorkerMessage.bind(this),!1),this._synth.postMessage({cmd:"alphaSynth.initialize",sampleRate:this._output.sampleRate,logLevel:t.core.logLevel,bufferTimeInMilliseconds:t.player.bufferTimeInMilliseconds}),this.masterVolume=1,this.playbackSpeed=1,this.metronomeVolume=0}destroy(){this._synth.postMessage({cmd:"alphaSynth.destroy"})}play(){return this._output.activate(),this._synth.postMessage({cmd:"alphaSynth.play"}),!0}pause(){this._synth.postMessage({cmd:"alphaSynth.pause"})}playPause(){this._output.activate(),this._synth.postMessage({cmd:"alphaSynth.playPause"})}stop(){this._synth.postMessage({cmd:"alphaSynth.stop"})}playOneTimeMidiFile(e){this._synth.postMessage({cmd:"alphaSynth.playOneTimeMidiFile",midi:Vt.midiFileToJsObject(e)})}loadSoundFont(e,t){this._synth.postMessage({cmd:"alphaSynth.loadSoundFontBytes",data:e,append:t})}loadSoundFontFromUrl(e,t,r){V.debug("AlphaSynth",`Start loading Soundfont from url ${e}`);let n=new XMLHttpRequest;n.open("GET",e,!0,null,null),n.responseType="arraybuffer",n.onload=s=>{let a=new Uint8Array(n.response);this.loadSoundFont(a,t)},n.onerror=s=>{V.error("AlphaSynth","Loading failed: "+s.message),this.soundFontLoadFailed.trigger(new ns(s.message,n))},n.onprogress=s=>{V.debug("AlphaSynth",`Soundfont downloading: ${s.loaded}/${s.total} bytes`),r(new xU(s.loaded,s.total))},n.send()}resetSoundFonts(){this._synth.postMessage({cmd:"alphaSynth.resetSoundFonts"})}loadMidiFile(e){this._synth.postMessage({cmd:"alphaSynth.loadMidi",midi:Vt.midiFileToJsObject(e)})}applyTranspositionPitches(e){this._synth.postMessage({cmd:"alphaSynth.applyTranspositionPitches",transpositionPitches:JSON.stringify(Array.from(e.entries()))})}setChannelMute(e,t){this._synth.postMessage({cmd:"alphaSynth.setChannelMute",channel:e,mute:t})}resetChannelStates(){this._synth.postMessage({cmd:"alphaSynth.resetChannelStates"})}setChannelSolo(e,t){this._synth.postMessage({cmd:"alphaSynth.setChannelSolo",channel:e,solo:t})}setChannelVolume(e,t){t=Math.max(t,Te.MinVolume),this._synth.postMessage({cmd:"alphaSynth.setChannelVolume",channel:e,volume:t})}handleWorkerMessage(e){let t=e.data;switch(t.cmd){case"alphaSynth.ready":this._workerIsReady=!0,this.checkReady();break;case"alphaSynth.destroyed":this._synth.terminate();break;case"alphaSynth.readyForPlayback":this._workerIsReadyForPlayback=!0,this.checkReadyForPlayback();break;case"alphaSynth.positionChanged":this._timePosition=t.currentTime,this._tickPosition=t.currentTick,this.positionChanged.trigger(new Uu(t.currentTime,t.endTime,t.currentTick,t.endTick,t.isSeek));break;case"alphaSynth.midiEventsPlayed":this.midiEventsPlayed.trigger(new W1(t.events.map(Vt.jsObjectToMidiEvent)));break;case"alphaSynth.playerStateChanged":this._state=t.state,this.stateChanged.trigger(new lu(t.state,t.stopped));break;case"alphaSynth.playbackRangeChanged":this._playbackRange=t.playbackRange,this.playbackRangeChanged.trigger(new G1(this._playbackRange));break;case"alphaSynth.finished":this.finished.trigger();break;case"alphaSynth.soundFontLoaded":this.soundFontLoaded.trigger();break;case"alphaSynth.soundFontLoadFailed":this.soundFontLoadFailed.trigger(t.error);break;case"alphaSynth.midiLoaded":this.checkReadyForPlayback(),this.midiLoaded.trigger(new Uu(t.currentTime,t.endTime,t.currentTick,t.endTick,t.isSeek));break;case"alphaSynth.midiLoadFailed":this.checkReadyForPlayback(),this.midiLoadFailed.trigger(t.error);break;case"alphaSynth.output.addSamples":this._output.addSamples(t.samples);break;case"alphaSynth.output.play":this._output.play();break;case"alphaSynth.output.pause":this._output.pause();break;case"alphaSynth.output.destroy":this._output.destroy();break;case"alphaSynth.output.resetSamples":this._output.resetSamples();break}}checkReady(){this.isReady&&this.ready.trigger()}checkReadyForPlayback(){this.isReadyForPlayback&&this.readyForPlayback.trigger()}onOutputSampleRequest(){this._synth.postMessage({cmd:"alphaSynth.output.sampleRequest"})}onOutputSamplesPlayed(e){this._synth.postMessage({cmd:"alphaSynth.output.samplesPlayed",samples:e})}onOutputReady(){this._outputIsReady=!0,this.checkReady()}}class kU{constructor(e,t){this._width=0,this.boundsLookup=null,this.preRender=new Fe,this.partialRenderFinished=new Fe,this.partialLayoutFinished=new Fe,this.renderFinished=new Fe,this.postRenderFinished=new ei,this.error=new Fe,this._api=e;try{this._worker=W.createWebWorker(t)}catch(r){V.error("Rendering",`Failed to create WebWorker: ${r}`);return}this._worker.postMessage({cmd:"alphaTab.initialize",settings:this.serializeSettingsForWorker(t)}),this._worker.addEventListener("message",this.handleWorkerMessage.bind(this))}destroy(){this._worker.terminate()}updateSettings(e){this._worker.postMessage({cmd:"alphaTab.updateSettings",settings:this.serializeSettingsForWorker(e)})}serializeSettingsForWorker(e){const t=Vt.settingsToJsObject(e);return t.delete("player"),t}render(){this._worker.postMessage({cmd:"alphaTab.render"})}resizeRender(){this._worker.postMessage({cmd:"alphaTab.resizeRender"})}renderResult(e){this._worker.postMessage({cmd:"alphaTab.renderResult",resultId:e})}get width(){return this._width}set width(e){this._width=e,this._worker.postMessage({cmd:"alphaTab.setWidth",width:e})}handleWorkerMessage(e){let t=e.data;switch(t.cmd){case"alphaTab.preRender":this.preRender.trigger(t.resize);break;case"alphaTab.partialRenderFinished":this.partialRenderFinished.trigger(t.result);break;case"alphaTab.partialLayoutFinished":this.partialLayoutFinished.trigger(t.result);break;case"alphaTab.renderFinished":this.renderFinished.trigger(t.result);break;case"alphaTab.postRenderFinished":this.boundsLookup=ju.fromJson(t.boundsLookup,this._api.score),this.boundsLookup.finish(),this.postRenderFinished.trigger();break;case"alphaTab.error":this.error.trigger(t.error);break}}renderScore(e,t){let r=e==null?null:Vt.scoreToJsObject(e);this._worker.postMessage({cmd:"alphaTab.renderScore",score:r,trackIndexes:t,fontSizes:Ci.FontSizeLookupTables})}}class TU{constructor(e,t,r,n){this.cursorWrapper=e,this.barCursor=t,this.beatCursor=r,this.selectionWrapper=n}}class Yu{static init(){var e;Yu._isRegistered||(Yu._isRegistered=!0,registerProcessor("alphatab",(e=class extends AudioWorkletProcessor{constructor(r){super(r),this._outputBuffer=new Float32Array(0),this._bufferCount=0,this._requestedBufferCount=0,this._isStopped=!1,V.debug("WebAudio","creating processor"),this._bufferCount=Math.floor(r.processorOptions.bufferTimeInMilliseconds*sampleRate/1e3/e.BufferSize),this._circularBuffer=new Y1(e.BufferSize*this._bufferCount),this.port.onmessage=this.handleMessage.bind(this)}handleMessage(r){let n=r.data;switch(n.cmd){case ut.CmdOutputAddSamples:const a=n.samples;this._circularBuffer.write(a,0,a.length),this._requestedBufferCount--;break;case ut.CmdOutputResetSamples:this._circularBuffer.clear();break;case ut.CmdOutputStop:this._isStopped=!0;break}}process(r,n,s){if(n.length!==1&&n[0].length!==2)return!1;let a=n[0][0],o=n[0][1];if(!a||!o)return!0;let l=a.length+o.length,u=this._outputBuffer;u.length!==l&&(u=new Float32Array(l),this._outputBuffer=u);const c=this._circularBuffer.read(u,0,Math.min(u.length,this._circularBuffer.count));let h=0;const d=Math.min(a.length,c);for(let f=0;f<d;f++)a[f]=u[h++],o[f]=u[h++];if(c<a.length)for(let f=c;f<a.length;f++)a[f]=0,o[f]=0;return this.port.postMessage({cmd:ut.CmdOutputSamplesPlayed,samples:c/Te.AudioChannels}),this.requestBuffers(),this._circularBuffer.count>0||!this._isStopped}requestBuffers(){const r=this._bufferCount/2|0;let n=r*e.BufferSize;if(this._circularBuffer.count+this._requestedBufferCount*e.BufferSize<n){for(let a=0;a<r;a++)this.port.postMessage({cmd:ut.CmdOutputSampleRequest});this._requestedBufferCount+=r}}},e.BufferSize=4096,e)))}}Yu._isRegistered=!1;class zB extends Er{constructor(e){super(),this._worklet=null,this._bufferTimeInMilliseconds=0,this._settings=e}open(e){super.open(e),this._bufferTimeInMilliseconds=e,this.onReady()}play(){super.play();let e=this._context;W.createAudioWorklet(e,this._settings).then(()=>{this._worklet=new AudioWorkletNode(e,"alphatab",{numberOfOutputs:1,outputChannelCount:[2],processorOptions:{bufferTimeInMilliseconds:this._bufferTimeInMilliseconds}}),this._worklet.port.onmessage=this.handleMessage.bind(this),this._source.connect(this._worklet),this._source.start(0),this._worklet.connect(e.destination)},t=>{V.error("WebAudio",`Audio Worklet creation failed: reason=${t}`)})}handleMessage(e){let t=e.data;switch(t.cmd){case ut.CmdOutputSamplesPlayed:this.onSamplesPlayed(t.samples);break;case ut.CmdOutputSampleRequest:this.onSampleRequest();break}}pause(){super.pause(),this._worklet&&(this._worklet.port.postMessage({cmd:ut.CmdOutputStop}),this._worklet.port.onmessage=null,this._worklet.disconnect()),this._worklet=null}addSamples(e){var t;(t=this._worklet)==null||t.port.postMessage({cmd:ut.CmdOutputAddSamples,samples:e})}resetSamples(){var e;(e=this._worklet)==null||e.port.postMessage({cmd:ut.CmdOutputResetSamples})}}class CU extends $n{constructor(e,t,r){super(e),this._xscale=t,this._yscale=r}get width(){return this.element.offsetWidth/this._xscale}set width(e){this.element.style.width=e*this._xscale+"px"}get height(){return this.element.offsetHeight/this._yscale}set height(e){e>=0?this.element.style.height=e*this._yscale+"px":this.element.style.height="100%"}setBounds(e,t,r,n){isNaN(e)&&(e=this.lastBounds.x),isNaN(t)&&(t=this.lastBounds.y),isNaN(r)?r=this.lastBounds.w:r=r/this._xscale,isNaN(n)?n=this.lastBounds.h:n=n/this._yscale,this.element.style.transform=`translate(${e}px, ${t}px) scale(${r}, ${n})`,this.element.style.transformOrigin="top left",this.lastBounds.x=e,this.lastBounds.y=t,this.lastBounds.w=r,this.lastBounds.h=n}}var Vn;(function(i){i[i.LayoutDone=0]="LayoutDone",i[i.RenderRequested=1]="RenderRequested",i[i.RenderDone=2]="RenderDone",i[i.Detached=3]="Detached"})(Vn||(Vn={}));class NU{get resizeThrottle(){return 10}get canRender(){return this.areAllFontsLoaded()}areAllFontsLoaded(){if(W.bravuraFontChecker.checkForFontAvailability(),!W.bravuraFontChecker.isFontLoaded)return!1;let e=!1;for(const t of this._fontCheckers.values())t.isFontLoaded||(e=!0);return e?!1:(V.debug("Font","All fonts loaded: "+this._fontCheckers.size),!0)}onFontLoaded(e){Ci.generateFontLookup(e),this.areAllFontsLoaded()&&this.canRenderChanged.trigger()}constructor(e){if(this._fontCheckers=new Map,this._contents=null,this._file=null,this._totalResultCount=0,this._initialTrackIndexes=null,this._barToElementLookup=new Map,this._resultIdToElementLookup=new Map,this.rootContainerBecameVisible=new ei,this.canRenderChanged=new ei,this._highlightedElements=[],this._scrollContainer=null,W.webPlatform!==hr.Browser&&W.webPlatform!==hr.BrowserModule)throw new oi(ai.General,"Usage of AlphaTabApi is only possible in browser environments. For usage in node use the Low Level APIs");e.classList.add("alphaTab"),this.rootContainer=new $n(e),this.areWorkersSupported="Worker"in window,W.bravuraFontChecker.fontLoaded.on(this.onFontLoaded.bind(this)),this._intersectionObserver=new IntersectionObserver(this.onElementVisibilityChanged.bind(this),{threshold:[0,.01,1]}),this._intersectionObserver.observe(e)}onElementVisibilityChanged(e){for(const t of e){const r=t.target;if(r===this.rootContainer.element)t.isIntersecting&&(this.rootContainerBecameVisible.trigger(),this._intersectionObserver.unobserve(this.rootContainer.element));else if("layoutResultId"in r&&this._api.settings.core.enableLazyLoading){const n=r;t.isIntersecting?n.renderedResultId!==n.layoutResultId?this._resultIdToElementLookup.has(n.layoutResultId)?n.resultState!==Vn.RenderRequested&&(n.resultState=Vn.RenderRequested,this._api.renderer.renderResult(n.layoutResultId)):r.replaceChildren():n.resultState===Vn.Detached&&(r.replaceChildren(...n.renderedResult),n.resultState=Vn.RenderDone):n.resultState===Vn.RenderDone&&(n.resultState=Vn.Detached,n.replaceChildren())}}}createWorkerRenderer(){return new kU(this._api,this._api.settings)}initialize(e,t){this._api=e;let r;t instanceof qa?r=t:r=Vt.jsObjectToSettings(t);let n=this.getDataAttributes();sl.fromJson(r,n),r.notation.notationMode===Zt.SongBook&&r.setSongBookModeSettings(),e.settings=r,this.setupFontCheckers(r),this._initialTrackIndexes=this.parseTracks(r.core.tracks),this._contents="";let s=e.container;r.core.tex&&(this._contents=s.element.innerHTML,s.element.innerHTML=""),this.createStyleElement(r),this._file=r.core.file}setupFontCheckers(e){this.registerFontChecker(e.display.resources.copyrightFont),this.registerFontChecker(e.display.resources.effectFont),this.registerFontChecker(e.display.resources.fingeringFont),this.registerFontChecker(e.display.resources.graceFont),this.registerFontChecker(e.display.resources.markerFont),this.registerFontChecker(e.display.resources.tablatureFont),this.registerFontChecker(e.display.resources.titleFont),this.registerFontChecker(e.display.resources.wordsFont),this.registerFontChecker(e.display.resources.barNumberFont),this.registerFontChecker(e.display.resources.fretboardNumberFont),this.registerFontChecker(e.display.resources.subTitleFont)}registerFontChecker(e){if(!this._fontCheckers.has(e.families.join(", "))){let t=new VB(e.families);this._fontCheckers.set(e.families.join(", "),t),t.fontLoaded.on(this.onFontLoaded.bind(this)),t.checkForFontAvailability()}}destroy(){this.rootContainer.element.innerHTML=""}createCanvasElement(){let e=document.createElement("div");return e.className="at-surface",e.style.fontSize="0",e.style.overflow="hidden",e.style.lineHeight="0",e.style.position="relative",new $n(e)}triggerEvent(e,t,r=null,n){let s=e.element;t="alphaTab."+t;let a=document.createEvent("CustomEvent"),o=n?n.mouseEvent:null;if(a.initCustomEvent(t,!1,!1,r),o&&(a.originalEvent=o),s.dispatchEvent(a),window&&"jQuery"in window){let l=window.jQuery,u=[];u.push(r),o&&u.push(o),l(s).trigger(t,u)}}load(e,t,r){if(e instanceof no)return t(e),!0;if(e instanceof ArrayBuffer){let n=new Uint8Array(e);return t(Oo.loadScoreFromBytes(n,this._api.settings)),!0}return e instanceof Uint8Array?(t(Oo.loadScoreFromBytes(e,this._api.settings)),!0):typeof e=="string"?(Oo.loadScoreAsync(e,t,r,this._api.settings),!0):!1}loadSoundFont(e,t){return this._api.player?e instanceof ArrayBuffer?(this._api.player.loadSoundFont(new Uint8Array(e),t),!0):e instanceof Uint8Array?(this._api.player.loadSoundFont(e,t),!0):typeof e=="string"?(this._api.loadSoundFontFromUrl(e,t),!0):!1:!1}initialRender(){this._api.renderer.preRender.on(t=>{this._totalResultCount=0,this._resultIdToElementLookup.clear(),this._barToElementLookup.clear()});const e=()=>{this._api.renderer.width=this.rootContainer.width|0,this._api.renderer.updateSettings(this._api.settings),this._contents?(this._api.tex(this._contents,this._initialTrackIndexes??void 0),this._initialTrackIndexes=null):this._file&&Oo.loadScoreAsync(this._file,t=>{this._api.renderScore(t,this._initialTrackIndexes??void 0),this._initialTrackIndexes=null},t=>{this._api.onError(t)},this._api.settings)};this.rootContainer.isVisible?e():this.rootContainerBecameVisible.on(e)}createStyleElement(e){let t=this._api.container.element.ownerDocument;W.createStyleElement(t,e.core.fontDirectory)}parseTracks(e){if(!e)return[];let t=[];if(typeof e=="string")try{if(e==="all")return[-1];e=JSON.parse(e)}catch{e=[0]}if(typeof e=="number")t.push(e);else if("length"in e){let r=e.length,n=e;for(let s=0;s<r;s++){let a=n[s],o=0;typeof a=="number"?o=a:"index"in a?o=a.index:o=parseInt(a.toString()),(o>=0||o===-1)&&t.push(o)}}else"index"in e&&t.push(e.index);return t}getDataAttributes(){let e=new Map,t=this._api.container.element;if(t.dataset)for(let r of Object.keys(t.dataset)){let n=t.dataset[r];try{n=JSON.parse(n)}catch{n===""&&(n=null)}e.set(r,n)}else for(let r=0;r<t.attributes.length;r++){let n=t.attributes.item(r),s=n.nodeName;if(s.startsWith("data-")){let a=s.substr(5).split("-"),o=a[0];for(let u=1;u<a.length;u++)o+=a[u].substr(0,1).toUpperCase()+a[u].substr(1);let l=n.nodeValue;try{l=JSON.parse(l)}catch{l===""&&(l=null)}e.set(o,l)}}return e}beginUpdateRenderResults(e){if(!this._resultIdToElementLookup.has(e.id))return;const t=this._resultIdToElementLookup.get(e.id),r=e.renderResult;typeof r=="string"?t.innerHTML=r:"nodeType"in r&&t.replaceChildren(r),t.resultState=Vn.RenderDone,t.renderedResultId=e.id,t.renderedResult=Array.from(t.children)}beginAppendRenderResults(e){const t=this._api.canvasElement.element;if(e){let r;this._totalResultCount<t.childElementCount?r=t.childNodes.item(this._totalResultCount):(r=document.createElement("div"),t.appendChild(r)),r.style.zIndex="1",r.style.position="absolute",r.style.left=e.x+"px",r.style.top=e.y+"px",r.style.width=e.width+"px",r.style.height=e.height+"px",r.style.display="inline-block",r.layoutResultId=e.id,r.resultState=Vn.LayoutDone,delete r.renderedResultId,delete r.renderedResult,this._resultIdToElementLookup.set(e.id,r);for(let n=e.firstMasterBarIndex;n<=e.lastMasterBarIndex;n++)n>=0&&this._barToElementLookup.set(n,r);this._api.settings.core.enableLazyLoading&&(this._intersectionObserver.unobserve(r),this._intersectionObserver.observe(r)),this._totalResultCount++}else for(;t.childElementCount>this._totalResultCount;)this._api.settings.core.enableLazyLoading&&this._intersectionObserver.unobserve(t.lastChild),t.removeChild(t.lastElementChild)}createWorkerPlayer(){let e=null,t="ScriptProcessorNode"in window;return window.isSecureContext&&"AudioWorkletNode"in window&&this._api.settings.player.outputMode===$u.WebAudioAudioWorklets?(V.debug("Player","Will use webworkers for synthesizing and web audio api with worklets for playback"),e=new S0(new zB(this._api.settings),this._api.settings)):t&&(V.debug("Player","Will use webworkers for synthesizing and web audio api with ScriptProcessor for playback"),e=new S0(new HB,this._api.settings)),e?e.ready.on(()=>{this._api.settings.player.soundFont&&this._api.loadSoundFontFromUrl(this._api.settings.player.soundFont,!1)}):V.error("Player","Player requires webworkers and web audio api, browser unsupported",null),e}beginInvoke(e){window.requestAnimationFrame(()=>{e()})}highlightElements(e,t){const r=this._barToElementLookup.get(t);if(r){let n=r.getElementsByClassName(e);for(let s=0;s<n.length;s++)n.item(s).classList.add("at-highlight"),this._highlightedElements.push(n.item(s))}}removeHighlights(){const e=this._highlightedElements;if(e){for(const t of e)t.classList.remove("at-highlight");this._highlightedElements=[]}}destroyCursors(){let e=this._api.container.element,t=e.querySelector(".at-cursors");e.removeChild(t)}createCursors(){let e=this._api.container.element,t=document.createElement("div");t.classList.add("at-cursors");let r=document.createElement("div");r.classList.add("at-selection");const n=this.createScalingElement(),s=this.createScalingElement();let a=n.element;a.classList.add("at-cursor-bar");let o=s.element;return o.classList.add("at-cursor-beat"),e.style.position="relative",e.style.textAlign="left",t.style.position="absolute",t.style.zIndex="1000",t.style.display="inline",t.style.pointerEvents="none",r.style.position="absolute",a.style.position="absolute",a.style.left="0",a.style.top="0",a.style.willChange="transform",n.width=1,n.height=1,n.setBounds(0,0,1,1),o.style.position="absolute",o.style.transition="all 0s linear",o.style.left="0",o.style.top="0",o.style.willChange="transform",s.width=3,s.height=1,s.setBounds(0,0,1,1),e.insertBefore(t,e.firstChild),t.appendChild(r),t.appendChild(a),t.appendChild(o),new TU(new $n(t),n,s,new $n(r))}getOffset(e,t){let r=t.element,n=r.getBoundingClientRect(),s=n.top+r.ownerDocument.defaultView.pageYOffset,a=n.left+r.ownerDocument.defaultView.pageXOffset;if(e){let l=e.element,u=l.nodeName.toLowerCase();if(u!=="html"&&u!=="body"){let c=this.getOffset(null,e);s=s+l.scrollTop-c.y,a=a+l.scrollLeft-c.x}}let o=new ji;return o.x=a,o.y=s,o.w=n.width,o.h=n.height,o}getScrollContainer(){if(this._scrollContainer)return this._scrollContainer;let e=typeof this._api.settings.player.scrollElement=="string"?document.querySelector(this._api.settings.player.scrollElement):this._api.settings.player.scrollElement,t=e.nodeName.toLowerCase();return(t==="html"||t==="body")&&("scrollingElement"in document?e=document.scrollingElement:navigator.userAgent.indexOf("WebKit")!==-1?e=document.body:e=document.documentElement),this._scrollContainer=new $n(e),this._scrollContainer}createSelectionElement(){return this.createScalingElement()}createScalingElement(){const e=document.createElement("div");e.style.position="absolute";const t=new CU(e,100,100);return t.width=1,t.height=1,t.setBounds(0,0,1,1),t}scrollToY(e,t,r){this.internalScrollToY(e.element,t,r)}scrollToX(e,t,r){this.internalScrollToX(e.element,t,r)}internalScrollToY(e,t,r){if(this._api.settings.player.nativeBrowserSmoothScroll)e.scrollTo({top:t,behavior:"smooth"});else{let n=e.scrollTop,s=t-n,a=0,o=l=>{a===0&&(a=l);let u=l-a,c=Math.min(u/r,1);e.scrollTop=n+s*c|0,u<r&&window.requestAnimationFrame(o)};window.requestAnimationFrame(o)}}internalScrollToX(e,t,r){if(this._api.settings.player.nativeBrowserSmoothScroll)e.scrollTo({left:t,behavior:"smooth"});else{let n=e.scrollLeft,s=t-n,a=0,o=l=>{a===0&&(a=l);let u=l-a,c=Math.min(u/r,1);e.scrollLeft=n+s*c|0,u<r&&window.requestAnimationFrame(o)};window.requestAnimationFrame(o)}}}class pp extends SU{constructor(e,t){super(new NU(e),t),this.soundFontLoad=new Fe}tex(e,t){let r=this.uiFacade;super.tex(e,r.parseTracks(t))}print(e,t=null){let r=window.open("","","width=0,height=0"),n=r.document.createElement("div");e?n.style.width=e:this.settings.display.layoutMode===ps.Horizontal?n.style.width="297mm":n.style.width="210mm",r.document.write(`
        <!DOCTYPE html>
        <html>
          <head>
            <style>
            .at-surface {
                width: auto !important;
                height: auto !important;
            }
            .at-surface > div {
                position: relative!important;
                left: auto !important;
                top: auto !important;
                break-inside: avoid;
            }
            </style>
          </head>
          <body></body>
        </html>
        `);const s=this.score;s&&(s.artist&&s.title?r.document.title=`${s.title} - ${s.artist}`:s.title&&(r.document.title=`${s.title}`)),r.document.body.appendChild(n);let a=typeof window.screenLeft<"u"?window.screenLeft:window.left,o=typeof window.screenTop<"u"?window.screenTop:window.top,l="innerWidth"in window?window.innerWidth:"clientWidth"in document.documentElement?document.documentElement.clientWidth:window.screen.width,u="innerHeight"in window?window.innerHeight:"clientHeight"in document.documentElement?document.documentElement.clientHeight:window.screen.height,c=n.offsetWidth+50,h=window.innerHeight,d=(l/2|0)-(c/2|0)+a,f=(u/2|0)-(h/2|0)+o;r.resizeTo(c,h),r.moveTo(d,f),r.focus();let p=Vt.jsObjectToSettings(Vt.settingsToJsObject(this.settings));p.core.enableLazyLoading=!1,p.core.useWorkers=!0,p.core.file=null,p.core.tracks=null,p.player.enableCursor=!1,p.player.enablePlayer=!1,p.player.enableElementHighlighting=!1,p.player.enableUserInteraction=!1,p.player.soundFont=null,p.display.scale=.8,p.display.stretchForce=.8,sl.fromJson(p,t);let g=new pp(n,p);r.onunload=()=>{g.destroy()},g.renderer.postRenderFinished.on(()=>{r.print()}),g.renderTracks(this.tracks)}downloadMidi(e=nl.SingleTrackMultiChannel){if(!this.score)return;let t=new ia;t.format=e;let r=new Gn(t,!0);new je(this.score,this.settings,r).generate();let s=t.toBinary(),a=this.score.title?`${this.score.title}.mid`:"File.mid",o=document.createElement("a");o.download=a;let l=new Blob([s],{type:"audio/midi"}),u=URL.createObjectURL(l);o.href=u,o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o)}changeTrackMute(e,t){let r=this.trackIndexesToTracks(this.uiFacade.parseTracks(e));super.changeTrackMute(r,t)}changeTrackSolo(e,t){let r=this.trackIndexesToTracks(this.uiFacade.parseTracks(e));super.changeTrackSolo(r,t)}changeTrackVolume(e,t){let r=this.trackIndexesToTracks(this.uiFacade.parseTracks(e));super.changeTrackVolume(r,t)}trackIndexesToTracks(e){if(!this.score)return[];let t=[];if(e.length===1&&e[0]===-1)for(let r of this.score.tracks)t.push(r);else for(let r of e)r>=0&&r<this.score.tracks.length&&t.push(this.score.tracks[r]);return t}loadSoundFontFromUrl(e,t){this.player&&this.player.loadSoundFontFromUrl(e,t,r=>{this.soundFontLoad.trigger(r),this.uiFacade.triggerEvent(this.container,"soundFontLoad",r)})}}class MS{constructor(){this._initListeners=[]}exec(e,t,r){if(typeof t!="string"&&(r=[t],t="init"),t.charCodeAt(0)===95||t==="exec")return null;let n=new jQuery(e),s=n.data("alphaTab");if(t==="destroy"&&!s)return null;if(t!=="init"&&!s)throw new Error("alphaTab not initialized");let a=this[t];if(a){let o=[n,s].concat(r);return a.apply(this,o)}else return V.error("Api","Method '"+t+"' does not exist on jQuery.alphaTab"),null}init(e,t,r){if(!t){t=new pp(e[0],r),e.data("alphaTab",t);for(let n of this._initListeners)n(e,t,r)}}destroy(e,t){e.removeData("alphaTab"),t.destroy()}print(e,t,r,n){t.print(r,n)}load(e,t,r,n){return t.load(r,n)}render(e,t){t.render()}renderScore(e,t,r,n){t.renderScore(r,n)}renderTracks(e,t,r){t.renderTracks(r)}invalidate(e,t){t.render()}tex(e,t,r,n){t.tex(r,n)}muteTrack(e,t,r,n){t.changeTrackMute(r,n)}soloTrack(e,t,r,n){t.changeTrackSolo(r,n)}trackVolume(e,t,r,n){t.changeTrackVolume(r,n)}loadSoundFont(e,t,r,n){t.loadSoundFont(r,n)}resetSoundFonts(e,t){t.resetSoundFonts()}pause(e,t){t.pause()}play(e,t){return t.play()}playPause(e,t){t.playPause()}stop(e,t){t.stop()}api(e,t){return t}player(e,t){return t.player}isReadyForPlayback(e,t){return t.isReadyForPlayback}playerState(e,t){return t.playerState}masterVolume(e,t,r){return typeof r=="number"&&(t.masterVolume=r),t.masterVolume}metronomeVolume(e,t,r){return typeof r=="number"&&(t.metronomeVolume=r),t.metronomeVolume}countInVolume(e,t,r){return typeof r=="number"&&(t.countInVolume=r),t.countInVolume}midiEventsPlayedFilter(e,t,r){return Array.isArray(r)&&(t.midiEventsPlayedFilter=r),t.midiEventsPlayedFilter}playbackSpeed(e,t,r){return typeof r=="number"&&(t.playbackSpeed=r),t.playbackSpeed}tickPosition(e,t,r){return typeof r=="number"&&(t.tickPosition=r),t.tickPosition}timePosition(e,t,r){return typeof r=="number"&&(t.timePosition=r),t.timePosition}loop(e,t,r){return typeof r=="boolean"&&(t.isLooping=r),t.isLooping}renderer(e,t){return t.renderer}score(e,t){return t.score}settings(e,t){return t.settings}tracks(e,t){return t.tracks}_oninit(e){this._initListeners.push(e)}static restore(e){new jQuery(e).empty().removeData("alphaTab")}}class X1{constructor(){this.buffer="",this._currentPath="",this._currentPathIsEmpty=!0,this.color=new qe(255,255,255,255),this.lineWidth=1,this.font=new He("Arial",10,St.Plain),this.textAlign=ue.Left,this.textBaseline=Se.Top}destroy(){}beginRender(e,t){this.buffer=`<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="${e|0}px" height="${t|0}px" class="at-surface-svg">
`,this._currentPath="",this._currentPathIsEmpty=!0,this.textBaseline=Se.Top}beginGroup(e){this.buffer+=`<g class="${e}">`}endGroup(){this.buffer+="</g>"}endRender(){return this.buffer+="</svg>",this.buffer}fillRect(e,t,r,n){r>0&&(this.buffer+=`<rect x="${e|0}" y="${t|0}" width="${r}" height="${n}" fill="${this.color.rgba}" />
`)}strokeRect(e,t,r,n){this.buffer+=`<rect x="${e|0}" y="${t|0}" width="${r}" height="${n}" stroke="${this.color.rgba}"`,this.lineWidth!==1&&(this.buffer+=` stroke-width="${this.lineWidth}"`),this.buffer+=` fill="transparent" />
`}beginPath(){}closePath(){this._currentPath+=" z"}moveTo(e,t){this._currentPath+=` M${e},${t}`}lineTo(e,t){this._currentPathIsEmpty=!1,this._currentPath+=` L${e},${t}`}quadraticCurveTo(e,t,r,n){this._currentPathIsEmpty=!1,this._currentPath+=` Q${e},${t},${r},${n}`}bezierCurveTo(e,t,r,n,s,a){this._currentPathIsEmpty=!1,this._currentPath+=` C${e},${t},${r},${n},${s},${a}`}fillCircle(e,t,r){this._currentPathIsEmpty=!1,this._currentPath+=` M${e-r},${t} A1,1 0 0,0 ${e+r},${t} A1,1 0 0,0 ${e-r},${t} z`,this.fill()}strokeCircle(e,t,r){this._currentPathIsEmpty=!1,this._currentPath+=` M${e-r},${t} A1,1 0 0,0 ${e+r},${t} A1,1 0 0,0 ${e-r},${t} z`,this.stroke()}fill(){this._currentPathIsEmpty||(this.buffer+=`<path d="${this._currentPath}"`,this.color.rgba!=="#000000"&&(this.buffer+=` fill="${this.color.rgba}"`),this.buffer+=' style="stroke: none"/>'),this._currentPath="",this._currentPathIsEmpty=!0}stroke(){if(!this._currentPathIsEmpty){let e=`<path d="${this._currentPath}" stroke="${this.color.rgba}"`;this.lineWidth!==1&&(e+=` stroke-width="${this.lineWidth}"`),e+=' style="fill: none" />',this.buffer+=e}this._currentPath="",this._currentPathIsEmpty=!0}fillText(e,t,r){if(e==="")return;let n=`<text x="${t|0}" y="${r|0}" style="stroke: none; font:${this.font.toCssString(this.settings.display.scale)}; ${this.getSvgBaseLine()}"`;this.color.rgba!=="#000000"&&(n+=` fill="${this.color.rgba}"`),this.textAlign!==ue.Left&&(n+=` text-anchor="${this.getSvgTextAlignment(this.textAlign)}"`),n+=`>${X1.escapeText(e)}</text>`,this.buffer+=n}static escapeText(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}getSvgTextAlignment(e){switch(e){case ue.Left:return"start";case ue.Center:return"middle";case ue.Right:return"end"}return""}getSvgBaseLine(){switch(this.textBaseline){case Se.Top:return"dominant-baseline: hanging";case Se.Bottom:return"dominant-baseline: bottom";default:return""}}measureText(e){return e?Ci.measureString(e,this.font.families,this.font.size,this.font.style,this.font.weight):new cp(0,0)}onRenderFinished(){return null}beginRotate(e,t,r){this.buffer+='<g transform="translate('+e+" ,"+t+") rotate( "+r+')">'}endRotate(){this.buffer+="</g>"}}class BU extends X1{constructor(){super()}fillMusicFontSymbol(e,t,r,n,s){n!==w.None&&this.fillMusicFontSymbolText(e,t,r,`&#${n};`,s)}fillMusicFontSymbols(e,t,r,n,s){let a="";for(let o of n)o!==w.None&&(a+=`&#${o};`);this.fillMusicFontSymbolText(e,t,r,a,s)}fillMusicFontSymbolText(e,t,r,n,s){this.buffer+=`<g transform="translate(${e} ${t})" class="at" ><text`,r!==1?this.buffer+=` style="font-size: ${r*100}%; stroke:none"`:this.buffer+=' style="stroke:none"',this.color.rgba!=="#000000"&&(this.buffer+=` fill="${this.color.rgba}"`),s&&(this.buffer+=' text-anchor="'+this.getSvgTextAlignment(ue.Center)+'"'),this.buffer+=`>${n}</text></g>`}}class gp{constructor(){this.isInAccolade=!0,this.isRelevantForBoundsLookup=!0,this.hideOnMultiTrack=!1,this.hideOnPercussionTrack=!1}canCreate(e,t){return!this.hideOnPercussionTrack||!t.isPercussion}}var Oe;(function(i){i[i.PreNotes=0]="PreNotes",i[i.OnNotes=1]="OnNotes",i[i.MiddleNotes=2]="MiddleNotes",i[i.Stem=3]="Stem",i[i.PostNotes=4]="PostNotes",i[i.EndBeat=5]="EndBeat"})(Oe||(Oe={}));class Mn extends Mt{get isEmpty(){return!this.glyphs||this.glyphs.length===0}constructor(e,t){super(e,t),this.glyphs=null}doLayout(){if(!this.glyphs||this.glyphs.length===0){this.width=0;return}let e=0;for(let t=0,r=this.glyphs.length;t<r;t++){let n=this.glyphs[t];n.renderer=this.renderer,n.doLayout(),e=Math.max(e,n.width)}this.width=e}addGlyph(e){this.glyphs||(this.glyphs=[]),this.renderer&&(e.renderer=this.renderer),this.glyphs.push(e)}paint(e,t,r){let n=this.glyphs;if(!(!n||n.length===0))for(let s of n)s.paint(e+this.x,t+this.y,r)}}class Ol extends Mn{constructor(){super(0,0),this.glyphs=[]}addGlyph(e){e.x=this.glyphs.length===0?0:this.glyphs[this.glyphs.length-1].x+this.glyphs[this.glyphs.length-1].width,e.renderer=this.renderer,e.doLayout(),this.width=e.x+e.width,super.addGlyph(e)}}class UB extends Mn{constructor(e,t,r){super(e,t),this.voice=r,this.beatGlyphs=[],this.tupletGroups=[]}scaleToWidth(e){const t=this.renderer.scale;let r=this.renderer.layoutingInfo.spaceToForce(e/t);this.scaleToForce(r)}scaleToForce(e){const t=this.renderer.scale;this.width=this.renderer.layoutingInfo.calculateVoiceWidth(e)*t;let r=this.renderer.layoutingInfo.buildOnTimePositions(e),n=this.beatGlyphs;for(let s=0,a=n.length;s<a;s++){let o=n[s];switch(o.beat.graceType){case ce.None:o.x=r.get(o.beat.absoluteDisplayStart)*t-o.onTimeX;break;default:const l=o.beat.graceGroup.beats[0].absoluteDisplayStart,u=o.beat.graceGroup.id;if(o.beat.graceGroup.isComplete&&r.has(l)){o.x=r.get(l)*t-o.onTimeX;let c=this.renderer.layoutingInfo.allGraceRods.get(u);const h=o.beat.graceGroup.beats[o.beat.graceGroup.beats.length-1].nextBeat,d=h?this.renderer.layoutingInfo.getPreBeatSize(h)+tn.GraceBeatPadding*this.renderer.scale:0;o.x-=d,o.x-=c[o.beat.graceIndex].postSpringWidth,o.x+=c[o.beat.graceIndex].graceBeatWidth;const f=c[o.beat.graceGroup.beats.length-1];o.x-=f.graceBeatWidth}else{let c=this.renderer.layoutingInfo.incompleteGraceRods.get(u);const h=c[o.beat.graceIndex].postSpringWidth-c[o.beat.graceIndex].preSpringWidth;s>0?o.beat.graceIndex===0?o.x=n[s-1].x+n[s-1].width:o.x=n[s-1].x+c[o.beat.graceIndex-1].postSpringWidth-c[o.beat.graceIndex-1].preSpringWidth-h:o.x=-h}break}if(s>0){let l=o.x-n[s-1].x;n[s-1].scaleToWidth(l)}if(s===a-1){let l=this.width-n[n.length-1].x;o.scaleToWidth(l)}}}registerLayoutingInfo(e){e.updateVoiceSize(this.width);let t=this.beatGlyphs;for(let r of t)r.registerLayoutingInfo(e)}applyLayoutingInfo(e){let t=this.beatGlyphs;for(let r of t)r.applyLayoutingInfo(e);this.scaleToForce(Math.max(this.renderer.settings.display.stretchForce,e.minStretchForce))}addGlyph(e){let t=e;e.x=this.beatGlyphs.length===0?0:this.beatGlyphs[this.beatGlyphs.length-1].x+this.beatGlyphs[this.beatGlyphs.length-1].width,e.renderer=this.renderer,e.doLayout(),this.beatGlyphs.push(t),this.width=e.x+e.width,t.beat.hasTuplet&&t.beat.tupletGroup.beats[0].id===t.beat.id&&this.tupletGroups.push(t.beat.tupletGroup)}doLayout(){}paint(e,t,r){r.color=this.voice.index===0?this.renderer.resources.mainGlyphColor:this.renderer.resources.secondaryGlyphColor;for(let n=0,s=this.beatGlyphs.length;n<s;n++)this.beatGlyphs[n].paint(e+this.x,t+this.y,r)}}UB.KeySizeBeat="Beat";var Ye;(function(i){i[i.None=0]="None",i[i.Natural=1]="Natural",i[i.Sharp=2]="Sharp",i[i.Flat=3]="Flat",i[i.NaturalQuarterNoteUp=4]="NaturalQuarterNoteUp",i[i.SharpQuarterNoteUp=5]="SharpQuarterNoteUp",i[i.FlatQuarterNoteUp=6]="FlatQuarterNoteUp",i[i.DoubleSharp=7]="DoubleSharp",i[i.DoubleFlat=8]="DoubleFlat"})(Ye||(Ye={}));class _U{constructor(){this.maxLine=-1e3,this.minLine=-1e3}}class Dt{constructor(e){this._registeredAccidentals=new Map,this._appliedScoreLines=new Map,this._appliedScoreLinesByValue=new Map,this._notesByValue=new Map,this._beatLines=new Map,this.maxLineBeat=null,this.minLineBeat=null,this.maxLine=-1e3,this.minLine=-1e3,this._barRenderer=e,this._bar=e.bar}static getPercussionLine(e,t){var r;return t<e.staff.track.percussionArticulations.length?e.staff.track.percussionArticulations[t].staffLine:((r=At.getArticulationByValue(t))==null?void 0:r.staffLine)??0}static getNoteValue(e){if(e.isPercussion)return e.percussionArticulation;let t=e.displayValue;switch(e.accidentalMode){case Ft.ForceDoubleFlat:t+=2;break;case Ft.ForceDoubleSharp:t-=2;break;case Ft.ForceFlat:t+=1;break;case Ft.ForceSharp:t-=1;break}return t}applyAccidental(e){const t=Dt.getNoteValue(e);let r=e.hasQuarterToneOffset;return this.getAccidental(t,r,e.beat,!1,e)}applyAccidentalForValue(e,t,r,n){return this.getAccidental(t,r,e,n,null)}static computeLineWithoutAccidentals(e,t){let r=0;const n=Dt.getNoteValue(t);if(e.staff.isPercussion)r=Dt.getPercussionLine(e,n);else{const s=t?t.accidentalMode:Ft.Default;r=Dt.calculateNoteLine(e,n,s)}return r}getAccidental(e,t,r,n,s=null){let a=Ye.None,o=0;if(this._bar.staff.isPercussion)o=Dt.getPercussionLine(this._bar,e);else{const l=s?s.accidentalMode:Ft.Default;o=Dt.calculateNoteLine(this._bar,e,l);let c=this._bar.masterBar.keySignature+7,h=e%12,d=c<7?Ye.Flat:Ye.Sharp,f=Dt.KeySignatureLookup[c][h],p=Dt.AccidentalNotes[h];if(t)switch(a=p?d:Ye.Natural,a){case Ye.Natural:a=Ye.NaturalQuarterNoteUp;break;case Ye.Sharp:a=Ye.SharpQuarterNoteUp;break;case Ye.Flat:a=Ye.FlatQuarterNoteUp;break}else{switch(l){case Ft.ForceSharp:a=Ye.Sharp;break;case Ft.ForceDoubleSharp:a=Ye.DoubleSharp;break;case Ft.ForceFlat:a=Ye.Flat;break;case Ft.ForceDoubleFlat:a=Ye.DoubleFlat;break;default:p?a=d:f&&(a=Ye.Natural);break}let g=!1;if(s&&s.isTieDestination&&s.beat.index===0){const y=this._barRenderer.previousRenderer;y&&y.accidentalHelper.getNoteLine(s.tieOrigin)===o&&(g=!0)}g?a=Ye.None:a!==Ye.None?(this._registeredAccidentals.has(o)?this._registeredAccidentals.get(o)===a&&(a=Ye.None):f&&a===d&&(a=Ye.None),a!==Ye.None&&this._registeredAccidentals.set(o,a)):this._registeredAccidentals.has(o)?this._registeredAccidentals.get(o)===Ye.Natural?a=Ye.None:(a=Ye.Natural,this._registeredAccidentals.set(o,a)):this._registeredAccidentals.delete(o)}}return s?(this._appliedScoreLines.set(s.id,o),this._notesByValue.set(e,s)):this._appliedScoreLinesByValue.set(e,o),(this.minLine===-1e3||this.minLine<o)&&(this.minLine=o,this.minLineBeat=r),(this.maxLine===-1e3||this.maxLine>o)&&(this.maxLine=o,this.maxLineBeat=r),n||this.registerLine(r,o),a}registerLine(e,t){let r;this._beatLines.has(e.id)?r=this._beatLines.get(e.id):(r=new _U,this._beatLines.set(e.id,r)),(r.minLine===-1e3||t<r.minLine)&&(r.minLine=t),(r.minLine===-1e3||t>r.maxLine)&&(r.maxLine=t)}getMaxLine(e){return this._beatLines.has(e.id)?this._beatLines.get(e.id).maxLine:0}getMinLine(e){return this._beatLines.has(e.id)?this._beatLines.get(e.id).minLine:0}static calculateNoteLine(e,t,r){let n=t,s=e.masterBar.keySignature,a=e.clef,o=n%12,l=(n/12|0)-1,u=Dt.OctaveSteps[a];u-=l*Dt.StepsPerOctave;let c=ct.keySignatureIsSharp(s)||ct.keySignatureIsNatural(s)?Dt.SharpNoteSteps:Dt.FlatNoteSteps;return u-=c[o],u}getNoteLine(e){return this._appliedScoreLines.get(e.id)}getNoteLineForValue(e,t=!1){return this._appliedScoreLinesByValue.has(e)?this._appliedScoreLinesByValue.get(e):t&&this._notesByValue.has(e)?this.getNoteLine(this._notesByValue.get(e)):0}}Dt.KeySignatureLookup=[[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],[!0,!0,!0,!0,!0,!1,!0,!0,!0,!0,!0,!0],[!1,!0,!0,!0,!0,!1,!0,!0,!0,!0,!0,!0],[!1,!0,!0,!0,!0,!1,!1,!1,!0,!0,!0,!0],[!1,!1,!1,!0,!0,!1,!1,!1,!0,!0,!0,!0],[!1,!1,!1,!0,!0,!1,!1,!1,!1,!1,!0,!0],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!0,!0,!1,!1,!1,!1,!1],[!0,!0,!1,!1,!1,!0,!0,!1,!1,!1,!1,!1],[!0,!0,!1,!1,!1,!0,!0,!0,!0,!1,!1,!1],[!0,!0,!0,!0,!1,!0,!0,!0,!0,!1,!1,!1],[!0,!0,!0,!0,!1,!0,!0,!0,!0,!0,!0,!1],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!1],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0]];Dt.AccidentalNotes=[!1,!0,!1,!0,!1,!1,!0,!1,!0,!1,!0,!1];Dt.StepsPerOctave=7;Dt.OctaveSteps=[38,32,30,26,38];Dt.SharpNoteSteps=[0,0,1,1,2,3,3,4,4,5,5,6];Dt.FlatNoteSteps=[0,1,1,2,2,3,4,4,5,5,6,6];class PU{constructor(){this.staffId="",this.up=0,this.down=0}}class RU{constructor(){this.startBeat=null,this.startX=0,this.startY=0,this.endBeat=null,this.endX=0,this.endY=0}calcY(e){return this.startX===this.endX?this.startY:(this.endY-this.startY)/(this.endX-this.startX)*(e-this.startX)+this.startY}}class Tn{get isRestBeamHelper(){return this.beats.length===1&&this.beats[0].isRest}hasLine(e,t){return e&&this.beatHasLine(t)||!e&&this.beats.length===1&&this.beatHasLine(t)}beatHasLine(e){return e.duration>_.Whole}hasFlag(e,t){return e&&this.beatHasFlag(t)||!e&&this.beats.length===1&&this.beatHasFlag(this.beats[0])}beatHasFlag(e){return!e.isRest&&(e.duration>_.Quarter||e.graceType!==ce.None)}constructor(e,t){this._beatLineXPositions=new Map,this._firstNonRestBeat=null,this._lastNonRestBeat=null,this.voice=null,this.beats=[],this.shortestDuration=_.QuadrupleWhole,this.fingeringCount=0,this.hasTuplet=!1,this._firstBeatLowestNoteCompareValue=-1,this._firstBeatHighestNoteCompareValue=-1,this._lastBeatLowestNoteCompareValue=-1,this._lastBeatHighestNoteCompareValue=-1,this.lowestNoteInHelper=null,this._lowestNoteCompareValueInHelper=-1,this.highestNoteInHelper=null,this._highestNoteCompareValueInHelper=-1,this.invertBeamDirection=!1,this.preferredBeamDirection=null,this.isGrace=!1,this.minRestLine=null,this.beatOfMinRestLine=null,this.maxRestLine=null,this.beatOfMaxRestLine=null,this.direction=H.Up,this.drawingInfos=new Map,this._staff=e,this._renderer=t,this.beats=[]}getBeatLineX(e){return this.hasBeatLineX(e)?this.direction===H.Up?this._beatLineXPositions.get(e.index).up:this._beatLineXPositions.get(e.index).down:0}hasBeatLineX(e){return this._beatLineXPositions.has(e.index)}registerBeatLineX(e,t,r,n){let s=this.getOrCreateBeatPositions(t);s.staffId=e,s.up=r,s.down=n;for(const a of this.drawingInfos.values())a.startBeat==t?a.startX=this.getBeatLineX(t):a.endBeat==t&&(a.endX=this.getBeatLineX(t))}getOrCreateBeatPositions(e){return this._beatLineXPositions.has(e.index)||this._beatLineXPositions.set(e.index,new PU),this._beatLineXPositions.get(e.index)}finish(){this.direction=this.calculateDirection()}calculateDirection(){let e=null;if(this.voice?this.preferredBeamDirection!==null?e=this.preferredBeamDirection:this.voice.index>0?e=this.invert(H.Down):this.voice.bar.isMultiVoice?e=this.invert(H.Up):this.beats[0].graceType!==ce.None&&(e=this.invert(H.Up)):e=H.Up,this.highestNoteInHelper&&this.lowestNoteInHelper){let t=this._renderer.getNoteY(this.highestNoteInHelper,te.Center),r=this._renderer.getNoteY(this.lowestNoteInHelper,te.Center);if(e===null){const n=(t+r)/2;e=this.invert(this._renderer.middleYPosition<n?H.Up:H.Down)}this._renderer.completeBeamingHelper(this)}else e=this.invert(H.Up),this._renderer.completeBeamingHelper(this);return e}static computeLineHeightsForRest(e){switch(e){case _.QuadrupleWhole:return[2,2];case _.DoubleWhole:return[2,2];case _.Whole:return[0,1];case _.Half:return[1,0];case _.Quarter:return[3,3];case _.Eighth:return[2,2];case _.Sixteenth:return[2,4];case _.ThirtySecond:return[4,4];case _.SixtyFourth:return[4,6];case _.OneHundredTwentyEighth:return[6,6];case _.TwoHundredFiftySixth:return[6,8]}return[0,0]}applyRest(e,t){if(this._lastNonRestBeat&&e.index>=this._lastNonRestBeat.index||this._firstNonRestBeat&&e.index<=this._firstNonRestBeat.index)return;let r=t,n=t;const s=Tn.computeLineHeightsForRest(e.duration);r-=s[0],n+=s[1];const a=this.minRestLine,o=this.maxRestLine;(a===null||a>r)&&(this.minRestLine=r,this.beatOfMinRestLine=e),(o===null||o<n)&&(this.maxRestLine=n,this.beatOfMaxRestLine=e)}invert(e){if(!this.invertBeamDirection)return e;switch(e){case H.Down:return H.Up;default:return H.Down}}checkBeat(e){e.invertBeamDirection&&(this.invertBeamDirection=!0),this.voice||(this.voice=e.voice);let t=!1;if(this.beats.length===0)t=!0;else switch(this.beats[this.beats.length-1].beamingMode){case kn.Auto:t=Tn.canJoin(this.beats[this.beats.length-1],e);break;case kn.ForceSplitToNext:t=!1;break;case kn.ForceMergeWithNext:t=!0;break}if(t){if(e.preferredBeamDirection!==null&&(this.preferredBeamDirection=e.preferredBeamDirection),e.isRest)this.beats.length===0&&this.beats.push(e);else{this.isRestBeamHelper&&(this.beats=[]),this.beats.push(e),e.graceType!==ce.None&&(this.isGrace=!0),e.hasTuplet&&(this.hasTuplet=!0);let r=0;for(let n=0;n<e.notes.length;n++){let s=e.notes[n];(s.leftHandFinger!==be.Unknown||s.rightHandFinger!==be.Unknown)&&r++}r>this.fingeringCount&&(this.fingeringCount=r),this.checkNote(e.minNote),this.checkNote(e.maxNote),this.shortestDuration<e.duration&&(this.shortestDuration=e.duration),this._firstNonRestBeat||(this._firstNonRestBeat=e),this._lastNonRestBeat=e}e.hasTuplet&&(this.hasTuplet=!0)}return t}checkNote(e){if(!e)return;let t,r;this.voice&&e.isPercussion?(t=-Dt.getPercussionLine(this.voice.bar,Dt.getNoteValue(e)),r=t):(t=Dt.getNoteValue(e),r=t,e.harmonicType!==ne.None&&e.harmonicType!==ne.Natural&&(r=e.realValue-this._staff.displayTranspositionPitch)),this.beats.length===1&&this.beats[0]===e.beat&&((this._firstBeatLowestNoteCompareValue===-1||t<this._firstBeatLowestNoteCompareValue)&&(this._firstBeatLowestNoteCompareValue=t),(this._firstBeatHighestNoteCompareValue===-1||r>this._firstBeatHighestNoteCompareValue)&&(this._firstBeatHighestNoteCompareValue=r)),(this._lastBeatLowestNoteCompareValue===-1||t<this._lastBeatLowestNoteCompareValue)&&(this._lastBeatLowestNoteCompareValue=t),(this._lastBeatHighestNoteCompareValue===-1||r>this._lastBeatHighestNoteCompareValue)&&(this._lastBeatHighestNoteCompareValue=r),(!this.lowestNoteInHelper||t<this._lowestNoteCompareValueInHelper)&&(this.lowestNoteInHelper=e,this._lowestNoteCompareValueInHelper=t),(!this.highestNoteInHelper||r>this._highestNoteCompareValueInHelper)&&(this.highestNoteInHelper=e,this._highestNoteCompareValueInHelper=r)}static canJoin(e,t){if(!e||!t||e.graceType!==t.graceType||e.graceType===ce.BendGrace||t.graceType===ce.BendGrace)return!1;if(e.graceType!==ce.None&&t.graceType!==ce.None)return!0;let r=e.voice.bar,n=t.voice.bar;if(r!==n)return!1;let s=e.playbackStart,a=t.playbackStart;if(!Tn.canJoinDuration(e.duration)||!Tn.canJoinDuration(t.duration))return s===a;if(e.tupletGroup!==t.tupletGroup)return!1;if(e.hasTuplet&&t.hasTuplet&&e.tupletGroup===t.tupletGroup&&e.tupletGroup.isFull)return!0;let o=we.QuarterTime;switch(r.masterBar.timeSignatureDenominator){case 8:r.masterBar.timeSignatureNumerator%3===0&&(o+=we.QuarterTime/2|0);break}let l=(o+s)/o|0|0,u=(o+a)/o|0|0;return l===u}static canJoinDuration(e){switch(e){case _.Whole:case _.Half:case _.Quarter:return!1;default:return!0}}static isFullBarJoin(e,t,r){return ct.getIndex(e.duration)-2-r>0&&ct.getIndex(t.duration)-2-r>0}get beatOfLowestNote(){return this.lowestNoteInHelper.beat}get beatOfHighestNote(){return this.highestNoteInHelper.beat}isPositionFrom(e,t){return this._beatLineXPositions.has(t.index)?this._beatLineXPositions.get(t.index).staffId===e||!this._beatLineXPositions.get(t.index).staffId:!0}}class EU{constructor(e,t){this.topY=0,this.bottomY=0,this.topY=e,this.bottomY=t}}class MU{constructor(e){this.topY=-1e3,this.bottomY=-1e3,this.slots=[],this.beat=e}addSlot(e,t){if(this.slots.push(new EU(e,t)),this.topY===-1e3)this.topY=e,this.bottomY=t;else{const r=Math.min(e,t),n=Math.max(e,t);r<this.topY&&(this.topY=r),n>this.bottomY&&(this.bottomY=n)}}}class OU{constructor(){this.reservedLayoutAreasByDisplayTime=new Map,this.restDurationsByDisplayTime=new Map}getBeatMinMaxY(){let e=-1e3,t=-1e3;for(const r of this.reservedLayoutAreasByDisplayTime.values())e===-1e3?(e=r.topY,t=r.bottomY):(e>r.topY&&(e=r.topY),t<r.bottomY&&(t=r.bottomY));return e===-1e3?[0,0]:[e,t]}reserveBeatSlot(e,t,r){t!=r&&(this.reservedLayoutAreasByDisplayTime.has(e.displayStart)||this.reservedLayoutAreasByDisplayTime.set(e.displayStart,new MU(e)),this.reservedLayoutAreasByDisplayTime.get(e.displayStart).addSlot(t,r),e.isRest&&this.registerRest(e))}registerRest(e){this.restDurationsByDisplayTime.has(e.displayStart)||this.restDurationsByDisplayTime.set(e.displayStart,new Map),this.restDurationsByDisplayTime.get(e.displayStart).has(e.playbackDuration)||this.restDurationsByDisplayTime.get(e.displayStart).set(e.playbackDuration,e.id)}applyRestCollisionOffset(e,t,r){if(e.voice.index>0&&this.reservedLayoutAreasByDisplayTime.has(e.playbackStart)){const n=Tn.computeLineHeightsForRest(e.duration).map(c=>c*r);let s=t-n[0],a=t+n[1],o=s;const l=this.reservedLayoutAreasByDisplayTime.get(e.playbackStart);let u=!1;for(const c of l.slots)if(s>=c.topY&&s<=c.bottomY||a>=c.topY&&a<=c.bottomY){u=!0;break}if(u){e.voice.index==1?o=l.topY-n[1]-n[0]:o=l.bottomY;let c=o+n[0]+n[1];const h=r*2;let d=Math.ceil(Math.abs(o-s)/h);return l.addSlot(o,c),o<s?d*-h:d*h}}return 0}}class IU{constructor(e){this.beamHelpers=[],this.beamHelperLookup=[],this._renderer=e,this.collisionHelper=new OU}initialize(){var e=this._renderer,t=this._renderer.bar;let r=null,n=null;for(let s=0,a=t.voices.length;s<a;s++){let o=t.voices[s];this.beamHelpers.push([]),this.beamHelperLookup.push(new Map);for(let l=0,u=o.beats.length;l<u;l++){let c=o.beats[l],h;c.graceType!==ce.None?h=n:(h=r,n=null),(!h||!h.checkBeat(c))&&(h&&h.finish(),h=new Tn(t.staff,e),h.checkBeat(c),c.graceType!==ce.None?n=h:r=h,this.beamHelpers[o.index].push(h)),this.beamHelperLookup[o.index].set(c.index,h)}r&&r.finish(),n&&n.finish(),r=null,n=null}}getBeamingHelperForBeat(e){return this.beamHelperLookup[e.voice.index].get(e.index)}}class hi extends In{constructor(e,t,r){super(e,t),this._textRow=0,this._fretRow=0,this._firstFretSpacing=0,this._chord=r}doLayout(){super.doLayout();const e=this.scale;let t=this.renderer.resources;this._textRow=t.effectFont.size*1.5*e,this._fretRow=t.effectFont.size*1.5*e,this._chord.firstFret>1?this._firstFretSpacing=hi.FretSpacing*e:this._firstFretSpacing=0,this.height=this._textRow+this._fretRow+(hi.Frets-1)*hi.FretSpacing*e+2*hi.Padding*e,this.width=this._firstFretSpacing+(this._chord.staff.tuning.length-1)*hi.StringSpacing*e+2*hi.Padding*e}paint(e,t,r){e+=this.x+hi.Padding*this.scale+this._firstFretSpacing,t+=this.y;let n=this.width-2*hi.Padding*this.scale+this.scale-this._firstFretSpacing,s=hi.StringSpacing*this.scale,a=hi.FretSpacing*this.scale,o=this.renderer.resources,l=hi.CircleRadius*this.scale,u=r.textAlign,c=r.textBaseline;r.font=o.effectFont,r.textAlign=ue.Center,r.textBaseline=Se.Top,this._chord.showName&&r.fillText(this._chord.name,e+this.width/2,t+o.effectFont.size/2),t+=this._textRow,e+=s/2,r.font=o.fretboardNumberFont,r.textBaseline=Se.Middle;for(let d=0;d<this._chord.staff.tuning.length;d++){let f=e+d*s,p=t+this._fretRow/2,g=this._chord.strings[this._chord.staff.tuning.length-d-1];g<0?r.fillMusicFontSymbol(f,p,this.scale,w.FretboardX,!0):g===0?r.fillMusicFontSymbol(f,p,this.scale,w.FretboardO,!0):(g-=this._chord.firstFret-1,r.fillText(g.toString(),f,p))}t+=this._fretRow;for(let d=0;d<this._chord.staff.tuning.length;d++){let f=e+d*s;r.fillRect(f,t,1,a*hi.Frets+this.scale)}this._chord.firstFret>1&&(r.textAlign=ue.Left,r.fillText(this._chord.firstFret.toString(),e-this._firstFretSpacing,t+a/2)),r.fillRect(e,t-this.scale,n,2*this.scale);for(let d=0;d<=hi.Frets;d++){let f=t+d*a;r.fillRect(e,f,n,this.scale)}let h=new Map;for(let d of this._chord.barreFrets){let f=[-1,-1];h.set(d-this._chord.firstFret,f)}for(let d=0;d<this._chord.strings.length;d++){let f=this._chord.strings[d];if(f>0){if(f-=this._chord.firstFret,h.has(f)){let y=h.get(f);(y[0]===-1||d<y[0])&&(y[0]=d),(y[1]===-1||d>y[1])&&(y[1]=d)}let p=t+f*a+a/2+.5*this.scale,g=e+(this._chord.strings.length-d-1)*s;r.fillCircle(g,p,l)}}for(const[d,f]of h){let p=t+d*a+a/2+.5*this.scale,g=e+(this._chord.strings.length-f[1]-1)*s,y=e+(this._chord.strings.length-f[0]-1)*s;r.fillRect(g,p-l,y-g,l*2)}r.textAlign=u,r.textBaseline=c}}hi.Padding=5;hi.Frets=5;hi.CircleRadius=2.5;hi.StringSpacing=10;hi.FretSpacing=12;class OS extends Mn{constructor(e,t,r=ue.Center){super(e,t),this._glyphWidth=0,this.glyphs=[],this._align=r}doLayout(){let e=0;switch(this._align){case ue.Left:e=0;break;case ue.Center:e=(this.width-this._glyphWidth)/2;break;case ue.Right:e=this.width-this._glyphWidth;break}for(let t of this.glyphs)t.x=e,e+=t.width}addGlyphToRow(e){this.glyphs.push(e),this._glyphWidth+=e.width,e.height>this.height&&(this.height=e.height)}}class vc extends Mn{constructor(e,t,r=ue.Center){super(e,t),this._rows=[],this.height=0,this.glyphs=[],this._align=r}doLayout(){let e=0,t=0,r=vc.Padding*this.scale;this._rows=[];let n=new OS(e,t,this._align);n.width=this.width;for(let s of this.glyphs)e+s.width<this.width?(n.addGlyphToRow(s),e+=s.width):(n.isEmpty||(n.doLayout(),this._rows.push(n),t+=n.height+r),e=0,n=new OS(e,t,this._align),n.width=this.width,n.addGlyphToRow(s),e+=s.width);n.isEmpty||(n.doLayout(),this._rows.push(n),t+=n.height+r),this.height=t}paint(e,t,r){for(let n of this._rows)n.paint(e+this.x,t+this.y,r)}}vc.Padding=3;class LU extends vc{constructor(e,t){super(e,t)}addChord(e){if(e.strings.length>0){let t=new hi(0,0,e);t.renderer=this.renderer,t.doLayout(),this.glyphs.push(t)}}}class _i extends In{constructor(e,t,r,n,s=ue.Left){super(e,t),this._lineHeights=null,this._lines=r.split(`
`),this.font=n,this.textAlign=s}doLayout(){super.doLayout(),this._lineHeights=[];const e=this.renderer.scoreRenderer.canvas;for(const t of this._lines){e.font=this.font;const r=e.measureText(t).height*this.scale;this._lineHeights.push(r),this.height+=r}}paint(e,t,r){let n=r.color;r.color=n,r.font=this.font;let s=r.textAlign;r.textAlign=this.textAlign;let a=t+this.y;for(let o=0;o<this._lines.length;o++)r.fillText(this._lines[o],e+this.x,a),a+=this._lineHeights[o];r.textAlign=s}}class DU{get staveId(){return this._factory.staffId}constructor(e,t,r){this._sharedLayoutData=new Map,this.barRenderers=[],this.x=0,this.y=0,this.height=0,this.index=0,this.staffIndex=0,this.trackIndex=0,this.staveTop=0,this.topSpacing=0,this.bottomSpacing=0,this.staveBottom=0,this.isFirstInAccolade=!1,this.isLastInAccolade=!1,this._factory=r,this.trackIndex=e,this.modelStaff=t}getSharedLayoutData(e,t){return this._sharedLayoutData.has(e)?this._sharedLayoutData.get(e):t}setSharedLayoutData(e,t){this._sharedLayoutData.set(e,t)}get isInAccolade(){return this._factory.isInAccolade}get isRelevantForBoundsLookup(){return this._factory.isRelevantForBoundsLookup}registerStaffTop(e){this.staveTop=e}registerStaffBottom(e){this.staveBottom=e}addBarRenderer(e){e.staff=this,e.index=this.barRenderers.length,e.reLayout(),this.barRenderers.push(e),this.system.layout.registerBarRenderer(this.staveId,e)}addBar(e,t){let r;e?r=this._factory.create(this.system.layout.renderer,e):r=new xt(this.system.layout.renderer,e),r.staff=this,r.index=this.barRenderers.length,r.layoutingInfo=t,r.doLayout(),r.registerLayoutingInfo();const n=r.barDisplayWidth;n>0&&this.system.layout.systemsLayoutMode==pr.FromModelWithWidths&&(r.width=n),this.barRenderers.push(r),e&&this.system.layout.registerBarRenderer(this.staveId,r)}revertLastBar(){let e=this.barRenderers[this.barRenderers.length-1];return this.barRenderers.splice(this.barRenderers.length-1,1),this.system.layout.unregisterBarRenderer(this.staveId,e),e}scaleToWidth(e){this._sharedLayoutData=new Map;let t=this.topOverflow,r=0;switch(this.system.layout.systemsLayoutMode){case pr.Automatic:let s=(e-this.system.computedWidth)/this.barRenderers.length;for(const o of this.barRenderers){o.x=r,o.y=this.topSpacing+t;let l=o.computedWidth+s;o.scaleToWidth(l),r+=o.width}break;case pr.FromModelWithScale:e-=this.system.accoladeWidth;const a=this.system.totalBarDisplayScale;for(const o of this.barRenderers){o.x=r,o.y=this.topSpacing+t;const l=o.barDisplayScale*e/a;o.scaleToWidth(l),r+=o.width}break;case pr.FromModelWithWidths:for(const o of this.barRenderers){o.x=r,o.y=this.topSpacing+t;const l=o.barDisplayWidth;l>0?o.scaleToWidth(l):o.scaleToWidth(o.computedWidth),r+=o.width}break}}get topOverflow(){let e=0;for(let t=0,r=this.barRenderers.length;t<r;t++){let n=this.barRenderers[t];n.topOverflow>e&&(e=n.topOverflow)}return e}get bottomOverflow(){let e=0;for(let t=0,r=this.barRenderers.length;t<r;t++){let n=this.barRenderers[t];n.bottomOverflow>e&&(e=n.bottomOverflow)}return e}finalizeStaff(){const e=this.system.layout.renderer.settings;this.topSpacing=this._factory.getStaffPaddingTop(this)*e.display.scale,this.bottomSpacing=this._factory.getStaffPaddingBottom(this)*e.display.scale,this.height=0;let t=!1,r=this.topOverflow;for(let n=0;n<this.barRenderers.length;n++)this.barRenderers[n].y=this.topSpacing+r,this.height=Math.max(this.height,this.barRenderers[n].height),this.barRenderers[n].finalizeRenderer()&&(t=!0);if(t){r=this.topOverflow;for(let n=0;n<this.barRenderers.length;n++)this.barRenderers[n].y=this.topSpacing+r,this.height=Math.max(this.height,this.barRenderers[n].height),this.barRenderers[n].finalizeRenderer()}this.height>0&&(this.height+=this.topSpacing+r+this.bottomOverflow+this.bottomSpacing)}paint(e,t,r,n,s){if(!(this.height===0||s===0))for(let a=n,o=Math.min(n+s,this.barRenderers.length);a<o;a++)this.barRenderers[a].paint(e+this.x,t+this.y,r)}}class IS{constructor(){this.timePosition=0,this.longestDuration=0,this.smallestDuration=0,this.force=0,this.springConstant=0,this.preBeatWidth=0,this.graceBeatWidth=0,this.postSpringWidth=0,this.allDurations=new Set}get springWidth(){return this.preSpringWidth+this.postSpringWidth}get preSpringWidth(){return this.preBeatWidth+this.graceBeatWidth}}class al{constructor(){this._timeSortedSprings=[],this._xMin=0,this._minTime=-1,this._onTimePositionsForce=0,this._onTimePositions=new Map,this._incompleteGraceRodsWidth=0,this.version=0,this.preBeatSizes=new Map,this.onBeatSizes=new Map,this.onBeatCenterX=new Map,this.preBeatSize=0,this.postBeatSize=0,this.voiceSize=0,this.minStretchForce=0,this.totalSpringConstant=0,this.incompleteGraceRods=new Map,this.allGraceRods=new Map,this.springs=new Map,this.height=0}updateVoiceSize(e){e>this.voiceSize&&(this.voiceSize=e,this.version++)}setPreBeatSize(e,t){(!this.preBeatSizes.has(e.id)||this.preBeatSizes.get(e.id)<t)&&(this.preBeatSizes.set(e.id,t),this.version++)}getPreBeatSize(e){return this.preBeatSizes.has(e.id)?this.preBeatSizes.get(e.id):0}setOnBeatSize(e,t){(!this.onBeatSizes.has(e.id)||this.onBeatSizes.get(e.id)<t)&&(this.onBeatSizes.set(e.id,t),this.version++)}getOnBeatSize(e){return this.onBeatSizes.has(e.id)?this.onBeatSizes.get(e.id):0}getBeatCenterX(e){return this.onBeatCenterX.has(e.id)?this.onBeatCenterX.get(e.id):0}setBeatCenterX(e,t){(!this.onBeatCenterX.has(e.id)||this.onBeatCenterX.get(e.id)<t)&&(this.onBeatCenterX.set(e.id,t),this.version++)}updateMinStretchForce(e){this.minStretchForce<e&&(this.minStretchForce=e)}addSpring(e,t,r,n,s){this.version++;let a;if(this.springs.has(e))a=this.springs.get(e),a.postSpringWidth<s&&(a.postSpringWidth=s),a.graceBeatWidth<r&&(a.graceBeatWidth=r),a.preBeatWidth<n&&(a.preBeatWidth=n),t<a.smallestDuration&&(a.smallestDuration=t),t>a.longestDuration&&(a.longestDuration=t),a.allDurations.add(t);else{if(a=new IS,a.timePosition=e,a.allDurations.add(t),this._timeSortedSprings.length>0){let u=this._timeSortedSprings[this._timeSortedSprings.length-1];for(const c of u.allDurations)u.timePosition+c}a.longestDuration=t,a.postSpringWidth=s,a.graceBeatWidth=r,a.preBeatWidth=n,this.springs.set(e,a);let o=this._timeSortedSprings,l=o.length-1;for(;l>0&&o[l].timePosition>e;)l--;this._timeSortedSprings.splice(l+1,0,a)}return(this._minTime===-1||this._minTime>e)&&(this._minTime=e),a}addBeatSpring(e,t,r){let n=e.absoluteDisplayStart;if(e.graceType!==ce.None){const s=e.graceGroup.id;this.allGraceRods.has(s)||this.allGraceRods.set(s,new Array(e.graceGroup.beats.length)),!e.graceGroup.isComplete&&!this.incompleteGraceRods.has(s)&&this.incompleteGraceRods.set(s,new Array(e.graceGroup.beats.length));let a=this.allGraceRods.get(s)[e.graceIndex];if(a)a.postSpringWidth<r&&(a.postSpringWidth=r),a.preBeatWidth<t&&(a.preBeatWidth=t);else{const o=new IS;o.timePosition=n,o.postSpringWidth=r,o.preBeatWidth=t,e.graceGroup.isComplete||(this.incompleteGraceRods.get(s)[e.graceIndex]=o),this.allGraceRods.get(s)[e.graceIndex]=o}}else{let s=0;if(e.graceGroup&&this.allGraceRods.has(e.graceGroup.id))for(const a of this.allGraceRods.get(e.graceGroup.id))s+=a.springWidth;this.addSpring(n,e.displayDuration,s,t,r)}}finish(){for(const[e,t]of this.allGraceRods){let r=0;if(this.incompleteGraceRods.has(e))for(const n of t)r+=n.preBeatWidth,n.graceBeatWidth=r,r+=n.postSpringWidth;else for(let n=t.length-1;n>=0;n--)t[n].graceBeatWidth=r,r-=t[n].preBeatWidth+t[n].postSpringWidth}this._incompleteGraceRodsWidth=0;for(const e of this.incompleteGraceRods.values())for(const t of e)this._incompleteGraceRodsWidth+=t.preBeatWidth+t.postSpringWidth;this.calculateSpringConstants(),this.version++}calculateSpringConstants(){this._xMin=0;let e=this.springs;for(const n of e.values())n.springWidth<this._xMin&&(this._xMin=n.springWidth);let t=0,r=this._timeSortedSprings;if(r.length===0){this.totalSpringConstant=-1,this.minStretchForce=-1;return}for(let n=0;n<r.length;n++){let s=r[n],a=0;if(n===r.length-1)a=s.longestDuration;else{let o=r[n+1];a=Math.abs(o.timePosition-s.timePosition)}s.springConstant=this.calculateSpringConstant(s,a),t+=1/s.springConstant}this.totalSpringConstant=1/t,this.minStretchForce=0;for(let n=0;n<r.length;n++){let s=r[n],a=0;if(n===r.length-1)a=s.postSpringWidth;else{let l=r[n+1];a=s.postSpringWidth+l.preSpringWidth}n===0&&(a+=s.preSpringWidth);let o=a*s.springConstant;this.updateMinStretchForce(o)}}paint(e,t,r){}calculateSpringConstant(e,t){t<=0&&(t=we.toTicks(_.SixtyFourth)),e.smallestDuration===0&&(e.smallestDuration=t);let r=e.smallestDuration,n=1+.85*Math.log2(t/al.MinDuration);return r/t*(1/(n*al.MinDurationWidth))}spaceToForce(e){return this.totalSpringConstant!==-1?(this._timeSortedSprings.length>0&&(e-=this._timeSortedSprings[0].preSpringWidth),e-=this._incompleteGraceRodsWidth,Math.max(e,0)*this.totalSpringConstant):-1}calculateVoiceWidth(e){let t=0;return this.totalSpringConstant!==-1&&(t=this.calculateWidth(e,this.totalSpringConstant)),this._timeSortedSprings.length>0&&(t+=this._timeSortedSprings[0].preSpringWidth),t+=this._incompleteGraceRodsWidth,t}calculateWidth(e,t){return e/t}buildOnTimePositions(e){if(this.totalSpringConstant===-1)return new Map;if(ct.isAlmostEqualTo(this._onTimePositionsForce,e)&&this._onTimePositions)return this._onTimePositions;this._onTimePositionsForce=e;let t=new Map;this._onTimePositions=t;let r=this._timeSortedSprings;if(r.length===0)return t;let n=r[0].preSpringWidth;for(let s=0;s<r.length;s++)t.set(r[s].timePosition,n),n+=this.calculateWidth(e,r[s].springConstant);return t}}al.MinDuration=30;al.MinDurationWidth=7;class FU{constructor(){this.width=0,this.isLinkedToPrevious=!1,this.canWrap=!0,this.renderers=[]}}class AU{constructor(e,t){this.staves=[],this.stavesRelevantForBoundsLookup=[],this.firstStaffInAccolade=null,this.lastStaffInAccolade=null,this.staffSystem=e,this.track=t}addStaff(e){this.staves.push(e),e.isRelevantForBoundsLookup&&this.stavesRelevantForBoundsLookup.push(e)}}class Xu{constructor(e){this._allStaves=[],this._firstStaffInAccolade=null,this._lastStaffInAccolade=null,this._accoladeSpacingCalculated=!1,this.x=0,this.y=0,this.index=0,this.accoladeWidth=0,this.isFull=!1,this.width=0,this.computedWidth=0,this.totalBarDisplayScale=0,this.isLast=!1,this.masterBarsRenderers=[],this.staves=[],this.layout=e,this.topPadding=e.renderer.settings.display.systemPaddingTop,this.bottomPadding=e.renderer.settings.display.systemPaddingBottom}get firstBarIndex(){return this.masterBarsRenderers[0].masterBar.index}get lastBarIndex(){return this.masterBarsRenderers[this.masterBarsRenderers.length-1].masterBar.index}addMasterBarRenderers(e,t){if(e.length===0)return null;this.masterBarsRenderers.push(t),this.calculateAccoladeSpacing(e),t.layoutingInfo.preBeatSize=0;let r=0;for(let n=0,s=this.staves.length;n<s;n++){let a=this.staves[n];for(let o=0,l=a.staves.length;o<l;o++){let u=a.staves[o],c=t.renderers[r++];u.addBarRenderer(c)}}return this.updateWidthFromLastBar(),t}addBars(e,t){if(e.length===0)return null;let r=new FU;r.layoutingInfo=new al,r.masterBar=e[0].score.masterBars[t],this.masterBarsRenderers.push(r),this.calculateAccoladeSpacing(e);let n=r.layoutingInfo;for(let s of this.staves)for(let a of s.staves){let o=s.track.staves[a.modelStaff.index].bars[t];a.addBar(o,n);let l=a.barRenderers[a.barRenderers.length-1];r.renderers.push(l),l.isLinkedToPrevious&&(r.isLinkedToPrevious=!0),l.canWrap||(r.canWrap=!1)}return n.finish(),r.width=this.updateWidthFromLastBar(),r}revertLastBar(){if(this.masterBarsRenderers.length>1){let e=this.masterBarsRenderers[this.masterBarsRenderers.length-1];this.masterBarsRenderers.splice(this.masterBarsRenderers.length-1,1);let t=0,r=0;for(let n=0,s=this._allStaves.length;n<s;n++){let o=this._allStaves[n].revertLastBar();const l=o.computedWidth;l>t&&(t=l);const u=o.barDisplayScale;u>r&&(r=u)}return this.width-=t,this.computedWidth-=t,this.totalBarDisplayScale-=r,e}return null}updateWidthFromLastBar(){let e=0,t=0;for(let r=0,n=this._allStaves.length;r<n;r++){let s=this._allStaves[r];const a=s.barRenderers[s.barRenderers.length-1];a.applyLayoutingInfo(),a.computedWidth>e&&(e=a.computedWidth);const o=a.barDisplayScale;o>t&&(t=o)}return this.width+=e,this.computedWidth+=e,this.totalBarDisplayScale+=t,e}calculateAccoladeSpacing(e){const t=this.layout.renderer.settings;if(!this._accoladeSpacingCalculated){if(this._accoladeSpacingCalculated=!0,this.index===0&&this.layout.renderer.settings.notation.isNotationElementVisible(pe.TrackNames)){let r=this.layout.renderer.canvas,n=t.display.resources.effectFont;r.font=n;for(let s of e)this.accoladeWidth=Math.ceil(Math.max(this.accoladeWidth,r.measureText(s.shortName).width));this.accoladeWidth*=this.layout.scale,this.accoladeWidth+=t.display.systemLabelPaddingLeft*this.layout.scale,this.accoladeWidth+=t.display.systemLabelPaddingRight*this.layout.scale}else this.accoladeWidth=0;this.accoladeWidth+=Xu.AccoladeBarSize*this.layout.scale,this.accoladeWidth+=t.display.accoladeBarPaddingRight*this.layout.scale,this.width+=this.accoladeWidth,this.computedWidth+=this.accoladeWidth}}getStaffTrackGroup(e){for(let t=0,r=this.staves.length;t<r;t++){let n=this.staves[t];if(n.track===e)return n}return null}addStaff(e,t){let r=this.getStaffTrackGroup(e);r||(r=new AU(this,e),this.staves.push(r)),t.staffTrackGroup=r,t.system=this,t.index=this._allStaves.length,this._allStaves.push(t),r.addStaff(t),t.isInAccolade&&(this._firstStaffInAccolade||(this._firstStaffInAccolade=t,t.isFirstInAccolade=!0),r.firstStaffInAccolade||(r.firstStaffInAccolade=t),this._lastStaffInAccolade||(this._lastStaffInAccolade=t,t.isLastInAccolade=!0),this._lastStaffInAccolade&&(this._lastStaffInAccolade.isLastInAccolade=!1),this._lastStaffInAccolade=t,this._lastStaffInAccolade.isLastInAccolade=!0,r.lastStaffInAccolade=t)}get height(){return this._allStaves[this._allStaves.length-1].y+this._allStaves[this._allStaves.length-1].height+this.topPadding+this.bottomPadding}scaleToWidth(e){for(let t=0,r=this._allStaves.length;t<r;t++)this._allStaves[t].scaleToWidth(e);this.width=e}paint(e,t,r){t+=this.topPadding,this.paintPartial(e+this.x,t+this.y,r,0,this.masterBarsRenderers.length)}paintPartial(e,t,r,n,s){for(let o=0,l=this._allStaves.length;o<l;o++)this._allStaves[o].paint(e,t,r,n,s);let a=this.layout.renderer.settings.display.resources;if(this.staves.length>0&&n===0){if(r.color=a.barSeparatorColor,this._firstStaffInAccolade&&this._lastStaffInAccolade){let l=t+this._firstStaffInAccolade.y+this._firstStaffInAccolade.staveTop+this._firstStaffInAccolade.topSpacing+this._firstStaffInAccolade.topOverflow,u=t+this._lastStaffInAccolade.y+this._lastStaffInAccolade.topSpacing+this._lastStaffInAccolade.topOverflow+this._lastStaffInAccolade.staveBottom,c=e+this._firstStaffInAccolade.x;r.beginPath(),r.moveTo(c,l),r.lineTo(c,u),r.stroke()}r.font=a.effectFont;const o=this.layout.renderer.settings;for(let l=0,u=this.staves.length;l<u;l++){let c=this.staves[l];if(c.firstStaffInAccolade&&c.lastStaffInAccolade){let h=t+c.firstStaffInAccolade.y+c.firstStaffInAccolade.staveTop+c.firstStaffInAccolade.topSpacing+c.firstStaffInAccolade.topOverflow,d=t+c.lastStaffInAccolade.y+c.lastStaffInAccolade.topSpacing+c.lastStaffInAccolade.topOverflow+c.lastStaffInAccolade.staveBottom;const f=this.index===0&&this.layout.renderer.settings.notation.isNotationElementVisible(pe.TrackNames);let p=e+c.firstStaffInAccolade.x,g=Xu.AccoladeBarSize*this.layout.scale,y=o.display.accoladeBarPaddingRight*this.layout.scale,b=h-g*4,m=d+g*4;f&&r.fillText(c.track.shortName,e+o.display.systemLabelPaddingLeft*this.layout.scale,h),r.fillRect(p-y-g,b,g,m-b);let v=p-y-g,k=p+g*2;r.beginPath(),r.moveTo(v,b),r.bezierCurveTo(v,b,v,b,k,b-g),r.bezierCurveTo(p,b+g,v,b+g,v,b+g),r.closePath(),r.fill(),r.beginPath(),r.moveTo(v,m),r.bezierCurveTo(v,m,p,m,k,m+g),r.bezierCurveTo(p,m-g,v,m-g,v,m-g),r.closePath(),r.fill()}}}}finalizeSystem(){const e=this.layout.renderer.settings;this.index===0&&(this.topPadding=e.display.firstSystemPaddingTop*e.display.scale),this.isLast&&(this.bottomPadding=e.display.lastSystemPaddingBottom*e.display.scale);let t=0;for(let r of this._allStaves)r.x=this.accoladeWidth,r.y=t,r.finalizeStaff(),t+=r.height}buildBoundingsLookup(e,t){if(this.layout.renderer.boundsLookup.isFinished||!this._firstStaffInAccolade||!this._lastStaffInAccolade)return;t+=this.topPadding;let r=this._allStaves[this._allStaves.length-1],n=t+this.y+this._firstStaffInAccolade.y,s=t+this.y+this._lastStaffInAccolade.y+this._lastStaffInAccolade.height,a=t+this.y+this._allStaves[0].y,o=t+this.y+r.y+r.height,l=t+this.y+this._firstStaffInAccolade.y+this._firstStaffInAccolade.topSpacing+this._firstStaffInAccolade.topOverflow+(this._firstStaffInAccolade.barRenderers.length>0?this._firstStaffInAccolade.barRenderers[0].topPadding:0),u=t+this.y+r.y+r.height-r.bottomSpacing-r.bottomOverflow-(r.barRenderers.length>0?r.barRenderers[0].bottomPadding:0),c=s-n,h=u-l,d=o-a,f=this.x+this._firstStaffInAccolade.x,p=new IB;p.visualBounds=new ji,p.visualBounds.x=e,p.visualBounds.y=t+this.y,p.visualBounds.w=this.width,p.visualBounds.h=this.height-this.topPadding-this.bottomPadding,p.realBounds=new ji,p.realBounds.x=e,p.realBounds.y=t+this.y,p.realBounds.w=this.width,p.realBounds.h=this.height,this.layout.renderer.boundsLookup.addStaffSystem(p);let g=new Map;for(let y=0;y<this.staves.length;y++)for(let b of this.staves[y].stavesRelevantForBoundsLookup)for(let m of b.barRenderers){let v;g.has(m.bar.masterBar.index)?v=g.get(m.bar.masterBar.index):(v=new OB,v.index=m.bar.masterBar.index,v.isFirstOfLine=m.isFirstOfLine,v.realBounds=new ji,v.realBounds.x=f+m.x,v.realBounds.y=a,v.realBounds.w=m.width,v.realBounds.h=d,v.visualBounds=new ji,v.visualBounds.x=f+m.x,v.visualBounds.y=n,v.visualBounds.w=m.width,v.visualBounds.h=c,v.lineAlignedBounds=new ji,v.lineAlignedBounds.x=f+m.x,v.lineAlignedBounds.y=l,v.lineAlignedBounds.w=m.width,v.lineAlignedBounds.h=h,this.layout.renderer.boundsLookup.addMasterBar(v),g.set(v.index,v)),m.buildBoundingsLookup(v,f,t+this.y+b.y)}}getBarX(e){if(!this._firstStaffInAccolade||this.layout.renderer.tracks.length===0)return 0;let t=this.layout.renderer.tracks[0].staves[0].bars[e];return this.layout.getRendererForBar(this._firstStaffInAccolade.staveId,t).x}}Xu.AccoladeBarSize=3;class mp extends Mn{constructor(e,t,r,n){super(e,t),this._tuning=r,this._trackLabel=n,this.glyphs=[]}doLayout(){if(!(this.glyphs.length>0)){this.createGlyphs(this._tuning);for(const e of this.glyphs)e.renderer=this.renderer,e.doLayout()}}paint(e,t,r){r.textBaseline=Se.Middle,super.paint(e,t,r)}createGlyphs(e){const t=this.renderer.scale,r=this.renderer.resources;this.height=0;const n=15*t;if(this._trackLabel.length>0){const o=new _i(0,this.height,this._trackLabel,r.effectFont,ue.Left);o.renderer=this.renderer,o.doLayout(),this.height+=o.height,o.y+=o.height/2,this.addGlyph(o)}const s=new _i(0,this.height,e.name,r.effectFont,ue.Left);s.renderer=this.renderer,s.doLayout(),this.height+=s.height,s.y+=s.height/2,this.addGlyph(s);const a=64*t;if(this.renderer.scoreRenderer.canvas.font=r.effectFont,this.width=Math.max(this.renderer.scoreRenderer.canvas.measureText(this._trackLabel).width*t,Math.max(this.renderer.scoreRenderer.canvas.measureText(e.name).width*t,2*a)),!e.isStandard){this.height+=n;const o=.7,l=mp.CircleNumberHeight*o*t;let u=Math.ceil(e.tunings.length/2)|0,c=0,h=this.height;for(let d=0,f=e.tunings.length;d<f;d++){const p=w.GuitarString0+(d+1);this.addGlyph(new _t(c,h+l/2.5,o,p));const g="= "+F.getTextForTuning(e.tunings[d],!1);this.addGlyph(new _i(c+l+1*t,h,g,r.effectFont,ue.Left)),h+=n,d===u-1&&(h=this.height,c+=a)}this.height+=u*n}this.width+=15*t}}mp.CircleNumberHeight=20;class VU extends vc{constructor(e,t){super(e,t,ue.Left)}addTuning(e,t){if(e.tunings.length>0){let r=new mp(0,0,e,t);r.renderer=this.renderer,r.doLayout(),this.glyphs.push(r)}}}class HU{constructor(e,t){this.args=e,this.renderCallback=t}}var pr;(function(i){i[i.Automatic=0]="Automatic",i[i.FromModelWithScale=1]="FromModelWithScale",i[i.FromModelWithWidths=2]="FromModelWithWidths"})(pr||(pr={}));class WB{constructor(e){this._barRendererLookup=new Map,this.width=0,this.height=0,this.scoreInfoGlyphs=new Map,this.chordDiagrams=null,this.tuningGlyph=null,this.systemsLayoutMode=pr.Automatic,this._lazyPartials=new Map,this.firstBarIndex=0,this.lastBarIndex=0,this.renderer=e}resize(){this._lazyPartials.clear(),this.doResize()}layoutAndRender(){this._lazyPartials.clear();let e=this.renderer.score,t=this.renderer.settings.display.startBar;t--,t=Math.min(e.masterBars.length-1,Math.max(0,t)),this.firstBarIndex=t;let r=this.renderer.settings.display.barCount;r<0&&(r=e.masterBars.length),r=t+r-1,r=Math.min(e.masterBars.length-1,Math.max(0,r)),this.lastBarIndex=r,this.createScoreInfoGlyphs(),this.doLayoutAndRender()}registerPartial(e,t){e.height!=0&&(this.renderer.settings.core.enableLazyLoading?(this._lazyPartials.set(e.id,new HU(e,t)),this.renderer.partialLayoutFinished.trigger(e)):(this.renderer.partialLayoutFinished.trigger(e),this.internalRenderLazyPartial(e,t)))}internalRenderLazyPartial(e,t){const r=this.renderer.canvas;r.beginRender(e.width,e.height),t(r),e.renderResult=r.endRender(),this.renderer.partialRenderFinished.trigger(e)}renderLazyPartial(e){if(this._lazyPartials.has(e)){const t=this._lazyPartials.get(e);this.internalRenderLazyPartial(t.args,t.renderCallback)}}createScoreInfoGlyphs(){V.debug("ScoreLayout","Creating score info glyphs");let e=this.renderer.settings.notation,t=this.renderer.score,r=this.renderer.settings.display.resources;this.scoreInfoGlyphs=new Map,t.title&&e.isNotationElementVisible(pe.ScoreTitle)&&this.scoreInfoGlyphs.set(pe.ScoreTitle,new _i(0,0,t.title,r.titleFont,ue.Center)),t.subTitle&&e.isNotationElementVisible(pe.ScoreSubTitle)&&this.scoreInfoGlyphs.set(pe.ScoreSubTitle,new _i(0,0,t.subTitle,r.subTitleFont,ue.Center)),t.artist&&e.isNotationElementVisible(pe.ScoreArtist)&&this.scoreInfoGlyphs.set(pe.ScoreArtist,new _i(0,0,t.artist,r.subTitleFont,ue.Center)),t.album&&e.isNotationElementVisible(pe.ScoreAlbum)&&this.scoreInfoGlyphs.set(pe.ScoreAlbum,new _i(0,0,t.album,r.subTitleFont,ue.Center)),t.music&&t.music===t.words&&e.isNotationElementVisible(pe.ScoreWordsAndMusic)?this.scoreInfoGlyphs.set(pe.ScoreWordsAndMusic,new _i(0,0,"Music and Words by "+t.words,r.wordsFont,ue.Center)):(t.music&&e.isNotationElementVisible(pe.ScoreMusic)&&this.scoreInfoGlyphs.set(pe.ScoreMusic,new _i(0,0,"Music by "+t.music,r.wordsFont,ue.Right)),t.words&&e.isNotationElementVisible(pe.ScoreWords)&&this.scoreInfoGlyphs.set(pe.ScoreWords,new _i(0,0,"Words by "+t.words,r.wordsFont,ue.Left)));const n=new xt(this.renderer,this.renderer.tracks[0].staves[0].bars[0]);for(const[s,a]of this.scoreInfoGlyphs)a.renderer=n,a.doLayout();if(e.isNotationElementVisible(pe.GuitarTuning)){let s=[];for(let a of this.renderer.tracks)for(let o of a.staves)if(!o.isPercussion&&o.isStringed&&o.tuning.length>0&&o.showTablature){s.push(o);break}if(s.length>0){this.tuningGlyph=new VU(0,0),this.tuningGlyph.renderer=n;for(const a of s)this.tuningGlyph.addTuning(a.stringTuning,s.length>1?a.track.name:"")}}if(e.isNotationElementVisible(pe.ChordDiagrams)){this.chordDiagrams=new LU(0,0),this.chordDiagrams.renderer=n;let s=new Set;for(let a of this.renderer.tracks)for(let o of a.staves){const l=o.chords;if(l)for(const[,u]of l)s.has(u.uniqueId)||u.showDiagram&&(s.add(u.uniqueId),this.chordDiagrams.addChord(u))}}}get scale(){return this.renderer.settings.display.scale}createEmptyStaffSystem(){let e=new Xu(this);for(let t=0;t<this.renderer.tracks.length;t++){let r=this.renderer.tracks[t],n=!1;for(let s of r.staves)if(s.showStandardNotation){n=!0;break}for(let s=0;s<r.staves.length;s++){let a=r.staves[s],o;if(a.isPercussion)o=ur.Score;else if(this.renderer.settings.display.staveProfile!==ur.Default)o=this.renderer.settings.display.staveProfile;else if(a.showTablature&&a.showStandardNotation)o=ur.ScoreTab;else if(a.showTablature)o=n?ur.TabMixed:ur.Tab;else if(a.showStandardNotation)o=ur.Score;else continue;let l=W.staveProfiles.get(o);for(let u of l)u.canCreate(r,a)&&e.addStaff(r,new DU(t,a,u))}}return e}registerBarRenderer(e,t){this._barRendererLookup.has(e)||this._barRendererLookup.set(e,new Map),this._barRendererLookup.get(e).set(t.bar.id,t)}unregisterBarRenderer(e,t){this._barRendererLookup.has(e)&&this._barRendererLookup.get(e).delete(t.bar.id)}getRendererForBar(e,t){let r=t.id;return this._barRendererLookup.has(e)&&this._barRendererLookup.get(e).has(r)?this._barRendererLookup.get(e).get(r):null}layoutAndRenderAnnotation(e){let t="rendered by alphaTab",r=this.renderer.settings.display.resources,n=12*this.renderer.settings.display.scale,s=Math.floor(n);const a=new Oa,o=He.withFamilyList(r.copyrightFont.families,n,St.Plain,cr.Bold);this.renderer.canvas.font=o;const l=W.getLayoutEngineFactory(this.renderer.settings.display.layoutMode).vertical;return a.width=this.renderer.canvas.measureText(t).width,a.height=s,a.x=l?(this.width-a.width)/2:this.firstBarX,a.y=e,a.totalWidth=this.width,a.totalHeight=e+s,a.firstMasterBarIndex=-1,a.lastMasterBarIndex=-1,this.registerPartial(a,u=>{u.color=r.mainGlyphColor,u.font=o,u.textAlign=ue.Left,u.textBaseline=Se.Top,u.fillText(t,0,0)}),e+s}}var te;(function(i){i[i.TopWithStem=0]="TopWithStem",i[i.Top=1]="Top",i[i.Center=2]="Center",i[i.Bottom=3]="Bottom",i[i.BottomWithStem=4]="BottomWithStem"})(te||(te={}));var ft;(function(i){i[i.Left=0]="Left",i[i.Center=1]="Center",i[i.Right=2]="Right"})(ft||(ft={}));class xt{get nextRenderer(){return!this.bar||!this.bar.nextBar?null:this.scoreRenderer.layout.getRendererForBar(this.staff.staveId,this.bar.nextBar)}get previousRenderer(){return!this.bar||!this.bar.previousBar?null:this.scoreRenderer.layout.getRendererForBar(this.staff.staveId,this.bar.previousBar)}constructor(e,t){this._preBeatGlyphs=new Ol,this._voiceContainers=new Map,this._postBeatGlyphs=new Ol,this._ties=[],this.x=0,this.y=0,this.width=0,this.computedWidth=0,this.height=0,this.index=0,this.topOverflow=0,this.bottomOverflow=0,this.isLinkedToPrevious=!1,this.canWrap=!0,this._wasFirstOfLine=!1,this._appliedLayoutingInfo=0,this.isFinalized=!1,this.topPadding=0,this.bottomPadding=0,this.scoreRenderer=e,this.bar=t,t&&(this.helpers=new IU(this))}registerTies(e){this._ties.push(...e)}get middleYPosition(){return 0}registerOverflowTop(e){return e>this.topOverflow?(this.topOverflow=e,!0):!1}registerOverflowBottom(e){return e>this.bottomOverflow?(this.bottomOverflow=e,!0):!1}scaleToWidth(e){let t=e-this._preBeatGlyphs.width-this._postBeatGlyphs.width;for(const r of this._voiceContainers.values())r.scaleToWidth(t);this._postBeatGlyphs.x=this._preBeatGlyphs.x+this._preBeatGlyphs.width+t,this.width=e}get resources(){return this.settings.display.resources}get settings(){return this.scoreRenderer.settings}get scale(){return this.settings.display.scale}get barDisplayScale(){return this.staff.system.staves.length>1?this.bar.masterBar.displayScale:this.bar.displayScale}get barDisplayWidth(){return this.staff.system.staves.length>1?this.bar.masterBar.displayWidth:this.bar.displayWidth}get isFirstOfLine(){return this.index===0}get isLast(){return!this.bar||this.bar.index===this.scoreRenderer.layout.lastBarIndex}registerLayoutingInfo(){let e=this.layoutingInfo,t=this._preBeatGlyphs.width;e.preBeatSize<t&&(e.preBeatSize=t);for(const n of this._voiceContainers.values())n.registerLayoutingInfo(e),n.x+n.width;let r=this._postBeatGlyphs.width;e.postBeatSize<r&&(e.postBeatSize=r)}applyLayoutingInfo(){if(this._appliedLayoutingInfo>=this.layoutingInfo.version)return!1;this._appliedLayoutingInfo=this.layoutingInfo.version,this._preBeatGlyphs.width=this.layoutingInfo.preBeatSize;let e=this._preBeatGlyphs.x+this._preBeatGlyphs.width;for(const r of this._voiceContainers.values()){r.x=this._preBeatGlyphs.x+this._preBeatGlyphs.width,r.applyLayoutingInfo(this.layoutingInfo);let n=r.x+r.width;e<n&&(e=n)}this._postBeatGlyphs.x=Math.floor(e),this._postBeatGlyphs.width=this.layoutingInfo.postBeatSize,this.width=Math.ceil(this._postBeatGlyphs.x+this._postBeatGlyphs.width),this.computedWidth=this.width;const t=this.barDisplayWidth;return t>0&&this.scoreRenderer.layout.systemsLayoutMode==pr.FromModelWithWidths&&(this.width=t,this.computedWidth=t),!0}finalizeRenderer(){this.isFinalized=!0;let e=!1;const t=this.y-this.staff.topSpacing,r=this.y+this.height+this.staff.bottomSpacing;for(const n of this._ties)if(n.doLayout(),n.height>0){const s=n.y+n.height-r;s>0&&this.registerOverflowBottom(s)&&(e=!0);const a=n.y-t;a<0&&this.registerOverflowTop(a*-1)&&(e=!0)}return e}doLayout(){if(this.bar){this.helpers.initialize(),this._ties=[],this._preBeatGlyphs=new Ol,this._preBeatGlyphs.renderer=this,this._voiceContainers.clear(),this._postBeatGlyphs=new Ol,this._postBeatGlyphs.renderer=this;for(let e=0;e<this.bar.voices.length;e++){let t=this.bar.voices[e];if(this.hasVoiceContainer(t)){let r=new UB(0,0,t);r.renderer=this,this._voiceContainers.set(this.bar.voices[e].index,r)}}this.bar.simileMark===Fr.SecondOfDouble&&(this.canWrap=!1),this.createPreBeatGlyphs(),this.createBeatGlyphs(),this.createPostBeatGlyphs(),this.updateSizes();for(const e of this.helpers.beamHelpers)for(const t of e)t.finish();this.computedWidth=this.width}}hasVoiceContainer(e){return!e.isEmpty||e.index===0}updateSizes(){this.staff.registerStaffTop(this.topPadding),this.staff.registerStaffBottom(this.height-this.bottomPadding);let e=this._voiceContainers,t=this.beatGlyphsStart,r=t;for(const n of e.values()){n.x=t,n.doLayout();let s=n.x+n.width;r<s&&(r=s)}this._postBeatGlyphs.x=Math.floor(r),this.width=Math.ceil(this._postBeatGlyphs.x+this._postBeatGlyphs.width),this.height+=this.layoutingInfo.height*this.scale}addPreBeatGlyph(e){e.renderer=this,this._preBeatGlyphs.addGlyph(e)}addBeatGlyph(e){e.renderer=this,e.preNotes.renderer=this,e.onNotes.renderer=this,e.onNotes.beamingHelper=this.helpers.beamHelperLookup[e.beat.voice.index].get(e.beat.index),this.getVoiceContainer(e.beat.voice).addGlyph(e)}getVoiceContainer(e){return this._voiceContainers.has(e.index)?this._voiceContainers.get(e.index):void 0}getBeatContainer(e){var t,r;return(r=(t=this.getVoiceContainer(e.voice))==null?void 0:t.beatGlyphs)==null?void 0:r[e.index]}getPreNotesGlyphForBeat(e){var t;return(t=this.getBeatContainer(e))==null?void 0:t.preNotes}getOnNotesGlyphForBeat(e){var t;return(t=this.getBeatContainer(e))==null?void 0:t.onNotes}paint(e,t,r){this.paintBackground(e,t,r),r.color=this.resources.mainGlyphColor,this._preBeatGlyphs.paint(e+this.x,t+this.y,r);for(const n of this._voiceContainers.values())r.color=n.voice.index===0?this.resources.mainGlyphColor:this.resources.secondaryGlyphColor,n.paint(e+this.x,t+this.y,r);r.color=this.resources.mainGlyphColor,this._postBeatGlyphs.paint(e+this.x,t+this.y,r)}paintBackground(e,t,r){this.layoutingInfo.paint(e+this.x+this._preBeatGlyphs.x+this._preBeatGlyphs.width,t+this.y+this.height,r)}buildBoundingsLookup(e,t,r){let n=new EB;n.bar=this.bar,n.visualBounds=new ji,n.visualBounds.x=t+this.x,n.visualBounds.y=r+this.y+this.topPadding,n.visualBounds.w=this.width,n.visualBounds.h=this.height-this.topPadding-this.bottomPadding,n.realBounds=new ji,n.realBounds.x=t+this.x,n.realBounds.y=r+this.y,n.realBounds.w=this.width,n.realBounds.h=this.height,e.addBar(n);for(const[s,a]of this._voiceContainers){let o=this.bar.isEmpty&&s===0;if(!a.voice.isEmpty||o)for(let l=0,u=a.beatGlyphs.length;l<u;l++)a.beatGlyphs[l].buildBoundingsLookup(n,t+this.x+a.x,r+this.y+a.y,o)}}addPostBeatGlyph(e){this._postBeatGlyphs.addGlyph(e)}createPreBeatGlyphs(){this._wasFirstOfLine=this.isFirstOfLine}createBeatGlyphs(){for(const e of this.bar.voices)this.hasVoiceContainer(e)&&this.createVoiceGlyphs(e)}createVoiceGlyphs(e){}createPostBeatGlyphs(){}get beatGlyphsStart(){return this._preBeatGlyphs.x+this._preBeatGlyphs.width}get postBeatGlyphsStart(){return this._postBeatGlyphs.x}getBeatX(e,t=Oe.PreNotes){let r=this.getBeatContainer(e);if(r)switch(t){case Oe.PreNotes:return r.voiceContainer.x+r.x;case Oe.OnNotes:return r.voiceContainer.x+r.x+r.onNotes.x;case Oe.MiddleNotes:return r.voiceContainer.x+r.x+r.onTimeX;case Oe.Stem:const n=r.onNotes.beamingHelper?r.onNotes.beamingHelper.getBeatLineX(e):r.onNotes.x+r.onNotes.width/2;return r.voiceContainer.x+n;case Oe.PostNotes:return r.voiceContainer.x+r.x+r.onNotes.x+r.onNotes.width;case Oe.EndBeat:return r.voiceContainer.x+r.x+r.width}return 0}getNoteX(e,t){let r=this.getBeatContainer(e.beat);return r?r.voiceContainer.x+r.x+r.onNotes.x+r.onNotes.getNoteX(e,t):0}getNoteY(e,t){let r=this.getOnNotesGlyphForBeat(e.beat);return r?r.getNoteY(e,t):NaN}reLayout(){(this._wasFirstOfLine&&!this.isFirstOfLine||!this._wasFirstOfLine&&this.isFirstOfLine)&&(this._preBeatGlyphs=new Ol,this._preBeatGlyphs.renderer=this,this.createPreBeatGlyphs()),this.updateSizes(),this.registerLayoutingInfo()}paintSimileMark(e,t,r){switch(this.bar.simileMark){case Fr.Simple:r.fillMusicFontSymbol(e+this.x+(this.width-20*this.scale)/2,t+this.y+this.height/2,1,w.Repeat1Bar,!1);break;case Fr.SecondOfDouble:r.fillMusicFontSymbol(e+this.x-28*this.scale/2,t+this.y+this.height/2,1,w.Repeat2Bars,!1);break}}completeBeamingHelper(e){}getBeatDirection(e){return this.helpers.getBeamingHelperForBeat(e).direction}}xt.RawLineSpacing=8;xt.StemWidth=.12*xt.RawLineSpacing;xt.StaffLineThickness=.13*xt.RawLineSpacing;xt.BeamThickness=.5*xt.RawLineSpacing;xt.BeamSpacing=.25*xt.RawLineSpacing;var Ae;(function(i){i[i.SinglePreBeat=0]="SinglePreBeat",i[i.SingleOnBeat=1]="SingleOnBeat",i[i.SingleOnBeatToEnd=2]="SingleOnBeatToEnd",i[i.GroupedOnBeat=3]="GroupedOnBeat",i[i.GroupedOnBeatToEnd=4]="GroupedOnBeatToEnd",i[i.FullBar=5]="FullBar"})(Ae||(Ae={}));class zU extends Mt{constructor(e,t){super(0,0),this._uniqueEffectGlyphs=[],this._effectGlyphs=[],this.isEmpty=!0,this.previousBand=null,this.isLinkedToPrevious=!1,this.firstBeat=null,this.lastBeat=null,this.height=0,this.slot=null,this.voice=e,this.info=t}doLayout(){super.doLayout();for(let e=0;e<this.renderer.bar.voices.length;e++)this._effectGlyphs.push(new Map),this._uniqueEffectGlyphs.push([])}createGlyph(e){if(e.voice===this.voice&&this.info.shouldCreateGlyph(this.renderer.settings,e)&&(!this.info.hideOnMultiTrack||this.renderer.staff.trackIndex===0)){if(this.isEmpty=!1,(!this.firstBeat||e.isBefore(this.firstBeat))&&(this.firstBeat=e),!this.lastBeat||e.isAfter(this.lastBeat))switch(this.lastBeat=e,this.info.sizingMode){case Ae.SingleOnBeatToEnd:case Ae.GroupedOnBeatToEnd:this.lastBeat.nextBeat&&(this.lastBeat=this.lastBeat.nextBeat);break}let t=this.createOrResizeGlyph(this.info.sizingMode,e);t.height>this.height&&(this.height=t.height)}}createOrResizeGlyph(e,t){let r;switch(e){case Ae.FullBar:return r=this.info.createNewGlyph(this.renderer,t),r.renderer=this.renderer,r.beat=t,r.doLayout(),this._effectGlyphs[t.voice.index].set(t.index,r),this._uniqueEffectGlyphs[t.voice.index].push(r),r;case Ae.SinglePreBeat:case Ae.SingleOnBeat:case Ae.SingleOnBeatToEnd:return r=this.info.createNewGlyph(this.renderer,t),r.renderer=this.renderer,r.beat=t,r.doLayout(),this._effectGlyphs[t.voice.index].set(t.index,r),this._uniqueEffectGlyphs[t.voice.index].push(r),r;case Ae.GroupedOnBeat:case Ae.GroupedOnBeatToEnd:let n=e===Ae.GroupedOnBeat?Ae.SingleOnBeat:Ae.SingleOnBeatToEnd;if(t.index>0||this.renderer.index>0){let s=t.previousBeat;if(this.info.shouldCreateGlyph(this.renderer.settings,s)){let a=null;if(t.index>0&&this._effectGlyphs[t.voice.index].has(s.index))a=this._effectGlyphs[t.voice.index].get(s.index);else if(this.renderer.index>0){let u=this.renderer.previousRenderer.getBand(s.voice,this.info.effectId);if(u){let c=u._effectGlyphs[s.voice.index];c.has(s.index)&&(a=c.get(s.index))}}let o=this.createOrResizeGlyph(n,t);return a&&this.info.canExpand(s,t)&&(a.nextGlyph=o,o.previousGlyph=a,this.isLinkedToPrevious=!0),o}return this.createOrResizeGlyph(n,t)}return this.createOrResizeGlyph(n,t);default:return this.createOrResizeGlyph(Ae.SingleOnBeat,t)}}paint(e,t,r){super.paint(e,t,r);for(let n=0,s=this._uniqueEffectGlyphs.length;n<s;n++){let a=this._uniqueEffectGlyphs[n];for(let o=0,l=a.length;o<l;o++)a[o].paint(e+this.x,t+this.y,r)}}alignGlyphs(){for(let e=0;e<this._effectGlyphs.length;e++)for(const t of this._effectGlyphs[e].keys())this.alignGlyph(this.info.sizingMode,this.renderer.bar.voices[e].beats[t])}alignGlyph(e,t){let r=this._effectGlyphs[t.voice.index].get(t.index),n,s=this.renderer.getBeatContainer(t);switch(e){case Ae.SinglePreBeat:n=s.preNotes,r.x=this.renderer.beatGlyphsStart+n.x+s.x,r.width=n.width;break;case Ae.SingleOnBeat:case Ae.GroupedOnBeat:n=s.onNotes,r.x=this.renderer.beatGlyphsStart+n.x+s.x,r.width=n.width;break;case Ae.SingleOnBeatToEnd:case Ae.GroupedOnBeatToEnd:n=s.onNotes,r.x=this.renderer.beatGlyphsStart+n.x+s.x,s.beat.isLastOfVoice?r.width=this.renderer.width-r.x:r.width=s.width-s.preNotes.width-s.preNotes.x;break;case Ae.FullBar:r.width=this.renderer.width;break}}}class UU{constructor(){this.uniqueEffectId=null,this.y=0,this.height=0,this.firstBeat=null,this.lastBeat=null}}class WU{constructor(){this.bands=[],this.shared=new UU}update(e){e.info.canShareBand||(this.shared.uniqueEffectId=e.info.effectId),e.slot=this,this.bands.push(e),e.height>this.shared.height&&(this.shared.height=e.height),(!this.shared.firstBeat||e.firstBeat.isBefore(this.shared.firstBeat))&&(this.shared.firstBeat=e.firstBeat),(!this.shared.lastBeat||e.lastBeat.isAfter(this.shared.lastBeat))&&(this.shared.lastBeat=e.lastBeat)}canBeUsed(e){return(!this.shared.uniqueEffectId&&e.info.canShareBand||e.info.effectId===this.shared.uniqueEffectId)&&(!this.shared.firstBeat||this.shared.lastBeat.isBefore(e.firstBeat)||this.shared.lastBeat.isBefore(this.shared.firstBeat))}}class GU{constructor(){this.slots=[],this._effectSlot=new Map}getOrCreateSlot(e){if(this._effectSlot.has(e.info.effectId)){let r=this._effectSlot.get(e.info.effectId);if(r.canBeUsed(e))return r}for(let r of this.slots)if(r.canBeUsed(e))return r;let t=new WU;return this.slots.push(t),t}register(e){let t=this.getOrCreateSlot(e);t.update(e),this._effectSlot.set(e.info.effectId,t)}}class wc extends Mn{constructor(){super(0,0),this.computedWidth=0}doLayout(){let e=0;if(this.glyphs)for(let t=0,r=this.glyphs.length;t<r;t++){let n=this.glyphs[t];n.x=e,n.renderer=this.renderer,n.doLayout(),e+=n.width}this.width=e,this.computedWidth=e}noteLoop(e){for(let t=this.container.beat.notes.length-1;t>=0;t--)e(this.container.beat.notes[t])}}class Sc extends wc{constructor(){super(...arguments),this.centerX=0}updateBeamingHelper(){}buildBoundingsLookup(e,t,r){}getNoteX(e,t){return 0}getNoteY(e,t){return 0}}class $U extends xt{constructor(e,t,r){super(e,t),this._bands=[],this._bandLookup=new Map,this.sizingInfo=null,this._infos=r}updateSizes(){this.topOverflow=0,this.bottomOverflow=0,this.topPadding=0,this.bottomPadding=0,this.updateHeight(),super.updateSizes()}finalizeRenderer(){let e=super.finalizeRenderer();return this.updateHeight()&&(e=!0),e}updateHeight(){if(!this.sizingInfo)return!1;let e=0;for(let t of this.sizingInfo.slots){t.shared.y=e;for(let r of t.bands)r.y=e,r.height=t.shared.height;e+=t.shared.height}return e!==this.height?(this.height=e,!0):!1}applyLayoutingInfo(){if(!super.applyLayoutingInfo())return!1;if(this.index>0){let e=this.previousRenderer;this.sizingInfo=e.sizingInfo}else this.sizingInfo=new GU;for(let e of this._bands)e.alignGlyphs(),e.isEmpty||this.sizingInfo.register(e);return this.updateHeight(),!0}scaleToWidth(e){super.scaleToWidth(e);for(let t of this._bands)t.alignGlyphs()}createBeatGlyphs(){this._bands=[],this._bandLookup=new Map;for(let e of this.bar.voices)if(this.hasVoiceContainer(e))for(let t of this._infos){let r=new zU(e,t);r.renderer=this,r.doLayout(),this._bands.push(r),this._bandLookup.set(e.index+"."+t.effectId,r)}for(let e of this.bar.voices)this.hasVoiceContainer(e)&&this.createVoiceGlyphs(e);for(let e of this._bands)e.isLinkedToPrevious&&(this.isLinkedToPrevious=!0)}createVoiceGlyphs(e){for(let t of e.beats){let r=new tn(t,this.getVoiceContainer(e));r.preNotes=new wc,r.onNotes=new Sc,this.addBeatGlyph(r);for(let n of this._bands)n.createGlyph(t)}}paint(e,t,r){this.paintBackground(e,t,r);for(let n of this._bands)r.color=n.voice.index===0?this.resources.mainGlyphColor:this.resources.secondaryGlyphColor,n.isEmpty||n.paint(e+this.x,t+this.y,r)}getBand(e,t){let r=e.index+"."+t;return this._bandLookup.has(r)?this._bandLookup.get(r):null}}class Fn extends gp{get staffId(){return this._staffId}getStaffPaddingTop(e){return e.system.layout.renderer.settings.display.effectStaffPaddingTop}getStaffPaddingBottom(e){return e.system.layout.renderer.settings.display.effectStaffPaddingBottom}constructor(e,t){super(),this._infos=t,this._staffId=e,this.isInAccolade=!1,this.isRelevantForBoundsLookup=!1}create(e,t){return new $U(e,t,this._infos.filter(r=>e.settings.notation.isNotationElementVisible(r.notationElement)))}}class Ku extends In{constructor(e,t,r){super(e,t),this._endingsString="",this._endings=[];for(let n=0;n<Ts.MaxAlternateEndings;n++)r&1<<n&&this._endings.push(n)}doLayout(){super.doLayout(),this.height=this.renderer.resources.wordsFont.size+(Ku.Padding*this.scale+2);let e="";for(let t=0,r=this._endings.length;t<r;t++)e+=this._endings[t]+1,e+=". ";this._endingsString=e}paint(e,t,r){super.paint(e,t,r);let n=r.textBaseline;if(r.textBaseline=Se.Top,this._endings.length>0){let s=this.renderer.resources;r.font=s.wordsFont,r.moveTo(e+this.x,t+this.y+this.height),r.lineTo(e+this.x,t+this.y),r.lineTo(e+this.x+this.width,t+this.y),r.stroke(),r.fillText(this._endingsString,e+this.x+Ku.Padding*this.scale,t+this.y*this.scale)}r.textBaseline=n}}Ku.Padding=3;class li{get effectId(){return this.notationElement.toString()}}class Cg extends li{get notationElement(){return pe.EffectAlternateEndings}get hideOnMultiTrack(){return!0}get canShareBand(){return!1}get sizingMode(){return Ae.FullBar}shouldCreateGlyph(e,t){return t.voice.index===0&&t.index===0&&t.voice.bar.masterBar.alternateEndings!==0}createNewGlyph(e,t){return new Ku(0,0,t.voice.bar.masterBar.alternateEndings)}canExpand(e,t){return!0}}class LS extends li{get notationElement(){return pe.EffectCapo}get hideOnMultiTrack(){return!1}get canShareBand(){return!1}get sizingMode(){return Ae.SingleOnBeat}shouldCreateGlyph(e,t){return t.index===0&&t.voice.bar.index===0&&t.voice.bar.staff.capo!==0}createNewGlyph(e,t){return new _i(0,0,"Capo. fret "+t.voice.bar.staff.capo,e.resources.effectFont,ue.Left)}canExpand(e,t){return!1}}class Ng extends li{get notationElement(){return pe.EffectChordNames}get hideOnMultiTrack(){return!1}get canShareBand(){return!0}get sizingMode(){return Ae.SingleOnBeat}shouldCreateGlyph(e,t){return t.hasChord}createNewGlyph(e,t){return new _i(0,0,t.chord.name,e.resources.effectFont,ue.Center)}canExpand(e,t){return!1}}class xc extends In{constructor(e){super(),this.forceGroupedRendering=!1,this.endOnBarLine=!1,this.endPosition=e}get isLinkedWithPrevious(){return!!this.previousGlyph&&this.previousGlyph.renderer.staff.system===this.renderer.staff.system}get isLinkedWithNext(){return!!this.nextGlyph&&this.nextGlyph.renderer.isFinalized&&this.nextGlyph.renderer.staff.system===this.renderer.staff.system}paint(e,t,r){if(this.isLinkedWithPrevious)return;if(!this.isLinkedWithNext&&!this.forceGroupedRendering){this.paintNonGrouped(e,t,r);return}let n;if(!this.isLinkedWithNext&&this.forceGroupedRendering)n=this;else for(n=this.nextGlyph;n.isLinkedWithNext;)n=n.nextGlyph;let s=n.renderer,a=n.beat,o=this.endPosition,l=e-this.renderer.x,u=this.calculateEndX(s,a,l,o);this.paintGrouped(e,t,u,r)}calculateEndX(e,t,r,n){return t?r+e.x+e.getBeatX(t,n):r+e.x+this.x+this.width}paintNonGrouped(e,t,r){let n=e-this.renderer.x,s=this.calculateEndX(this.renderer,this.beat,n,this.endPosition);this.paintGrouped(e,t,s,r)}}class qu extends xc{constructor(e,t,r){super(Oe.EndBeat),this._crescendo=Zi.None,this._crescendo=r,this.x=e,this.y=t}doLayout(){super.doLayout(),this.height=17*this.scale}paintGrouped(e,t,r,n){let s=e+this.x,a=this.height*this.scale;n.beginPath(),this._crescendo===Zi.Crescendo?(r-=qu.Padding*this.scale,n.moveTo(r,t+this.y),n.lineTo(s,t+this.y+a/2),n.lineTo(r,t+this.y+a)):(r-=qu.Padding*this.scale,n.moveTo(s,t+this.y),n.lineTo(r,t+this.y+a/2),n.lineTo(s,t+this.y+a)),n.stroke()}}qu.Padding=ke.QuarterNoteHeadWidth/2|0;class DS extends li{get notationElement(){return pe.EffectCrescendo}get hideOnMultiTrack(){return!1}get canShareBand(){return!0}get sizingMode(){return Ae.GroupedOnBeatToEnd}shouldCreateGlyph(e,t){return t.crescendo!==Zi.None}createNewGlyph(e,t){return new qu(0,0,t.crescendo)}canExpand(e,t){return e.crescendo===t.crescendo}}class K1 extends _t{constructor(e,t,r){super(e,t,.6,K1.getSymbol(r))}doLayout(){super.doLayout(),this.height=17*this.scale,this.y+=this.height/2}static getSymbol(e){switch(e){case _e.PPP:return w.DynamicPPP;case _e.PP:return w.DynamicPP;case _e.P:return w.DynamicPiano;case _e.MP:return w.DynamicMP;case _e.MF:return w.DynamicMF;case _e.F:return w.DynamicForte;case _e.FF:return w.DynamicFF;case _e.FFF:return w.DynamicFFF;default:return w.None}}}class FS extends li{get notationElement(){return pe.EffectDynamics}get hideOnMultiTrack(){return!1}get canShareBand(){return!1}get sizingMode(){return Ae.SingleOnBeat}shouldCreateGlyph(e,t){return this.internalShouldCreateGlyph(t)}internalShouldCreateGlyph(e){if(e.voice.bar.staff.track.score.stylesheet.hideDynamics||e.isEmpty||e.voice.isEmpty||e.isRest||e.graceType!==ce.None)return!1;let t=this.getPreviousDynamicsBeat(e),r=e.voice.index===0&&!t||e.dynamics!==(t==null?void 0:t.dynamics);if(r&&e.voice.index>0){for(let n of e.voice.bar.voices)if(n.index<e.voice.index){let s=n.getBeatAtPlaybackStart(e.playbackStart);s&&e.dynamics===s.dynamics&&this.internalShouldCreateGlyph(s)&&(r=!1)}}return r}getPreviousDynamicsBeat(e){let t=e.previousBeat;for(;t!=null;){if(!t.isRest&&t.graceType===ce.None)return t;t=t.previousBeat}return null}createNewGlyph(e,t){return new K1(0,0,t.dynamics)}canExpand(e,t){return!0}}class jU extends In{doLayout(){super.doLayout(),this.height=17*this.scale}paint(e,t,r){let n=6*this.scale,s=Math.max(this.width,14*this.scale),a=this.height/2;r.beginPath(),r.moveTo(e+this.x,t+this.y+a),r.quadraticCurveTo(e+this.x+s/2,t+this.y+a,e+this.x+s,t+this.y+a-n),r.moveTo(e+this.x,t+this.y+a),r.quadraticCurveTo(e+this.x+s/2,t+this.y+a,e+this.x+s,t+this.y+a+n),r.stroke()}}class Bg extends li{get notationElement(){return pe.EffectFadeIn}get hideOnMultiTrack(){return!1}get canShareBand(){return!0}get sizingMode(){return Ae.SingleOnBeat}shouldCreateGlyph(e,t){return t.fadeIn}createNewGlyph(e,t){return new jU}canExpand(e,t){return!0}}class q1 extends _t{constructor(e,t,r){super(e,t,1,q1.getSymbol(r))}static getSymbol(e){switch(e){case Bn.Short:return w.FermataShortAbove;case Bn.Medium:return w.FermataAbove;case Bn.Long:return w.FermataLongAbove;default:return w.None}}doLayout(){this.width=23*this.scale,this.height=12*this.scale}paint(e,t,r){super.paint(e-this.width/2,t+this.height,r)}}class _g extends li{get notationElement(){return pe.EffectFermata}get hideOnMultiTrack(){return!1}get canShareBand(){return!1}get sizingMode(){return Ae.SingleOnBeat}shouldCreateGlyph(e,t){return t.voice.index===0&&!!t.fermata}createNewGlyph(e,t){return new q1(0,0,t.fermata.type)}canExpand(e,t){return!0}}class AS extends li{get notationElement(){return pe.EffectFingering}get hideOnMultiTrack(){return!1}get canShareBand(){return!0}get sizingMode(){return Ae.SingleOnBeat}shouldCreateGlyph(e,t){return t.voice.index!==0||t.isRest||e.notation.fingeringMode!==En.SingleNoteEffectBand&&e.notation.fingeringMode!==En.SingleNoteEffectBandForcePiano||t.notes.length!==1?!1:t.notes[0].isFingering}createNewGlyph(e,t){let r=be.Unknown,n=!1,s=t.notes[0];s.leftHandFinger!==be.Unknown?(r=s.leftHandFinger,n=!0):s.rightHandFinger!==be.Unknown&&(r=s.rightHandFinger);let a=ct.fingerToString(e.settings,t,r,n)??"";return new _i(0,0,a,e.resources.fingeringFont,ue.Left)}canExpand(e,t){return!0}}class so extends li{constructor(){super(...arguments),this.lastCreateInfo=null}shouldCreateGlyph(e,t){this.lastCreateInfo=[];for(let r=0,n=t.notes.length;r<n;r++){let s=t.notes[r];this.shouldCreateGlyphForNote(s)&&this.lastCreateInfo.push(s)}return this.lastCreateInfo.length>0}get hideOnMultiTrack(){return!1}get canShareBand(){return!0}canExpand(e,t){return!0}}class Es extends xc{constructor(e){super(Oe.OnNotes),this._label=e}doLayout(){this.renderer.settings.notation.extendLineEffectsToBeatEnd&&(this.endPosition=Oe.EndBeat,this.forceGroupedRendering=!0),super.doLayout(),this.height=this.renderer.resources.effectFont.size}paintNonGrouped(e,t,r){let n=this.renderer.resources;r.font=n.effectFont;let s=r.textAlign;r.textAlign=ue.Center,r.fillText(this._label,e+this.x,t+this.y),r.textAlign=s}paintGrouped(e,t,r,n){this.paintNonGrouped(e,t,n);let s=3*this.scale,a=n.measureText(this._label).width,o=e+this.x+a/2+s,l=t+this.y+4*this.scale,u=8*this.scale;if(r>o){let c=o;for(;c<r;)n.beginPath(),n.moveTo(c,l|0),n.lineTo(Math.min(c+u,r),l|0),c+=u+s,n.stroke();n.beginPath(),n.moveTo(r,l-5*this.scale|0),n.lineTo(r,l+5*this.scale|0),n.stroke()}}}Es.LineSpacing=3;Es.LineTopPadding=4;Es.LineTopOffset=5;Es.LineSize=8;class Nr extends so{get effectId(){return this._effectId}get notationElement(){return pe.EffectHarmonics}constructor(e){switch(super(),this._beat=null,this._harmonicType=e,e){case ne.None:this._effectId="harmonics-none";break;case ne.Natural:this._effectId="harmonics-natural";break;case ne.Artificial:this._effectId="harmonics-artificial";break;case ne.Pinch:this._effectId="harmonics-pinch";break;case ne.Tap:this._effectId="harmonics-tap";break;case ne.Semi:this._effectId="harmonics-semi";break;case ne.Feedback:this._effectId="harmonics-feedback";break;default:this._effectId="";break}}shouldCreateGlyphForNote(e){return!e.isHarmonic||e.harmonicType!==this._harmonicType?!1:(e.beat!==this._beat&&(this._beat=e.beat),!0)}get sizingMode(){return Ae.GroupedOnBeat}createNewGlyph(e,t){return new Es(Nr.harmonicToString(this._harmonicType))}static harmonicToString(e){switch(e){case ne.Natural:return"N.H.";case ne.Artificial:return"A.H.";case ne.Pinch:return"P.H.";case ne.Tap:return"T.H.";case ne.Semi:return"S.H.";case ne.Feedback:return"Fdbk."}return""}}class Pg extends li{get notationElement(){return pe.EffectLetRing}get canShareBand(){return!1}get hideOnMultiTrack(){return!1}shouldCreateGlyph(e,t){return t.isLetRing}get sizingMode(){return Ae.GroupedOnBeat}createNewGlyph(e,t){return new Es("LetRing")}canExpand(e,t){return!0}}class YU extends In{constructor(e,t,r,n,s=ue.Center){super(e,t),this._lines=r,this.font=n,this.textAlign=s}doLayout(){super.doLayout(),this.height=this.font.size*this._lines.length}paint(e,t,r){r.font=this.font;let n=r.textAlign;r.textAlign=this.textAlign;for(let s=0;s<this._lines.length;s++)this._lines[s]&&r.fillText(this._lines[s],e+this.x,t+this.y+s*this.font.size);r.textAlign=n}}class nh extends li{get notationElement(){return pe.EffectLyrics}get hideOnMultiTrack(){return!1}get canShareBand(){return!1}get sizingMode(){return Ae.SingleOnBeat}shouldCreateGlyph(e,t){return!!t.lyrics}createNewGlyph(e,t){return new YU(0,0,t.lyrics,e.resources.effectFont,ue.Center)}canExpand(e,t){return!0}}class Rg extends li{get notationElement(){return pe.EffectMarker}get hideOnMultiTrack(){return!0}get canShareBand(){return!0}get sizingMode(){return Ae.SinglePreBeat}shouldCreateGlyph(e,t){return t.voice.bar.staff.index===0&&t.voice.index===0&&t.index===0&&t.voice.bar.masterBar.isSectionStart}createNewGlyph(e,t){return new _i(0,0,t.voice.bar.masterBar.section.marker?"["+t.voice.bar.masterBar.section.marker+"] "+t.voice.bar.masterBar.section.text:t.voice.bar.masterBar.section.text,e.resources.markerFont,ue.Left)}canExpand(e,t){return!0}}class XU extends xc{constructor(e,t){super(Oe.PostNotes),this._ottava=e,this._aboveStaff=t}doLayout(){super.doLayout(),this.height=13*this.scale}paintNonGrouped(e,t,r){this.paintOttava(e,t,r)}paintOttava(e,t,r){let n=0;switch(this._ottava){case $e._15ma:n=37*this.scale,r.fillMusicFontSymbol(e+this.x-n/2,t+this.y+this.height,.8,w.QuindicesimaAlta,!1);break;case $e._8va:n=26*this.scale,r.fillMusicFontSymbol(e+this.x-n/2,t+this.y+this.height,.8,w.OttavaAlta,!1);break;case $e._8vb:n=23*this.scale,r.fillMusicFontSymbol(e+this.x-n/2,t+this.y+this.height,.8,w.OttavaBassaVb,!1);break;case $e._15mb:n=36*this.scale,r.fillMusicFontSymbols(e+this.x-n/2,t+this.y+this.height,.8,[w.Quindicesima,w.OctaveBaselineM,w.OctaveBaselineB],!1);break}return n/2}paintGrouped(e,t,r,n){let s=this.paintOttava(e,t,n),a=3*this.scale,o=e+this.x+s+a,l=t+this.y;l+=this._aboveStaff?2*this.scale:this.height-2*this.scale;let u=8*this.scale;if(r>o){let c=o;for(;c<r;)n.beginPath(),n.moveTo(c,l|0),n.lineTo(Math.min(c+u,r),l|0),c+=u+a,n.stroke();n.beginPath(),this._aboveStaff?(n.moveTo(r,l),n.lineTo(r,t+this.y+this.height)):(n.moveTo(r,l),n.lineTo(r,t+this.y)),n.stroke()}}}class sh extends li{get effectId(){return"ottavia-"+(this._aboveStaff?"above":"below")}get notationElement(){return pe.EffectOttavia}get hideOnMultiTrack(){return!1}get canShareBand(){return!0}get sizingMode(){return Ae.GroupedOnBeat}constructor(e){super(),this._aboveStaff=e}shouldCreateGlyph(e,t){switch(t.ottava){case $e._15ma:return this._aboveStaff;case $e._8va:return this._aboveStaff;case $e._8vb:return!this._aboveStaff;case $e._15mb:return!this._aboveStaff}return!1}createNewGlyph(e,t){return new XU(t.ottava,this._aboveStaff)}canExpand(e,t){return e.ottava===t.ottava}}class Eg extends so{get notationElement(){return pe.EffectPalmMute}shouldCreateGlyphForNote(e){return e.isPalmMute}get sizingMode(){return Ae.GroupedOnBeat}createNewGlyph(e,t){return new Es("P.M.")}constructor(){super()}}class Mg extends so{get notationElement(){return pe.EffectPickSlide}shouldCreateGlyphForNote(e){return e.slideOutType===xe.PickSlideDown||e.slideOutType===xe.PickSlideUp}get sizingMode(){return Ae.GroupedOnBeat}createNewGlyph(e,t){return new Es("P.S.")}constructor(){super()}}class Ju extends _t{constructor(e,t,r){super(e,t,ke.GraceScale,Ju.getSymbol(r))}doLayout(){this.width=9*this.scale,this.height=13*this.scale}paint(e,t,r){super.paint(e,t+this.height,r)}static getSymbol(e){switch(e){case gi.Up:return w.StringsUpBow;case gi.Down:return w.StringsDownBow;default:return w.None}}}class Og extends li{get notationElement(){return pe.EffectPickStroke}get hideOnMultiTrack(){return!1}get canShareBand(){return!0}get sizingMode(){return Ae.SingleOnBeat}shouldCreateGlyph(e,t){return t.pickStroke!==gi.None}createNewGlyph(e,t){return new Ju(0,0,t.pickStroke)}canExpand(e,t){return!0}}class GB extends xc{constructor(e){super(Oe.EndBeat),this._stepSize=0,this._type=e}doLayout(){switch(super.doLayout(),this._type){case Ue.Slight:this._stepSize=12*this.scale;break;case Ue.Wide:this._stepSize=23*this.scale;break}this.height=18*this.scale}paintGrouped(e,t,r,n){let s=e+this.x,a=r-s,o=Math.max(1,a/this._stepSize);n.beginPath(),n.moveTo(s,t+this.y);for(let l=0;l<o;l++)n.lineTo(s+this._stepSize/2,t+this.y+this.height),n.lineTo(s+this._stepSize,t+this.y),s+=this._stepSize;n.stroke()}}class ah extends li{get notationElement(){return pe.EffectSlightBeatVibrato}get hideOnMultiTrack(){return!1}get canShareBand(){return!0}get sizingMode(){return Ae.GroupedOnBeatToEnd}shouldCreateGlyph(e,t){return t.vibrato===Ue.Slight}createNewGlyph(e,t){return new GB(Ue.Slight)}canExpand(e,t){return!0}}class Ja extends xc{constructor(e,t,r,n=1.2,s=!1){super(Oe.EndBeat),this._scale=0,this._symbol=w.None,this._symbolSize=0,this._type=r,this._scale=n,this.x=e,this.y=t,this._partialWaves=s}doLayout(){super.doLayout();let e=0;switch(this._type){case Ue.Slight:this._symbol=w.WiggleTrill,this._symbolSize=9*this._scale,e=6*this._scale;break;case Ue.Wide:this._symbol=w.WiggleVibratoMediumFast,this._symbolSize=10*this._scale,e=10*this._scale;break}this.height=e*this.scale}paintGrouped(e,t,r,n){let s=e+this.x,a=r-s,o=this._symbolSize*this.scale,l=a/o;this._partialWaves||(l=Math.floor(l)),l<1&&(l=1);let u=0;for(let c=0;c<l;c++)n.fillMusicFontSymbol(e+this.x+u,t+this.y+this.height*2,this._scale*this.scale,this._symbol,!1),u+=o}}class oh extends so{get notationElement(){return pe.EffectSlightNoteVibrato}shouldCreateGlyphForNote(e){return e.vibrato===Ue.Slight||e.isTieDestination&&e.tieOrigin.vibrato===Ue.Slight}get sizingMode(){return Ae.GroupedOnBeatToEnd}createNewGlyph(e,t){return new Ja(0,0,Ue.Slight,1.2)}constructor(){super()}}class VS extends li{get notationElement(){return pe.EffectTap}get hideOnMultiTrack(){return!1}get canShareBand(){return!0}get sizingMode(){return Ae.SingleOnBeat}shouldCreateGlyph(e,t){return t.slap||t.pop||t.tap}createNewGlyph(e,t){let r=e.resources;return t.slap?new _i(0,0,"S",r.effectFont,ue.Left):t.pop?new _i(0,0,"P",r.effectFont,ue.Left):new _i(0,0,"T",r.effectFont,ue.Left)}canExpand(e,t){return!0}}class KU extends In{constructor(e){super(0,0),this.tempoAutomations=e}doLayout(){super.doLayout(),this.height=25*this.scale}paint(e,t,r){const n=e+this.x,s=e+this.renderer.postBeatGlyphsStart;for(const a of this.tempoAutomations){const o=e+this.x+(s-n)*a.ratioPosition,l=this.renderer.resources;r.font=l.markerFont,r.fillMusicFontSymbol(o,t+this.y+this.height*.8,this.scale*ke.GraceScale,w.NoteQuarterUp,!1),r.textBaseline=Se.Top,r.fillText("= "+a.value.toString(),o+this.height/2,t+this.y+r.font.size/2)}}}class Ig extends li{get notationElement(){return pe.EffectTempo}get hideOnMultiTrack(){return!0}get canShareBand(){return!1}get sizingMode(){return Ae.SinglePreBeat}shouldCreateGlyph(e,t){return t.voice.bar.staff.index===0&&t.voice.index===0&&t.index===0&&t.voice.bar.masterBar.tempoAutomations.length>0}createNewGlyph(e,t){return new KU(t.voice.bar.masterBar.tempoAutomations)}canExpand(e,t){return!0}}class Lg extends li{get notationElement(){return pe.EffectText}get hideOnMultiTrack(){return!1}get canShareBand(){return!1}get sizingMode(){return Ae.SingleOnBeat}shouldCreateGlyph(e,t){return!!t.text}createNewGlyph(e,t){return new _i(0,0,t.text,e.resources.effectFont,ue.Left)}canExpand(e,t){return!0}}class qU extends In{constructor(e,t){super(e,t)}doLayout(){super.doLayout(),this.height=this.renderer.resources.markerFont.size*this.scale}paint(e,t,r){let n=this.renderer.resources;r.font=n.markerFont;let s=r.measureText("tr").width;r.fillText("tr",e+this.x,t+this.y);let a=s+3*this.scale,o=this.width-a,l=1.2,u=11*this.scale*l,c=Math.max(1,(o-a)/u),h=a,d=t+this.y+this.height*1.2;for(let f=0;f<c;f++)r.fillMusicFontSymbol(e+this.x+h,d,l,w.WiggleTrill,!1),h+=u}}class lh extends so{get notationElement(){return pe.EffectTrill}shouldCreateGlyphForNote(e){return e.isTrill}get sizingMode(){return Ae.SingleOnBeat}createNewGlyph(e,t){return new qU(0,0)}}var bt;(function(i){i[i.Full=0]="Full",i[i.PartialLeft=1]="PartialLeft",i[i.PartialRight=2]="PartialRight"})(bt||(bt={}));class Ke extends In{constructor(e){super(0,0),this._tripletFeel=e}doLayout(){super.doLayout(),this.height=25*this.scale}paint(e,t,r){e+=this.x,t+=this.y;let n=t+this.height*ke.GraceScale;r.font=this.renderer.resources.effectFont,r.fillText("(",e,t+this.height*.3);let s=e+10*this.scale,a=e+40*this.scale;switch(this._tripletFeel){case Be.NoTripletFeel:this.renderBarNote(s,n,Ke.NoteScale,r,[bt.Full]),this.renderBarNote(a,n,Ke.NoteScale,r,[bt.Full]);break;case Be.Triplet8th:this.renderBarNote(s,n,Ke.NoteScale,r,[bt.Full]),r.fillMusicFontSymbol(a,n,Ke.NoteScale,w.NoteQuarterUp,!1),r.fillMusicFontSymbol(a+Ke.NoteSeparation*this.scale,n,Ke.NoteScale,w.NoteEighthUp,!1),this.renderTriplet(a,t,r);break;case Be.Triplet16th:this.renderBarNote(s,n,Ke.NoteScale,r,[bt.Full,bt.Full]),this.renderBarNote(a,n,Ke.NoteScale,r,[bt.Full,bt.PartialRight]),this.renderTriplet(a,t,r);break;case Be.Dotted8th:this.renderBarNote(s,n,Ke.NoteScale,r,[bt.Full]),this.renderBarNote(a,n,Ke.NoteScale,r,[bt.Full,bt.PartialRight]),r.fillCircle(a+9*this.scale,n,this.scale);break;case Be.Dotted16th:this.renderBarNote(s,n,Ke.NoteScale,r,[bt.Full,bt.Full]),this.renderBarNote(a,n,Ke.NoteScale,r,[bt.Full,bt.Full,bt.PartialRight]),r.fillCircle(a+9*this.scale,n,this.scale);break;case Be.Scottish8th:this.renderBarNote(s,n,Ke.NoteScale,r,[bt.Full]),this.renderBarNote(a,n,Ke.NoteScale,r,[bt.Full,bt.PartialLeft]),r.fillCircle(a+Ke.NoteSeparation*this.scale+8*this.scale,n,this.scale);break;case Be.Scottish16th:this.renderBarNote(s,n,Ke.NoteScale,r,[bt.Full,bt.Full]),this.renderBarNote(a,n,Ke.NoteScale,r,[bt.Full,bt.Full,bt.PartialLeft]),r.fillCircle(a+Ke.NoteSeparation*this.scale+8*this.scale,n,this.scale);break}r.fillText("=",e+30*this.scale,t+5*this.scale),r.fillText(")",e+65*this.scale,t+this.height*.3)}renderBarNote(e,t,r,n,s){n.fillMusicFontSymbol(e,t,r,w.NoteQuarterUp,!1);let a=Ke.NoteSeparation/2*this.scale;for(let o=0;o<s.length;o++)switch(s[o]){case bt.Full:n.fillRect(e+4*this.scale,t-Ke.NoteHeight*this.scale+Ke.BarSeparation*this.scale*o,Ke.NoteSeparation*this.scale,Ke.BarHeight*this.scale);break;case bt.PartialLeft:n.fillRect(e+4*this.scale,t-Ke.NoteHeight*this.scale+Ke.BarSeparation*this.scale*o,a,Ke.BarHeight*this.scale);break;case bt.PartialRight:n.fillRect(e+4*this.scale+a,t-Ke.NoteHeight*this.scale+Ke.BarSeparation*this.scale*o,a,Ke.BarHeight*this.scale);break}n.fillMusicFontSymbol(e+Ke.NoteSeparation*this.scale,t,r,w.NoteQuarterUp,!1)}renderTriplet(e,t,r){t+=2*this.scale;let n=this.renderer.resources.effectFont;r.font=He.withFamilyList(n.families,n.size*.8,n.style);let s=e+Ke.NoteSeparation*this.scale+3*this.scale;r.beginPath(),r.moveTo(e,t+3*this.scale),r.lineTo(e,t),r.lineTo(e+5*this.scale,t),r.moveTo(s+5*this.scale,t+3*this.scale),r.lineTo(s+5*this.scale,t),r.lineTo(s,t),r.stroke(),r.fillText("3",e+7*this.scale,t-10*this.scale),r.font=n}}Ke.NoteScale=.4;Ke.NoteHeight=12;Ke.NoteSeparation=12;Ke.BarHeight=2;Ke.BarSeparation=3;class Dg extends li{get notationElement(){return pe.EffectTripletFeel}get hideOnMultiTrack(){return!0}get canShareBand(){return!1}get sizingMode(){return Ae.SinglePreBeat}shouldCreateGlyph(e,t){return t.index===0&&(t.voice.bar.masterBar.index===0&&t.voice.bar.masterBar.tripletFeel!==Be.NoTripletFeel||t.voice.bar.masterBar.index>0&&t.voice.bar.masterBar.tripletFeel!==t.voice.bar.masterBar.previousMasterBar.tripletFeel)}createNewGlyph(e,t){return new Ke(t.voice.bar.masterBar.tripletFeel)}canExpand(e,t){return!0}}class HS extends li{get notationElement(){return pe.EffectWhammyBar}get hideOnMultiTrack(){return!1}get canShareBand(){return!1}get sizingMode(){return Ae.GroupedOnBeat}shouldCreateGlyph(e,t){return t.hasWhammyBar}createNewGlyph(e,t){return new Es("w/bar")}canExpand(e,t){return!0}}class uh extends li{get notationElement(){return pe.EffectWideBeatVibrato}get hideOnMultiTrack(){return!1}get canShareBand(){return!0}get sizingMode(){return Ae.GroupedOnBeatToEnd}shouldCreateGlyph(e,t){return t.vibrato===Ue.Wide}createNewGlyph(e,t){return new GB(Ue.Wide)}canExpand(e,t){return!0}}class ch extends so{get notationElement(){return pe.EffectWideNoteVibrato}shouldCreateGlyphForNote(e){return e.vibrato===Ue.Wide||e.isTieDestination&&e.tieOrigin.vibrato===Ue.Wide}get sizingMode(){return Ae.GroupedOnBeatToEnd}createNewGlyph(e,t){return new Ja(0,0,Ue.Wide,1.2)}}class zS{constructor(){this.x=0,this.width=0,this.masterBars=[]}}class JU extends WB{get name(){return"HorizontalScreen"}constructor(e){super(e),this._system=null,this._pagePadding=null}get supportsResize(){return!1}get firstBarX(){let e=this._pagePadding[0];return this._system&&(e+=this._system.accoladeWidth),e}doResize(){}doLayoutAndRender(){switch(this._pagePadding=this.renderer.settings.display.padding,this.renderer.settings.display.systemsLayoutMode){case fa.Automatic:this.systemsLayoutMode=pr.Automatic;break;case fa.UseModelLayout:this.systemsLayoutMode=pr.FromModelWithWidths;break}this._pagePadding||(this._pagePadding=[0,0,0,0]),this._pagePadding.length===1?this._pagePadding=[this._pagePadding[0],this._pagePadding[0],this._pagePadding[0],this._pagePadding[0]]:this._pagePadding.length===2&&(this._pagePadding=[this._pagePadding[0],this._pagePadding[1],this._pagePadding[0],this._pagePadding[1]]);let e=this.renderer.score,t=this.renderer.settings.display.startBar;t--,t=Math.min(e.masterBars.length-1,Math.max(0,t));let r=t,n=this.renderer.settings.display.barCount;n<=0&&(n=e.masterBars.length),n=t+n-1,n=Math.min(e.masterBars.length-1,Math.max(0,n)),this._system=this.createEmptyStaffSystem(),this._system.isLast=!0,this._system.x=this._pagePadding[0],this._system.y=this._pagePadding[1];let s=this.renderer.settings.display.barCountPerPartial,a=[],o=new zS,l=0;for(;r<=n;){let c=this._system.addBars(this.renderer.tracks,r);if(c)if(o.masterBars.length===0&&c.isLinkedToPrevious&&a.length>0){let h=a[a.length-1];h.masterBars.push(e.masterBars[r]),h.width+=c.width,l+=c.width,o.x+=l}else o.masterBars.push(e.masterBars[r]),o.width+=c.width,o.masterBars.length>=s&&(a.length===0&&(o.width+=this._system.accoladeWidth+this._pagePadding[0]),l+=o.width,a.push(o),V.debug(this.name,"Finished partial from bar "+o.masterBars[0].index+" to "+o.masterBars[o.masterBars.length-1].index,null),o=new zS,o.x=l);r++}o.masterBars.length>0&&(a.length===0&&(o.width+=this._system.accoladeWidth+this._pagePadding[0]),a.push(o),V.debug(this.name,"Finished partial from bar "+o.masterBars[0].index+" to "+o.masterBars[o.masterBars.length-1].index,null)),this.finalizeStaffSystem(),this.height=Math.floor(this._system.y+this._system.height),this.width=this._system.x+this._system.width+this._pagePadding[2],r=0;let u=0;for(let c=0;c<a.length;c++){const h=a[c],d=new Oa;d.x=u,d.y=0,d.totalWidth=this.width,d.totalHeight=this.height,d.width=h.width,d.height=this.height,d.firstMasterBarIndex=h.masterBars[0].index,d.lastMasterBarIndex=h.masterBars[h.masterBars.length-1].index,u+=h.width;const f=r,p=c;this._system.buildBoundingsLookup(0,0),this.registerPartial(d,g=>{let y=this._system.getBarX(h.masterBars[0].index)+this._system.accoladeWidth;p===0&&(y-=this._system.x+this._system.accoladeWidth),g.color=this.renderer.settings.display.resources.mainGlyphColor,g.textAlign=ue.Left,V.debug(this.name,"Rendering partial from bar "+h.masterBars[0].index+" to "+h.masterBars[h.masterBars.length-1].index,null),this._system.paintPartial(-y,this._system.y,g,f,h.masterBars.length)}),r+=h.masterBars.length}this.height=this.layoutAndRenderAnnotation(this.height)+this._pagePadding[3]}finalizeStaffSystem(){this._system.scaleToWidth(this._system.width),this._system.finalizeSystem()}}class QU extends WB{get name(){return"PageView"}constructor(e){super(e),this._systems=[],this._allMasterBarRenderers=[],this._barsFromPreviousSystem=[],this._pagePadding=null}doLayoutAndRender(){switch(this.renderer.settings.display.systemsLayoutMode){case fa.Automatic:this.systemsLayoutMode=pr.Automatic;break;case fa.UseModelLayout:this.systemsLayoutMode=pr.FromModelWithScale;break}this._pagePadding=this.renderer.settings.display.padding,this._pagePadding||(this._pagePadding=[0,0,0,0]),this._pagePadding.length===1?this._pagePadding=[this._pagePadding[0],this._pagePadding[0],this._pagePadding[0],this._pagePadding[0]]:this._pagePadding.length===2&&(this._pagePadding=[this._pagePadding[0],this._pagePadding[1],this._pagePadding[0],this._pagePadding[1]]);let e=this._pagePadding[1];this.width=this.renderer.width,this._allMasterBarRenderers=[],e=this.layoutAndRenderScoreInfo(e,-1),e=this.layoutAndRenderTunings(e,-1),e=this.layoutAndRenderChordDiagrams(e,-1),e=this.layoutAndRenderScore(e),e=this.layoutAndRenderAnnotation(e),this.height=e+this._pagePadding[3]}get supportsResize(){return!0}get firstBarX(){let e=this._pagePadding[0];return this._systems.length>0&&(e+=this._systems[0].accoladeWidth),e}doResize(){let e=this._pagePadding[1];this.width=this.renderer.width;let t=this.height;e=this.layoutAndRenderScoreInfo(e,t),e=this.layoutAndRenderTunings(e,t),e=this.layoutAndRenderChordDiagrams(e,t),e=this.resizeAndRenderScore(e,t),e=this.layoutAndRenderAnnotation(e),this.height=e+this._pagePadding[3]}layoutAndRenderTunings(e,t=-1){if(!this.tuningGlyph)return e;let r=this.renderer.settings.display.resources;this.tuningGlyph.x=this._pagePadding[0],this.tuningGlyph.width=this.width,this.tuningGlyph.doLayout();let n=this.tuningGlyph.height;const s=new Oa;return s.x=0,s.y=e,s.width=this.width,s.height=n,s.totalWidth=this.width,s.totalHeight=t<0?e+s.height:t,this.registerPartial(s,a=>{a.color=r.scoreInfoColor,a.textAlign=ue.Center,this.tuningGlyph.paint(0,0,a)}),e+n}layoutAndRenderChordDiagrams(e,t=-1){if(!this.chordDiagrams)return e;const r=this.renderer.settings.display.resources;this.chordDiagrams.width=this.width,this.chordDiagrams.doLayout();const n=Math.floor(this.chordDiagrams.height),s=new Oa;return s.x=0,s.y=e,s.width=this.width,s.height=n,s.totalWidth=this.width,s.totalHeight=t<0?e+n:t,this.registerPartial(s,a=>{a.color=r.scoreInfoColor,a.textAlign=ue.Center,this.chordDiagrams.paint(0,0,a)}),e+n}layoutAndRenderScoreInfo(e,t=-1){V.debug(this.name,"Layouting score info");const r=new Oa;r.x=0,r.y=e;let n=0,s=this.scale,a=this.renderer.settings.display.resources,o=[pe.ScoreTitle,pe.ScoreSubTitle,pe.ScoreArtist,pe.ScoreAlbum,pe.ScoreWordsAndMusic];for(let c=0;c<o.length;c++)if(this.scoreInfoGlyphs.has(o[c])){let h=this.scoreInfoGlyphs.get(o[c]);h.x=this.width/2,h.y=n,h.textAlign=ue.Center,n+=h.font.size*s}let l=!1,u=0;if(this.scoreInfoGlyphs.has(pe.ScoreMusic)){let c=this.scoreInfoGlyphs.get(pe.ScoreMusic);c.x=this.width-this._pagePadding[2],c.y=n,c.textAlign=ue.Right,l=!0,u=c.font.size*s}if(this.scoreInfoGlyphs.has(pe.ScoreWords)){let c=this.scoreInfoGlyphs.get(pe.ScoreWords);c.x=this._pagePadding[0],c.y=n,c.textAlign=ue.Left,l=!0,u=c.font.size*s}return l&&(n+=u),this.scoreInfoGlyphs.size>0&&(n=Math.floor(n+17*this.scale),r.width=this.width,r.height=n,r.totalWidth=this.width,r.totalHeight=t<0?e+r.height:t,this.registerPartial(r,c=>{c.color=a.scoreInfoColor,c.textAlign=ue.Center;for(const h of this.scoreInfoGlyphs.values())h.paint(0,0,c)})),e+n}resizeAndRenderScore(e,t){if(this.renderer.settings.display.barsPerRow>0||this.systemsLayoutMode==pr.FromModelWithScale)for(let n=0;n<this._systems.length;n++){let s=this._systems[n];this.fitSystem(s),e+=this.paintSystem(s,t)}else{this._systems=[];let n=0,s=this.maxWidth,a=this.createEmptyStaffSystem();for(a.index=this._systems.length,a.x=this._pagePadding[0],a.y=e;n<this._allMasterBarRenderers.length;){let o=this._allMasterBarRenderers[n];if(a.width+o.width<=s||a.masterBarsRenderers.length===0)a.addMasterBarRenderers(this.renderer.tracks,o),n++;else{for(;o&&!o.canWrap&&a.masterBarsRenderers.length>1;)o=a.revertLastBar(),n--;a.isFull=!0,a.isLast=this.lastBarIndex===a.lastBarIndex,this._systems.push(a),this.fitSystem(a),e+=this.paintSystem(a,t),a=this.createEmptyStaffSystem(),a.index=this._systems.length,a.x=this._pagePadding[0],a.y=e}}a.isLast=this.lastBarIndex===a.lastBarIndex,this.fitSystem(a),e+=this.paintSystem(a,t)}return e}layoutAndRenderScore(e){let r=this.firstBarIndex,n=this.lastBarIndex;for(this._systems=[];r<=n;){let s=this.createStaffSystem(r,n);this._systems.push(s),s.x=this._pagePadding[0],s.y=e,r=s.lastBarIndex+1,this.fitSystem(s),V.debug(this.name,"Rendering partial from bar "+s.firstBarIndex+" to "+s.lastBarIndex,null),e+=this.paintSystem(s,e)}return e}paintSystem(e,t){let r=Math.floor(e.height);const n=new Oa;return n.x=0,n.y=e.y,n.totalWidth=this.width,n.totalHeight=t,n.width=this.width,n.height=r,n.firstMasterBarIndex=e.firstBarIndex,n.lastMasterBarIndex=e.lastBarIndex,e.buildBoundingsLookup(0,0),this.registerPartial(n,s=>{this.renderer.canvas.color=this.renderer.settings.display.resources.mainGlyphColor,this.renderer.canvas.textAlign=ue.Left,e.paint(0,-n.y,s)}),t+=r,r}fitSystem(e){e.isFull||e.width>this.maxWidth||this.renderer.settings.display.justifyLastSystem?e.scaleToWidth(this.maxWidth):e.scaleToWidth(e.width),e.finalizeSystem()}getBarsPerSystem(e){let t=this.renderer.settings.display.barsPerRow;if(this.systemsLayoutMode==pr.FromModelWithScale){let r,n;this.renderer.tracks.length>1?(r=this.renderer.score.defaultSystemsLayout,n=this.renderer.score.systemsLayout):(r=this.renderer.tracks[0].defaultSystemsLayout,n=this.renderer.tracks[0].systemsLayout),t=e<n.length?n[e]:r}return t}createStaffSystem(e,t){let r=this.createEmptyStaffSystem();r.index=this._systems.length;let n=this.getBarsPerSystem(r.index),s=this.maxWidth,a=t+1,o=e;for(;o<a;){if(this._barsFromPreviousSystem.length>0)for(let u of this._barsFromPreviousSystem)r.addMasterBarRenderers(this.renderer.tracks,u),o=u.masterBar.index;else{let u=r.addBars(this.renderer.tracks,o);u&&this._allMasterBarRenderers.push(u)}this._barsFromPreviousSystem=[];let l=!1;if((n===-1&&r.width>=s&&r.masterBarsRenderers.length!==0||r.masterBarsRenderers.length===n+1)&&(l=!0),l){let u=r.revertLastBar();if(u)for(this._barsFromPreviousSystem.push(u);u&&!u.canWrap&&r.masterBarsRenderers.length>1;)u=r.revertLastBar(),u&&this._barsFromPreviousSystem.push(u);return r.isFull=!0,r.isLast=!1,this._barsFromPreviousSystem.reverse(),r}r.x=0,o++}return r.isLast=t===r.lastBarIndex,r}get maxWidth(){return this.renderer.width-this._pagePadding[0]-this._pagePadding[2]}}class ra extends _t{constructor(e,t,r,n=!1){super(e,t,n?ke.GraceScale:1,ra.getMusicSymbol(r)),this._isGrace=n,this._accidentalType=r}static getMusicSymbol(e){switch(e){case Ye.Natural:return w.AccidentalNatural;case Ye.Sharp:return w.AccidentalSharp;case Ye.Flat:return w.AccidentalFlat;case Ye.NaturalQuarterNoteUp:return w.AccidentalQuarterToneNaturalArrowUp;case Ye.SharpQuarterNoteUp:return w.AccidentalQuarterToneSharpArrowUp;case Ye.FlatQuarterNoteUp:return w.AccidentalQuarterToneFlatArrowUp;case Ye.DoubleSharp:return w.AccidentalDoubleSharp;case Ye.DoubleFlat:return w.AccidentalDoubleFlat}return w.None}doLayout(){switch(this._accidentalType){case Ye.DoubleFlat:this.width=18;break;default:this.width=8;break}this.width=this.width*(this._isGrace?ke.GraceScale:1)*this.scale}}class J1 extends _t{constructor(e,t,r,n){super(e,t,1,J1.getSymbol(r)),this._clef=r,this._clefOttava=n}doLayout(){switch(this._clef){case ve.Neutral:this.width=15*this.scale;break;case ve.C3:case ve.C4:case ve.F4:case ve.G2:this.width=28*this.scale;break}}static getSymbol(e){switch(e){case ve.Neutral:return w.UnpitchedPercussionClef1;case ve.C3:return w.CClef;case ve.C4:return w.CClef;case ve.F4:return w.FClef;case ve.G2:return w.GClef;default:return w.None}}paint(e,t,r){super.paint(e,t,r);let n,s=!1;switch(this._clefOttava){case $e._15ma:n=new _t(-4*this.scale,0,.5,w.Quindicesima),s=!0;break;case $e._8va:n=new _t(-2*this.scale,0,.5,w.Ottava),s=!0;break;case $e._8vb:n=new _t(-6*this.scale,0,.5,w.Ottava);break;case $e._15mb:n=new _t(-8*this.scale,0,.5,w.Quindicesima);break;default:return}let a=0,o=0;switch(this._clef){case ve.Neutral:a=s?-12:15,o=0;break;case ve.C3:a=s?-19:27,o=0;break;case ve.C4:a=s?-19:27,o=0;break;case ve.F4:a=s?-9:27,o=-4;break;case ve.G2:a=s?-37:30,o=0;break;default:return}n.renderer=this.renderer,n.doLayout();let l=this.width/2;n.paint(e+this.x+l+o*this.scale,t+this.y+a*this.scale,r)}}class Hd extends _t{constructor(e,t,r){super(e,t,1,Hd.getSymbol(r))}static getSymbol(e){switch(e){case jt.None:return w.None;case jt.Normal:return w.ArticAccentAbove;case jt.Heavy:return w.ArticMarcatoAbove;default:return w.None}}doLayout(){this.width=9*this.scale,this.height=9*this.scale}paint(e,t,r){super.paint(e-2*this.scale,t+this.height,r)}}class zd extends Mt{constructor(e,t,r){super(e,t),this._size=0,this._size=r}doLayout(){this.width=this._size+3*this.scale}paint(e,t,r){r.fillCircle(e+this.x,t+this.y,this._size)}}class ZU extends _t{constructor(e,t,r){super(e,t,r?ke.GraceScale:1,w.NoteheadXOrnate),this._isGrace=r}doLayout(){this.width=9*(this._isGrace?ke.GraceScale:1)*this.scale,this.height=ke.NoteHeadHeight*this.scale}}class Ud extends _t{constructor(e,t,r,n){super(e,t,n?ke.GraceScale:1,Ud.getSymbol(r)),this._isGrace=n}static getSymbol(e){switch(e){case _.QuadrupleWhole:case _.DoubleWhole:case _.Whole:case _.Half:return w.NoteheadDiamondWhiteWide;default:return w.NoteheadDiamondBlackWide}}doLayout(){this.width=9*(this._isGrace?ke.GraceScale:1)*this.scale,this.height=ke.NoteHeadHeight*this.scale}}class Qt extends Mt{constructor(e,t,r){super(0,0),this.yOffset=0,this.startNoteRenderer=null,this.endNoteRenderer=null,this.tieDirection=H.Up,this._startX=0,this._startY=0,this._endX=0,this._endY=0,this._tieHeight=0,this._shouldDraw=!1,this.startBeat=e,this.endBeat=t,this.forEnd=r}doLayout(){if(this.width=0,!this.endBeat){this._shouldDraw=!1;return}let e=this.renderer.scoreRenderer.layout.getRendererForBar(this.renderer.staff.staveId,this.startBeat.voice.bar);this.startNoteRenderer=e;let t=this.renderer.scoreRenderer.layout.getRendererForBar(this.renderer.staff.staveId,this.endBeat.voice.bar);this.endNoteRenderer=t,this._startX=0,this._endX=0,this._startY=0,this._endY=0,this.height=0,this._shouldDraw=!1,this.tieDirection=e?this.getBeamDirection(this.startBeat,e):this.getBeamDirection(this.endBeat,t),!this.forEnd&&e?(e!==t?(this._startX=e.x+this.getStartX(),this._startY=e.y+this.getStartY()+this.yOffset,!t||e.staff!==t.staff?(this._endX=e.x+e.width,this._endY=this._startY):(this._endX=t.x+this.getEndX(),this._endY=t.y+this.getEndY()+this.yOffset)):(this._startX=e.x+this.getStartX(),this._endX=t.x+this.getEndX(),this._startY=e.y+this.getStartY()+this.yOffset,this._endY=t.y+this.getEndY()+this.yOffset),this._shouldDraw=!0):(!e||e.staff!==t.staff)&&(this._startX=t.x,this._endX=t.x+this.getEndX(),this._startY=t.y+this.getEndY()+this.yOffset,this._endY=this._startY,this._shouldDraw=!0),this._shouldDraw&&(this.y=Math.min(this._startY,this._endY),this.shouldDrawBendSlur()?this._tieHeight=0:(this._tieHeight=this.getTieHeight(this._startX,this._startY,this._endX,this._endY),this.height=Qt.calculateActualTieHeight(this.renderer.scale,this._startX,this._startY,this._endX,this._endY,this.tieDirection===H.Down,this._tieHeight,4).h),this.tieDirection===H.Up&&(this.y-=this.height))}paint(e,t,r){this._shouldDraw&&(this.shouldDrawBendSlur()?Qt.drawBendSlur(r,e+this._startX,t+this._startY,e+this._endX,t+this._endY,this.tieDirection===H.Down,this.scale):Qt.paintTie(r,this.scale,e+this._startX,t+this._startY,e+this._endX,t+this._endY,this.tieDirection===H.Down,this._tieHeight,4))}shouldDrawBendSlur(){return!1}getTieHeight(e,t,r,n){return 22}getBeamDirection(e,t){return H.Down}getStartY(){return 0}getEndY(){return 0}getStartX(){return 0}getEndX(){return 0}static calculateActualTieHeight(e,t,r,n,s,a,o,l){const u=Qt.computeBezierControlPoints(e,t,r,n,s,a,o,l);t=u[0],r=u[1];const c=u[2],h=u[3];n=u[6],s=u[7];const d=(t-c)/(t-2*c+n),f=Qt.calculateExtrema(t,r,c,h,n,s,d),p=f.length>0?Math.min(t,n,f[0]):Math.min(t,n),g=f.length>0?Math.max(t,n,f[0]):Math.max(t,n),y=(r-h)/(r-2*h+s),b=Qt.calculateExtrema(t,r,c,h,n,s,y),m=b.length>0?Math.min(r,s,b[1]):Math.min(r,s),v=b.length>0?Math.max(r,s,b[1]):Math.max(r,s),k=new ji;return k.x=p,k.y=m,k.w=g-p,k.h=v-m,k}static calculateExtrema(e,t,r,n,s,a,o){if(o<=0||1<=o)return[];const l=e+(r-e)*o,u=t+(n-t)*o,c=r+(s-r)*o,h=n+(a-n)*o;return[l+(c-l)*o,u+(h-u)*o]}static computeBezierControlPoints(e,t,r,n,s,a,o,l){if(t===n&&r===s)return[];if(n<t){let m=t;t=n,n=m,m=r,r=s,s=m}o*=e,l*=e;let u=s-r,c=n-t,h=Math.sqrt(u*u+c*c);a?u*=-1:c*=-1,u/=h,c/=h;let d=(n+t)/2,f=(s+r)/2,p=d+o*u,g=f+o*c,y=d+(o-l)*u,b=f+(o-l)*c;return[t,r,p,g,y,b,n,s]}static paintTie(e,t,r,n,s,a,o=!1,l=22,u=4){const c=Qt.computeBezierControlPoints(t,r,n,s,a,o,l,u);e.beginPath(),e.moveTo(c[0],c[1]),e.quadraticCurveTo(c[2],c[3],c[6],c[7]),e.quadraticCurveTo(c[4],c[5],c[0],c[1]),e.closePath(),e.fill()}static drawBendSlur(e,t,r,n,s,a,o,l){let u=s-r,c=n-t,h=Math.sqrt(u*u+c*c);a?u*=-1:c*=-1,u/=h,c/=h;let d=(n+t)/2,f=(s+r)/2,p=Qt.BendSlurHeight*o;n-t<20&&(p/=2);let g=d+p*u,y=f+p*c;if(e.beginPath(),e.moveTo(t,r),e.lineTo(g,y),e.lineTo(n,s),e.stroke(),l){let b=e.measureText(l).width,m=a?0:-e.font.size;e.fillText(l,g-b/2,y+m)}}}Qt.BendSlurHeight=11;class yp extends Mt{constructor(e){super(0,0),this._isOpen=e}doLayout(){super.doLayout(),this.width=yp.Size*this.scale}paint(e,t,r){this._isOpen?Qt.paintTie(r,this.scale,e+this.x+this.width,t+this.y+this.height,e+this.x+this.width,t+this.y,!1,6,3):Qt.paintTie(r,this.scale,e+this.x,t+this.y,e+this.x,t+this.y+this.height,!1,6,3)}}yp.Size=6;class eW{constructor(e,t){this.line=0,this.line=e,this.isGhost=t}}class Wd extends Mt{constructor(e){super(0,0),this._infos=[],this._glyphs=[],this.isEmpty=!0,this._isOpen=e}addParenthesis(e){let t=this.renderer,r=t.getNoteLine(e),n=e.isGhost||this.isTiedBend(e)&&t.settings.notation.isNotationElementVisible(pe.ParenthesisOnTiedBends);this.addParenthesisOnLine(r,n)}addParenthesisOnLine(e,t){let r=new eW(e,t);this._infos.push(r),t&&(this.isEmpty=!1)}isTiedBend(e){return e.isTieDestination?e.tieOrigin.hasBend?!0:this.isTiedBend(e.tieOrigin):!1}doLayout(){let e=this.renderer;this._infos.sort((n,s)=>n.line-s.line);let t=null,r=e.getScoreHeight(1);for(let n=0,s=this._infos.length;n<s;n++){let a;if(!this._infos[n].isGhost)t=null;else if(!t)a=new yp(this._isOpen),a.renderer=this.renderer,a.y=e.getScoreY(this._infos[n].line)-r,a.height=r*2,a.doLayout(),this._glyphs.push(a),t=a;else{let o=e.getScoreY(this._infos[n].line)+r;t.height=o-t.y}}this.width=this._glyphs.length>0?this._glyphs[0].width:0}paint(e,t,r){super.paint(e,t,r);for(let n of this._glyphs)n.paint(e+this.x,t+this.y,r)}}class tW{constructor(e,t){this.line=0,this.glyph=e,this.line=t}}class $B extends Mt{constructor(){super(0,0),this._infos=[],this._noteHeadPadding=0,this.minNote=null,this.maxNote=null,this.spacingChanged=new ei,this.upLineX=0,this.downLineX=0,this.displacedX=0,this.noteStartX=0}add(e,t){let r=new tW(e,t);this._infos.push(r),(!this.minNote||this.minNote.line>r.line)&&(this.minNote=r),(!this.maxNote||this.maxNote.line<r.line)&&(this.maxNote=r)}get hasTopOverflow(){return!!this.minNote&&this.minNote.line<=0}get hasBottomOverflow(){return!!this.maxNote&&this.maxNote.line>8}doLayout(){this._infos.sort((o,l)=>l.line-o.line);let e=0,t=!1,r=0,n=!1,s=this.direction,a=0;for(let o=0,l=this._infos.length;o<l;o++){let u=this._infos[o].glyph;u.renderer=this.renderer,u.doLayout();let c=!1;o===0?e=u.width:Math.abs(r-this._infos[o].line)<=1?t?t=!1:(c=!0,u.x=e,n=!0,t=!0):t=!1,s===H.Down?u.x=c?0:e:u.x=c?e:0,u.x+=this.noteStartX,r=this._infos[o].line,a=Math.max(a,u.x+u.width)}n?(this._noteHeadPadding=0,this.upLineX=e,this.downLineX=e):(this._noteHeadPadding=s===H.Down?-e:0,a+=this._noteHeadPadding,this.upLineX=a,this.downLineX=0),this.displacedX=e,this.width=a}paint(e,t,r){e+=this.x,t+=this.y;let n=this.renderer,s=3*this.scale,a=this.width-this.noteStartX+s*2;if(this.hasTopOverflow){let u=r.color;r.color=n.resources.staffLineColor;let c=-2;for(;c>=this.minNote.line;){let h=t+n.getScoreY(c);r.fillRect(e-s+this.noteStartX,h,a,this.scale),c-=2}r.color=u}if(this.hasBottomOverflow){let u=r.color;r.color=n.resources.staffLineColor;let c=10;for(;c<=this.maxNote.line;){let h=t+n.getScoreY(c);r.fillRect(e-s+this.noteStartX,h,a,this.scale),c+=2}r.color=u}let o=this._infos,l=e+this._noteHeadPadding;for(let u of o)u.glyph.renderer=this.renderer,u.glyph.paint(l,t,r)}}class bp extends _t{constructor(e,t,r){super(e,t,1,bp.getSymbol(r))}doLayout(){this.width=12*this.scale}static getSymbol(e){switch(e){case _.ThirtySecond:return w.Tremolo3;case _.Sixteenth:return w.Tremolo2;case _.Eighth:return w.Tremolo1;default:return w.None}}}class iW extends $B{constructor(){super(),this._noteGlyphLookup=new Map,this._notes=[],this._tremoloPicking=null,this.aboveBeatEffects=new Map,this.belowBeatEffects=new Map}get direction(){return this.beamingHelper.direction}getNoteX(e,t){if(this._noteGlyphLookup.has(e.id)){let r=this._noteGlyphLookup.get(e.id),n=this.x+r.x+this._noteHeadPadding;switch(t){case ft.Left:break;case ft.Center:n+=r.width/2;break;case ft.Right:n+=r.width;break}return n}return 0}getNoteY(e,t){if(this._noteGlyphLookup.has(e.id)){const r=this._noteGlyphLookup.get(e.id);let n=this.y+r.y;switch(t){case te.TopWithStem:n-=this.renderer.getStemSize(this.beamingHelper);break;case te.Top:n-=r.height/2;break;case te.Center:break;case te.Bottom:n+=r.height/2;break;case te.BottomWithStem:n+=this.renderer.getStemSize(this.beamingHelper);break}return n}return 0}addNoteGlyph(e,t,r){super.add(e,r),this._noteGlyphLookup.set(t.id,e),this._notes.push(t)}updateBeamingHelper(e){this.beamingHelper&&this.beamingHelper.registerBeatLineX("score",this.beat,e+this.x+this.upLineX,e+this.x+this.downLineX)}doLayout(){super.doLayout();let e=this.direction;for(const t of this.aboveBeatEffects.values())t.renderer=this.renderer,t.doLayout();for(const t of this.belowBeatEffects.values())t.renderer=this.renderer,t.doLayout();if(this.beat.isTremolo){let t=0,r=e===H.Up?this.minNote:this.maxNote,n=e===H.Up?this.displacedX:0,s=this.beat.tremoloSpeed;switch(s){case _.ThirtySecond:t=e===H.Up?-15:15;break;case _.Sixteenth:t=e===H.Up?-12:15;break;case _.Eighth:t=e===H.Up?-10:10;break;default:t=e===H.Up?-10:15;break}this._tremoloPicking=new bp(n,r.glyph.y+t*this.scale,s),this._tremoloPicking.renderer=this.renderer,this._tremoloPicking.doLayout()}}buildBoundingsLookup(e,t,r){for(let n of this._notes)if(this._noteGlyphLookup.has(n.id)){let s=this._noteGlyphLookup.get(n.id),a=new fp;a.note=n,a.noteHeadBounds=new ji,a.noteHeadBounds.x=t+this.x+this._noteHeadPadding+s.x,a.noteHeadBounds.y=r+this.y+s.y-s.height/2,a.noteHeadBounds.w=s.width,a.noteHeadBounds.h=s.height,e.addNote(a)}}paint(e,t,r){let n=this.renderer,s=0,a=0,o=1,l=-o;this.beamingHelper.direction===H.Up?(a=n.getScoreY(this.minNote.line),s=n.getScoreY(this.maxNote.line-2)):(a=n.getScoreY(this.maxNote.line-1),s=n.getScoreY(this.minNote.line+1),l*=-1,o*=-1);for(const u of this.aboveBeatEffects.values())s+=l*u.height,u.paint(e+this.x+2*this.scale,t+this.y+s,r);for(const u of this.belowBeatEffects.values())a+=o*u.height,u.paint(e+this.x+2*this.scale,t+this.y+a,r);super.paint(e,t,r),this._tremoloPicking&&this._tremoloPicking.paint(e,t,r)}}class Qa extends _t{constructor(e,t,r){super(e,t,1,Qa.getSymbol(r)),this._duration=r}static getSymbol(e){switch(e){case _.QuadrupleWhole:return w.RestLonga;case _.DoubleWhole:return w.RestDoubleWhole;case _.Whole:return w.RestWhole;case _.Half:return w.RestHalf;case _.Quarter:return w.RestQuarter;case _.Eighth:return w.RestEighth;case _.Sixteenth:return w.RestSixteenth;case _.ThirtySecond:return w.RestThirtySecond;case _.SixtyFourth:return w.RestSixtyFourth;case _.OneHundredTwentyEighth:return w.RestOneHundredTwentyEighth;case _.TwoHundredFiftySixth:return w.RestTwoHundredFiftySixth;default:return w.None}}static getSize(e){switch(e){case _.QuadrupleWhole:case _.DoubleWhole:case _.Whole:case _.Half:case _.Quarter:case _.Eighth:case _.Sixteenth:return 9;case _.ThirtySecond:return 12;case _.SixtyFourth:return 14;case _.OneHundredTwentyEighth:case _.TwoHundredFiftySixth:return 20}return 10}doLayout(){this.width=Qa.getSize(this._duration)*this.scale}updateBeamingHelper(e){this.beamingHelper&&this.beamingHelper.registerBeatLineX("score",this.beat,e+this.x+this.width/2,e+this.x+this.width/2)}}class US{constructor(){this.x=0,this.y=-3e3,this.width=0}}class jB extends Mn{constructor(){super(0,0)}doLayout(){if(!this.glyphs||this.glyphs.length===0){this.width=0;return}this.glyphs.sort((r,n)=>r.y<n.y?-1:r.y>n.y?1:0);let e=[];e.push(new US);let t=21*this.scale;for(let r=0,n=this.glyphs.length;r<n;r++){let s=this.glyphs[r];s.renderer=this.renderer,s.doLayout();let a=0;for(;e[a].y>s.y;)a++,a===e.length&&e.push(new US);s.x=a,e[a].y=s.y+t,e[a].width<s.width&&(e[a].width=s.width)}this.width=0;for(const r of e)this.width+=r.width,r.x=this.width;for(let r=0,n=this.glyphs.length;r<n;r++){let s=this.glyphs[r];const a=e[s.x];s.x=this.width-a.x}}}class Ji extends $B{get direction(){return H.Up}constructor(e,t=!1){super(),this._showParenthesis=!1,this._noteValueLookup=new Map,this._accidentals=new jB,this._preNoteParenthesis=null,this._postNoteParenthesis=null,this.isEmpty=!0,this.noteHeadOffset=0,this._beat=e,this._showParenthesis=t,t&&(this._preNoteParenthesis=new Wd(!0),this._postNoteParenthesis=new Wd(!1))}containsNoteValue(e){return this._noteValueLookup.has(e)}getNoteValueY(e){return this._noteValueLookup.has(e)?this.y+this._noteValueLookup.get(e).y:0}addGlyph(e,t=!1){let r=this.renderer,n=new ke(0,0,_.Quarter,!0),s=r.accidentalHelper.applyAccidentalForValue(this._beat,e,t,!0),a=r.accidentalHelper.getNoteLineForValue(e,!1);if(n.y=r.getScoreY(a),this._showParenthesis&&(this._preNoteParenthesis.renderer=this.renderer,this._postNoteParenthesis.renderer=this.renderer,this._preNoteParenthesis.addParenthesisOnLine(a,!0),this._postNoteParenthesis.addParenthesisOnLine(a,!0)),s!==Ye.None){let o=new ra(0,n.y,s,!0);o.renderer=this.renderer,this._accidentals.renderer=this.renderer,this._accidentals.addGlyph(o)}this._noteValueLookup.set(e,n),this.add(n,a),this.isEmpty=!1}doLayout(){let e=0;this._showParenthesis&&(this._preNoteParenthesis.x=e,this._preNoteParenthesis.renderer=this.renderer,this._preNoteParenthesis.doLayout(),e+=this._preNoteParenthesis.width+Ji.ElementPadding*this.scale),this._accidentals.isEmpty||(e+=this._accidentals.width+Ji.ElementPadding*this.scale,this._accidentals.x=e,this._accidentals.renderer=this.renderer,this._accidentals.doLayout(),e+=this._accidentals.width+Ji.ElementPadding*this.scale),this.noteStartX=e,super.doLayout(),this.noteHeadOffset=this.noteStartX+(this.width-this.noteStartX)/2,this._showParenthesis&&(this._postNoteParenthesis.x=this.width+Ji.ElementPadding*this.scale,this._postNoteParenthesis.renderer=this.renderer,this._postNoteParenthesis.doLayout(),this.width+=this._postNoteParenthesis.width+Ji.ElementPadding*this.scale)}paint(e,t,r){this._accidentals.isEmpty||this._accidentals.paint(e+this.x,t+this.y,r),this._showParenthesis&&(this._preNoteParenthesis.paint(e+this.x,t+this.y,r),this._postNoteParenthesis.paint(e+this.x,t+this.y,r)),super.paint(e,t,r)}}Ji.ElementPadding=2;class Q1 extends Mt{constructor(){super(...arguments),this.BendNoteHeads=[]}drawBendSlur(e,t,r,n,s,a,o,l){Qt.drawBendSlur(e,t,r,n,s,a,o,l)}doLayout(){super.doLayout(),this.width=0;for(let e of this.BendNoteHeads)e.doLayout(),this.width+=e.width+10*this.scale}getTieDirection(e,t){switch(t.getBeatDirection(e)){case H.Up:return H.Down;default:return H.Up}}}Q1.EndPadding=(10/2|0)+3;class Fs extends ${constructor(e=0,t=0){super(e,t),this.lineValue=0,this.lineValue=t}}class Zr extends Mt{constructor(){super(0,0),this._notes=[],this._renderPoints=new Map,this._preBendMinValue=-1,this._bendMiddleMinValue=-1,this._bendEndMinValue=-1,this._bendEndContinuedMinValue=-1,this._releaseMinValue=-1,this._releaseContinuedMinValue=-1,this._maxBendValue=-1}addBends(e){this._notes.push(e);let t=this.createRenderingPoints(e);this._renderPoints.set(e.id,t),(this._maxBendValue===-1||this._maxBendValue<e.maxBendPoint.value)&&(this._maxBendValue=e.maxBendPoint.value);let r=0;switch(e.bendType){case ee.Bend:r=t[1].value,e.isTieOrigin?(this._bendEndContinuedMinValue===-1||r<this._bendEndContinuedMinValue)&&(this._bendEndContinuedMinValue=r):(this._bendEndMinValue===-1||r<this._bendEndMinValue)&&(this._bendEndMinValue=r);break;case ee.Release:r=t[1].value,e.isTieOrigin?(this._releaseContinuedMinValue===-1||r<this._releaseContinuedMinValue)&&(this._releaseContinuedMinValue=r):r>0&&(this._releaseMinValue===-1||r<this._releaseMinValue)&&(this._releaseMinValue=r);break;case ee.BendRelease:r=t[1].value,(this._bendMiddleMinValue===-1||r<this._bendMiddleMinValue)&&(this._bendMiddleMinValue=r),r=t[2].value,e.isTieOrigin?(this._releaseContinuedMinValue===-1||r<this._releaseContinuedMinValue)&&(this._releaseContinuedMinValue=r):r>0&&(this._releaseMinValue===-1||r<this._releaseMinValue)&&(this._releaseMinValue=r);break;case ee.Prebend:r=t[0].value,(this._preBendMinValue===-1||r<this._preBendMinValue)&&(this._preBendMinValue=r);break;case ee.PrebendBend:r=t[0].value,(this._preBendMinValue===-1||r<this._preBendMinValue)&&(this._preBendMinValue=r),r=t[1].value,e.isTieOrigin?(this._bendEndContinuedMinValue===-1||r<this._bendEndContinuedMinValue)&&(this._bendEndContinuedMinValue=r):(this._bendEndMinValue===-1||r<this._bendEndMinValue)&&(this._bendEndMinValue=r);break;case ee.PrebendRelease:r=t[0].value,(this._preBendMinValue===-1||r<this._preBendMinValue)&&(this._preBendMinValue=r),r=t[1].value,e.isTieOrigin?(this._releaseContinuedMinValue===-1||r<this._releaseContinuedMinValue)&&(this._releaseContinuedMinValue=r):r>0&&(this._releaseMinValue===-1||r<this._releaseMinValue)&&(this._releaseMinValue=r);break}}doLayout(){super.doLayout();let e=this._maxBendValue*Zr.BendValueHeight*this.scale;this.renderer.registerOverflowTop(e);let t=0;for(let r of this._notes){let n=this._renderPoints.get(r.id);switch(r.bendType){case ee.Bend:n[1].lineValue=r.isTieOrigin?this._bendEndContinuedMinValue:this._bendEndMinValue;break;case ee.Release:t=r.isTieOrigin?this._releaseContinuedMinValue:this._releaseMinValue,t>=0&&(n[1].lineValue=t);break;case ee.BendRelease:n[1].lineValue=this._bendMiddleMinValue,t=r.isTieOrigin?this._releaseContinuedMinValue:this._releaseMinValue,t>=0&&(n[2].lineValue=t);break;case ee.Prebend:n[0].lineValue=this._preBendMinValue;break;case ee.PrebendBend:n[0].lineValue=this._preBendMinValue,n[1].lineValue=r.isTieOrigin?this._bendEndContinuedMinValue:this._bendEndMinValue;break;case ee.PrebendRelease:n[0].lineValue=this._preBendMinValue,t=r.isTieOrigin?this._releaseContinuedMinValue:this._releaseMinValue,t>=0&&(n[1].lineValue=t);break}}this.width=0,this._notes.sort((r,n)=>r.isStringed?r.string-n.string:r.realValue-n.realValue)}createRenderingPoints(e){let t=[];switch(e.bendType){case ee.Custom:for(let r of e.bendPoints)t.push(new Fs(r.offset,r.value));break;case ee.BendRelease:t.push(new Fs(0,e.bendPoints[0].value)),t.push(new Fs($.MaxPosition/2|0,e.bendPoints[1].value)),t.push(new Fs($.MaxPosition,e.bendPoints[3].value));break;case ee.Bend:case ee.Hold:case ee.Prebend:case ee.PrebendBend:case ee.PrebendRelease:case ee.Release:t.push(new Fs(0,e.bendPoints[0].value)),t.push(new Fs($.MaxPosition,e.bendPoints[1].value));break}return t}paint(e,t,r){let n=r.color;this._notes.length>1&&(r.color=this.renderer.resources.secondaryGlyphColor);for(let s of this._notes){let a=this._renderPoints.get(s.id),o=this.renderer,l=s,u=!1,c=null,h=!1,d=s.bendStyle===Je.Gradual?"grad.":"",f=null;for(;l.isTieOrigin;){let v=l.tieDestination;if(c=this.renderer.scoreRenderer.layout.getRendererForBar(this.renderer.staff.staveId,v.beat.voice.bar),!c||o.staff!==c.staff)break;if(l=v,u=!0,l.hasBend||!this.renderer.settings.notation.extendBendArrowsOnTiedNotes){h=!0;break}}f=l.beat,c=this.renderer.scoreRenderer.layout.getRendererForBar(this.renderer.staff.staveId,f.voice.bar),f.isLastOfVoice&&!l.hasBend&&this.renderer.settings.notation.extendBendArrowsOnTiedNotes&&(f=null);let p=0,g=0,y=t+o.y;p=e+o.x,a[0].value>0||s.isContinuedBend?p+=o.getBeatX(s.beat,Oe.MiddleNotes):p+=o.getNoteX(s,ft.Right),!f||f.isLastOfVoice&&!h?g=e+c.x+c.postBeatGlyphsStart:h||!f.nextBeat?g=e+c.x+c.getBeatX(f,Oe.MiddleNotes):s.bendType===ee.Hold?g=e+c.x+c.getBeatX(f.nextBeat,Oe.OnNotes):g=e+c.x+c.getBeatX(f.nextBeat,Oe.PreNotes),u||(g-=Zr.ArrowSize*this.scale);let m=(g-p)/$.MaxPosition;r.beginPath();for(let v=0,k=a.length-1;v<k;v++){let x=a[v],C=a[v+1];v===0&&x.value!==0&&!s.isTieDestination&&this.paintBend(s,new Fs(0,0),x,p,y,m,d,r),s.bendType!==ee.Prebend?(v===0&&(p+=2*this.scale),this.paintBend(s,x,C,p,y,m,d,r)):s.isTieOrigin&&s.tieDestination.hasBend&&(C=new Fs($.MaxPosition,x.value),C.lineValue=x.lineValue,this.paintBend(s,x,C,p,y,m,d,r))}r.color=n}}paintBend(e,t,r,n,s,a,o,l){let u=this.renderer,c=this.renderer.resources,h=u.lineOffset/2,d=n+a*t.offset,f=Zr.BendValueHeight*this.scale,p=s-f*t.lineValue;t.value===0?r.offset===t.offset?p+=u.getNoteY(e.beat.maxStringNote,te.Top):p+=u.getNoteY(e,te.Center):p+=h;let g=n+a*r.offset,y=s-f*r.lineValue;r.lineValue===0?y+=u.getNoteY(e,te.Center):y+=h;let b=0,m=Zr.ArrowSize*this.scale;if(r.value>t.value?(y+m>p&&(y=p-m),l.beginPath(),l.moveTo(g,y),l.lineTo(g-m*.5,y+m),l.lineTo(g+m*.5,y+m),l.closePath(),l.fill(),b=m):r.value!==t.value&&(y<p&&(y=p+m),l.beginPath(),l.moveTo(g,y),l.lineTo(g-m*.5,y-m),l.lineTo(g+m*.5,y-m),l.closePath(),l.fill(),b=-m),l.stroke(),t.value===r.value){if(t.lineValue>0){let v=g,k=Zr.DashSize*this.scale,x=d+k;if((v-d)/(k*2)<1)l.moveTo(v,p),l.lineTo(d,p);else for(;v>x;)l.moveTo(v,p),l.lineTo(v-k,p),v-=k*2;l.stroke()}}else g>d?(l.moveTo(d,p),l.bezierCurveTo((d+g)/2,p,g,p,g,y+b),l.stroke()):(l.moveTo(d,p),l.lineTo(g,y),l.stroke());if(o&&t.offset<r.offset){l.font=c.graceFont;let v=l.measureText(o).width,k=0,x=0;if(p>y){let C=Math.abs(p-y);k=C>l.font.size*1.3?p-C/2:p,x=(d+g-v)/2}else k=p,x=g-v;l.fillText(o,x,k)}if(r.value!==0&&t.value!==r.value){let v=r.value,k=r.value>t.value;v=Math.abs(v);let x="";if(v===4)x="full",v-=4;else if(v>=4||v<=-4){let C=v/4|0;x+=C,v-=C*4}if(v>0&&(x+=Zr.getFractionSign(v)),x!==""){y=s-f*r.value;let C=y;k||(C=p+Math.abs(y-p)*1/3),l.font=c.tablatureFont;let N=l.measureText(x).width,B=C-c.tablatureFont.size*.5-2*this.scale,E=g-N/2;l.fillText(x,E,B)}}}static getFractionSign(e){switch(e){case 1:return"¼";case 2:return"½";case 3:return"¾";default:return e+"/ 4"}}}Zr.ArrowSize=6;Zr.DashSize=3;Zr.BendValueHeight=6;class Pr extends Mt{constructor(e){super(0,0),this._isSimpleDip=!1,this._beat=e,this._renderPoints=this.createRenderingPoints(e)}createRenderingPoints(e){if(e.whammyBarType===Ge.Custom)return e.whammyBarPoints;let t=[];switch(e.whammyBarType){case Ge.Dive:case Ge.Hold:case Ge.PrediveDive:case Ge.Predive:t.push(new $(0,e.whammyBarPoints[0].value)),t.push(new $($.MaxPosition,e.whammyBarPoints[1].value));break;case Ge.Dip:t.push(new $(0,e.whammyBarPoints[0].value)),t.push(new $($.MaxPosition/2|0,e.whammyBarPoints[1].value)),t.push(new $($.MaxPosition,e.whammyBarPoints[e.whammyBarPoints.length-1].value));break}return t}doLayout(){super.doLayout(),this._isSimpleDip=this.renderer.settings.notation.notationMode===Zt.SongBook&&this._beat.whammyBarType===Ge.Dip;let e=null,t=null,r=this._beat;for(;r&&r.hasWhammyBar;)(!e||e.value>r.minWhammyPoint.value)&&(e=r.minWhammyPoint),(!t||t.value<r.maxWhammyPoint.value)&&(t=r.maxWhammyPoint),r=r.nextBeat;let n=t.value>0?Math.abs(this.getOffset(t.value)):0;(n>0||this._beat.whammyBarPoints[0].value!==0||this.renderer.settings.notation.isNotationElementVisible(pe.ZerosOnDiveWhammys))&&(n+=this.renderer.resources.tablatureFont.size*2);let s=e.value<0?Math.abs(this.getOffset(e.value)):0;this.renderer.registerOverflowTop(n+s);let a=this.renderer.staff.getSharedLayoutData(Pr.TopOffsetSharedDataKey,-1);n>a&&this.renderer.staff.setSharedLayoutData(Pr.TopOffsetSharedDataKey,n)}getOffset(e){if(e===0)return 0;let t=Pr.PerHalfSize*this.scale+Math.log2(Math.abs(e)/2)*Pr.PerHalfSize*this.scale;return e<0&&(t=-t),t}paint(e,t,r){let n=this.renderer,s=this._beat.nextBeat,a=null,o=Oe.PreNotes;s&&(a=this.renderer.scoreRenderer.layout.getRendererForBar(this.renderer.staff.staveId,s.voice.bar),!a||a.staff!==n.staff||a!==n&&!s.hasWhammyBar?(s=null,a=null):o=s.hasWhammyBar&&(n.settings.notation.notationMode!==Zt.SongBook||s.whammyBarType!==Ge.Dip)?Oe.MiddleNotes:Oe.PreNotes);let l=0,u=0;this._isSimpleDip?(l=e+n.x+n.getBeatX(this._beat,Oe.OnNotes)-2*this.scale,u=e+n.x+n.getBeatX(this._beat,Oe.PostNotes)+2*this.scale):(l=e+n.x+n.getBeatX(this._beat,Oe.MiddleNotes),u=a?e+a.x+a.getBeatX(s,o):e+n.x+n.width-2*this.scale);let c=r.textAlign;if(r.textAlign=ue.Center,this._renderPoints.length>=2){let h=(u-l)/$.MaxPosition;r.beginPath();let d=t+this.renderer.staff.getSharedLayoutData(Pr.TopOffsetSharedDataKey,0),f=this._beat.whammyStyle===Je.Gradual?"grad.":"";for(let p=0,g=this._renderPoints.length-1;p<g;p++){let y=this._renderPoints[p],b=this._renderPoints[p+1],m=p<g-2?this._renderPoints[p+2]:null,v=p===0;p===0&&y.value!==0&&!this._beat.isContinuedWhammy&&(this.paintWhammy(!1,new $(0,0),y,b,l,d,h,r),v=!1),this.paintWhammy(v,y,b,m,l,d,h,r,f),f=""}r.stroke()}r.textAlign=c}paintWhammy(e,t,r,n,s,a,o,l,u){let c=s+o*t.offset,h=s+o*r.offset,d=a-this.getOffset(t.value),f=a-this.getOffset(r.value);if(t.offset===r.offset){let y=Pr.DashSize*this.scale;if(Math.abs(f-d)/(y*2)<1)l.moveTo(c,d),l.lineTo(h,f);else{let m=Math.max(d,f),v=Math.min(d,f);for(;m>v;)l.moveTo(c,v),l.lineTo(c,v+y),v+=y*2}l.stroke()}else if(t.value===r.value){let y=Pr.DashSize*this.scale;if(Math.abs(h-c)/(y*2)<1)l.moveTo(c,d),l.lineTo(h,f);else{let m=Math.max(c,h),v=Math.min(c,h);for(;m>v;)l.moveTo(m,d),l.lineTo(m-y,d),m-=y*2}l.stroke()}else l.moveTo(c,d),l.lineTo(h,f);let p=this.renderer.resources;if(e&&!this._beat.isContinuedWhammy&&!this._isSimpleDip){let y=d;y-=p.tablatureFont.size+2*this.scale,this.renderer.settings.notation.isNotationElementVisible(pe.ZerosOnDiveWhammys)&&l.fillText("0",c,y),u&&(y-=p.tablatureFont.size+2*this.scale,l.fillText(u,c,y))}let g=Math.abs(r.value);if((g!==0||this.renderer.settings.notation.isNotationElementVisible(pe.ZerosOnDiveWhammys)&&!this._isSimpleDip)&&t.value!==r.value){let y="";if(r.value<0&&(y+="-"),g>=4){let v=g/4|0;y+=v,g-=v*4}else g===0&&(y+="0");g>0&&(y+=Zr.getFractionSign(g));let b=0;this._isSimpleDip?b=Math.min(d,f)-p.tablatureFont.size-2*this.scale:(b=t.offset===r.offset?Math.min(d,f):f,b-=p.tablatureFont.size+2*this.scale,n&&n.value>r.value&&(b-=2*this.scale));let m=h;l.fillText(y,m,b)}}}Pr.TopOffsetSharedDataKey="tab.whammy.topoffset";Pr.PerHalfSize=6;Pr.DashSize=3;class Va extends Q1{constructor(e){super(0,0),this._beat=e}doLayout(){let e=this.renderer.settings.notation.notationMode;switch(this._beat.whammyBarType){case Ge.None:case Ge.Custom:case Ge.Hold:return;case Ge.Dive:case Ge.PrediveDive:{let t=new Ji(this._beat,!1);t.renderer=this.renderer;let r=this._beat.whammyBarPoints[this._beat.whammyBarPoints.length-1];for(let n of this._beat.notes)n.isTieOrigin||t.addGlyph(this.getBendNoteValue(n,r),r.value%2!==0);t.doLayout(),this.BendNoteHeads.push(t)}break;case Ge.Dip:if(e===Zt.SongBook){let t=this.renderer.resources;this.renderer.simpleWhammyOverflow=t.tablatureFont.size*1.5+Va.SimpleDipHeight*this.scale+Va.SimpleDipPadding*this.scale}else{let t=new Ji(this._beat,!1);if(t.renderer=this.renderer,this.renderer.settings.notation.notationMode===Zt.GuitarPro){let n=this._beat.whammyBarPoints[1];for(let s of this._beat.notes)t.addGlyph(this.getBendNoteValue(s,this._beat.whammyBarPoints[1]),n.value%2!==0)}t.doLayout(),this.BendNoteHeads.push(t);let r=new Ji(this._beat,!1);if(r.renderer=this.renderer,this.renderer.settings.notation.notationMode===Zt.GuitarPro){let n=this._beat.whammyBarPoints[this._beat.whammyBarPoints.length-1];for(let s of this._beat.notes)r.addGlyph(this.getBendNoteValue(s,n),n.value%2!==0)}r.doLayout(),this.BendNoteHeads.push(r)}break;case Ge.Predive:break}super.doLayout()}paint(e,t,r){let n=this._beat;switch(n.whammyBarType){case Ge.None:case Ge.Custom:return}let s=this.renderer.settings.notation.notationMode,a=this.renderer.scoreRenderer.layout.getRendererForBar(this.renderer.staff.staveId,n.voice.bar),o=e+a.x+a.getBeatX(n,Oe.MiddleNotes),l=this.getTieDirection(n,a),u=this._beat.notes.length===1?l:H.Up,c=r.textAlign;for(let h=0;h<n.notes.length;h++){let d=n.notes[h],f=t+a.y;h>0&&h>=(this._beat.notes.length/2|0)&&(u=H.Down),u===H.Down?f+=a.getNoteY(d,te.Bottom):f+=a.getNoteY(d,te.Top);let p=e+a.x;n.isLastOfVoice?p+=a.width:p+=a.getBeatX(n,Oe.EndBeat),p-=8*this.scale;let g=n.whammyStyle===Je.Gradual&&h===0?"grad.":"",y=null;d.isTieOrigin&&(y=this.renderer.scoreRenderer.layout.getRendererForBar(this.renderer.staff.staveId,d.tieDestination.beat.voice.bar),y&&y.staff===a.staff?p=e+y.x+y.getBeatX(d.tieDestination.beat,Oe.MiddleNotes):y=null);let b=ke.NoteHeadHeight*this.scale*ke.GraceScale*.5;u===H.Up&&(b=-b);let m=n.whammyBarPoints.length>0?this.getBendNoteValue(d,n.whammyBarPoints[n.whammyBarPoints.length-1]):0,v=0,k=!1;switch(this.BendNoteHeads.length>0&&this.BendNoteHeads[0].containsNoteValue(m)?(v=this.BendNoteHeads[0].getNoteValueY(m)+b,k=!0):y&&(d.isTieOrigin&&d.tieDestination.beat.hasWhammyBar||d.beat.isContinuedWhammy)?(v=t+y.y+y.getNoteY(d.tieDestination,te.Top),k=!0,u===H.Down&&(v+=ke.NoteHeadHeight*this.scale)):d.isTieOrigin&&(y?v=t+y.y+y.getNoteY(d.tieDestination,te.Top):v=f,u===H.Down&&(v+=ke.NoteHeadHeight*this.scale)),n.whammyBarType){case Ge.Hold:d.isTieOrigin&&Qt.paintTie(r,this.scale,o,f,p,v,l===H.Down,22,4);break;case Ge.Dive:h===0&&(this.BendNoteHeads[0].x=p-this.BendNoteHeads[0].noteHeadOffset,this.BendNoteHeads[0].y=t+a.y,this.BendNoteHeads[0].paint(0,0,r),this.BendNoteHeads[0].containsNoteValue(m)&&(v+=this.BendNoteHeads[0].y)),k?this.drawBendSlur(r,o,f,p,v,u===H.Down,this.scale,g):d.isTieOrigin&&Qt.paintTie(r,this.scale,o,f,p,v,l===H.Down,22,4);break;case Ge.Dip:if(s===Zt.SongBook){if(h===0){let N=e+a.x+a.getBeatX(this._beat,Oe.OnNotes)-2*this.scale,B=e+a.x+a.getBeatX(this._beat,Oe.PostNotes)+2*this.scale,E=(N+B)/2,O=((this._beat.whammyBarPoints[1].value-this._beat.whammyBarPoints[0].value)/4|0).toString();r.font=this.renderer.resources.tablatureFont,r.fillText(O,E,t+this.y);let z=t+this.y+r.font.size+2*this.scale,J=z+Va.SimpleDipHeight*this.scale;this._beat.whammyBarPoints[1].value>this._beat.whammyBarPoints[0].value?(r.moveTo(N,J),r.lineTo(E,z),r.lineTo(B,J)):(r.moveTo(N,z),r.lineTo(E,J),r.lineTo(B,z)),r.stroke()}d.isTieOrigin&&Qt.paintTie(r,this.scale,o,f,p,v,l===H.Down,22,4)}else{let N=(o+p)/2;this.BendNoteHeads[0].x=N-this.BendNoteHeads[0].noteHeadOffset,this.BendNoteHeads[0].y=t+a.y,this.BendNoteHeads[0].paint(0,0,r);let B=this.getBendNoteValue(d,n.whammyBarPoints[1]),E=this.BendNoteHeads[0].getNoteValueY(B)+b;this.drawBendSlur(r,o,f,N,E,u===H.Down,this.scale,g),this.BendNoteHeads[1].x=p-this.BendNoteHeads[1].noteHeadOffset,this.BendNoteHeads[1].y=t+a.y,this.BendNoteHeads[1].paint(0,0,r),v=this.BendNoteHeads[1].getNoteValueY(m)+b,this.drawBendSlur(r,N,E,p,v,u===H.Down,this.scale,g)}break;case Ge.PrediveDive:case Ge.Predive:let x=e+a.x+a.getBeatX(d.beat,Oe.PreNotes);x+=a.getPreNotesGlyphForBeat(d.beat).prebendNoteHeadOffset;let C=t+a.y+a.getScoreY(a.accidentalHelper.getNoteLineForValue(d.displayValue-(d.beat.whammyBarPoints[0].value/2|0),!1))+b;this.drawBendSlur(r,x,C,o,f,u===H.Down,this.scale,g),this.BendNoteHeads.length>0&&(this.BendNoteHeads[0].x=p-this.BendNoteHeads[0].noteHeadOffset,this.BendNoteHeads[0].y=t+a.y,this.BendNoteHeads[0].paint(0,0,r),this.drawBendSlur(r,o,f,p,v,u===H.Down,this.scale,g));break}}r.textAlign=c}getBendNoteValue(e,t){return e.displayValueWithoutBend+(t.value/2|0)}}Va.SimpleDipHeight=Pr.PerHalfSize*2;Va.SimpleDipPadding=2;class Qi extends Mt{constructor(e,t,r){super(e,t),this.width=r}}class rW extends _t{constructor(e,t,r,n,s){super(e,t,s?ke.GraceScale:1,r.getSymbol(n)),this._isGrace=s,this._articulation=r}paint(e,t,r){let n=this._isGrace?this.scale:0;r.fillMusicFontSymbol(e+this.x,t+this.y+n,this.glyphScale*this.scale,this.symbol,!1),this._articulation.techniqueSymbol!==w.None&&this._articulation.techniqueSymbolPlacement===Se.Middle&&r.fillMusicFontSymbol(e+this.x,t+this.y+n,this.glyphScale*this.scale,this._articulation.techniqueSymbol,!1)}doLayout(){let e=(this._isGrace?ke.GraceScale:1)*this.scale;switch(this.symbol){case w.NoteheadWhole:this.width=14;break;case w.NoteheadCircleX:case w.NoteheadDiamondWhite:this.width=9;break;case w.NoteheadHeavyXHat:case w.NoteheadHeavyX:this.width=13;break;default:this.width=10;break}this.width=this.width*(this._isGrace?ke.GraceScale:1)*this.scale,this.height=ke.NoteHeadHeight*e}}class WS extends _t{constructor(e,t){super(e,t,ke.GraceScale,w.ArticStaccatoAbove)}doLayout(){this.width=ke.QuarterNoteHeadWidth*this.scale,this.height=7*this.scale}paint(e,t,r){super.paint(e+3*this.scale,t+5*this.scale,r)}}class nW extends _t{constructor(e,t){super(e,t,.5,w.PictEdgeOfCymbal)}doLayout(){this.width=22*this.scale,this.height=15*this.scale}paint(e,t,r){super.paint(e-3*this.scale,t+this.height,r)}}class sW extends _t{constructor(e,t){super(e,t,ke.GraceScale,w.GuitarGolpe)}doLayout(){this.width=9*this.scale,this.height=10*this.scale}paint(e,t,r){super.paint(e,t+this.height,r)}}class aW extends Sc{constructor(){super(...arguments),this._collisionOffset=-1e3,this._skipPaint=!1,this.noteHeads=null,this.restGlyph=null}getNoteX(e,t){return this.noteHeads?this.noteHeads.getNoteX(e,t):0}buildBoundingsLookup(e,t,r){this.noteHeads&&this.noteHeads.buildBoundingsLookup(e,t+this.x,r+this.y)}getNoteY(e,t){return this.noteHeads?this.noteHeads.getNoteY(e,t):0}updateBeamingHelper(){if(this.noteHeads)this.noteHeads.updateBeamingHelper(this.container.x+this.x);else if(this.restGlyph&&(this.restGlyph.updateBeamingHelper(this.container.x+this.x),this.renderer.bar.isMultiVoice&&this._collisionOffset===-1e3)){this._collisionOffset=this.renderer.helpers.collisionHelper.applyRestCollisionOffset(this.container.beat,this.restGlyph.y,this.renderer.getScoreHeight(1)),this.y+=this._collisionOffset;const e=this.renderer.helpers.collisionHelper.restDurationsByDisplayTime;e.has(this.container.beat.playbackStart)&&e.get(this.container.beat.playbackStart).has(this.container.beat.playbackDuration)&&e.get(this.container.beat.playbackStart).get(this.container.beat.playbackDuration)!==this.container.beat.id&&(this._skipPaint=!0)}}paint(e,t,r){this._skipPaint||super.paint(e,t,r)}doLayout(){let e=this.renderer;if(!this.container.beat.isEmpty)if(this.container.beat.isRest){let t=Math.ceil((this.renderer.bar.staff.standardNotationLineCount-1)/2)*2;this.container.beat.duration===_.Whole&&this.renderer.bar.staff.standardNotationLineCount!==1&&this.renderer.bar.staff.standardNotationLineCount!==3&&(t-=2);const r=new Qa(0,e.getScoreY(t),this.container.beat.duration);if(this.restGlyph=r,r.beat=this.container.beat,r.beamingHelper=this.beamingHelper,this.addGlyph(r),this.renderer.bar.isMultiVoice)if(this.container.beat.voice.index===0){const n=Tn.computeLineHeightsForRest(this.container.beat.duration);let s=r.y-e.getScoreHeight(n[0]),a=r.y+e.getScoreHeight(n[1]);this.renderer.helpers.collisionHelper.reserveBeatSlot(this.container.beat,s,a)}else this.renderer.helpers.collisionHelper.registerRest(this.container.beat);if(this.beamingHelper&&this.beamingHelper.applyRest(this.container.beat,t),this.container.beat.dots>0){this.addGlyph(new Qi(0,0,5*this.scale));for(let n=0;n<this.container.beat.dots;n++){let s=new Mn(0,0);s.renderer=this.renderer,this.createBeatDot(t,s),this.addGlyph(s)}}}else{const t=new iW;this.noteHeads=t,t.beat=this.container.beat,t.beamingHelper=this.beamingHelper;let r=new Wd(!1);r.renderer=this.renderer;for(let n of this.container.beat.notes)n.isVisible&&(this.createNoteGlyph(n),r.addParenthesis(n));if(this.addGlyph(t),r.isEmpty||(this.addGlyph(new Qi(0,0,4*(this.container.beat.graceType!==ce.None?ke.GraceScale:1)*this.scale)),this.addGlyph(r)),this.container.beat.hasWhammyBar){let n=new Va(this.container.beat);n.renderer=this.renderer,n.doLayout(),this.container.ties.push(n)}if(this.container.beat.dots>0){this.addGlyph(new Qi(0,0,5*this.scale));for(let n=0;n<this.container.beat.dots;n++){let s=new Mn(0,0);s.renderer=this.renderer;for(let a of this.container.beat.notes)this.createBeatDot(e.getNoteLine(a),s);this.addGlyph(s)}}}super.doLayout(),this.container.beat.isEmpty?this.centerX=this.width/2:this.container.beat.isRest?this.centerX=this.restGlyph.x+this.restGlyph.width/2:this.centerX=this.noteHeads.x+this.noteHeads.width/2}createBeatDot(e,t){let r=this.renderer;t.addGlyph(new zd(0,r.getScoreY(e),1.5*this.scale))}createNoteHeadGlyph(e){let t=this.container.beat.graceType!==ce.None;if(e.beat.voice.bar.staff.isPercussion){const r=At.getArticulation(e);if(r)return new rW(0,0,r,e.beat.duration,t);V.warning("Rendering",`No articulation found for percussion instrument ${e.percussionArticulation}`)}return e.isDead?new ZU(0,0,t):e.beat.graceType===ce.BendGrace?new ke(0,0,_.Quarter,!0):e.harmonicType===ne.Natural?new Ud(0,0,e.beat.duration,t):new ke(0,0,e.beat.duration,t)}createNoteGlyph(e){if(e.beat.graceType===ce.BendGrace&&!e.hasBend)return;let t=this.renderer,r=this.createNoteHeadGlyph(e),n=t.getNoteLine(e);if(r.y=t.getScoreY(n),this.noteHeads.addNoteGlyph(r,e,n),e.harmonicType!==ne.None&&e.harmonicType!==ne.Natural){let s=e.displayValue+e.harmonicPitch;r=new Ud(0,0,e.beat.duration,this.container.beat.graceType!==ce.None),n=t.accidentalHelper.getNoteLineForValue(s,!1),r.y=t.getScoreY(n),this.noteHeads.addNoteGlyph(r,e,n)}if(e.isStaccato&&!this.noteHeads.aboveBeatEffects.has("Staccato")&&this.noteHeads.belowBeatEffects.set("Staccato",new WS(0,0)),e.accentuated===jt.Normal&&!this.noteHeads.aboveBeatEffects.has("Accent")&&this.noteHeads.belowBeatEffects.set("Accent",new Hd(0,0,jt.Normal)),e.accentuated===jt.Heavy&&!this.noteHeads.aboveBeatEffects.has("HAccent")&&this.noteHeads.belowBeatEffects.set("HAccent",new Hd(0,0,jt.Heavy)),e.isPercussion){const s=At.getArticulation(e);if(s&&s.techniqueSymbolPlacement!==Se.Middle){const a=s.techniqueSymbolPlacement===Se.Top?this.noteHeads.aboveBeatEffects:this.noteHeads.belowBeatEffects;switch(s.techniqueSymbol){case w.PictEdgeOfCymbal:a.set("PictEdgeOfCymbal",new nW(0,0));break;case w.ArticStaccatoAbove:a.set("ArticStaccatoAbove",new WS(0,0));break;case w.StringsUpBow:a.set("StringsUpBow",new Ju(0,0,gi.Up));break;case w.StringsDownBow:a.set("StringsDownBow",new Ju(0,0,gi.Down));break;case w.GuitarGolpe:a.set("GuitarGolpe",new sW(0,0));break}}}}}class oW extends Mt{constructor(e){super(0,0),this._beat=e}doLayout(){this.width=this._beat.brushType===lt.ArpeggioUp||this._beat.brushType===lt.ArpeggioDown?10*this.scale:0}paint(e,t,r){if(this._beat.brushType===lt.ArpeggioUp||this._beat.brushType===lt.ArpeggioDown){let n=this.renderer,s=n.lineOffset,a=t+this.y+(n.getNoteY(this._beat.maxNote,te.Bottom)-s),o=t+this.y+n.getNoteY(this._beat.minNote,te.Top)+s,l=e+this.x+this.width/2,u=8*this.scale,c=new Ja(0,0,Ue.Slight,1.2,!0);c.renderer=this.renderer,c.doLayout();let h=-c.height/2;if(this._beat.brushType===lt.ArpeggioUp){let d=a+u,f=o-u;c.width=Math.abs(f-d),r.beginRotate(e+this.x+5*this.scale,f,-90),c.paint(0,h,r),r.endRotate(),r.beginPath(),r.moveTo(l,o),r.lineTo(l+u/2,o-u),r.lineTo(l-u/2,o-u),r.closePath(),r.fill()}else if(this._beat.brushType===lt.ArpeggioDown){let d=a+u,f=o;c.width=Math.abs(f-d),r.beginRotate(e+this.x+5*this.scale,d,90),c.paint(0,h,r),r.endRotate(),r.beginPath(),r.moveTo(l,a),r.lineTo(l+u/2,a+u),r.lineTo(l-u/2,a+u),r.closePath(),r.fill()}}}}class lW extends wc{get prebendNoteHeadOffset(){return this._prebends?this._prebends.x+this._prebends.noteHeadOffset:0}doLayout(){if(!this.container.beat.isRest){let e=new jB;e.renderer=this.renderer;let t=new Wd(!0);t.renderer=this.renderer;const r=new Ji(this.container.beat,!0);this._prebends=r,r.renderer=this.renderer;for(let n of this.container.beat.notes)if(n.isVisible){if(n.hasBend)switch(n.bendType){case ee.PrebendBend:case ee.Prebend:case ee.PrebendRelease:r.addGlyph(n.displayValue-(n.bendPoints[0].value/2|0),!1);break}else if(n.beat.hasWhammyBar)switch(n.beat.whammyBarType){case Ge.PrediveDive:case Ge.Predive:this._prebends.addGlyph(n.displayValue-(n.beat.whammyBarPoints[0].value/2|0),!1);break}this.createAccidentalGlyph(n,e),t.addParenthesis(n)}r.isEmpty||(this.addGlyph(r),this.addGlyph(new Qi(0,0,4*(this.container.beat.graceType!==ce.None?ke.GraceScale:1)*this.scale))),this.container.beat.brushType!==lt.None&&(this.addGlyph(new oW(this.container.beat)),this.addGlyph(new Qi(0,0,4*this.scale))),t.isEmpty||(this.addGlyph(t),this.addGlyph(new Qi(0,0,4*(this.container.beat.graceType!==ce.None?ke.GraceScale:1)*this.scale))),e.isEmpty||(this.accidentals=e,this.addGlyph(new Qi(0,0,2*(this.container.beat.graceType!==ce.None?ke.GraceScale:1)*this.scale)),this.addGlyph(e),this.addGlyph(new Qi(0,0,2*(this.container.beat.graceType!==ce.None?ke.GraceScale:1)*this.scale)))}super.doLayout()}createAccidentalGlyph(e,t){let r=this.renderer,n=r.accidentalHelper.applyAccidental(e),s=r.getNoteLine(e),a=this.container.beat.graceType!==ce.None;if(n!==Ye.None){let o=new ra(0,r.getScoreY(s),n,a);o.renderer=this.renderer,t.addGlyph(o)}if(e.harmonicType!==ne.None&&e.harmonicType!==ne.Natural){let o=e.displayValue+e.harmonicPitch;n=r.accidentalHelper.applyAccidentalForValue(e.beat,o,a,!1),s=r.accidentalHelper.getNoteLineForValue(o,!1);let l=new ra(0,r.getScoreY(s),n,a);l.renderer=this.renderer,t.addGlyph(l)}}constructor(){super(),this._prebends=null,this.accidentals=null}}class Z1 extends _t{constructor(e,t,r,n){super(e,t,n,Z1.getSymbol(r)),this._digit=0,this._scale=0,this._digit=r,this._scale=n}doLayout(){this.width=this.getDigitWidth(this._digit)*this.scale*this._scale}getDigitWidth(e){switch(e){case 0:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:return 14;case 1:return 10;default:return 0}}static getSymbol(e){switch(e){case 0:return w.TimeSig0;case 1:return w.TimeSig1;case 2:return w.TimeSig2;case 3:return w.TimeSig3;case 4:return w.TimeSig4;case 5:return w.TimeSig5;case 6:return w.TimeSig6;case 7:return w.TimeSig7;case 8:return w.TimeSig8;case 9:return w.TimeSig9;default:return w.None}}}class Hh extends Mn{constructor(e,t,r,n=1){super(e,t),this._number=0,this._scale=0,this._number=r,this._scale=n}doLayout(){let e=this._number;for(;e>0;){let t=e%10,r=new Z1(0,0,t,this._scale);this.addGlyph(r),e=e/10|0}if(this.glyphs){this.glyphs.reverse();let t=0;for(let r=0,n=this.glyphs.length;r<n;r++){let s=this.glyphs[r];s.x=t,s.y=0,s.renderer=this.renderer,s.doLayout(),t+=s.width}this.width=t}}}Hh.numberHeight=18;class YB extends Mn{constructor(e,t,r,n,s){super(e,t),this._numerator=0,this._denominator=0,this._numerator=r,this._denominator=n,this._isCommon=s}doLayout(){if(this._isCommon&&this._numerator===2&&this._denominator===2){let e=new _t(0,0,this.commonScale,w.TimeSigCutCommon);e.width=14*this.scale,this.addGlyph(e),super.doLayout()}else if(this._isCommon&&this._numerator===4&&this._denominator===4){let e=new _t(0,0,this.commonScale,w.TimeSigCommon);e.width=14*this.scale,this.addGlyph(e),super.doLayout()}else{const e=Hh.numberHeight*this.scale;let t=new Hh(0,-e/2,this._numerator,this.numberScale),r=new Hh(0,e/2,this._denominator,this.numberScale);this.addGlyph(t),this.addGlyph(r),super.doLayout();for(let n=0,s=this.glyphs.length;n<s;n++){let a=this.glyphs[n];a.x=(this.width-a.width)/2}}}}class uW extends YB{get commonScale(){return 1}get numberScale(){return 1}}class cW extends Q1{constructor(e){super(0,0),this._notes=[],this._endNoteGlyph=null,this._middleNoteGlyph=null,this._beat=e}addBends(e){if(this._notes.push(e),!e.isTieOrigin)switch(e.bendType){case ee.Bend:case ee.PrebendRelease:case ee.PrebendBend:{let t=this._endNoteGlyph;t||(t=new Ji(e.beat,!1),t.renderer=this.renderer,this._endNoteGlyph=t,this.BendNoteHeads.push(t));let r=e.bendPoints[e.bendPoints.length-1];t.addGlyph(this.getBendNoteValue(e,r),r.value%2!==0)}break;case ee.Release:if(!e.isTieOrigin){let t=this._endNoteGlyph;t||(t=new Ji(e.beat,!1),t.renderer=this.renderer,this._endNoteGlyph=t,this.BendNoteHeads.push(t));let r=e.bendPoints[e.bendPoints.length-1];t.addGlyph(this.getBendNoteValue(e,r),r.value%2!==0)}break;case ee.BendRelease:{let t=this._middleNoteGlyph;t||(t=new Ji(e.beat,!1),this._middleNoteGlyph=t,t.renderer=this.renderer,this.BendNoteHeads.push(t));let r=e.bendPoints[1];t.addGlyph(this.getBendNoteValue(e,e.bendPoints[1]),r.value%2!==0);let n=this._endNoteGlyph;n||(n=new Ji(e.beat,!1),n.renderer=this.renderer,this._endNoteGlyph=n,this.BendNoteHeads.push(n));let s=e.bendPoints[e.bendPoints.length-1];n.addGlyph(this.getBendNoteValue(e,s),s.value%2!==0)}break}}paint(e,t,r){let n=this.renderer.scoreRenderer.layout.getRendererForBar(this.renderer.staff.staveId,this._beat.voice.bar),s=e+n.x+n.getBeatX(this._beat,Oe.MiddleNotes),a=e+n.x;this._beat.isLastOfVoice?a+=n.postBeatGlyphsStart:a+=n.getBeatX(this._beat.nextBeat,Oe.PreNotes),a-=8*this.scale;let o=(s+a)/2;this._middleNoteGlyph&&(this._middleNoteGlyph.x=o-this._middleNoteGlyph.noteHeadOffset,this._middleNoteGlyph.y=t+n.y,this._middleNoteGlyph.paint(0,0,r)),this._endNoteGlyph&&(this._endNoteGlyph.x=a-this._endNoteGlyph.noteHeadOffset,this._endNoteGlyph.y=t+n.y,this._endNoteGlyph.paint(0,0,r)),this._notes.sort((c,h)=>h.displayValue-c.displayValue);let l=this._beat.graceType===ce.BendGrace?this._beat.nextBeat:this._beat,u=this._notes.length===1?this.getTieDirection(l,n):H.Up;for(let c=0;c<this._notes.length;c++){let h=this._notes[c];c>0&&c>=(this._notes.length/2|0)&&(u=H.Down);let d=t+n.y+n.getNoteY(h,te.Top),f=ke.NoteHeadHeight*this.scale*ke.GraceScale*.5;u===H.Down&&(d+=ke.NoteHeadHeight*this.scale);let p=h.bendStyle===Je.Gradual?"grad.":"";if(h.isTieOrigin){let g=h.tieDestination,y=g?this.renderer.scoreRenderer.layout.getRendererForBar(this.renderer.staff.staveId,g.beat.voice.bar):null;if(!y||y.staff!==n.staff){let b=e+n.x+n.width,m=h.tieDestination.realValue;n.accidentalHelper.applyAccidentalForValue(h.beat,m,!1,!0);let v=t+n.y+n.getScoreY(n.accidentalHelper.getNoteLineForValue(m,!1));h.bendType===ee.Hold||h.bendType===ee.Prebend?Qt.paintTie(r,this.scale,s,d,b,v,u===H.Down,22,4):this.drawBendSlur(r,s,d,b,v,u===H.Down,this.scale,p)}else{let b=e+y.x+y.getBeatX(g.beat,Oe.MiddleNotes),m=t+y.y+y.getNoteY(g,te.Top);u===H.Down&&(m+=ke.NoteHeadHeight*this.scale),h.bendType===ee.Hold||h.bendType===ee.Prebend?Qt.paintTie(r,this.scale,s,d,b,m,u===H.Down,22,4):this.drawBendSlur(r,s,d,b,m,u===H.Down,this.scale,p)}switch(h.bendType){case ee.Prebend:case ee.PrebendBend:case ee.PrebendRelease:let b=e+n.x+n.getBeatX(h.beat,Oe.PreNotes);b+=n.getPreNotesGlyphForBeat(h.beat).prebendNoteHeadOffset;let m=t+n.y+n.getScoreY(n.accidentalHelper.getNoteLineForValue(h.displayValue-(h.bendPoints[0].value/2|0),!1))+f;this.drawBendSlur(r,b,m,s,d,u===H.Down,this.scale);break}}else{u===H.Up&&(f=-f);let g=0,y=0;switch(h.bendType){case ee.Bend:g=this.getBendNoteValue(h,h.bendPoints[h.bendPoints.length-1]),y=this._endNoteGlyph.getNoteValueY(g)+f,this.drawBendSlur(r,s,d,a,y,u===H.Down,this.scale,p);break;case ee.BendRelease:let b=this.getBendNoteValue(h,h.bendPoints[1]),m=this._middleNoteGlyph.getNoteValueY(b)+f;this.drawBendSlur(r,s,d,o,m,u===H.Down,this.scale,p),g=this.getBendNoteValue(h,h.bendPoints[h.bendPoints.length-1]),y=this._endNoteGlyph.getNoteValueY(g)+f,this.drawBendSlur(r,o,m,a,y,u===H.Down,this.scale,p);break;case ee.Release:this.BendNoteHeads.length>0&&(g=this.getBendNoteValue(h,h.bendPoints[h.bendPoints.length-1]),y=this.BendNoteHeads[0].getNoteValueY(g)+f,this.drawBendSlur(r,s,d,a,y,u===H.Down,this.scale,p));break;case ee.Prebend:case ee.PrebendBend:case ee.PrebendRelease:let v=e+n.x+n.getBeatX(h.beat,Oe.PreNotes);v+=n.getPreNotesGlyphForBeat(h.beat).prebendNoteHeadOffset;let k=t+n.y+n.getScoreY(n.accidentalHelper.getNoteLineForValue(h.displayValue-(h.bendPoints[0].value/2|0),!1))+f;this.drawBendSlur(r,v,k,s,d,u===H.Down,this.scale),this.BendNoteHeads.length>0&&(g=this.getBendNoteValue(h,h.bendPoints[h.bendPoints.length-1]),y=this.BendNoteHeads[0].getNoteValueY(g)+f,this.drawBendSlur(r,s,d,a,y,u===H.Down,this.scale,p));break}}}}getBendNoteValue(e,t){return e.displayValueWithoutBend+(t.value/2|0)}}class x0 extends Qt{constructor(e,t,r=!1){super(e,t,r)}doLayout(){super.doLayout()}getBeamDirection(e,t){if(e.isRest)return H.Up;switch(t.getBeatDirection(e)){case H.Up:return H.Down;default:return H.Up}}getStartY(){if(this.startBeat.isRest)return this.startNoteRenderer.getScoreY(9);switch(this.tieDirection){case H.Up:return this.startNoteRenderer.getNoteY(this.startBeat.maxNote,te.Top);default:return this.startNoteRenderer.getNoteY(this.startBeat.minNote,te.Bottom)}}getEndY(){const e=this.endNoteRenderer;if(this.endBeat.isRest)switch(this.tieDirection){case H.Up:return e.getScoreY(9);default:return e.getScoreY(0)}const t=this.startNoteRenderer.getBeatDirection(this.startBeat),r=e.getBeatDirection(this.endBeat);if(t!==r&&this.startBeat.graceType===ce.None)if(r===this.tieDirection)switch(this.tieDirection){case H.Up:return e.getNoteY(this.endBeat.maxNote,te.TopWithStem);default:return e.getNoteY(this.endBeat.minNote,te.BottomWithStem)}else switch(this.tieDirection){case H.Up:return e.getNoteY(this.endBeat.maxNote,te.BottomWithStem);default:return e.getNoteY(this.endBeat.minNote,te.TopWithStem)}switch(this.tieDirection){case H.Up:return e.getNoteY(this.endBeat.maxNote,te.Top);default:return e.getNoteY(this.endBeat.minNote,te.Bottom)}}getStartX(){return this.startNoteRenderer.getBeatX(this.startBeat,Oe.MiddleNotes)}getEndX(){const e=this.endNoteRenderer.getBeatDirection(this.endBeat);return this.endNoteRenderer.getBeatX(this.endBeat,this.endBeat.duration>_.Whole&&e===this.tieDirection?Oe.Stem:Oe.MiddleNotes)}}class hW extends Mt{constructor(e,t,r,n){super(0,0),this._outType=t,this._inType=e,this._startNote=r,this._parent=n}doLayout(){this.width=0}paint(e,t,r){this.paintSlideIn(e,t,r),this.drawSlideOut(e,t,r)}paintSlideIn(e,t,r){let n=this.renderer,s=12*this.scale,a=e+n.x+n.getNoteX(this._startNote,ft.Left)-2*this.scale,o=t+n.y+n.getNoteY(this._startNote,te.Center),l=a-s,u=t+n.y;switch(this._inType){case ri.IntoFromBelow:u+=n.getNoteY(this._startNote,te.Bottom);break;case ri.IntoFromAbove:u+=n.getNoteY(this._startNote,te.Top);break;default:return}let c=this.getAccidentalsWidth(n,this._startNote.beat);l-=c,a-=c,this.paintSlideLine(r,!1,l,a,u,o)}getAccidentalsWidth(e,t){let r=e.getPreNotesGlyphForBeat(t);return r&&r.accidentals?r.accidentals.width:0}drawSlideOut(e,t,r){let n=this.renderer,s=12*this.scale,a=1*this.scale,o=2*this.scale,l=0,u=0,c=0,h=0,d=!1;switch(this._outType){case xe.Shift:case xe.Legato:if(l=e+n.x+n.getBeatX(this._startNote.beat,Oe.PostNotes),u=t+n.y+n.getNoteY(this._startNote,te.Center),this._startNote.slideTarget){let f=this.renderer.scoreRenderer.layout.getRendererForBar(this.renderer.staff.staveId,this._startNote.slideTarget.beat.voice.bar);!f||f.staff!==n.staff?(c=e+n.x+n.width,h=u):(c=e+f.x+f.getBeatX(this._startNote.slideTarget.beat,Oe.PreNotes)-a,h=t+f.y+f.getNoteY(this._startNote.slideTarget,te.Center)),this._startNote.slideTarget.realValue>this._startNote.realValue?(u+=o,h-=o):(u-=o,h+=o)}else c=e+n.x+this._parent.x,h=u;break;case xe.OutUp:l=e+n.x+n.getNoteX(this._startNote,ft.Right),u=t+n.y+n.getNoteY(this._startNote,te.Center),c=l+s,h=t+n.y+n.getNoteY(this._startNote,te.Top);break;case xe.OutDown:l=e+n.x+n.getNoteX(this._startNote,ft.Right),u=t+n.y+n.getNoteY(this._startNote,te.Center),c=l+s,h=t+n.y+n.getNoteY(this._startNote,te.Bottom);break;case xe.PickSlideUp:l=e+n.x+n.getNoteX(this._startNote,ft.Right),u=t+n.y+n.getNoteY(this._startNote,te.Center),h=t+n.y+n.getNoteY(this._startNote,te.Top),c=e+n.x+n.width,this._startNote.beat.nextBeat&&this._startNote.beat.nextBeat.voice===this._startNote.beat.voice&&(c=e+n.x+n.getBeatX(this._startNote.beat.nextBeat,Oe.PreNotes)),d=!0;break;case xe.PickSlideDown:l=e+n.x+n.getNoteX(this._startNote,ft.Right),u=t+n.y+n.getNoteY(this._startNote,te.Center),h=t+n.y+n.getNoteY(this._startNote,te.Bottom),c=e+n.x+n.width,this._startNote.beat.nextBeat&&this._startNote.beat.nextBeat.voice===this._startNote.beat.voice&&(c=e+n.x+n.getBeatX(this._startNote.beat.nextBeat,Oe.PreNotes)),d=!0;break;default:return}this.paintSlideLine(r,d,l,c,u,h)}paintSlideLine(e,t,r,n,s,a){if(t){let o=new Ja(0,0,Ue.Slight,1.2);o.renderer=this.renderer,o.doLayout(),s-=o.height/2,a-=o.height/2;let l=n-r,u=a-s,c=Math.sqrt(Math.pow(u,2)+Math.pow(l,2));o.width=l;let h=Math.asin(u/c)*(180/Math.PI);e.beginRotate(r,s,h),o.paint(0,0,e),e.endRotate()}else e.beginPath(),e.moveTo(r,s),e.lineTo(n,a),e.stroke()}}class hh extends x0{constructor(e,t,r=!1){super(e.beat,t.beat,r),this._startNote=e,this._endNote=t}getTieHeight(e,t,r,n){return Math.log2(r-e+1)*this.renderer.settings.notation.slurHeight}getStartY(){if(this.isStartCentered())switch(this.tieDirection){case H.Up:return this.startNoteRenderer.getNoteY(this._startNote,te.Top);default:return this.startNoteRenderer.getNoteY(this._startNote,te.Bottom)}return this.startNoteRenderer.getNoteY(this._startNote,te.Center)}getEndY(){if(this.isEndCentered())if(this.isEndOnStem())switch(this.tieDirection){case H.Up:return this.endNoteRenderer.getNoteY(this._endNote,te.TopWithStem);default:return this.endNoteRenderer.getNoteY(this._endNote,te.BottomWithStem)}else switch(this.tieDirection){case H.Up:return this.endNoteRenderer.getNoteY(this._endNote,te.Top);default:return this.endNoteRenderer.getNoteY(this._endNote,te.Bottom)}else return this.endNoteRenderer.getNoteY(this._endNote,te.Center)}isStartCentered(){return this._startNote===this._startNote.beat.maxNote&&this.tieDirection===H.Up||this._startNote===this._startNote.beat.minNote&&this.tieDirection===H.Down}isEndCentered(){return this._startNote.beat.graceType===ce.None&&(this._endNote===this._endNote.beat.maxNote&&this.tieDirection===H.Up||this._endNote===this._endNote.beat.minNote&&this.tieDirection===H.Down)}isEndOnStem(){const e=this.endNoteRenderer,t=this.startNoteRenderer.getBeatDirection(this.startBeat),r=e.getBeatDirection(this.endBeat);return t!==r&&this.startBeat.graceType===ce.None}getStartX(){return this.isStartCentered()?this.startNoteRenderer.getBeatX(this._startNote.beat,Oe.MiddleNotes):this.startNoteRenderer.getNoteX(this._startNote,ft.Right)}getEndX(){return this.isEndCentered()?this.isEndOnStem()?this.endNoteRenderer.getBeatX(this._endNote.beat,Oe.Stem):this.endNoteRenderer.getNoteX(this._endNote,ft.Center):this.endNoteRenderer.getBeatX(this._endNote.beat,Oe.PreNotes)}}class GS extends Qt{constructor(e,t,r=!1){super(e?e.beat:null,t?t.beat:null,r),this.startNote=e,this.endNote=t}shouldDrawBendSlur(){return this.renderer.settings.notation.extendBendArrowsOnTiedNotes&&!!this.startNote.bendOrigin&&this.startNote.isTieOrigin}doLayout(){super.doLayout()}getBeamDirection(e,t){switch(t.getBeatDirection(e)){case H.Up:return H.Down;default:return H.Up}}getStartY(){if(this.startBeat.isRest)return this.startNoteRenderer.getScoreY(9);switch(this.tieDirection){case H.Up:return this.startNoteRenderer.getNoteY(this.startNote,te.Top);default:return this.startNoteRenderer.getNoteY(this.startNote,te.Bottom)}}getEndY(){const e=this.endNoteRenderer;if(this.endBeat.isRest)switch(this.tieDirection){case H.Up:return e.getScoreY(9);default:return e.getScoreY(0)}switch(this.tieDirection){case H.Up:return e.getNoteY(this.endNote,te.Top);default:return e.getNoteY(this.endNote,te.Bottom)}}getStartX(){return this.startNoteRenderer.getBeatX(this.startNote.beat,Oe.PostNotes)}getEndX(){return this.endNoteRenderer.getBeatX(this.endNote.beat,Oe.PreNotes)}}class dW extends tn{constructor(e,t){super(e,t),this._bend=null,this._effectSlur=null,this._effectEndSlur=null}doLayout(){if(this._effectSlur=null,this._effectEndSlur=null,super.doLayout(),this.beat.isLegatoOrigin){if(!this.beat.previousBeat||!this.beat.previousBeat.isLegatoOrigin){let e=this.beat.nextBeat;for(;e.nextBeat&&e.nextBeat.isLegatoDestination;)e=e.nextBeat;this.addTie(new x0(this.beat,e,!1))}}else if(this.beat.isLegatoDestination&&!this.beat.isLegatoOrigin){let e=this.beat.previousBeat;for(;e.previousBeat&&e.previousBeat.isLegatoOrigin;)e=e.previousBeat;this.addTie(new x0(e,this.beat,!0))}this._bend&&(this._bend.renderer=this.renderer,this._bend.doLayout(),this.updateWidth())}createTies(e){if(e.isVisible){if(e.isTieOrigin&&!e.hasBend&&!e.beat.hasWhammyBar&&e.beat.graceType!==ce.BendGrace&&e.tieDestination&&e.tieDestination.isVisible){let t=new GS(e,e.tieDestination,!1);this.addTie(t)}if(e.isTieDestination&&!e.tieOrigin.hasBend&&!e.beat.hasWhammyBar){let t=new GS(e.tieOrigin,e,!0);this.addTie(t)}if(e.slideInType!==ri.None||e.slideOutType!==xe.None){let t=new hW(e.slideInType,e.slideOutType,e,this);this.addTie(t)}if(e.isSlurOrigin&&e.slurDestination&&e.slurDestination.isVisible){let t=new hh(e,e.slurDestination,!1);this.addTie(t)}if(e.isSlurDestination){let t=new hh(e.slurOrigin,e,!0);this.addTie(t)}if(!this._effectSlur&&e.isEffectSlurOrigin&&e.effectSlurDestination){const t=new hh(e,e.effectSlurDestination,!1);this._effectSlur=t,this.addTie(t)}if(!this._effectEndSlur&&e.beat.isEffectSlurDestination&&e.beat.effectSlurOrigin){let t=this.onNotes.beamingHelper.direction,r=t===H.Up?e.beat.effectSlurOrigin.minNote:e.beat.effectSlurOrigin.maxNote,n=t===H.Up?e.beat.minNote:e.beat.maxNote;const s=new hh(r,n,!0);this._effectEndSlur=s,this.addTie(s)}if(e.hasBend){if(!this._bend){const t=new cW(e.beat);this._bend=t,t.renderer=this.renderer,this.addTie(t)}this._bend.addBends(e)}}}}class fW extends Mt{constructor(e,t,r,n){super(e,t),this._dotOffset=0,this._circleSize=0,this._dotOffset=0,this._circleSize=0,this._dotOffset=n,this._circleSize=r}doLayout(){this.width=13*this.scale}paint(e,t,r){let n=4*this.scale,s=t+this.y+this.renderer.topPadding,a=t+this.y+this.renderer.height-this.renderer.bottomPadding,o=e+this.x+.5,l=a-s;r.fillRect(o,s,n,l),o+=n*2-.5,r.beginPath(),r.moveTo(o,s),r.lineTo(o,a),r.stroke(),o+=3*this.scale;let u=this._circleSize*this.scale,c=(s+a)/2;r.fillCircle(o,c-u*this._dotOffset,u),r.fillCircle(o,c+u*this._dotOffset,u)}}class pW extends Mt{constructor(e,t){super(e,t)}doLayout(){this.renderer.isLast?this.width=15*this.scale:!this.renderer.nextRenderer||this.renderer.nextRenderer.staff!==this.renderer.staff||!this.renderer.nextRenderer.bar.masterBar.isRepeatStart?(this.width=2*this.scale,this.renderer.bar.masterBar.isDoubleBar&&(this.width+=2*this.scale)):this.width=2*this.scale}paint(e,t,r){let n=4*this.scale,s=t+this.y+this.renderer.topPadding,a=t+this.y+this.renderer.height-this.renderer.bottomPadding,o=e+this.x,l=a-s;this.renderer.isLast?(r.fillRect(o+this.width-n-n,s,this.scale,l),r.fillRect(o+this.width-n,s,n,l)):(!this.renderer.nextRenderer||this.renderer.nextRenderer.staff!==this.renderer.staff||!this.renderer.nextRenderer.bar.masterBar.isRepeatStart)&&(r.fillRect(o+this.width-this.scale,s,this.scale,l),this.renderer.bar.masterBar.isDoubleBar&&r.fillRect(o+this.width-5*this.scale,s,this.scale,l))}}class gW extends Mt{constructor(e,t){super(e,t)}doLayout(){this.width=11*this.scale}paint(e,t,r){let n=4*this.scale,s=t+this.y+this.renderer.topPadding,a=t+this.y+this.renderer.height-this.renderer.bottomPadding,o=e+this.x,l=a-s,u=1.5*this.scale,c=(s+a)/2,h=3;r.fillCircle(o,c-u*h,u),r.fillCircle(o,c+u*h,u),o+=4*this.scale,r.beginPath(),r.moveTo(o,s),r.lineTo(o,a),r.stroke(),o+=3*this.scale+.5,r.fillRect(o,s,n,l)}}class mW extends Mt{constructor(e,t,r){super(e,t),this._count=0,this._count=0,this._count=r}doLayout(){this.width=0}paint(e,t,r){let n=this.renderer.resources,s=r.textAlign;r.font=n.barNumberFont,r.textAlign=ue.Right;let a="x"+this._count,o=r.measureText(a).width/1.5;r.fillText(a,e+this.x-o,t+this.y),r.textAlign=s}}class yW extends Mt{constructor(e,t,r){super(e,t),this._number=0,this._number=r}doLayout(){this.renderer.scoreRenderer.canvas.font=this.renderer.resources.barNumberFont,this.width=this.renderer.scoreRenderer.canvas.measureText(this._number.toString()).width+5*this.scale}paint(e,t,r){if(!this.renderer.staff.isFirstInAccolade)return;let n=this.renderer.resources,s=r.color;const a=r.textBaseline;r.textBaseline=Se.Top,r.color=n.barNumberColor,r.font=n.barNumberFont,r.fillText(this._number.toString(),e+this.x,t+this.y),r.color=s,r.textBaseline=a}}class ol extends xt{constructor(e,t){super(e,t),this.firstLineY=0,this._startSpacing=!1,this.tupletSize=0}get lineOffset(){return(this.lineSpacing+1)*this.scale}get topGlyphOverflow(){const e=this.resources;return(e.tablatureFont.size/2+e.tablatureFont.size*.2)*this.scale}get bottomGlyphOverflow(){const e=this.resources;return(e.tablatureFont.size/2+e.tablatureFont.size*.2)*this.scale}initLineBasedSizes(){this.topPadding=this.topGlyphOverflow,this.bottomPadding=this.bottomGlyphOverflow,this.height=this.lineOffset*(this.heightLineCount-1)+this.topPadding+this.bottomPadding}updateSizes(){this.initLineBasedSizes(),this.adjustSizes(),this.updateFirstLineY(),super.updateSizes()}adjustSizes(){}updateFirstLineY(){let e=this.lineOffset*(this.heightLineCount-1),t=(this.drawnLineCount-1)*this.lineOffset;this.firstLineY=this.topPadding+(e-t)/2}doLayout(){this.initLineBasedSizes(),this.updateFirstLineY(),this.tupletSize=15*this.scale+this.resources.effectFont.size*.3,super.doLayout()}getLineY(e){return this.firstLineY+this.getLineHeight(e)}getLineHeight(e){return this.lineOffset*e}paintBackground(e,t,r){super.paintBackground(e,t,r);const n=this.resources;r.color=n.staffLineColor;const s=[];for(let a=0,o=this.drawnLineCount;a<o;a++)s.push([]);this.collectSpaces(s);for(const a of s)a.sort((o,l)=>o[0]>l[0]?1:o[0]<l[0]?-1:0);for(let a=0;a<this.drawnLineCount;a++){const o=this.getLineY(a);let l=0;for(let u of s[a])r.fillRect(e+this.x+l,t+this.y+o|0,u[0]-l,this.scale*xt.StaffLineThickness),l=u[0]+u[1];r.fillRect(e+this.x+l,t+this.y+o|0,this.width-l,this.scale*xt.StaffLineThickness)}r.color=n.mainGlyphColor,this.paintSimileMark(e,t,r)}collectSpaces(e){}createStartSpacing(){this._startSpacing||(this.addPreBeatGlyph(new Qi(0,0,2*this.scale)),this._startSpacing=!0)}paintTuplets(e,t,r){for(const n of this.bar.voices)if(this.hasVoiceContainer(n)){const s=this.getVoiceContainer(n);for(const a of s.tupletGroups)this.paintTupletHelper(e+this.beatGlyphsStart,t,r,a)}}paintTupletHelper(e,t,r,n){const s=this.resources;let a=r.textAlign,o=r.textBaseline;r.color=n.voice.index===0?this.resources.mainGlyphColor:this.resources.secondaryGlyphColor,r.textAlign=ue.Center,r.textBaseline=Se.Middle;let l,u=n.beats[0].tupletNumerator,c=n.beats[0].tupletDenominator;u===2&&c===3?l="2":u===3&&c===2?l="3":u===4&&c===6?l="4":u===5&&c===4?l="5":u===6&&c===4?l="6":u===7&&c===4?l="7":u===9&&c===8?l="9":u===10&&c===8?l="10":u===11&&c===8?l="11":u===12&&c===8?l="12":u===13&&c===8?l="13":l=u+":"+c;let h=10*this.scale,d=5*this.scale;if(n.beats.length===1||!n.isFull)for(const f of n.beats){let p=this.helpers.beamHelperLookup[n.voice.index].get(f.index);if(!p)continue;let g=this.getBeamDirection(p),y=p.getBeatLineX(f),b=this.calculateBeamYWithDirection(p,y,g);g===H.Down?b+=h+d:b-=h+d,r.font=s.effectFont,r.fillText(l,e+this.x+y,t+this.y+b)}else{let f=n.beats[0],p=n.beats[n.beats.length-1],g=null,y=null;for(let ge=0;ge<n.beats.length;ge++)if(!n.beats[ge].isRest){g=n.beats[ge];break}for(let ge=n.beats.length-1;ge>=0;ge--)if(!n.beats[ge].isRest){y=n.beats[ge];break}let b=!1;g||(g=f,b=!0),y||(y=p);let m=this.helpers.beamHelperLookup[n.voice.index].get(f.index),v=this.helpers.beamHelperLookup[n.voice.index].get(p.index),k=m.getBeatLineX(f),x=v.getBeatLineX(p),C=this.helpers.beamHelperLookup[n.voice.index].get(g.index),N=this.helpers.beamHelperLookup[n.voice.index].get(y.index),B=this.getBeamDirection(m),E=this.calculateBeamYWithDirection(C,k,B),O=this.calculateBeamYWithDirection(N,x,B);b&&(E=Math.max(E,O),O=E),r.font=s.effectFont;let z=r.measureText(l).width,J=3*this.scale,he=(k+x)/2,oe=he-z/2-J,ye=he+z/2+J,se=(O-E)/(x-k),K=E-se*k,U=se*oe+K,Z=se*he+K,re=se*ye+K;B===H.Down&&(h*=-1,d*=-1),r.beginPath(),r.moveTo(e+this.x+k,t+this.y+E-h|0),r.lineTo(e+this.x+k,t+this.y+E-h-d|0),r.lineTo(e+this.x+oe,t+this.y+U-h-d|0),r.stroke(),r.beginPath(),r.moveTo(e+this.x+ye,t+this.y+re-h-d|0),r.lineTo(e+this.x+x,t+this.y+O-h-d|0),r.lineTo(e+this.x+x,t+this.y+O-h|0),r.stroke(),r.fillText(l,e+this.x+he,t+this.y+Z-h-d)}r.textAlign=a,r.textBaseline=o}paintBeams(e,t,r){for(const n of this.helpers.beamHelpers)for(const s of n)this.paintBeamHelper(e+this.beatGlyphsStart,t,r,s)}drawBeamHelperAsFlags(e){return e.beats.length===1}paintBeamHelper(e,t,r,n){r.color=n.voice.index===0?this.resources.mainGlyphColor:this.resources.secondaryGlyphColor,n.isRestBeamHelper||(this.drawBeamHelperAsFlags(n)?this.paintFlag(e,t,r,n):this.paintBar(e,t,r,n))}shouldPaintFlag(e,t){return!(e.graceType===ce.BendGrace||!t.hasBeatLineX(e)||e.graceType!==ce.None&&this.settings.notation.notationMode===Zt.SongBook||e.duration===_.Whole||e.duration===_.DoubleWhole||e.duration===_.QuadrupleWhole)}paintFlag(e,t,r,n){for(const s of n.beats){if(!this.shouldPaintFlag(s,n))continue;let a=s.graceType!==ce.None,o=a?ke.GraceScale:1,l=this.getFlagStemSize(n.shortestDuration),u=n.getBeatLineX(s),c=this.getBeamDirection(n),h=this.getFlagTopY(s),d=this.getFlagBottomY(s),f=0,p=0;if(c===H.Down?(d+=l*o,f=d,p=t+this.y+d):(h-=l*o,f=h,p=t+this.y+h),this.paintFingering(r,s,e+this.x+u,c,p),!!n.hasLine(!0,s)){if(this.paintBeamingStem(s,t+this.y,e+this.x+u,t+this.y+h,t+this.y+d,r),s.graceType===ce.BeforeBeat){let g=15*this.scale,y=12*this.scale;r.beginPath(),c===H.Down?(r.moveTo(e+this.x+u-y/2,t+this.y+d-g),r.lineTo(e+this.x+u+y/2,t+this.y+d)):(r.moveTo(e+this.x+u-y/2,t+this.y+h+g),r.lineTo(e+this.x+u+y/2,t+this.y+h)),r.stroke()}if(n.hasFlag(!0,s)){let g=new bc(u-this.scale/2,f,s.duration,c,a);g.renderer=this,g.doLayout(),g.paint(e+this.x,t+this.y,r)}}}}paintFingering(e,t,r,n,s){let a=this.settings;if(a.notation.fingeringMode!==En.ScoreDefault&&a.notation.fingeringMode!==En.ScoreForcePiano)return;n===H.Up?r-=10*this.scale:r+=3*this.scale;let o=t.notes.slice(0);o.sort((l,u)=>l.realValue-u.realValue);for(let l=0;l<o.length;l++){let u=o[l],c=null;u.leftHandFinger!==be.Unknown?c=ct.fingerToString(a,t,u.leftHandFinger,!0):u.rightHandFinger!==be.Unknown&&(c=ct.fingerToString(a,t,u.rightHandFinger,!1)),c&&(e.fillText(c,r,s),s-=e.font.size|0)}}getFlagStemSize(e){let t=0;switch(e){case _.QuadrupleWhole:case _.Half:case _.Quarter:case _.Eighth:case _.Sixteenth:case _.ThirtySecond:case _.SixtyFourth:case _.OneHundredTwentyEighth:case _.TwoHundredFiftySixth:t=3;break;default:t=0;break}return this.getLineHeight(t)}calculateBeamY(e,t){return this.calculateBeamYWithDirection(e,t,this.getBeamDirection(e))}createPreBeatGlyphs(){super.createPreBeatGlyphs(),this.bar.masterBar.isRepeatStart&&this.addPreBeatGlyph(new fW(0,0,1.5,3)),this.createLinePreBeatGlyphs(),this.addPreBeatGlyph(new yW(0,this.getLineHeight(-.25),this.bar.index+1))}createPostBeatGlyphs(){super.createPostBeatGlyphs(),this.bar.masterBar.isRepeatEnd?(this.addPostBeatGlyph(new gW(this.x,0)),this.bar.masterBar.repeatCount>2&&this.addPostBeatGlyph(new mW(0,this.getLineHeight(-.25),this.bar.masterBar.repeatCount))):this.addPostBeatGlyph(new pW(0,0))}paintBar(e,t,r,n){for(let s=0,a=n.beats.length;s<a;s++){let o=n.beats[s];if(!n.hasBeatLineX(o))continue;let u=o.graceType!==ce.None?ke.GraceScale:1,c=n.getBeatLineX(o),h=this.getBeamDirection(n),d=t+this.y+this.getBarLineStart(o,h),f=t+this.y+this.calculateBeamY(n,c);this.paintBeamingStem(o,t+this.y,e+this.x+c,d,f,r);let p=f;h===H.Down?p+=r.font.size*2:s!==0&&(p-=r.font.size*1.5),this.paintFingering(r,o,e+this.x+c,h,p);let g=6*this.scale*u,y=(xt.BeamSpacing+xt.BeamThickness)*this.scale*u,b=xt.BeamThickness*this.scale*u,m=ct.getIndex(o.duration)-2,v=t+this.y;h===H.Down&&(y=-y,b=-b);for(let k=0;k<m;k++){let x=0,C=0,N=0,B=0,E=v+k*y;if(s<n.beats.length-1){if(Tn.isFullBarJoin(o,n.beats[s+1],k))x=c,C=n.getBeatLineX(n.beats[s+1]);else if(s===0||!Tn.isFullBarJoin(n.beats[s-1],o,k))x=c,C=x+g;else continue;N=E+this.calculateBeamY(n,x),B=E+this.calculateBeamY(n,C),ol.paintSingleBar(r,e+this.x+x,N,e+this.x+C,B,b)}else s>0&&!Tn.isFullBarJoin(o,n.beats[s-1],k)&&(x=c-g,C=c,N=E+this.calculateBeamY(n,x),B=E+this.calculateBeamY(n,C),ol.paintSingleBar(r,e+this.x+x,N,e+this.x+C,B,b))}}}static paintSingleBar(e,t,r,n,s,a){e.beginPath(),e.moveTo(t,r),e.lineTo(n,s),e.lineTo(n,s+a),e.lineTo(t,r+a),e.closePath(),e.fill()}}class jn extends ol{constructor(e,t){super(e,t),this.simpleWhammyOverflow=0,this.accidentalHelper=new Dt(this)}get lineSpacing(){return xt.RawLineSpacing}get heightLineCount(){return 5}get drawnLineCount(){return this.bar.staff.standardNotationLineCount}getScoreY(e){return super.getLineY(e/2)}getScoreHeight(e){return super.getLineHeight(e/2)}doLayout(){if(super.doLayout(),!this.bar.isEmpty&&this.accidentalHelper.maxLineBeat){let e=this.getScoreY(-2),t=this.getScoreY(10),r=this.simpleWhammyOverflow;this.registerOverflowTop(r);let n=this.getScoreY(this.accidentalHelper.maxLine),s=this.helpers.getBeamingHelperForBeat(this.accidentalHelper.maxLineBeat);s.direction===H.Up&&(n-=this.getStemSize(s),n-=s.fingeringCount*this.resources.graceFont.size,s.hasTuplet&&(n-=this.tupletSize)),n<e&&this.registerOverflowTop(Math.abs(n)+r);let a=this.getScoreY(this.accidentalHelper.minLine),o=this.helpers.getBeamingHelperForBeat(this.accidentalHelper.minLineBeat);o.direction===H.Down&&(a+=this.getStemSize(o),a+=o.fingeringCount*this.resources.graceFont.size,o.hasTuplet&&(a+=this.tupletSize)),a>t&&this.registerOverflowBottom(Math.abs(a)-t)}}paint(e,t,r){super.paint(e,t,r),this.paintBeams(e,t,r),this.paintTuplets(e,t,r)}getFlagTopY(e){return this.getScoreY(this.accidentalHelper.getMinLine(e))}getFlagBottomY(e){return this.getScoreY(this.accidentalHelper.getMaxLine(e))}getBeamDirection(e){return e.direction}getStemSize(e){let t=e.beats.length===1?this.getFlagStemSize(e.shortestDuration):this.getBarStemSize(e.shortestDuration);return e.isGrace&&(t=t*ke.GraceScale),t}getBarStemSize(e){let t=0;switch(e){case _.QuadrupleWhole:case _.Half:case _.Quarter:case _.Eighth:case _.Sixteenth:t=6;break;case _.ThirtySecond:t=8;break;case _.SixtyFourth:t=9;break;case _.OneHundredTwentyEighth:t=9;break;case _.TwoHundredFiftySixth:t=10;break;default:t=0;break}return this.getScoreHeight(t)}get middleYPosition(){return this.getScoreY(this.bar.staff.standardNotationLineCount-1)}getNoteY(e,t){let r=super.getNoteY(e,t);if(isNaN(r)){const n=Dt.computeLineWithoutAccidentals(this.bar,e);r=this.getScoreY(n)}return r}applyLayoutingInfo(){const e=super.applyLayoutingInfo();if(e&&this.bar.isMultiVoice){let t=this.getScoreY(-2),r=this.getScoreY(10),n=this.helpers.collisionHelper.getBeatMinMaxY();n[0]<t&&this.registerOverflowTop(Math.abs(n[0])),n[1]>r&&this.registerOverflowBottom(Math.abs(n[1])-r)}return e}calculateBeamYWithDirection(e,t,r){let n=this.getStemSize(e);if(!e.drawingInfos.has(r)){let s=new RU;e.drawingInfos.set(r,s);const a=e.beats[0],o=e.beats[e.beats.length-1];let l=e.isRestBeamHelper;s.startBeat=a,s.startX=e.getBeatLineX(a),l?s.startY=r===H.Up?this.getScoreY(e.minRestLine):this.getScoreY(e.maxRestLine):s.startY=r===H.Up?this.getScoreY(this.accidentalHelper.getMinLine(a))-n:this.getScoreY(this.accidentalHelper.getMaxLine(a))+n,s.endBeat=o,s.endX=e.getBeatLineX(o),l?s.endY=r===H.Up?this.getScoreY(e.minRestLine):this.getScoreY(e.maxRestLine):s.endY=r===H.Up?this.getScoreY(this.accidentalHelper.getMinLine(o))-n:this.getScoreY(this.accidentalHelper.getMaxLine(o))+n;let u=10*this.scale;if(r===H.Down&&s.startY>s.endY&&s.startY-s.endY>u&&(s.endY=s.startY-u),r===H.Down&&s.endY>s.startY&&s.endY-s.startY>u&&(s.startY=s.endY-u),r===H.Up&&s.startY<s.endY&&s.endY-s.startY>u&&(s.endY=s.startY+u),r===H.Up&&s.endY<s.startY&&s.startY-s.endY>u&&(s.startY=s.endY+u),e.beats.length>1){if(r===H.Up){let c=this.getScoreY(this.accidentalHelper.getMinLine(e.beatOfHighestNote))-n;const d=s.calcY(e.getBeatLineX(e.beatOfHighestNote))-c;d>0&&(s.startY-=d,s.endY-=d)}else{let c=this.getScoreY(this.accidentalHelper.getMaxLine(e.beatOfLowestNote))+n;const h=s.calcY(e.getBeatLineX(e.beatOfLowestNote)),d=c-h;d>0&&(s.startY+=d,s.endY+=d)}if(e.minRestLine!==null||e.maxRestLine!==null){const c=ct.getIndex(e.shortestDuration)-2;let h=e.isGrace?ke.GraceScale:1,d=c*(xt.BeamSpacing+xt.BeamThickness)*this.scale*h;if(d+=xt.BeamSpacing,r===H.Up&&e.minRestLine!==null){let f=this.getScoreY(e.minRestLine)-d;const g=s.calcY(e.getBeatLineX(e.beatOfMinRestLine))-f;g>0&&(s.startY-=g,s.endY-=g)}else if(r===H.Down&&e.maxRestLine!==null){let f=this.getScoreY(e.maxRestLine)+d;const p=s.calcY(e.getBeatLineX(e.beatOfMaxRestLine)),g=f-p;g>0&&(s.startY+=g,s.endY+=g)}}}}return e.drawingInfos.get(r).calcY(t)}getBarLineStart(e,t){return t===H.Up?this.getScoreY(this.accidentalHelper.getMaxLine(e)):this.getScoreY(this.accidentalHelper.getMinLine(e))}createLinePreBeatGlyphs(){if(this.isFirstOfLine||this.bar.clef!==this.bar.previousBar.clef||this.bar.clefOttava!==this.bar.previousBar.clefOttava){let e=0;switch(this.bar.clef){case ve.Neutral:e=this.bar.staff.standardNotationLineCount-1;break;case ve.F4:e=2;break;case ve.C3:e=4;break;case ve.C4:e=2;break;case ve.G2:e=6;break}this.createStartSpacing(),this.addPreBeatGlyph(new J1(0,this.getScoreY(e)+.5*xt.StaffLineThickness,this.bar.clef,this.bar.clefOttava))}(this.index===0&&this.bar.masterBar.keySignature!==qt.C||this.bar.previousBar&&this.bar.masterBar.keySignature!==this.bar.previousBar.masterBar.keySignature)&&(this.createStartSpacing(),this.createKeySignatureGlyphs()),(!this.bar.previousBar||this.bar.previousBar&&this.bar.masterBar.timeSignatureNumerator!==this.bar.previousBar.masterBar.timeSignatureNumerator||this.bar.previousBar&&this.bar.masterBar.timeSignatureDenominator!==this.bar.previousBar.masterBar.timeSignatureDenominator)&&(this.createStartSpacing(),this.createTimeSignatureGlyphs())}createKeySignatureGlyphs(){let e=0,t=this.bar.masterBar.keySignature,r=this.bar.previousBar?this.bar.previousBar.masterBar.keySignature:0;switch(this.bar.clef){case ve.Neutral:e=0;break;case ve.G2:e=1;break;case ve.F4:e=3;break;case ve.C3:e=2;break;case ve.C4:e=0;break}let n=new Map,s=[];if(ct.keySignatureIsSharp(t))for(let l=0;l<Math.abs(t);l++){let u=jn.SharpKsSteps[l]+e;s.push(new ra(0,this.getScoreY(u),Ye.Sharp,!1)),n.set(u,!0)}else for(let l=0;l<Math.abs(t);l++){let u=jn.FlatKsSteps[l]+e;s.push(new ra(0,this.getScoreY(u),Ye.Flat,!1)),n.set(u,!0)}let a=Math.abs(r),o=ct.keySignatureIsSharp(r)?jn.SharpKsSteps:jn.FlatKsSteps;for(let l=0;l<a;l++){let u=o[l]+e;n.has(u)||this.addPreBeatGlyph(new ra(0,this.getScoreY(o[l]+e),Ye.Natural,!1))}for(let l of s)this.addPreBeatGlyph(l)}createTimeSignatureGlyphs(){this.addPreBeatGlyph(new Qi(0,0,5*this.scale));const e=this.bar.staff.standardNotationLineCount-1;this.addPreBeatGlyph(new uW(0,this.getScoreY(e),this.bar.masterBar.timeSignatureNumerator,this.bar.masterBar.timeSignatureDenominator,this.bar.masterBar.timeSignatureCommon))}createVoiceGlyphs(e){for(const t of e.beats){let r=new dW(t,this.getVoiceContainer(e));r.preNotes=new lW,r.onNotes=new aW,this.addBeatGlyph(r)}}getNoteLine(e){return this.accidentalHelper.getNoteLine(e)}completeBeamingHelper(e){if(this.bar.isMultiVoice&&e.highestNoteInHelper&&e.lowestNoteInHelper){let t=this.getNoteY(e.highestNoteInHelper,te.Center),r=this.getNoteY(e.lowestNoteInHelper,te.Center),n=this.getStemSize(e);e.hasTuplet&&(n+=this.resources.effectFont.size*2),e.direction==H.Up?t-=n:r+=n;for(const s of e.beats)this.helpers.collisionHelper.reserveBeatSlot(s,t,r)}}paintBeamingStem(e,t,r,n,s,a){a.lineWidth=xt.StemWidth*this.scale,a.beginPath(),a.moveTo(r,n),a.lineTo(r,s),a.stroke(),a.lineWidth=this.scale}}jn.StaffId="score";jn.SharpKsSteps=[-1,2,-2,1,4,0,3];jn.FlatKsSteps=[3,0,4,1,5,2,6];class $S extends gp{get staffId(){return jn.StaffId}getStaffPaddingTop(e){return e.system.layout.renderer.settings.display.notationStaffPaddingTop}getStaffPaddingBottom(e){return e.system.layout.renderer.settings.display.notationStaffPaddingBottom}create(e,t){return new jn(e,t)}constructor(){super()}}class bW extends Mt{constructor(e,t,r,n){super(0,0),this._inType=e,this._outType=t,this._startNote=r,this._parent=n}doLayout(){this.width=0}paint(e,t,r){this.paintSlideIn(e,t,r),this.paintSlideOut(e,t,r)}paintSlideIn(e,t,r){let n=this.renderer,s=12*this.scale,a=3*this.scale,o=0,l=0,u=0,c=0;switch(this._inType){case ri.IntoFromBelow:u=e+n.x+n.getNoteX(this._startNote,ft.Left),c=t+n.y+n.getNoteY(this._startNote,te.Center),o=u-s,l=t+n.y+n.getNoteY(this._startNote,te.Center)+a;break;case ri.IntoFromAbove:u=e+n.x+n.getNoteX(this._startNote,ft.Left),c=t+n.y+n.getNoteY(this._startNote,te.Center),o=u-s,l=t+n.y+n.getNoteY(this._startNote,te.Center)-a;break;default:return}this.paintSlideLine(r,!1,o,u,l,c)}paintSlideOut(e,t,r){let n=this.renderer,s=12*this.scale,a=3*this.scale,o=0,l=0,u=0,c=0,h=!1;const d=2*this.scale;switch(this._outType){case xe.Shift:case xe.Legato:if(o=e+n.x+n.getBeatX(this._startNote.beat,Oe.PostNotes),l=t+n.y+n.getNoteY(this._startNote,te.Center),this._startNote.slideTarget){let f=this.renderer.scoreRenderer.layout.getRendererForBar(this.renderer.staff.staveId,this._startNote.slideTarget.beat.voice.bar);!f||f.staff!==n.staff?(u=e+n.x+n.width,c=l):(u=e+f.x+f.getBeatX(this._startNote.slideTarget.beat,Oe.OnNotes)-d,c=t+f.y+f.getNoteY(this._startNote.slideTarget,te.Center)),this._startNote.slideTarget.fret>this._startNote.fret?(l+=a,c-=a):(l-=a,c+=a)}else u=e+n.x+this._parent.x,c=l;break;case xe.OutUp:o=e+n.x+n.getNoteX(this._startNote,ft.Right),l=t+n.y+n.getNoteY(this._startNote,te.Center),u=o+s-d,c=t+n.y+n.getNoteY(this._startNote,te.Center)-a;break;case xe.OutDown:o=e+n.x+n.getNoteX(this._startNote,ft.Right),l=t+n.y+n.getNoteY(this._startNote,te.Center),u=o+s-d,c=t+n.y+n.getNoteY(this._startNote,te.Center)+a;break;case xe.PickSlideDown:o=e+n.x+n.getNoteX(this._startNote,ft.Right),l=t+n.y+n.getNoteY(this._startNote,te.Center),u=e+n.x+n.getBeatX(this._startNote.beat,Oe.EndBeat),c=l+a*3,h=!0;break;case xe.PickSlideUp:o=e+n.x+n.getNoteX(this._startNote,ft.Right),l=t+n.y+n.getNoteY(this._startNote,te.Center),u=e+n.x+n.getBeatX(this._startNote.beat,Oe.EndBeat),c=l-a*3,h=!0;break;default:return}this.paintSlideLine(r,h,o,u,l,c)}paintSlideLine(e,t,r,n,s,a){if(t){let o=new Ja(0,0,Ue.Slight,1.2);o.renderer=this.renderer,o.doLayout(),s-=o.height/2,a-=o.height/2;let l=n-r,u=a-s,c=Math.sqrt(Math.pow(u,2)+Math.pow(l,2));o.width=l;let h=Math.asin(u/c)*(180/Math.PI);e.beginRotate(r,s,h),o.paint(0,0,e),e.endRotate()}else e.beginPath(),e.moveTo(r,s),e.lineTo(n,a),e.stroke()}}class na extends Qt{constructor(e,t,r=!1){super(e.beat,t.beat,r),this.startNote=e,this.endNote=t}getTieHeight(e,t,r,n){return this.startNote===this.endNote?15:super.getTieHeight(e,t,r,n)}getBeamDirection(e,t){return this.startNote===this.endNote?H.Up:na.getBeamDirectionForNote(this.startNote)}static getBeamDirectionForNote(e){return e.string>3?H.Up:H.Down}getStartY(){return this.startNote===this.endNote?this.startNoteRenderer.getNoteY(this.startNote,te.Center):this.tieDirection===H.Up?this.startNoteRenderer.getNoteY(this.startNote,te.Top):this.startNoteRenderer.getNoteY(this.startNote,te.Bottom)}getEndY(){return this.getStartY()}getStartX(){return this.startNote===this.endNote?this.getEndX()-20*this.scale:this.startNoteRenderer.getNoteX(this.startNote,ft.Center)}getEndX(){return this.startNote===this.endNote?this.endNoteRenderer.getNoteX(this.endNote,ft.Left):this.endNoteRenderer.getNoteX(this.endNote,ft.Center)}}class jS extends na{constructor(e,t,r,n=!1){super(e,t,n),this._direction=na.getBeamDirectionForNote(e),this._forSlide=r}getTieHeight(e,t,r,n){return Math.log(r-e+1)*this.renderer.settings.notation.slurHeight}tryExpand(e,t,r,n){if(this._forSlide!==r||this.forEnd!==n||this.startNote.beat.id!==e.beat.id||this.endNote.beat.id!==t.beat.id||this._direction!==na.getBeamDirectionForNote(e))return!1;switch(this._direction){case H.Up:e.realValue>this.startNote.realValue&&(this.startNote=e,this.startBeat=e.beat),t.realValue>this.endNote.realValue&&(this.endNote=t,this.endBeat=t.beat);break;case H.Down:e.realValue<this.startNote.realValue&&(this.startNote=e,this.startBeat=e.beat),t.realValue<this.endNote.realValue&&(this.endNote=t,this.endBeat=t.beat);break}return!0}paint(e,t,r){let n=this.renderer.scoreRenderer.layout.getRendererForBar(this.renderer.staff.staveId,this.startBeat.voice.bar),s=this.getBeamDirection(this.startBeat,n),a="tab.slur."+this.startNote.beat.id+"."+this.endNote.beat.id+"."+s,o=this.renderer;o.staff.getSharedLayoutData(a,!1)||(o.staff.setSharedLayoutData(a,!0),super.paint(e,t,r))}}class vW extends tn{constructor(e,t){super(e,t),this._bend=null,this._effectSlurs=[]}drawBeamHelperAsFlags(e){return e.hasFlag(this.renderer.drawBeamHelperAsFlags(e),this.beat)}doLayout(){this._effectSlurs=[],super.doLayout(),this._bend&&(this._bend.renderer=this.renderer,this._bend.doLayout(),this.updateWidth())}createTies(e){if(!e.isVisible)return;let t=this.renderer;if(e.isTieOrigin&&t.showTiedNotes&&e.tieDestination.isVisible){let r=new na(e,e.tieDestination,!1);this.addTie(r)}if(e.isTieDestination&&t.showTiedNotes){let r=new na(e.tieOrigin,e,!0);this.addTie(r)}if(e.isLeftHandTapped&&!e.isHammerPullDestination){let r=new na(e,e,!1);this.addTie(r)}if(e.isEffectSlurOrigin&&e.effectSlurDestination){let r=!1;for(let n of this._effectSlurs)if(n.tryExpand(e,e.effectSlurDestination,!1,!1)){r=!0;break}if(!r){let n=new jS(e,e.effectSlurDestination,!1,!1);this._effectSlurs.push(n),this.addTie(n)}}if(e.isEffectSlurDestination&&e.effectSlurOrigin){let r=!1;for(let n of this._effectSlurs)if(n.tryExpand(e.effectSlurOrigin,e,!1,!0)){r=!0;break}if(!r){let n=new jS(e.effectSlurOrigin,e,!1,!0);this._effectSlurs.push(n),this.addTie(n)}}if(e.slideInType!==ri.None||e.slideOutType!==xe.None){let r=new bW(e.slideInType,e.slideOutType,e,this);this.addTie(r)}if(e.hasBend){if(!this._bend){const r=new Zr;this._bend=r,r.renderer=this.renderer,this.addTie(r)}this._bend.addBends(e)}}}class wW extends Mt{constructor(e,t,r){super(e,t),this._noteString=null,this._trillNoteString=null,this._trillNoteStringWidth=0,this.isEmpty=!1,this.noteStringWidth=0,this._note=r}doLayout(){let e=this._note,t=e.fret-e.beat.voice.bar.staff.transpositionPitch;if(e.harmonicType===ne.Natural&&e.harmonicValue!==0&&(t=e.harmonicValue-e.beat.voice.bar.staff.transpositionPitch),e.isTieDestination)e.beat.index===0&&this.renderer.settings.notation.notationMode==Zt.GuitarPro||(e.bendType===ee.Bend||e.bendType===ee.BendRelease)&&this.renderer.settings.notation.isNotationElementVisible(pe.TabNotesOnTiedBends)?this._noteString="("+(e.tieOrigin.fret-e.beat.voice.bar.staff.transpositionPitch).toString()+")":this._noteString="";else if(this._noteString=e.isDead?"x":t.toString(),e.isGhost)this._noteString="("+this._noteString+")";else if(e.harmonicType===ne.Natural){let r=this._noteString.indexOf(".");r>=0&&(this._noteString=this._noteString.substr(0,r+2)),this._noteString="<"+this._noteString+">"}if(e.isTrill)this._trillNoteString="("+(e.trillFret-e.beat.voice.bar.staff.transpositionPitch).toString()+")";else if(ct.isAlmostEqualTo(e.harmonicValue,0))this._trillNoteString="";else switch(e.harmonicType){case ne.Artificial:case ne.Pinch:case ne.Tap:case ne.Semi:case ne.Feedback:let r=(t+e.harmonicValue).toString(),n=r.indexOf(".");n>=0&&(r=r.substr(0,n+2)),this._trillNoteString="<"+r+">";break;default:this._trillNoteString="";break}this.isEmpty=!this._noteString,this.isEmpty||(this.renderer.scoreRenderer.canvas.font=this.renderer.resources.tablatureFont,this.noteStringWidth=this.renderer.scoreRenderer.canvas.measureText(this._noteString).width*this.scale,this.width=this.noteStringWidth,this.height=this.renderer.scoreRenderer.canvas.font.size,this._trillNoteString&&(this.renderer.scoreRenderer.canvas.font=this.renderer.resources.graceFont,this._trillNoteStringWidth=3*this.scale+this.renderer.scoreRenderer.canvas.measureText(this._trillNoteString).width,this.width+=this._trillNoteStringWidth))}paint(e,t,r){if(this.isEmpty)return;let n=this.noteStringWidth+this._trillNoteStringWidth,s=e+this.x+(this.width-n)/2,a=this.renderer.scoreRenderer.canvas.font;this.renderer.scoreRenderer.canvas.font=this.renderer.resources.graceFont,r.fillText(this._trillNoteString,s+this.noteStringWidth+3*this.scale,t+this.y),this.renderer.scoreRenderer.canvas.font=a,r.fillText(this._noteString,s,t+this.y)}buildBoundingsLookup(e,t,r){let n=new fp;n.note=this._note,n.noteHeadBounds=new ji,n.noteHeadBounds.x=t+this.x,n.noteHeadBounds.y=r+this.y-this.height/2,n.noteHeadBounds.w=this.width,n.noteHeadBounds.h=this.height,e.addNote(n)}}class SW extends Mt{constructor(e,t,r){super(e,t),this._notes=[],this.minStringNote=null,this.beatEffects=new Map,this.notesPerString=new Map,this.noteStringWidth=0,this._isGrace=r}buildBoundingsLookup(e,t,r){for(const n of this._notes)n.buildBoundingsLookup(e,t+this.x,r+this.y)}getNoteX(e,t){if(this.notesPerString.has(e.string)){let r=this.notesPerString.get(e.string),n=this.x+r.x;switch(t){case ft.Left:break;case ft.Center:n+=r.noteStringWidth/2;break;case ft.Right:n+=r.width;break}return n}return 0}getNoteY(e,t){if(this.notesPerString.has(e.string)){const r=this.notesPerString.get(e.string);let n=this.y+r.y;switch(t){case te.Top:case te.TopWithStem:n-=r.height/2+2*this.scale;break;case te.Center:break;case te.Bottom:case te.BottomWithStem:n+=r.height/2;break}return n}return 0}doLayout(){let e=0,t=0;for(let a=0,o=this._notes.length;a<o;a++){let l=this._notes[a];l.renderer=this.renderer,l.doLayout(),l.width>e&&(e=l.width),l.noteStringWidth>t&&(t=l.noteStringWidth)}this.noteStringWidth=t;let r=this.renderer.resources.tablatureFont.size,n=this.getNoteY(this.minStringNote,te.Center)+r/2,s=7*this.scale;for(const a of this.beatEffects.values())a.y+=n,a.x+=this.width/2,a.renderer=this.renderer,n+=s,a.doLayout();this.width=e}addNoteGlyph(e,t){this._notes.push(e),this.notesPerString.set(t.string,e),(!this.minStringNote||t.string<this.minStringNote.string)&&(this.minStringNote=t)}paint(e,t,r){e+=this.x,t+=this.y;let n=this.renderer.resources,s=r.textBaseline;r.textBaseline=Se.Middle,r.font=this._isGrace?n.graceFont:n.tablatureFont;let a=this._notes,o=this.width;for(let l of a)l.renderer=this.renderer,l.width=o,l.paint(e,t,r);r.textBaseline=s;for(const l of this.beatEffects.values())l.paint(e,t,r)}updateBeamingHelper(e){this.beamingHelper&&this.beamingHelper.isPositionFrom("tab",this.beat)&&this.beamingHelper.registerBeatLineX("tab",this.beat,e+this.x+this.width/2,e+this.x+this.width/2)}}class xW extends _t{constructor(e,t,r,n){super(e,t,1,Qa.getSymbol(n)),this._isVisibleRest=r,this._duration=n}doLayout(){this._isVisibleRest?this.width=Qa.getSize(this._duration)*this.scale:this.width=10*this.scale}updateBeamingHelper(e){this.beamingHelper&&this.beamingHelper.isPositionFrom("tab",this.beat)&&this.beamingHelper.registerBeatLineX("tab",this.beat,e+this.x+this.width/2,e+this.x+this.width/2)}paint(e,t,r){this._isVisibleRest&&super.paint(e,t,r)}}class kW extends Sc{constructor(){super(...arguments),this.noteNumbers=null,this.restGlyph=null}getNoteX(e,t){return this.noteNumbers?this.noteNumbers.getNoteX(e,t):0}getNoteY(e,t){return this.noteNumbers?this.noteNumbers.getNoteY(e,t):0}buildBoundingsLookup(e,t,r){this.noteNumbers&&this.noteNumbers.buildBoundingsLookup(e,t+this.x,r+this.y)}doLayout(){let e=this.renderer;if(this.container.beat.isRest){let r=Math.floor((this.renderer.bar.staff.tuning.length-1)/2),n=e.getTabY(r);const s=new xW(0,n,e.showRests,this.container.beat.duration);if(this.restGlyph=s,s.beat=this.container.beat,s.beamingHelper=this.beamingHelper,this.addGlyph(s),this.container.beat.dots>0&&e.showRests){this.addGlyph(new Qi(0,0,5*this.scale));for(let a=0;a<this.container.beat.dots;a++)this.addGlyph(new zd(0,n,1.5*this.scale))}}else{let r=this.renderer.settings.notation.smallGraceTabNotes&&this.container.beat.graceType!==ce.None;const n=new SW(0,0,r);this.noteNumbers=n,n.beat=this.container.beat,n.beamingHelper=this.beamingHelper;for(let s of this.container.beat.notes)s.isVisible&&this.createNoteGlyph(s);if(this.addGlyph(n),this.container.beat.hasWhammyBar){let s=new Pr(this.container.beat);s.renderer=this.renderer,s.doLayout(),this.container.ties.push(s)}if(this.container.beat.isTremolo&&!this.noteNumbers.beatEffects.has("tremolo")){let s=0,a=this.container.beat.tremoloSpeed;switch(a){case _.ThirtySecond:s=10;break;case _.Sixteenth:s=5;break;case _.Eighth:s=0;break}this.noteNumbers.beatEffects.set("tremolo",new bp(5*this.scale,s*this.scale,a))}if(this.container.beat.dots>0&&e.settings.notation.rhythmMode!==cs.Hidden){this.addGlyph(new Qi(0,0,5*this.scale));for(let s=0;s<this.container.beat.dots;s++)this.addGlyph(new zd(0,e.lineOffset*e.bar.staff.tuning.length+e.settings.notation.rhythmHeight*e.scale,1.5*this.scale))}}if(!this.glyphs)return;let t=0;for(let r=0,n=this.glyphs.length;r<n;r++){let s=this.glyphs[r];s.x=t,s.renderer=this.renderer,s.doLayout(),t+=s.width}this.width=t,this.computedWidth=t,this.container.beat.isEmpty?this.centerX=this.width/2:this.container.beat.isRest?this.centerX=this.restGlyph.x+this.restGlyph.width/2:this.centerX=this.noteNumbers.x+this.noteNumbers.noteStringWidth/2}updateBeamingHelper(){this.container.beat.isRest?this.restGlyph.updateBeamingHelper(this.container.x+this.x):this.noteNumbers.updateBeamingHelper(this.container.x+this.x)}createNoteGlyph(e){let t=this.renderer,r=new wW(0,0,e),n=e.beat.voice.bar.staff.tuning.length-e.string;r.y=t.getTabY(n),r.renderer=this.renderer,r.doLayout(),this.noteNumbers.addNoteGlyph(r,e);let s=r.y-r.height/2,a=s+r.height;this.renderer.helpers.collisionHelper.reserveBeatSlot(this.container.beat,s,a)}}class TW extends Mt{constructor(e){super(0,0),this._beat=e}doLayout(){this.width=10*this.scale}paint(e,t,r){let n=this.renderer,s=t+this.x+n.getNoteY(this._beat.maxStringNote,te.Top),a=t+this.y+n.getNoteY(this._beat.minStringNote,te.Bottom),o=e+this.x+this.width/2|0,l=8*this.scale;if(this._beat.brushType!==lt.None){if(this._beat.brushType===lt.BrushUp||this._beat.brushType===lt.BrushDown)r.beginPath(),r.moveTo(o,s),r.lineTo(o,a),r.stroke();else if(this._beat.brushType===lt.ArpeggioUp){let u=new Ja(0,0,Ue.Slight,1.2,!0);u.renderer=this.renderer,u.doLayout();let c=s,h=a-l;u.width=Math.abs(h-c),r.beginRotate(e+this.x+4*this.scale,h,-90),u.paint(0,-u.height/2,r),r.endRotate()}else if(this._beat.brushType===lt.ArpeggioDown){let u=new Ja(0,0,Ue.Slight,1.2,!0);u.renderer=this.renderer,u.doLayout();let c=s+l,h=a;u.width=Math.abs(h-c),r.beginRotate(e+this.x+4*this.scale,c,90),u.paint(0,-u.height/2,r),r.endRotate()}this._beat.brushType===lt.BrushUp||this._beat.brushType===lt.ArpeggioUp?(r.beginPath(),r.moveTo(o,a),r.lineTo(o+l/2,a-l),r.lineTo(o-l/2,a-l),r.closePath(),r.fill()):(r.beginPath(),r.moveTo(o,s),r.lineTo(o+l/2,s+l),r.lineTo(o-l/2,s+l),r.closePath(),r.fill())}}}class CW extends wc{doLayout(){this.container.beat.brushType!==lt.None&&!this.container.beat.isRest&&(this.addGlyph(new TW(this.container.beat)),this.addGlyph(new Qi(0,0,4*this.scale))),super.doLayout()}constructor(){super()}}class NW extends Mt{constructor(e,t){super(e,t)}doLayout(){this.width=28*this.scale}paint(e,t,r){let n=this.renderer.bar.staff.tuning.length,s=n<=4?w.FourStringTabClef:w.SixStringTabClef,a=n<=4?n/4.5:n/6.5;r.fillMusicFontSymbol(e+this.x+5*this.scale,t+this.y,a*this.scale,s,!1)}}class BW extends YB{get commonScale(){return 1}get numberScale(){return this.renderer.bar.staff.tuning.length<=4?ke.GraceScale:1}}class ll extends ol{constructor(e,t){super(e,t),this._hasTuplets=!1,this.showTimeSignature=!1,this.showRests=!1,this.showTiedNotes=!1}get lineSpacing(){return ll.TabLineSpacing}get heightLineCount(){return this.bar.staff.tuning.length}get drawnLineCount(){return this.bar.staff.tuning.length}getTabY(e){return super.getLineY(e)}getTabHeight(e){return super.getLineHeight(e)}collectSpaces(e){const t=this.scale;for(let r of this.bar.voices)if(this.hasVoiceContainer(r)){let n=this.getVoiceContainer(r);for(let s of n.beatGlyphs){let a=s.onNotes,o=a.noteNumbers;if(o)for(const[l,u]of o.notesPerString)u.isEmpty||e[this.bar.staff.tuning.length-l].push(new Float32Array([n.x+s.x+a.x+o.x,o.width+t]))}}}adjustSizes(){this.settings.notation.rhythmMode!==cs.Hidden&&(this.height+=this.settings.notation.rhythmHeight*this.settings.display.scale,this.bottomPadding+=this.settings.notation.rhythmHeight*this.settings.display.scale)}doLayout(){if(super.doLayout(),this.settings.notation.rhythmMode!==cs.Hidden){this._hasTuplets=!1;for(let e of this.bar.voices)if(this.hasVoiceContainer(e)&&this.getVoiceContainer(e).tupletGroups.length>0){this._hasTuplets=!0;break}this._hasTuplets&&this.registerOverflowBottom(this.tupletSize)}}createLinePreBeatGlyphs(){if(this.isFirstOfLine){let e=(this.bar.staff.tuning.length-1)/2;this.addPreBeatGlyph(new NW(5*this.scale,this.getTabY(e)))}this.showTimeSignature&&(!this.bar.previousBar||this.bar.previousBar&&this.bar.masterBar.timeSignatureNumerator!==this.bar.previousBar.masterBar.timeSignatureNumerator||this.bar.previousBar&&this.bar.masterBar.timeSignatureDenominator!==this.bar.previousBar.masterBar.timeSignatureDenominator)&&(this.createStartSpacing(),this.createTimeSignatureGlyphs())}createTimeSignatureGlyphs(){this.addPreBeatGlyph(new Qi(0,0,5*this.scale));const e=(this.bar.staff.tuning.length+1)/2-1;this.addPreBeatGlyph(new BW(0,this.getTabY(e),this.bar.masterBar.timeSignatureNumerator,this.bar.masterBar.timeSignatureDenominator,this.bar.masterBar.timeSignatureCommon))}createVoiceGlyphs(e){for(const t of e.beats){let r=new vW(t,this.getVoiceContainer(e));r.preNotes=new CW,r.onNotes=new kW,this.addBeatGlyph(r)}}paint(e,t,r){super.paint(e,t,r),this.settings.notation.rhythmMode!==cs.Hidden&&(this.paintBeams(e,t,r),this.paintTuplets(e,t,r))}drawBeamHelperAsFlags(e){return super.drawBeamHelperAsFlags(e)||this.settings.notation.rhythmMode===cs.ShowWithBeams}getFlagTopY(e){const t=this.getOnNotesGlyphForBeat(e);return!t.noteNumbers||e.duration===_.Half?this.height-this.settings.notation.rhythmHeight*this.settings.display.scale-this.tupletSize:t.noteNumbers.getNoteY(t.noteNumbers.minStringNote,te.Bottom)}getFlagBottomY(e){return this.getFlagAndBarPos()}getFlagStemSize(e){return 0}getBarLineStart(e,t){let r=this.getOnNotesGlyphForBeat(e);return!r.noteNumbers||e.duration===_.Half?this.height-this.settings.notation.rhythmHeight*this.settings.display.scale-this.tupletSize:r.noteNumbers.getNoteY(r.noteNumbers.minStringNote,te.Bottom)+this.lineOffset/2}getBeamDirection(e){return H.Down}getFlagAndBarPos(){return this.height-(this._hasTuplets?this.tupletSize/2:0)}calculateBeamYWithDirection(e,t,r){return this.getFlagAndBarPos()}shouldPaintFlag(e,t){return!super.shouldPaintFlag(e,t)||e.graceType!==ce.None?!1:this.drawBeamHelperAsFlags(t)}paintBeamingStem(e,t,r,n,s,a){if(s<n){const u=s;s=n,n=u}a.lineWidth=xt.StemWidth*this.scale,a.beginPath();let o=[];this.helpers.collisionHelper.reservedLayoutAreasByDisplayTime.has(e.displayStart)&&(o=this.helpers.collisionHelper.reservedLayoutAreasByDisplayTime.get(e.displayStart).slots.slice(),o.sort((u,c)=>u.topY-c.topY));let l=s;for(;l>n;){a.moveTo(r,l);let u=n;if(o.length>0&&o[o.length-1].bottomY>u){const c=o.pop();u=t+c.bottomY,a.lineTo(r,u),l=t+c.topY}else{a.lineTo(r,u);break}}a.stroke(),a.lineWidth=this.scale}}ll.StaffId="tab";ll.TabLineSpacing=10;class Fg extends gp{get staffId(){return ll.StaffId}getStaffPaddingTop(e){return e.system.layout.renderer.settings.display.notationStaffPaddingTop}getStaffPaddingBottom(e){return e.system.layout.renderer.settings.display.notationStaffPaddingBottom}constructor(e,t,r){super(),this._showTimeSignature=e,this._showRests=t,this._showTiedNotes=r,this.hideOnPercussionTrack=!0}canCreate(e,t){return t.tuning.length>0&&super.canCreate(e,t)}create(e,t){let r=new ll(e,t);return r.showRests=this._showRests,r.showTimeSignature=this._showTimeSignature,r.showTiedNotes=this._showTiedNotes,r}}class Qu extends In{constructor(){super(0,0)}doLayout(){super.doLayout();const e=this.renderer.resources.effectFont;this.height=e.size+Qu.Padding*this.scale}paint(e,t,r){let n=this.renderer.resources;r.font=n.effectFont;let s=r.textAlign;r.textAlign=ue.Center,r.fillText("T",e+this.x,t+this.y+r.font.size/2),r.textAlign=s,r.strokeCircle(e+this.x,t+this.y+r.font.size/2+(Qu.Padding-1)*this.scale,r.font.size/1.6)}}Qu.Padding=4;class dh extends so{get notationElement(){return pe.EffectTap}get sizingMode(){return Ae.SingleOnBeat}shouldCreateGlyphForNote(e){return e.isLeftHandTapped}createNewGlyph(e,t){return new Qu}}class Ms{constructor(){this.noteRange=1,this.x=0,this.y=0}}var Ia;(function(i){i[i.None=0]="None",i[i.Rectangle=1]="Rectangle",i[i.Ellipse=2]="Ellipse",i[i.Circle=3]="Circle"})(Ia||(Ia={}));class Ag extends Ms{constructor(){super(...arguments),this.align=ue.Left,this.frame=Ia.None,this.text="",this.fontFace="",this.weight=0,this.height=0}}class YS extends Ms{constructor(){super(...arguments),this.chord=new ha}}class XS extends Ms{}class KS extends Ms{}class _W extends Ms{constructor(){super(...arguments),this.number=0}}class qS extends Ms{constructor(){super(...arguments),this.decrescendo=!1}}class Vg extends Ms{constructor(){super(...arguments),this.allNumbers=!1,this.firstNumber=0,this.lastNumber=0}}class PW extends Ms{constructor(){super(...arguments),this.octave=1}}class RW extends Ms{}class EW{constructor(){this.defaultClef=ve.G2,this.description="",this.percussion=!1,this.instrument=0,this.volume=0,this.transpose=0,this.index=0}}class MW{constructor(){this.from=0,this.to=0,this.curly=!1}}class OW{constructor(){this.currentBarIndex=-1,this.currentBarComplete=!0,this.currentBarDuration=0,this.currentPosition=0,this.voiceStemDir=null,this.repeatCount=0,this.repeatEnd=null}}class Gd{constructor(){this._trackChannel=0,this._beamingMode=kn.Auto,this._isFirstSystem=!0,this._staffLookup=new Map,this._brackets=[],this._staffLayoutLookup=new Map,this._staffLayouts=[],this._timeSignature=new Ts,this._voiceStates=new Map}parseXml(e,t){this._galleryObjects=new Map,this._tieStarts=[],this._tieStartIds=new Map,this._voiceCounts=new Map,this._slurs=new Map,this._crescendo=new Map,this._isFirstSystem=!0;let r=new Fd;try{r.parse(e)}catch(n){throw new gt("Could not parse XML",n)}this.parseDom(r),this.consolidate(),this.score.finish(t)}consolidate(){for(const e of this.score.tracks){const t=this._voiceCounts.get(e.index);for(const r of e.staves){for(;r.bars.length<this.score.masterBars.length;)this.addNewBar(r);for(const n of r.bars){for(;n.voices.length<t;)n.addVoice(new Qn);for(const s of n.voices)if(s.beats.length===0){const a=new xi;a.isEmpty=!0,s.addBeat(a)}}}}Gd.applyEffectRange(this._slurs,(e,t)=>{t.isLegatoOrigin=!0}),Gd.applyEffectRange(this._crescendo,(e,t)=>{t.crescendo=e.decrescendo?Zi.Decrescendo:Zi.Crescendo})}static applyEffectRange(e,t){for(const[r,n]of e){const s=n.noteRange;let a=r;for(let o=0;o<s;o++)if(t(n,a),a.index+1<a.voice.beats.length)a=a.voice.beats[a.index+1];else if(a.voice.bar.index+1<a.voice.bar.staff.bars.length)a=a.voice.bar.staff.bars[a.voice.bar.index+1].voices[a.voice.index].beats[0];else break}}parseDom(e){let t=e.firstElement;if(!t)throw new gt("No valid XML");if(t.localName==="score"){this.score=new no,this.score.tempo=120;for(let r of t.childNodes)if(r.nodeType===I.Element)switch(r.localName){case"info":this.parseInfo(r);break;case"layout":this.parseLayout(r);break;case"gallery":this.parseGallery(r);break;case"pageObjects":this.parsePageObjects(r);break;case"systems":this.parseSystems(r);break}}else throw new gt('Root node of XML was not "score"')}parseLayout(e){for(let s of e.childNodes)if(s.nodeType===I.Element)switch(s.localName){case"staves":this.parseLayoutStaves(s);break;case"brackets":this.parseBrackets(s);break}const t=this._brackets.filter(s=>!!s.curly);t.sort((s,a)=>s.from-a.from);let r=0,n=null;for(let s=0;s<this._staffLayouts.length;s++){const a=this._staffLayouts[s];for(;r<t.length&&s>t[r].to;)r++;n&&r<t.length&&s>t[r].from&&s<=t[r].to?n.ensureStaveCount(n.staves.length+1):(n=new Jn,n.ensureStaveCount(1),n.name=a.description,n.playbackInfo.volume=Math.floor(a.volume/128*16),n.playbackInfo.program=a.instrument,a.percussion?(n.playbackInfo.primaryChannel=9,n.playbackInfo.secondaryChannel=9):(n.playbackInfo.primaryChannel=this._trackChannel++,n.playbackInfo.secondaryChannel=this._trackChannel++),this.score.addTrack(n));const o=n.staves[n.staves.length-1];o.isPercussion=a.percussion,o.transpositionPitch=a.transpose,o.displayTranspositionPitch=0,o.showTablature=!1,this._staffLookup.set(a.index,o)}}parseBrackets(e){for(let t of e.childNodes)if(t.nodeType===I.Element)switch(t.localName){case"bracket":this.parseBracket(t);break}}parseBracket(e){const t=new MW;t.from=parseInt(e.getAttribute("from")),t.to=parseInt(e.getAttribute("to")),e.attributes.has("curly")&&(t.curly=e.attributes.get("curly")==="true"),this._brackets.push(t)}parseLayoutStaves(e){for(let t of e.childNodes)if(t.nodeType===I.Element)switch(t.localName){case"staffLayout":this.parseStaffLayout(t);break}}parseStaffLayout(e){const t=new EW;t.description=e.getAttribute("description");for(let r of e.childNodes)if(r.nodeType===I.Element)switch(r.localName){case"notation":r.attributes.has("defaultClef")&&(t.defaultClef=this.parseClef(r.attributes.get("defaultClef")));break;case"sound":r.attributes.has("percussion")&&(t.percussion=r.attributes.get("percussion")==="true"),r.attributes.has("instr")&&(t.instrument=parseInt(r.attributes.get("instr"))),r.attributes.has("volume")&&(t.volume=parseInt(r.attributes.get("volume"))),r.attributes.has("transpose")&&(t.transpose=parseInt(r.attributes.get("transpose")));break}this._staffLayoutLookup.set(t.description,t),t.index=this._staffLayouts.length,this._staffLayouts.push(t)}parseClef(e){switch(e){case"treble":return ve.G2;case"bass":return ve.F4;case"alto":return ve.C4;case"tenor":return ve.C4}return ve.G2}parseClefOttava(e){return e.endsWith("-")?$e._8vb:e.endsWith("+")?$e._8va:$e.Regular}parseSystems(e){for(let t of e.childNodes)if(t.nodeType===I.Element)switch(t.localName){case"system":this.parseSystem(t);break}}parseSystem(e){e.attributes.has("tempo")&&this.score.masterBars.length===0&&(this.score.tempo=parseInt(e.attributes.get("tempo"))),e.getAttribute("beamGrouping")==="0"&&(this._beamingMode=kn.ForceSplitToNext);for(let t of e.childNodes)if(t.nodeType===I.Element)switch(t.localName){case"staves":this.parseStaves(e,t);break}this._isFirstSystem=!1}parseStaves(e,t){let r=this.score.masterBars.length;for(let n of t.childNodes)if(n.nodeType===I.Element)switch(n.localName){case"staff":this.parseStaff(e,r,n);break}}parseStaff(e,t,r){const n=r.getAttribute("layout");this._currentStaffLayout=this._staffLayoutLookup.get(n),this._timeSignature.timeSignatureNumerator=4,this._timeSignature.timeSignatureDenominator=4,this._timeSignature.timeSignatureCommon=!1,this.parseTime(r.getAttribute("defaultTime"));const s=this._staffLookup.get(this._currentStaffLayout.index);for(;s.bars.length<t;)this.addNewBar(s);for(let a of r.childNodes)if(a.nodeType===I.Element)switch(a.localName){case"voices":this.parseVoices(n,s,e,t,a);break}}parseTime(e){switch(e){case"allaBreve":case"C":this._timeSignature.timeSignatureNumerator=2,this._timeSignature.timeSignatureDenominator=2,this._timeSignature.timeSignatureCommon=!0;break;case"longAllaBreve":this._timeSignature.timeSignatureNumerator=4,this._timeSignature.timeSignatureDenominator=4,this._timeSignature.timeSignatureCommon=!0;break;default:if(e.indexOf("/")>0){const t=e.split("/");this._timeSignature.timeSignatureNumerator=parseInt(t[0]),this._timeSignature.timeSignatureDenominator=parseInt(t[1]),this._timeSignature.timeSignatureCommon=!1}break}}parseVoices(e,t,r,n,s){let a=0;for(let o of s.childNodes)if(o.nodeType===I.Element)switch(o.localName){case"voice":this.parseVoice(e,t,r,a,n,o),a++;break}}getOrCreateBar(e,t){return t<e.bars.length?e.bars[t]:this.addNewBar(e)}addNewBar(e){let t=new Ps;if(e.bars.length>0?(t.clef=e.bars[e.bars.length-1].clef,t.clefOttava=e.bars[e.bars.length-1].clefOttava):t.clef=this._currentStaffLayout.defaultClef,e.addBar(t),e.bars.length>this.score.masterBars.length){let r=new Ts;this.score.addMasterBar(r),r.index>0&&(r.keySignature=r.previousMasterBar.keySignature,r.keySignatureType=r.previousMasterBar.keySignatureType,r.tripletFeel=r.previousMasterBar.tripletFeel),r.timeSignatureDenominator=this._timeSignature.timeSignatureDenominator,r.timeSignatureNumerator=this._timeSignature.timeSignatureNumerator,r.timeSignatureCommon=this._timeSignature.timeSignatureCommon}return t}newBar(e,t){this._currentVoiceState.currentBarIndex++,this._currentBar=this.getOrCreateBar(e,this._currentVoiceState.currentBarIndex),this._currentVoiceState.currentBarDuration=this._currentBar.masterBar.calculateDuration(!1),this._currentVoiceState.currentBarComplete=!1,this._currentVoiceState.currentPosition=0,this.ensureVoice(e,t)}parseVoice(e,t,r,n,s,a){const o=e+"_"+n;if(this._currentVoiceState&&!this._currentVoiceState.currentBarComplete&&(this._currentBar.masterBar.isAnacrusis=!0),this._voiceStates.has(o)?(this._currentVoiceState=this._voiceStates.get(o),this._currentBar=this.getOrCreateBar(t,this._currentVoiceState.currentBarIndex),this.ensureVoice(t,n)):(this._currentVoiceState=new OW,this._currentVoiceState.currentBarIndex=s-1,this._voiceStates.set(o,this._currentVoiceState),this.newBar(t,n)),a.attributes.has("stemDir"))switch(a.attributes.get("stemDir")){case"up":this._currentVoiceState.voiceStemDir=H.Up;break;case"down":this._currentVoiceState.voiceStemDir=H.Down;break;default:this._currentVoiceState.voiceStemDir=null;break}else this._currentVoiceState.voiceStemDir=null;const l=a.findChildElement("noteObjects");if(r.attributes.has("tempo")){const u=new wi;u.isLinear=!0,u.type=$t.Tempo,u.value=parseInt(r.attributes.get("tempo")),u.ratioPosition=this._currentVoiceState.currentPosition/this._currentVoiceState.currentBarDuration,this._currentBar.masterBar.tempoAutomations.push(u)}if(l){for(let u of l.childNodes)if(u.nodeType===I.Element)switch(this._currentVoiceState.currentBarComplete&&u.localName!=="barline"&&this.newBar(t,n),u.localName){case"clefSign":this._currentBar.clef=this.parseClef(u.getAttribute("clef")),this._currentBar.clefOttava=this.parseClefOttava(u.getAttribute("clef"));break;case"keySign":this._currentBar.masterBar.keySignature=parseInt(u.getAttribute("fifths"));break;case"timeSign":this.parseTime(u.getAttribute("time")),this._currentBar.masterBar.timeSignatureDenominator=this._timeSignature.timeSignatureDenominator,this._currentBar.masterBar.timeSignatureNumerator=this._timeSignature.timeSignatureNumerator,this._currentBar.masterBar.timeSignatureCommon=this._timeSignature.timeSignatureCommon,this._currentVoiceState.currentPosition=0,this._currentVoiceState.currentBarDuration=this._currentBar.masterBar.calculateDuration(!1);break;case"barline":switch(u.getAttribute("type")){case"double":this._currentBar.masterBar.isDoubleBar=!0,this._currentVoiceState.currentBarComplete||(this._currentBar.masterBar.isAnacrusis=!0),this._currentVoiceState.currentBarComplete=!0;break;case"end":this._currentVoiceState.currentBarComplete||(this._currentBar.masterBar.isAnacrusis=!0);break;case"repEnd":this._currentVoiceState.repeatEnd=this._currentBar.masterBar,this._currentBar.masterBar.repeatCount<this._currentVoiceState.repeatCount&&(this._currentBar.masterBar.repeatCount=this._currentVoiceState.repeatCount),this.parseBarDrawObject(u),this._currentVoiceState.currentBarComplete||(this._currentBar.masterBar.isAnacrusis=!0),this._currentVoiceState.currentBarComplete=!0;break;case"repBegin":this.newBar(t,n),this._currentBar.masterBar.isRepeatStart=!0,this._currentVoiceState.repeatEnd=null,this._currentVoiceState.repeatCount=0;break;case"repEndBegin":this._currentVoiceState.repeatEnd=this._currentBar.masterBar,this._currentBar.masterBar.repeatCount<this._currentVoiceState.repeatCount&&(this._currentBar.masterBar.repeatCount=this._currentVoiceState.repeatCount),this.parseBarDrawObject(u),this.newBar(t,n),this._currentBar.masterBar.isRepeatStart=!0;break;case"dashed":this._currentVoiceState.currentBarComplete||(this._currentBar.masterBar.isAnacrusis=!0),this._currentVoiceState.currentBarComplete=!0;break;default:this._currentVoiceState.currentBarComplete||(this._currentBar.masterBar.isAnacrusis=!0),this._currentVoiceState.currentBarComplete=!0;break}break;case"chord":let c=new xi;this.initFromPreviousBeat(c,this._currentVoice),c.beamingMode=this._beamingMode,this._currentVoiceState.voiceStemDir&&(c.preferredBeamDirection=this._currentVoiceState.voiceStemDir),this.parseDuration(this._currentBar,c,u.findChildElement("duration")),c.updateDurations(),this._currentVoiceState.currentPosition+=c.playbackDuration,this._currentVoice.addBeat(c),this.parseChord(c,u),this._currentVoiceState.currentPosition>=this._currentVoiceState.currentBarDuration&&(this._currentVoiceState.currentBarComplete=!0);break;case"rest":const h=this.parseRestDurations(this._currentBar,u.findChildElement("duration"));h&&(this.initFromPreviousBeat(h,this._currentVoice),h.updateDurations(),this._currentVoiceState.currentPosition+=h.playbackDuration,this._currentVoice.addBeat(h),this._currentVoiceState.currentPosition>=this._currentVoiceState.currentBarDuration&&(this._currentVoiceState.currentBarComplete=!0));break}}}initFromPreviousBeat(e,t){let r=this.getLastBeat(t);r&&(e.dynamics=r.dynamics)}getLastBeat(e){if(e.beats.length>0)return e.beats[e.beats.length-1];if(e.bar.index>0){const t=e.bar.staff.bars[e.bar.index-1];if(e.index<t.voices.length){const r=t.voices[e.index];return this.getLastBeat(r)}}return null}ensureVoice(e,t){for(;this._currentBar.voices.length<t+1;)this._currentBar.addVoice(new Qn);(!this._voiceCounts.has(e.track.index)||this._voiceCounts.get(e.track.index)<this._currentBar.voices.length)&&this._voiceCounts.set(e.track.index,this._currentBar.voices.length),this._currentVoice=this._currentBar.voices[t]}parseChord(e,t){const r=new Nt;for(let n of t.childNodes)if(n.nodeType===I.Element)switch(n.localName){case"stem":switch(n.getAttribute("dir")){case"up":e.preferredBeamDirection=H.Up;break;case"down":e.preferredBeamDirection=H.Down;break}break;case"articulation":switch(n.getAttribute("type")){case"staccato":r.isStaccato=!0;break;case"normalAccent":r.accentuated=jt.Normal;break;case"strongAccent":r.accentuated=jt.Heavy;break}break;case"lyric":this.parseLyric(e,n);break;case"drawObjects":this.parseBeatDrawObject(e,n);break;case"heads":this.parseHeads(e,r,n);break;case"beam":switch(n.getAttribute("group")){case"force":e.beamingMode=kn.ForceMergeWithNext;break;case"divide":e.beamingMode=kn.ForceSplitToNext;break}break}}parseHeads(e,t,r){for(let n of r.childNodes)if(n.nodeType===I.Element)switch(n.localName){case"head":this.parseHead(e,t,n);break}}parseHead(e,t,r){const n=new Nt,s=ct.parseTuning(r.getAttribute("pitch"));n.octave=s.octave-1,n.tone=s.noteValue,n.isStaccato=t.isStaccato,n.accentuated=t.accentuated,e.addNote(n);for(let a of r.childNodes)if(a.nodeType===I.Element)switch(a.localName){case"alter":a.attributes.has("step")&&(n.tone+=parseInt(a.attributes.get("step")));break;case"tie":a.attributes.has("begin")?this._tieStartIds.has(n.id)||(this._tieStartIds.set(n.id,!0),this._tieStarts.push(n)):a.attributes.has("end")&&this._tieStarts.length>0&&!n.isTieDestination&&(n.isTieDestination=!0,n.tieOrigin=this._tieStarts[0],this._tieStarts.splice(0,1),this._tieStartIds.delete(n.id));break}}parseBeatDrawObject(e,t){for(let r of t.childNodes)if(r.nodeType===I.Element)switch(r.localName){case"drawObj":const n=this.parseDrawObj(r);if(n){if(n instanceof Ag)n.fontFace.startsWith("capella")?n.text==="u"?(e.fermata=new F1,e.fermata.type=Bn.Medium):n.text==="f"?e.dynamics=_e.F:n.text==="j"&&(e.dynamics=_e.MF):this._isFirstSystem&&this.score.title===""&&n.align===ue.Center&&n.height>16&&n.weight>400?this.score.title=n.text:this._isFirstSystem&&this.score.artist===""&&n.align===ue.Center&&n.y<0?this.score.artist=n.text:this._isFirstSystem&&this.score.music===""&&n.align===ue.Right&&n.y<0?this.score.music=n.text:n.text.startsWith("by capella")||(e.text=n.text);else if(!(n instanceof YS))if(n instanceof KS)e.vibrato=Ue.Slight;else if(n instanceof qS)e.crescendo=n.decrescendo?Zi.Decrescendo:Zi.Crescendo,n.noteRange++,this._crescendo.set(e,n);else if(n instanceof XS){const s=n;this._slurs.set(e,s)}else n instanceof Vg&&this.applyVolta(n)}break}}parseBarDrawObject(e){for(let t of e.childNodes)if(t.nodeType===I.Element)switch(t.localName){case"drawObj":const r=this.parseDrawObj(t);r&&r instanceof Vg&&this.applyVolta(r);break}}applyVolta(e){if(e.lastNumber>0?(this._currentVoiceState.repeatCount=e.lastNumber,this._currentVoiceState.repeatEnd&&this._currentVoiceState.repeatEnd.repeatCount<this._currentVoiceState.repeatCount&&(this._currentVoiceState.repeatEnd.repeatCount=this._currentVoiceState.repeatCount)):e.firstNumber>0&&(this._currentVoiceState.repeatCount=e.firstNumber,this._currentVoiceState.repeatEnd&&this._currentVoiceState.repeatEnd.repeatCount<this._currentVoiceState.repeatCount&&(this._currentVoiceState.repeatEnd.repeatCount=this._currentVoiceState.repeatCount)),e.lastNumber>0&&e.firstNumber>0){let t=0;for(let r=e.firstNumber;r<=e.lastNumber;r++)t=t|1<<r-1;this._currentBar.masterBar.alternateEndings=t}else e.lastNumber>0?this._currentBar.masterBar.alternateEndings=1<<e.lastNumber-1:e.firstNumber>0&&(this._currentBar.masterBar.alternateEndings=1<<e.firstNumber-1)}parseLyric(e,t){for(let r of t.childNodes)if(r.nodeType===I.Element)switch(r.localName){case"verse":e.lyrics||(e.lyrics=[]);let n=r.innerText;r.getAttribute("hyphen")==="true"&&(n+="-"),e.lyrics.push(n);break}}parseRestDurations(e,t){const r=t.getAttribute("base");if(r.indexOf("/")!==-1){let s=new xi;return s.beamingMode=this._beamingMode,this.parseDuration(e,s,t),s}if(parseInt(r)===1){let s=new xi;return s.beamingMode=this._beamingMode,s.duration=_.Whole,s}else return V.warning("Importer","Multi-Bar rests are not supported"),null}parseDurationValue(e){switch(e){case"2/1":return _.DoubleWhole;case"1/1":return _.Whole;case"1/2":return _.Half;case"1/4":return _.Quarter;case"1/8":return _.Eighth;case"1/16":return _.Sixteenth;case"1/32":return _.ThirtySecond;case"1/64":return _.SixtyFourth;case"1/128":return _.OneHundredTwentyEighth;default:return V.warning("Importer","Unsupported duration"),_.Quarter}}parseDuration(e,t,r){const n=r.getAttribute("base");t.duration=this.parseDurationValue(n),r.attributes.has("dots")&&(t.dots=parseInt(r.attributes.get("dots")));const s=r.findChildElement("tuplet");if(s){t.tupletNumerator=parseInt(s.getAttribute("count"));const a=s.getAttribute("tripartite")==="true"?3:1,o=s.getAttribute("prolong")==="true"?0:1;let l=0;for(;a*Math.pow(2,l+o)<t.tupletNumerator;)l++;t.tupletDenominator=a*Math.pow(2,l)}}parsePageObjects(e){for(let t of e.childNodes)if(t.nodeType===I.Element)switch(t.localName){case"drawObj":const r=this.parseDrawObj(t);if(r&&r instanceof Ag)switch(r.align){case ue.Center:this.score.title?this.score.subTitle||(this.score.subTitle=t.innerText):this.score.title=t.innerText;break;case ue.Right:this.score.artist||(this.score.artist=t.innerText);break}break}}parseGallery(e){for(let t of e.childNodes)if(t.nodeType===I.Element)switch(t.localName){case"drawObj":const r=this.parseDrawObj(t);r&&this._galleryObjects.set(t.getAttribute("name"),r);break}}parseDrawObj(e){let t=null,r=1;for(let n of e.childNodes)if(n.nodeType===I.Element)switch(n.localName){case"text":t=this.parseText(n);break;case"guitar":t=this.parseGuitar(n);break;case"slur":t=this.parseSlur(n);break;case"wavyLine":t=this.parseWavyLine(n);break;case"bracket":t=this.parseTupletBracket(n);break;case"wedge":t=this.parseWedge(n);break;case"volta":t=this.parseVolta(n);break;case"octaveClef":t=this.parseOctaveClef(n);break;case"trill":t=this.parseTrill(n);break;case"basic":n.attributes.has("noteRange")&&(r=parseInt(n.attributes.get("noteRange")));break}return t&&(t.noteRange=r),t}parseTrill(e){return new RW}parseOctaveClef(e){const t=new PW;return e.attributes.has("octave")&&(t.octave=parseInt(e.attributes.get("octave"))),t}parseVolta(e){const t=new Vg;return t.allNumbers=e.attributes.get("allNumbers")==="true",e.attributes.has("firstNumber")&&(t.firstNumber=parseInt(e.attributes.get("firstNumber"))),e.attributes.has("lastNumber")&&(t.lastNumber=parseInt(e.attributes.get("lastNumber"))),t}parseWedge(e){const t=new qS;return t.decrescendo=e.attributes.get("decrescendo")==="true",t}parseTupletBracket(e){const t=new _W;return e.attributes.has("number")&&(t.number=parseInt(e.attributes.get("number"))),t}parseWavyLine(e){return new KS}parseSlur(e){return new XS}parseGuitar(e){const t=new YS,r=e.innerText.trim();for(let n=0;n<r.length;n++)r.charAt(n)==="/"?t.chord.strings.push(0):t.chord.strings.push(parseInt(r.charAt(n)));return t}parseText(e){const t=new Ag;switch(e.attributes.has("x")&&(t.x=parseFloat(e.attributes.get("x"))),e.attributes.has("x")&&(t.y=parseFloat(e.attributes.get("y"))),e.getAttribute("align")){case"left":t.align=ue.Left;break;case"center":t.align=ue.Center;break;case"right":t.align=ue.Right;break}switch(e.getAttribute("frame")){case"rectangle":t.frame=Ia.Rectangle;break;case"ellipse":t.frame=Ia.Ellipse;break;case"circle":t.frame=Ia.Circle;break;case"none":t.frame=Ia.None;break}if(e.firstElement){for(let r of e.childNodes)if(r.nodeType===I.Element)switch(r.localName){case"font":t.fontFace=r.getAttribute("face"),r.attributes.has("weight")&&(t.weight=parseInt(r.attributes.get("weight"))),r.attributes.has("height")&&(t.height=parseInt(r.attributes.get("height")));break;case"content":t.text=r.innerText;break}}else t.text=e.innerText;return t}parseInfo(e){for(let t of e.childNodes)if(t.nodeType===I.Element)switch(t.localName){case"author":this.score.tab=t.firstChild.innerText;break;case"comment":this.score.notices=t.firstChild.innerText;break}}}class IW extends bl{get name(){return"Capella"}constructor(){super()}readScore(){V.debug(this.name,"Loading ZIP entries");let e=new H1(this.data),t,r=null;if(t=e.read(),V.debug(this.name,"Zip entries loaded"),t.length>0)for(let n of t)switch(n.fileName){case"score.xml":r=M.toString(n.data,this.settings.importer.encoding);break}else this.data.reset(),r=M.toString(this.data.readAll(),this.settings.importer.encoding);if(!r)throw new gt("No valid capella file");V.debug(this.name,"Start Parsing score.xml");try{let n=new Gd;return n.parseXml(r,this.settings),V.debug(this.name,"score.xml parsed"),n.score}catch(n){throw new gt("Failed to parse CapXML",n)}}}class LW{constructor(e){this._targets=new Set,this._callback=e,window.addEventListener("resize",this.onWindowResize.bind(this),!1)}observe(e){this._targets.add(e)}unobserve(e){this._targets.delete(e)}disconnect(){this._targets.clear()}onWindowResize(){const e=[];for(const t of this._targets)e.push({target:t,contentRect:void 0,borderBoxSize:void 0,contentBoxSize:[],devicePixelContentBoxSize:[]});this._callback(e,this)}}class DW{constructor(e){this._elements=[];let t=null;const r=this._check.bind(this);this._check=()=>{t||(t=setTimeout(()=>{r(),t=null},100))},this._callback=e,window.addEventListener("resize",this._check,!0),document.addEventListener("scroll",this._check,!0)}observe(e){this._elements.indexOf(e)>=0||(this._elements.push(e),this._check())}unobserve(e){this._elements=this._elements.filter(t=>t!=e)}_check(){const e=[];this._elements.forEach(t=>{const r=t.getBoundingClientRect();r.top+r.height>=0&&r.top<=window.innerHeight&&r.left+r.width>=0&&r.left<=window.innerWidth&&e.push({target:t,isIntersecting:!0})}),e.length&&this._callback(e,this)}}function JS(i,e,t){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var r,n;if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=e[Symbol.dispose]}if(typeof r!="function")throw new TypeError("Object not disposable.");n&&(r=function(){try{n.call(this)}catch(s){return Promise.reject(s)}}),i.stack.push({value:e,dispose:r,async:t})}return e}var FW=typeof SuppressedError=="function"?SuppressedError:function(i,e,t){var r=new Error(t);return r.name="SuppressedError",r.error=i,r.suppressed=e,r};function QS(i){function e(r){i.error=i.hasError?new FW(r,i.error,"An error was suppressed during disposal."):r,i.hasError=!0}function t(){for(;i.stack.length;){var r=i.stack.pop();try{var n=r.dispose&&r.dispose.call(r.value);if(r.async)return Promise.resolve(n).then(t,function(s){return e(s),t()})}catch(s){e(s)}}if(i.hasError)throw i.error}return t()}class ot{static enable(e,t){ot.alphaSkia=t,ot.initializeMusicFont(ot.alphaSkia.AlphaSkiaTypeface.register(e))}static initializeMusicFont(e){ot.musicFont=e}static registerFont(e,t){const r=ot.alphaSkia.AlphaSkiaTypeface.register(e.buffer);t||(t=He.withFamilyList([r.familyName],12,r.isItalic?St.Italic:St.Plain,r.isBold?cr.Bold:cr.Regular));for(const n of t.families)this.customTypeFaces.set(ot.customTypefaceKey(n,t.isBold,t.isItalic),r);return t}static customTypefaceKey(e,t,r){return e.toLowerCase()+"_"+t+"_"+r}getTypeFace(){if(this._typeFaceCache!=this.font.toCssString(this.settings.display.scale)){if(this._typeFaceIsSystem){const t={stack:[],error:void 0,hasError:!1};try{const r=JS(t,this._typeFace,!1)}catch(r){t.error=r,t.hasError=!0}finally{QS(t)}}for(const t of this.font.families){var e=ot.customTypefaceKey(t,this.font.isBold,this.font.isItalic);ot.customTypeFaces.has(e)?(this._typeFaceIsSystem=!1,this._typeFace=ot.customTypeFaces.get(e)):(this._typeFaceIsSystem=!0,this._typeFace=ot.alphaSkia.AlphaSkiaTypeface.create(t,this.font.isBold,this.font.isItalic))}this._typeFaceCache=this.font.toCssString(this.settings.display.scale)}return this._typeFace}constructor(){this._color=new qe(0,0,0,0),this._lineWidth=0,this._typeFaceCache="",this._typeFaceIsSystem=!1,this._typeFace=null,this.font=new He("Arial",10,St.Plain),this.textAlign=ue.Left,this.textBaseline=Se.Top,this._canvas=new ot.alphaSkia.AlphaSkiaCanvas,this.color=new qe(0,0,0,255)}destroy(){const e={stack:[],error:void 0,hasError:!1};try{const t=JS(e,this._canvas,!1)}catch(t){e.error=t,e.hasError=!0}finally{QS(e)}}onRenderFinished(){return null}beginRender(e,t){this._canvas.beginRender(e,t,W.HighDpiFactor)}endRender(){return this._canvas.endRender()}get color(){return this._color}set color(e){this._color.rgba!==e.rgba&&(this._color=e,this._canvas.color=ot.alphaSkia.AlphaSkiaCanvas.rgbaToColor(e.r,e.g,e.b,e.a))}get lineWidth(){return this._lineWidth}set lineWidth(e){this._lineWidth=e,this._canvas.lineWidth=e}fillRect(e,t,r,n){r>0&&this._canvas.fillRect(e|0,t|0,r,n)}strokeRect(e,t,r,n){this._canvas.strokeRect(e|0,t|0,r,n)}beginPath(){this._canvas.beginPath()}closePath(){this._canvas.closePath()}moveTo(e,t){this._canvas.moveTo(e,t)}lineTo(e,t){this._canvas.lineTo(e,t)}quadraticCurveTo(e,t,r,n){this._canvas.quadraticCurveTo(e,t,r,n)}bezierCurveTo(e,t,r,n,s,a){this._canvas.bezierCurveTo(e,t,r,n,s,a)}fillCircle(e,t,r){this._canvas.fillCircle(e,t,r)}strokeCircle(e,t,r){this._canvas.strokeCircle(e,t,r)}fill(){this._canvas.fill()}stroke(){this._canvas.stroke()}beginGroup(e){}endGroup(){}fillText(e,t,r){if(e.length==0)return;let n=ot.alphaSkia.AlphaSkiaTextAlign.Left;switch(this.textAlign){case ue.Left:n=ot.alphaSkia.AlphaSkiaTextAlign.Left;break;case ue.Center:n=ot.alphaSkia.AlphaSkiaTextAlign.Center;break;case ue.Right:n=ot.alphaSkia.AlphaSkiaTextAlign.Right;break}let s=ot.alphaSkia.AlphaSkiaTextBaseline.Top;switch(this.textBaseline){case Se.Top:s=ot.alphaSkia.AlphaSkiaTextBaseline.Top;break;case Se.Middle:s=ot.alphaSkia.AlphaSkiaTextBaseline.Middle;break;case Se.Bottom:s=ot.alphaSkia.AlphaSkiaTextBaseline.Bottom;break}this._canvas.fillText(e,this.getTypeFace(),this.font.size*this.settings.display.scale,t,r,n,s)}measureText(e){return new cp(this._canvas.measureText(e,this.getTypeFace(),this.font.size*this.settings.display.scale),this.font.size*ot.FontSizeToLineHeight)}fillMusicFontSymbol(e,t,r,n,s){n!==w.None&&this.fillMusicFontSymbolText(e,t,r,String.fromCharCode(n),s)}fillMusicFontSymbols(e,t,r,n,s){let a="";for(let o of n)o!==w.None&&(a+=String.fromCharCode(o));this.fillMusicFontSymbolText(e,t,r,a,s)}fillMusicFontSymbolText(e,t,r,n,s){this._canvas.fillText(n,ot.musicFont,W.MusicFontSize*this.settings.display.scale*r,e,t,s?ot.alphaSkia.AlphaSkiaTextAlign.Center:ot.alphaSkia.AlphaSkiaTextAlign.Left,ot.alphaSkia.AlphaSkiaTextBaseline.Alphabetic)}beginRotate(e,t,r){this._canvas.beginRotate(e,t,r)}endRotate(){this._canvas.endRotate()}}ot.musicFont=null;ot.customTypeFaces=new Map;ot.FontSizeToLineHeight=1.2;class dr extends _t{constructor(e,t,r,n){super(e,t,n?ke.GraceScale:1,dr.getSymbol(r)),this._isGrace=n,this._duration=r}paint(e,t,r){let n=this._isGrace?this.scale:0;r.fillMusicFontSymbol(e+this.x,t+this.y+n,this.glyphScale*this.scale,this.symbol,!1)}doLayout(){const e=(this._isGrace?ke.GraceScale:1)*this.scale;switch(this._duration){case _.QuadrupleWhole:case _.DoubleWhole:case _.Whole:this.width=dr.WholeNoteHeadWidth*e;break;case _.Half:this.width=dr.HalfNoteHeadWidth*e;break;default:this.width=dr.QuarterNoteHeadWidth*e;break}this.height=dr.NoteHeadHeight*e}static getSymbol(e){switch(e){case _.QuadrupleWhole:case _.DoubleWhole:case _.Whole:return w.NoteheadSlashWhiteWhole;case _.Half:return w.NoteheadSlashWhiteHalf;default:return w.NoteheadSlashVerticalEnds}}}dr.NoteHeadHeight=17;dr.QuarterNoteHeadWidth=12;dr.HalfNoteHeadWidth=25;dr.WholeNoteHeadWidth=32;class ZS extends Qt{constructor(e,t,r=!1){super(e.beat,t.beat,r),this.startNote=e,this.endNote=t}getTieHeight(e,t,r,n){return this.startNote===this.endNote?15:super.getTieHeight(e,t,r,n)}getBeamDirection(e,t){return H.Down}static getBeamDirectionForNote(e){return H.Down}getStartY(){return this.startNoteRenderer.getNoteY(this.startNote,te.Center)}getEndY(){return this.getStartY()}getStartX(){return this.startNote===this.endNote?this.getEndX()-20*this.scale:this.startNoteRenderer.getNoteX(this.startNote,ft.Right)}getEndX(){return this.endNoteRenderer.getNoteX(this.endNote,ft.Left)}}class AW extends tn{constructor(e,t){super(e,t),this._tiedNoteTie=null}createTies(e){if(e.isVisible){if(!this._tiedNoteTie&&e.isTieOrigin&&e.tieDestination.isVisible){let t=new ZS(e,e.tieDestination,!1);this._tiedNoteTie=t,this.addTie(t)}if(!this._tiedNoteTie&&e.isTieDestination){let t=new ZS(e.tieOrigin,e,!0);this._tiedNoteTie=t,this.addTie(t)}}}}class VW extends Qa{constructor(e,t,r){super(e,t,r)}updateBeamingHelper(e){this.beamingHelper&&this.beamingHelper.registerBeatLineX("slash",this.beat,e+this.x+this.width/2,e+this.x+this.width/2)}}class HW extends Sc{constructor(){super(...arguments),this.noteHeads=null,this.restGlyph=null}getNoteX(e,t){if(this.noteHeads){let r=this.noteHeads.x;switch(t){case ft.Left:break;case ft.Center:r+=this.noteHeads.width/2;break;case ft.Right:r+=this.noteHeads.width;break}return r}return 0}buildBoundingsLookup(e,t,r){if(this.noteHeads&&this.container.beat.notes.length>0){const n=new fp;n.note=this.container.beat.notes[0],n.noteHeadBounds=new ji,n.noteHeadBounds.x=t+this.x+this.noteHeads.x,n.noteHeadBounds.y=r+this.y+this.noteHeads.y-this.noteHeads.height/2,n.noteHeadBounds.w=this.width,n.noteHeadBounds.h=this.height,e.addNote(n)}}getNoteY(e,t){if(this.noteHeads){let r=this.y+this.noteHeads.y;switch(t){case te.Top:case te.TopWithStem:r-=this.noteHeads.height/2+2*this.scale;break;case te.Center:break;case te.Bottom:case te.BottomWithStem:r+=this.noteHeads.height/2;break}return r}return 0}updateBeamingHelper(){this.noteHeads?this.beamingHelper&&this.beamingHelper.registerBeatLineX("slash",this.container.beat,this.container.x+this.x+this.noteHeads.x+this.noteHeads.width,this.container.x+this.x+this.noteHeads.x+this.noteHeads.width):this.restGlyph&&this.restGlyph.updateBeamingHelper(this.container.x+this.x)}doLayout(){let e=this.renderer;const t=e.getNoteLine(),r=e.getLineY(t);if(!this.container.beat.isEmpty)if(this.container.beat.isRest){const n=new VW(0,r,this.container.beat.duration);this.restGlyph=n,n.beat=this.container.beat,n.beamingHelper=this.beamingHelper,this.addGlyph(n),this.beamingHelper&&this.beamingHelper.applyRest(this.container.beat,0)}else{const n=this.container.beat.graceType!==ce.None,s=new dr(0,r,this.container.beat.duration,n);this.noteHeads=s,this.addGlyph(s)}if(this.container.beat.dots>0){this.addGlyph(new Qi(0,0,5*this.scale));for(let n=0;n<this.container.beat.dots;n++)this.addGlyph(new zd(0,e.getLineY(e.getNoteLine())-e.getLineHeight(.5),1.5*this.scale))}super.doLayout(),this.container.beat.isEmpty?this.centerX=this.width/2:this.container.beat.isRest?this.centerX=this.restGlyph.x+this.restGlyph.width/2:this.centerX=this.noteHeads.x+this.noteHeads.width/2}}class k0 extends ol{constructor(e,t){super(e,t),this.simpleWhammyOverflow=0}get lineSpacing(){return xt.RawLineSpacing}get heightLineCount(){return 5}get drawnLineCount(){return 1}get bottomGlyphOverflow(){return 0}paint(e,t,r){super.paint(e,t,r),this.paintBeams(e,t,r),this.paintTuplets(e,t,r)}doLayout(){super.doLayout();let e=!1;for(let t of this.bar.voices)if(this.hasVoiceContainer(t)&&this.getVoiceContainer(t).tupletGroups.length>0){e=!0;break}e&&this.registerOverflowTop(this.tupletSize)}getNoteLine(){return 0}getFlagTopY(e){return this.getLineY(0)-dr.NoteHeadHeight/2*this.scale}getFlagBottomY(e){return this.getLineY(0)-dr.NoteHeadHeight/2*this.scale}getBeamDirection(e){return H.Up}getNoteY(e,t){let r=super.getNoteY(e,t);return isNaN(r)&&(r=this.getLineY(0)),r}calculateBeamYWithDirection(e,t,r){return this.getLineY(0)-this.getFlagStemSize(e.shortestDuration)}getBarLineStart(e,t){return this.getLineY(0)-dr.NoteHeadHeight/2*this.scale}createLinePreBeatGlyphs(){}createVoiceGlyphs(e){for(const t of e.beats){let r=new AW(t,this.getVoiceContainer(e));r.preNotes=new wc,r.onNotes=e.index==0?new HW:new Sc,this.addBeatGlyph(r)}}paintBeamingStem(e,t,r,n,s,a){a.lineWidth=xt.StemWidth*this.scale,a.beginPath(),a.moveTo(r,n),a.lineTo(r,s),a.stroke(),a.lineWidth=this.scale}}k0.StaffId="slash";class fh extends gp{get staffId(){return k0.StaffId}getStaffPaddingTop(e){return e.system.layout.renderer.settings.display.notationStaffPaddingTop}getStaffPaddingBottom(e){return e.system.layout.renderer.settings.display.notationStaffPaddingBottom}create(e,t){return new k0(e,t)}canCreate(e,t){return super.canCreate(e,t)&&t.showSlash}constructor(){super()}}class ex{constructor(e,t){this.vertical=e,this.createLayout=t}}class Hg{constructor(e,t){this.supportsWorkers=e,this.createCanvas=t}}class W{static createStyleElement(e,t){let r=e.getElementById("alphaTabStyle");if(!r){if(!t){V.error("AlphaTab","Font directory could not be detected, cannot create style element");return}r=e.createElement("style"),r.id="alphaTabStyle";let n=`
            @font-face {
                font-family: 'alphaTab';
                 src: url('${t}Bravura.eot');
                 src: url('${t}Bravura.eot?#iefix') format('embedded-opentype')
                      , url('${t}Bravura.woff') format('woff')
                      , url('${t}Bravura.otf') format('opentype')
                      , url('${t}Bravura.svg#Bravura') format('svg');
                 font-weight: normal;
                 font-style: normal;
            }
            .at-surface * {
                cursor: default;
                vertical-align: top;
                overflow: visible;
            }
            .at-surface-svg text {
                dominant-baseline: central;
            }
            .at {
                 font-family: 'alphaTab';
                 speak: none;
                 font-style: normal;
                 font-weight: normal;
                 font-variant: normal;
                 text-transform: none;
                 line-height: 1;
                 line-height: 1;
                 -webkit-font-smoothing: antialiased;
                 -moz-osx-font-smoothing: grayscale;
                 font-size: ${W.MusicFontSize}px;
                 overflow: visible !important;
            }`;r.innerHTML=n,e.getElementsByTagName("head").item(0).appendChild(r),W.bravuraFontChecker.checkForFontAvailability()}}static get globalThis(){if(W._globalThis===void 0){try{W._globalThis=globalThis}catch{}typeof W._globalThis>"u"&&(W._globalThis=self),typeof W._globalThis>"u"&&(W._globalThis=global),typeof W._globalThis>"u"&&(W._globalThis=window),typeof W._globalThis>"u"&&(W._globalThis=Function("return this")())}return this._globalThis}static get isRunningInWorker(){return"WorkerGlobalScope"in W.globalThis}static get isRunningInAudioWorklet(){return"AudioWorkletGlobalScope"in W.globalThis}static throttle(e,t){let r=0;return()=>{W.globalThis.clearTimeout(r),r=W.globalThis.setTimeout(e,t)}}static detectScriptFile(){if(!W.isRunningInWorker&&W.globalThis.ALPHATAB_ROOT){let e=W.globalThis.ALPHATAB_ROOT;return e=W.ensureFullUrl(e),e=W.appendScriptName(e),e}try{const e=import.meta.url;if(e&&e.indexOf("file://")===-1)return e}catch{}return"document"in W.globalThis&&document.currentScript?document.currentScript.src:null}static ensureFullUrl(e){var t,r,n;if(!e)return"";if(!e.startsWith("http")&&!e.startsWith("https")&&!e.startsWith("file")){let s="",a=W.globalThis.location;if(s+=(t=a.protocol)==null?void 0:t.toString(),s+="//",a.hostname&&(s+=(r=a.hostname)==null?void 0:r.toString()),a.port&&(s+=":",s+=(n=a.port)==null?void 0:n.toString()),!e.startsWith("/")){let o=a.pathname.split("/").slice(0,-1).join("/");o.length>0&&(o.startsWith("/")||(s+="/"),s+=o==null?void 0:o.toString())}return e.startsWith("/")||(s+="/"),s+=e==null?void 0:e.toString(),s}return e}static appendScriptName(e){return e&&!e.endsWith(".js")&&(e.endsWith("/")||(e+="/"),e+="alphaTab.js"),e}static detectFontDirectory(){if(!W.isRunningInWorker&&W.globalThis.ALPHATAB_FONT)return W.ensureFullUrl(W.globalThis.ALPHATAB_FONT);const e=W.scriptFile;if(e){let t=e.lastIndexOf("/");if(t>=0)return e.substr(0,t)+"/font/"}return null}static registerJQueryPlugin(){if(!W.isRunningInWorker&&W.globalThis&&"jQuery"in W.globalThis){let e=W.globalThis.jQuery,t=new MS;e.fn.alphaTab=function(r){const n=Array.prototype.slice.call(arguments,1);return this.length===1?t.exec(this[0],r,n):this.each((s,a)=>{t.exec(a,r,n)})},e.alphaTab={restore:MS.restore},e.fn.alphaTab.fn=t}}static getRenderEngineFactory(e){return!e||!W.renderEngines.has(e)?W.renderEngines.get("default"):W.renderEngines.get(e)}static getLayoutEngineFactory(e){return!e||!W.layoutEngines.has(e)?W.layoutEngines.get(ps.Page):W.layoutEngines.get(e)}static buildImporters(){return[new Un,new eU,new Qz,new tU,new IW,new Ti]}static createDefaultRenderEngines(){const e=new Map;return e.set("svg",new Hg(!0,()=>new BU)),e.set("default",e.get("svg")),e.set("skia",new Hg(!1,()=>new ot)),W.createPlatformSpecificRenderEngines(e),e}static enableAlphaSkia(e,t){ot.enable(e,t)}static registerAlphaSkiaCustomFont(e,t){return ot.registerFont(e,t)}static createPlatformSpecificRenderEngines(e){e.set("html5",new Hg(!1,()=>new fU))}static createDefaultStaveProfiles(){const e=new Map;e.set(ur.ScoreTab,[new Fn("top-effects",[new Ig,new Dg,new Rg,new Lg,new Ng]),new fh,new Fn("score-effects",[new _g,new HS,new lh,new sh(!0),new uh,new ah,new ch,new oh,new dh,new Cg]),new $S,new Fn("tab-effects",[new DS,new sh(!1),new FS,new nh,new lh,new uh,new ah,new ch,new oh,new VS,new Bg,new Nr(ne.Natural),new Nr(ne.Artificial),new Nr(ne.Pinch),new Nr(ne.Tap),new Nr(ne.Semi),new Nr(ne.Feedback),new Pg,new LS,new AS,new Eg,new Og,new Mg,new dh]),new Fg(!1,!1,!1)]),e.set(ur.Score,[new Fn("top-effects",[new Ig,new Dg,new Rg,new Lg,new Ng]),new fh,new Fn("score-effects",[new _g,new HS,new lh,new sh(!0),new uh,new ah,new ch,new oh,new Bg,new Pg,new Eg,new Og,new Mg,new dh,new Cg]),new $S,new Fn("score-bottom-effects",[new DS,new sh(!1),new FS,new nh])]);let t=[new Ig,new Dg,new Rg,new Lg,new Ng,new _g,new lh,new uh,new ah,new ch,new oh,new VS,new Bg,new Nr(ne.Artificial),new Nr(ne.Pinch),new Nr(ne.Tap),new Nr(ne.Semi),new Nr(ne.Feedback),new Pg,new LS,new AS,new Eg,new Og,new Mg,new dh,new Cg];return e.set(ur.Tab,[new fh,new Fn("tab-effects",t),new Fg(!0,!0,!0),new Fn("tab-bottom-effects",[new nh])]),e.set(ur.TabMixed,[new fh,new Fn("tab-effects",t),new Fg(!1,!1,!1),new Fn("tab-bottom-effects",[new nh])]),e}static createDefaultLayoutEngines(){const e=new Map;return e.set(ps.Page,new ex(!0,t=>new QU(t))),e.set(ps.Horizontal,new ex(!1,t=>new JU(t))),e}static initializeMain(e,t){W.isRunningInWorker||W.isRunningInAudioWorklet||((W.webPlatform===hr.Browser||W.webPlatform===hr.BrowserModule)&&(W.registerJQueryPlugin(),W.HighDpiFactor=window.devicePixelRatio,"ResizeObserver"in W.globalThis||(W.globalThis.ResizeObserver=LW),"IntersectionObserver"in W.globalThis||(W.globalThis.IntersectionObserver=DW),"replaceChildren"in Element.prototype||(Element.prototype.replaceChildren=function(...r){this.innerHTML="",this.append(...r)},Document.prototype.replaceChildren=Element.prototype.replaceChildren,DocumentFragment.prototype.replaceChildren=Element.prototype.replaceChildren),"replaceAll"in String.prototype||(String.prototype.replaceAll=function(r,n){return this.replace(new RegExp(r,"g"),n)})),W.createWebWorker=e,W.createAudioWorklet=t)}static get alphaTabWorker(){return this.globalThis.Worker}static initializeWorker(){if(!W.isRunningInWorker)throw new oi(ai.General,"Not running in worker, cannot run worker initialization");j1.init(),$1.init(),W.createWebWorker=e=>{throw new oi(ai.General,"Nested workers are not supported")}}static initializeAudioWorklet(){if(!W.isRunningInAudioWorklet)throw new oi(ai.General,"Not running in audio worklet, cannot run worklet initialization");Yu.init()}static detectWebPack(){try{if(typeof __webpack_require__=="function")return!0}catch{}return!1}static detectVite(){try{if(typeof __BASE__=="string")return!0}catch{}return!1}static detectWebPlatform(){try{if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return hr.NodeJs}catch{}try{const e=import.meta.url;if(e&&typeof e=="string"&&!e.startsWith("file://"))return hr.BrowserModule}catch{}return hr.Browser}}W.MusicFontSize=34;W.HighDpiFactor=1;W._globalThis=void 0;W.webPlatform=W.detectWebPlatform();W.isWebPackBundled=W.detectWebPack();W.isViteBundled=W.detectVite();W.scriptFile=W.detectScriptFile();W.fontDirectory=W.detectFontDirectory();W.bravuraFontChecker=new VB(["alphaTab"]);W.renderEngines=W.createDefaultRenderEngines();W.layoutEngines=W.createDefaultLayoutEngines();W.staveProfiles=W.createDefaultStaveProfiles();class XB{constructor(){this.scriptFile=null,this.fontDirectory=null,this.file=null,this.tex=!1,this.tracks=null,this.enableLazyLoading=!0,this.engine="default",this.logLevel=xn.Info,this.useWorkers=!0,this.includeNoteBounds=!1,this.scriptFile=W.scriptFile,this.fontDirectory=W.fontDirectory}}var L;(function(i){i[i.SteelGuitar=1]="SteelGuitar",i[i.AcousticGuitar=2]="AcousticGuitar",i[i.TwelveStringGuitar=3]="TwelveStringGuitar",i[i.ElectricGuitar=4]="ElectricGuitar",i[i.Bass=5]="Bass",i[i.ClassicalGuitar=23]="ClassicalGuitar",i[i.UprightBass=6]="UprightBass",i[i.Ukulele=7]="Ukulele",i[i.Banjo=8]="Banjo",i[i.Mandolin=9]="Mandolin",i[i.Piano=10]="Piano",i[i.Synth=12]="Synth",i[i.Strings=11]="Strings",i[i.Brass=13]="Brass",i[i.Reed=14]="Reed",i[i.Woodwind=15]="Woodwind",i[i.Vocal=16]="Vocal",i[i.PitchedIdiophone=17]="PitchedIdiophone",i[i.Fx=21]="Fx",i[i.PercussionKit=18]="PercussionKit",i[i.Idiophone=19]="Idiophone",i[i.Membraphone=20]="Membraphone"})(L||(L={}));class D{constructor(e,t,r=null){if(this.icon=L.Piano,this.icon=e,this.instrumentSetName=t,r)this.instrumentSetType=r;else{const n=t.split(" ");n[0]=n[0].substr(0,1).toLowerCase()+n[0].substr(1),this.instrumentSetType=n.join("")}}}new D(L.Piano,"Acoustic Piano"),new D(L.Piano,"Acoustic Piano"),new D(L.Piano,"Electric Piano"),new D(L.Piano,"Acoustic Piano"),new D(L.Piano,"Electric Piano"),new D(L.Piano,"Electric Piano"),new D(L.Piano,"Harpsichord"),new D(L.Piano,"Harpsichord"),new D(L.PitchedIdiophone,"Celesta"),new D(L.PitchedIdiophone,"Vibraphone"),new D(L.PitchedIdiophone,"Vibraphone"),new D(L.PitchedIdiophone,"Vibraphone"),new D(L.PitchedIdiophone,"Xylophone"),new D(L.PitchedIdiophone,"Xylophone"),new D(L.PitchedIdiophone,"Vibraphone"),new D(L.Banjo,"Banjo"),new D(L.Piano,"Electric Organ"),new D(L.Piano,"Electric Organ"),new D(L.Piano,"Electric Organ"),new D(L.Piano,"Electric Organ"),new D(L.Piano,"Electric Organ"),new D(L.Piano,"Electric Organ"),new D(L.Woodwind,"Recorder"),new D(L.Piano,"Electric Organ"),new D(L.ClassicalGuitar,"Nylon Guitar"),new D(L.SteelGuitar,"Steel Guitar"),new D(L.SteelGuitar,"Electric Guitar"),new D(L.ElectricGuitar,"Electric Guitar"),new D(L.ElectricGuitar,"Electric Guitar"),new D(L.ElectricGuitar,"Electric Guitar"),new D(L.SteelGuitar,"Electric Guitar"),new D(L.SteelGuitar,"Electric Guitar"),new D(L.Bass,"Acoustic Bass"),new D(L.Bass,"Electric Bass"),new D(L.Bass,"Electric Bass"),new D(L.Bass,"Acoustic Bass"),new D(L.Bass,"Electric Bass"),new D(L.Bass,"Electric Bass"),new D(L.Synth,"Synth Bass"),new D(L.Synth,"Synth Bass"),new D(L.Strings,"Violin"),new D(L.Strings,"Viola"),new D(L.Strings,"Cello"),new D(L.Strings,"Contrabass"),new D(L.Strings,"Violin"),new D(L.Strings,"Violin"),new D(L.Piano,"Harp"),new D(L.Membraphone,"Timpani"),new D(L.Strings,"Violin"),new D(L.Strings,"Violin"),new D(L.Strings,"Violin"),new D(L.Strings,"Violin"),new D(L.Vocal,"Voice"),new D(L.Vocal,"Voice"),new D(L.Vocal,"Voice"),new D(L.Synth,"Pad Synthesizer"),new D(L.Brass,"Trumpet"),new D(L.Brass,"Trombone"),new D(L.Brass,"Tuba"),new D(L.Brass,"Trumpet"),new D(L.Brass,"French Horn"),new D(L.Brass,"Trumpet"),new D(L.Brass,"Trumpet"),new D(L.Brass,"Trumpet"),new D(L.Reed,"Saxophone"),new D(L.Reed,"Saxophone"),new D(L.Reed,"Saxophone"),new D(L.Reed,"Saxophone"),new D(L.Reed,"Oboe"),new D(L.Reed,"English Horn"),new D(L.Reed,"Bassoon"),new D(L.Reed,"Clarinet"),new D(L.Reed,"Piccolo"),new D(L.Woodwind,"Flute"),new D(L.Woodwind,"Recorder"),new D(L.Woodwind,"Flute"),new D(L.Woodwind,"Recorder"),new D(L.Woodwind,"Flute"),new D(L.Woodwind,"Recorder"),new D(L.Woodwind,"Flute"),new D(L.Synth,"Lead Synthesizer"),new D(L.Synth,"Lead Synthesizer"),new D(L.Synth,"Lead Synthesizer"),new D(L.Synth,"Lead Synthesizer"),new D(L.Synth,"Lead Synthesizer"),new D(L.Synth,"Lead Synthesizer"),new D(L.Synth,"Lead Synthesizer"),new D(L.Synth,"Lead Synthesizer"),new D(L.Synth,"Pad Synthesizer"),new D(L.Synth,"Pad Synthesizer"),new D(L.Synth,"Pad Synthesizer"),new D(L.Synth,"Pad Synthesizer"),new D(L.Synth,"Pad Synthesizer"),new D(L.Synth,"Pad Synthesizer"),new D(L.Synth,"Pad Synthesizer"),new D(L.Synth,"Pad Synthesizer"),new D(L.Fx,"Pad Synthesizer"),new D(L.Fx,"Pad Synthesizer"),new D(L.Fx,"Pad Synthesizer"),new D(L.Fx,"Pad Synthesizer"),new D(L.Fx,"Lead Synthesizer"),new D(L.Fx,"Lead Synthesizer"),new D(L.Fx,"Lead Synthesizer"),new D(L.Fx,"Trumpet"),new D(L.ElectricGuitar,"Banjo"),new D(L.Banjo,"Banjo"),new D(L.Ukulele,"Ukulele"),new D(L.Banjo,"Banjo"),new D(L.PitchedIdiophone,"Xylophone"),new D(L.Reed,"Bassoon"),new D(L.Strings,"Violin"),new D(L.Woodwind,"Flute"),new D(L.PitchedIdiophone,"Xylophone"),new D(L.Idiophone,"Celesta"),new D(L.PitchedIdiophone,"Vibraphone"),new D(L.Idiophone,"Xylophone"),new D(L.Membraphone,"Xylophone"),new D(L.Membraphone,"Xylophone"),new D(L.Membraphone,"Xylophone"),new D(L.Idiophone,"Celesta"),new D(L.Fx,"Steel Guitar"),new D(L.Fx,"Recorder"),new D(L.Fx,"Recorder"),new D(L.Fx,"Recorder"),new D(L.Fx,"Recorder"),new D(L.Fx,"Recorder"),new D(L.Fx,"Recorder"),new D(L.Fx,"Timpani");new D(L.PercussionKit,"Drums","drumKit");class Ha{static buildCrc32Lookup(){const t=new Uint32Array(256);for(let r=0;r<t.length;r++){let n=r;for(let s=0;s<8;s++)n=(n&1)===1?n>>>1^3988292384:n>>>1;t[r]=n}return t}get value(){return~this._checkValue}constructor(){this._checkValue=Ha.CrcInit,this.reset()}update(e,t,r){for(let n=0;n<r;n++)this._checkValue=Ha.Crc32Lookup[(this._checkValue^e[t+n])&255]^this._checkValue>>>8}reset(){this._checkValue=Ha.CrcInit}}Ha.Crc32Lookup=Ha.buildCrc32Lookup();Ha.CrcInit=4294967295;class kt{}kt.MAX_WBITS=15;kt.WSIZE=1<<kt.MAX_WBITS;kt.WMASK=kt.WSIZE-1;kt.MIN_MATCH=3;kt.MAX_MATCH=258;kt.DEFAULT_MEM_LEVEL=8;kt.PENDING_BUF_SIZE=1<<kt.DEFAULT_MEM_LEVEL+8;kt.HASH_BITS=kt.DEFAULT_MEM_LEVEL+7;kt.HASH_SIZE=1<<kt.HASH_BITS;kt.HASH_SHIFT=(kt.HASH_BITS+kt.MIN_MATCH-1)/kt.MIN_MATCH;kt.HASH_MASK=kt.HASH_SIZE-1;kt.MIN_LOOKAHEAD=kt.MAX_MATCH+kt.MIN_MATCH+1;kt.MAX_DIST=kt.WSIZE-kt.MIN_LOOKAHEAD;class Rr{constructor(e,t,r,n){this.length=null,this.numCodes=0,this.codes=null,this.huffman=e,this.minNumCodes=r,this.maxLength=n,this.freqs=new Int16Array(t),this.bitLengthCounts=new Int32Array(n)}reset(){for(let e=0;e<this.freqs.length;e++)this.freqs[e]=0;this.codes=null,this.length=null}buildTree(){let e=this.freqs.length,t=new Int32Array(e),r=0,n=0;for(let u=0;u<e;u++){let c=this.freqs[u];if(c!==0){let h=r++;for(;h>0;){let d=Math.floor((h-1)/2);if(this.freqs[t[d]]>c)t[h]=t[d],h=d;else break}t[h]=u,n=u}}for(;r<2;){let u=n<2?++n:0;t[r++]=u}this.numCodes=Math.max(n+1,this.minNumCodes);let s=r,a=new Int32Array(4*r-2),o=new Int32Array(2*r-1),l=s;for(let u=0;u<r;u++){let c=t[u];a[2*u]=c,a[2*u+1]=-1,o[u]=this.freqs[c]<<8,t[u]=u}do{let u=t[0],c=t[--r],h=0,d=1;for(;d<r;)d+1<r&&o[t[d]]>o[t[d+1]]&&d++,t[h]=t[d],h=d,d=d*2+1;let f=o[c];for(;d=h,h>0;)if(h=Math.floor((d-1)/2),o[t[h]]>f)t[d]=t[h];else break;t[d]=c;let p=t[0];c=l++,a[2*c]=u,a[2*c+1]=p;let g=Math.min(o[u]&255,o[p]&255);for(f=o[u]+o[p]-g+1,o[c]=f,h=0,d=1;d<r;)d+1<r&&o[t[d]]>o[t[d+1]]&&d++,t[h]=t[d],h=d,d=h*2+1;for(;d=h,d>0;)if(h=Math.floor((d-1)/2),o[t[h]]>f)t[d]=t[h];else break;t[d]=c}while(r>1);this.buildLength(a)}buildLength(e){this.length=new Uint8Array(this.freqs.length);let t=Math.floor(e.length/2),r=Math.floor((t+1)/2),n=0;for(let l=0;l<this.maxLength;l++)this.bitLengthCounts[l]=0;let s=new Int32Array(t);s[t-1]=0;for(let l=t-1;l>=0;l--)if(e[2*l+1]!=-1){let u=s[l]+1;u>this.maxLength&&(u=this.maxLength,n++),s[e[2*l]]=u,s[e[2*l+1]]=u}else{let u=s[l];this.bitLengthCounts[u-1]++,this.length[e[2*l]]=s[l]}if(n==0)return;let a=this.maxLength-1;do{for(;this.bitLengthCounts[--a]==0;);do this.bitLengthCounts[a]--,this.bitLengthCounts[++a]++,n-=1<<this.maxLength-1-a;while(n>0&&a<this.maxLength-1)}while(n>0);this.bitLengthCounts[this.maxLength-1]+=n,this.bitLengthCounts[this.maxLength-2]-=n;let o=2*r;for(let l=this.maxLength;l!=0;l--){let u=this.bitLengthCounts[l-1];for(;u>0;){let c=2*e[o++];e[c+1]==-1&&(this.length[e[c]]=l,u--)}}}getEncodedLength(){let e=0;for(let t=0;t<this.freqs.length;t++)e+=this.freqs[t]*this.length[t];return e}calcBLFreq(e){let t,r,n,s=-1,a=0;for(;a<this.numCodes;){n=1;let o=this.length[a];for(o==0?(t=138,r=3):(t=6,r=3,s!=o&&(e.freqs[o]++,n=0)),s=o,a++;a<this.numCodes&&s==this.length[a]&&(a++,!(++n>=t)););n<r?e.freqs[s]+=n:s!=0?e.freqs[Rr.Repeat3To6]++:n<=10?e.freqs[Rr.Repeat3To10]++:e.freqs[Rr.Repeat11To138]++}}setStaticCodes(e,t){this.codes=e,this.length=t}buildCodes(){let e=new Int32Array(this.maxLength),t=0;this.codes=new Int16Array(this.freqs.length);for(let r=0;r<this.maxLength;r++)e[r]=t,t+=this.bitLengthCounts[r]<<15-r;for(let r=0;r<this.numCodes;r++){let n=this.length[r];n>0&&(this.codes[r]=de.bitReverse(e[n-1]),e[n-1]+=1<<16-n)}}writeTree(e){let t,r,n,s=-1,a=0;for(;a<this.numCodes;){n=1;let o=this.length[a];for(o==0?(t=138,r=3):(t=6,r=3,s!=o&&(e.writeSymbol(o),n=0)),s=o,a++;a<this.numCodes&&s==this.length[a]&&(a++,!(++n>=t)););if(n<r)for(;n-- >0;)e.writeSymbol(s);else s!=0?(e.writeSymbol(Rr.Repeat3To6),this.huffman.pending.writeBits(n-3,2)):n<=10?(e.writeSymbol(Rr.Repeat3To10),this.huffman.pending.writeBits(n-3,3)):(e.writeSymbol(Rr.Repeat11To138),this.huffman.pending.writeBits(n-11,7))}}writeSymbol(e){this.huffman.pending.writeBits(this.codes[e]&65535,this.length[e])}}Rr.Repeat3To6=16;Rr.Repeat3To10=17;Rr.Repeat11To138=18;class de{static staticInit(){let e=0;for(;e<144;)de.staticLCodes[e]=de.bitReverse(48+e<<8),de.staticLLength[e++]=8;for(;e<256;)de.staticLCodes[e]=de.bitReverse(256+e<<7),de.staticLLength[e++]=9;for(;e<280;)de.staticLCodes[e]=de.bitReverse(-256+e<<9),de.staticLLength[e++]=7;for(;e<de.LITERAL_NUM;)de.staticLCodes[e]=de.bitReverse(-88+e<<8),de.staticLLength[e++]=8;for(e=0;e<de.DIST_NUM;e++)de.staticDCodes[e]=de.bitReverse(e<<11),de.staticDLength[e]=5}static bitReverse(e){return de.bit4Reverse[e&15]<<12|de.bit4Reverse[e>>4&15]<<8|de.bit4Reverse[e>>8&15]<<4|de.bit4Reverse[e>>12]}constructor(e){this.last_lit=0,this.extra_bits=0,this.pending=e,this.literalTree=new Rr(this,de.LITERAL_NUM,257,15),this.distTree=new Rr(this,de.DIST_NUM,1,15),this.blTree=new Rr(this,de.BITLEN_NUM,4,7),this.d_buf=new Int16Array(de.BUFSIZE),this.l_buf=new Uint8Array(de.BUFSIZE)}isFull(){return this.last_lit>=de.BUFSIZE}reset(){this.last_lit=0,this.extra_bits=0,this.literalTree.reset(),this.distTree.reset(),this.blTree.reset()}flushStoredBlock(e,t,r,n){this.pending.writeBits((de.STORED_BLOCK<<1)+(n?1:0),3),this.pending.alignToByte(),this.pending.writeShort(r),this.pending.writeShort(~r),this.pending.writeBlock(e,t,r),this.reset()}flushBlock(e,t,r,n){this.literalTree.freqs[de.EOF_SYMBOL]++,this.literalTree.buildTree(),this.distTree.buildTree(),this.literalTree.calcBLFreq(this.blTree),this.distTree.calcBLFreq(this.blTree),this.blTree.buildTree();let s=4;for(let l=18;l>s;l--)this.blTree.length[de.BL_ORDER[l]]>0&&(s=l+1);let a=14+s*3+this.blTree.getEncodedLength()+this.literalTree.getEncodedLength()+this.distTree.getEncodedLength()+this.extra_bits,o=this.extra_bits;for(let l=0;l<de.LITERAL_NUM;l++)o+=this.literalTree.freqs[l]*de.staticLLength[l];for(let l=0;l<de.DIST_NUM;l++)o+=this.distTree.freqs[l]*de.staticDLength[l];a>=o&&(a=o),t>=0&&r+4<a>>3?this.flushStoredBlock(e,t,r,n):a==o?(this.pending.writeBits((de.STATIC_TREES<<1)+(n?1:0),3),this.literalTree.setStaticCodes(de.staticLCodes,de.staticLLength),this.distTree.setStaticCodes(de.staticDCodes,de.staticDLength),this.compressBlock(),this.reset()):(this.pending.writeBits((de.DYN_TREES<<1)+(n?1:0),3),this.sendAllTrees(s),this.compressBlock(),this.reset())}sendAllTrees(e){this.blTree.buildCodes(),this.literalTree.buildCodes(),this.distTree.buildCodes(),this.pending.writeBits(this.literalTree.numCodes-257,5),this.pending.writeBits(this.distTree.numCodes-1,5),this.pending.writeBits(e-4,4);for(let t=0;t<e;t++)this.pending.writeBits(this.blTree.length[de.BL_ORDER[t]],3);this.literalTree.writeTree(this.blTree),this.distTree.writeTree(this.blTree)}compressBlock(){for(let e=0;e<this.last_lit;e++){let t=this.l_buf[e]&255,r=this.d_buf[e];if(r--!=0){let n=de.Lcode(t);this.literalTree.writeSymbol(n);let s=Math.floor((n-261)/4);s>0&&s<=5&&this.pending.writeBits(t&(1<<s)-1,s);let a=de.Dcode(r);this.distTree.writeSymbol(a),s=Math.floor(a/2)-1,s>0&&this.pending.writeBits(r&(1<<s)-1,s)}else this.literalTree.writeSymbol(t)}this.literalTree.writeSymbol(de.EOF_SYMBOL)}tallyDist(e,t){this.d_buf[this.last_lit]=e,this.l_buf[this.last_lit++]=t-3;let r=de.Lcode(t-3);this.literalTree.freqs[r]++,r>=265&&r<285&&(this.extra_bits+=Math.floor((r-261)/4));let n=de.Dcode(e-1);return this.distTree.freqs[n]++,n>=4&&(this.extra_bits+=Math.floor(n/2)-1),this.isFull()}tallyLit(e){return this.d_buf[this.last_lit]=0,this.l_buf[this.last_lit++]=e,this.literalTree.freqs[e]++,this.isFull()}static Lcode(e){if(e==255)return 285;let t=257;for(;e>=8;)t+=4,e=e>>1;return t+e}static Dcode(e){let t=0;for(;e>=4;)t+=2,e=e>>1;return t+e}}de.BUFSIZE=1<<kt.DEFAULT_MEM_LEVEL+6;de.LITERAL_NUM=286;de.STORED_BLOCK=0;de.STATIC_TREES=1;de.DYN_TREES=2;de.DIST_NUM=30;de.staticLCodes=new Int16Array(de.LITERAL_NUM);de.staticLLength=new Uint8Array(de.LITERAL_NUM);de.staticDCodes=new Int16Array(de.DIST_NUM);de.staticDLength=new Uint8Array(de.DIST_NUM);de.BL_ORDER=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];de.bit4Reverse=new Uint8Array([0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15]);de.BITLEN_NUM=19;de.EOF_SYMBOL=256;de.staticInit();var zW=Object.freeze({__proto__:null,ActiveBeatsChangedEventArgs:AB,AlphaSynth:RB,AlphaSynthAudioWorkletOutput:zB,AlphaSynthScriptProcessorOutput:HB,AlphaSynthWebAudioOutputBase:Er,AlphaSynthWebWorkerApi:S0,CircularSampleBuffer:Y1,MidiEventsPlayedEventArgs:W1,PlaybackRange:FB,PlaybackRangeChangedEventArgs:G1,get PlayerState(){return Wt},PlayerStateChangedEventArgs:lu,PositionChangedEventArgs:Uu});W.isRunningInWorker?W.initializeWorker():W.isRunningInAudioWorklet?W.initializeAudioWorklet():W.initializeMain(i=>{if(W.webPlatform==hr.NodeJs)throw new oi(ai.General,"Workers not yet supported in Node.js");if(W.webPlatform==hr.BrowserModule||W.isWebPackBundled||W.isViteBundled)return V.debug("AlphaTab","Creating webworker"),new W.alphaTabWorker(new URL(new URL(""+new URL("alphaTab.worker-7xS6fjbH.js",import.meta.url).href,import.meta.url),import.meta.url),{type:"module"});if(!i.core.scriptFile)throw new oi(ai.General,"Could not detect alphaTab script file, cannot initialize renderer");try{V.debug("AlphaTab","Creating Blob worker");const e=`importScripts('${i.core.scriptFile}')`,t=new Blob([e]);return new Worker(URL.createObjectURL(t))}catch{return V.warning("Rendering","Could not create inline worker, fallback to normal worker"),new Worker(i.core.scriptFile)}},(i,e)=>{if(W.webPlatform==hr.NodeJs)throw new oi(ai.General,"Audio Worklets not yet supported in Node.js");return W.webPlatform==hr.BrowserModule||W.isWebPackBundled||W.isViteBundled?(V.debug("AlphaTab","Creating Module worklet"),i.audioWorklet.addModule(new URL(new URL(""+new URL("alphaTab.worklet-BtzzHHPJ.js",import.meta.url).href,import.meta.url),import.meta.url))):(V.debug("AlphaTab","Creating Script worklet"),i.audioWorklet.addModule(e.core.scriptFile))});const UW={tex:!0,fontDirectory:"font/",engine:"svg"},WW={staveProfile:"Default",resources:{staffLineColor:"#ffffff80",barSeparatorColor:"#fff",mainGlyphColor:"#fff",secondaryGlyphColor:"#fff",scoreInfoColor:"#fff",barNumberColor:"#fff"}},GW=i=>({scrollElement:i,enableCursor:!0,enableAnimatedBeatCursor:!0,enableElementHighlighting:!0,enablePlayer:!0,enableUserInteraction:!0,soundFont:"soundfont/sonivox.sf2"}),$W={guitarTuning:!1,trackNames:!1},jW={elements:$W},YW=i=>({core:UW,display:WW,notation:jW,player:GW(i)}),XW=()=>{};function KW({bpm:i,tex:e,root:t,scrollArea:r,isLooping:n,bassVolume:s,chordsVolume:a,metronomeVolume:o}){const[l,u]=S.useState(),[c,h]=S.useState(!1),[d,f]=S.useState(!1);return S.useEffect(()=>{A(l)||l.tex(e)},[l,e]),S.useEffect(()=>{A(l)||(l.isLooping=n)},[l,n]),S.useEffect(()=>{!A(l)&&A(l.score)},[l,i]),tx(l,0,s),tx(l,1,a),qW(l,o),S.useEffect(()=>{if(!A(t)&&!A(r)){const p=new pp(t,YW(r));return p.renderStarted.on(()=>h(!0)),p.renderFinished.on(()=>h(!1)),p.playerStateChanged.on(({state:g})=>f(g===zW.PlayerState.Playing)),p.render(),p.isLooping=n,p.metronomeVolume=o,T0(p,0,s),T0(p,1,a),u(p),()=>p.destroy()}return XW},[t,r]),{api:l,isLoading:c,isPlaying:d}}function tx(i,e,t){S.useEffect(()=>{T0(i,e,t)},[e,t,i])}function qW(i,e){S.useEffect(()=>{A(i)||(i.metronomeVolume=e)},[e])}function T0(i,e,t){var n;if(A(i))return;const r=(n=i.score)==null?void 0:n.tracks[e];A(r)||i.changeTrackVolume([r],t)}const JW=R`
  display: flex;
  flex-direction: row;
  gap: 14px;
  align-items: center;
  justify-content: center;
`,QW=R`
  appearance: none;
  background-color: transparent;
  width: 180px;

  &::-webkit-slider-runnable-track {
    height: 8px;
    background-color: #ffffff60;
    border-radius: 8px;
  }

  &::-moz-range-track {
    height: 8px;
    background-color: #ffffff60;
    border-radius: 8px;
  }

  &::-webkit-slider-thumb {
    box-sizing: border-box;
    appearance: none;
    position: relative;
    background-color: #ffffffdd;
    border-radius: 50%;
    width: 24px;
    height: 24px;
    top: 50%;
    translate: 0 -50%;
    transition: background-color 0.2s ease, transform 0.2s ease;
    cursor: pointer;
    &:hover {
      background-color: #ffffff;
      transform: scale(1.4);
    }
  }

  &::-moz-range-thumb {
    box-sizing: border-box;
    appearance: none;
    position: relative;
    background-color: #ffffffdd;
    border-radius: 50%;
    width: 24px;
    height: 24px;
    transition: background-color 0.2s ease, transform 0.2s ease;
    cursor: pointer;
    &:hover {
      background-color: #ffffff;
      transform: scale(1.4);
    }
  }
`,ix=R`
  font-size: 1.6em;
  color: #ffffffdd;
  cursor: pointer;
  &:hover {
    color: #ffffff;
  }
`,ZW=R`
  font-size: 1.8em;
  margin-right: 10px;
  color: #ffffff;
`,zg=({value:i,onChange:e,Icon:t,...r})=>T.jsxs("div",{className:JW,...r,children:[T.jsx(t,{className:ZW}),T.jsx(l4,{className:ix,onClick:()=>e(0)}),T.jsx("input",{type:"range",className:QW,min:0,max:1,step:.02,value:i,onChange:n=>e(n.target.valueAsNumber)}),T.jsx(u4,{className:ix,onClick:()=>e(1)})]});function eG(i){return pt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M3 5m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z"},child:[]},{tag:"path",attr:{d:"M9 19v-6"},child:[]},{tag:"path",attr:{d:"M8 5v8h2v-8"},child:[]},{tag:"path",attr:{d:"M15 19v-6"},child:[]},{tag:"path",attr:{d:"M14 5v8h2v-8"},child:[]}]})(i)}function tG(i){return pt({tag:"svg",attr:{viewBox:"0 0 15 15",fill:"none"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M3.35355 1.85355C3.54882 1.65829 3.54882 1.34171 3.35355 1.14645C3.15829 0.951184 2.84171 0.951184 2.64645 1.14645L0.646447 3.14645C0.451184 3.34171 0.451184 3.65829 0.646447 3.85355L2.64645 5.85355C2.84171 6.04882 3.15829 6.04882 3.35355 5.85355C3.54882 5.65829 3.54882 5.34171 3.35355 5.14645L2.20711 4H9.5C11.433 4 13 5.567 13 7.5C13 7.77614 13.2239 8 13.5 8C13.7761 8 14 7.77614 14 7.5C14 5.01472 11.9853 3 9.5 3H2.20711L3.35355 1.85355ZM2 7.5C2 7.22386 1.77614 7 1.5 7C1.22386 7 1 7.22386 1 7.5C1 9.98528 3.01472 12 5.5 12H12.7929L11.6464 13.1464C11.4512 13.3417 11.4512 13.6583 11.6464 13.8536C11.8417 14.0488 12.1583 14.0488 12.3536 13.8536L14.3536 11.8536C14.5488 11.6583 14.5488 11.3417 14.3536 11.1464L12.3536 9.14645C12.1583 8.95118 11.8417 8.95118 11.6464 9.14645C11.4512 9.34171 11.4512 9.65829 11.6464 9.85355L12.7929 11H5.5C3.567 11 2 9.433 2 7.5Z",fill:"currentColor"},child:[]}]})(i)}const iG=R`
  border-radius: 50%;
  width: 100px;
  height: 100px;
  background-color: #ffffff15;
  color: #ffffff;
  font-size: 50px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: background-color 0.2s ease, outline 0.2s ease;
  border: none;
  &:hover {
    background-color: #ffffff40;
  }
  &:focus {
    outline: 2px solid #ffffff;
  }
`,KB=R`
  border-radius: 50%;
  width: 60px;
  height: 60px;
  background-color: transparent;
  color: #ffffff;
  font-size: 25px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: background-color 0.2s ease, outline 0.2s ease;
  background-color: #ffffff20;
  border: none;
  &:hover {
    background-color: #ffffff40;
  }
  &:focus {
    outline: 2px solid #ffffff;
  }
`,rG=R`
  background-color: #ffffff60;
  &:hover {
    background-color: #ffffff60;
  }
`,nG=({onClick:i,isToggled:e,...t})=>T.jsx("button",{className:iG,onClick:i,...t,children:e?T.jsx(s4,{}):T.jsx(a4,{})}),sG=({onClick:i,isToggled:e,...t})=>{const r=mi(KB,e?rG:null);return T.jsx("button",{className:r,onClick:i,...t,children:T.jsx(tG,{})})},aG=({onClick:i,...e})=>T.jsx("button",{className:KB,onClick:i,...e,children:T.jsx(o4,{})}),oG=R`
  fill: #ffffff;
`,lG=R`
  fill: #ffffff99; ;
`,uG=R`
  fill: #ffffff;
`,cG=R`
  font-size: 0.85em;
  color: #ffffff99;
`,hG=R`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  opacity: 0.8;
  height: 100%;
  gap: 4px;
  cursor: pointer;
  transition: opacity 0.2s ease;
  &:hover {
    opacity: 1;
  }
`,dG=({className:i})=>{const{t:e}=vt();return T.jsxs("a",{className:mi(hG,i),href:"https://alphatab.net",children:[T.jsx("span",{className:cG,children:e("Score.AlphaTabRenderedBy")}),T.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:200,viewBox:"120 30 550 160",className:i,children:[T.jsx("path",{className:oG,d:"M272.361,127.215a40.439,40.439,0,0,1-7.987,12.887,14.527,14.527,0,0,1-17.38,2.956,15.5,15.5,0,0,1-5.228-4.65,22.556,22.556,0,0,1-3.333-7.175,34.1,34.1,0,0,1-1.178-9.242,38.739,38.739,0,0,1,1.322-10.39,26.12,26.12,0,0,1,3.792-8.237,17.9,17.9,0,0,1,6.033-5.425,16.344,16.344,0,0,1,7.986-1.952,12.464,12.464,0,0,1,6.78,1.808,17.174,17.174,0,0,1,5.056,5.052,34.849,34.849,0,0,1,3.792,7.749,101.456,101.456,0,0,1,2.93,9.9Zm18.989,22.99q1.062-.2,2.384-0.545v-6.487q-0.633.173-1.293,0.287a8.18,8.18,0,0,1-1.407.115,4.053,4.053,0,0,1-2.471-.8,8.223,8.223,0,0,1-2.183-3.3,49.048,49.048,0,0,1-2.27-7.06q-1.178-4.565-2.729-12.026L292.7,91.05h-7.929l-6.32,18.714h-0.173A54.687,54.687,0,0,0,275,102.043a27.1,27.1,0,0,0-4.568-6.4,20.347,20.347,0,0,0-6.177-4.363,18.961,18.961,0,0,0-7.986-1.607,25.155,25.155,0,0,0-11.232,2.44,23.773,23.773,0,0,0-8.36,6.774,31.172,31.172,0,0,0-5.2,10.361,45.78,45.78,0,0,0-1.81,13.2,39.2,39.2,0,0,0,1.638,11.653,27.415,27.415,0,0,0,4.654,9.07,21.447,21.447,0,0,0,7.268,5.913,20.8,20.8,0,0,0,9.422,2.123,22.808,22.808,0,0,0,7.412-1.176,20.69,20.69,0,0,0,6.435-3.617,29.477,29.477,0,0,0,5.573-6.2,55.7,55.7,0,0,0,4.884-8.927h0.23q1.033,4.881,2.154,8.5a29.909,29.909,0,0,0,2.471,5.97,10.615,10.615,0,0,0,2.988,3.5,6.391,6.391,0,0,0,3.763,1.148A15.575,15.575,0,0,0,291.35,150.205Zm16.523-.373V62.808h-7.355v87.024h7.355Zm21.837-9.472q6.147,10.849,18.558,10.849a25.024,25.024,0,0,0,11.06-2.382,24,24,0,0,0,8.36-6.687,30.671,30.671,0,0,0,5.286-10.3,45.243,45.243,0,0,0,1.838-13.289,40.843,40.843,0,0,0-1.637-12,26.158,26.158,0,0,0-4.711-9.069,20.89,20.89,0,0,0-7.527-5.769,25.565,25.565,0,0,0-22.465,1.206,23.365,23.365,0,0,0-8.762,9.386h-0.23V91.05h-7.354v85.819h7.354V140.36h0.23Zm-0.23-22.789a25.064,25.064,0,0,1,1.379-8.352,20.471,20.471,0,0,1,3.965-6.86,18.652,18.652,0,0,1,6.262-4.621,19.561,19.561,0,0,1,8.274-1.693,17.175,17.175,0,0,1,7.383,1.55,15.551,15.551,0,0,1,5.63,4.478,21.124,21.124,0,0,1,3.591,7.089,32.071,32.071,0,0,1,1.264,9.328,40.881,40.881,0,0,1-1.35,10.907,25.723,25.723,0,0,1-3.849,8.324,17.429,17.429,0,0,1-6.062,5.309,16.936,16.936,0,0,1-7.986,1.866,18.084,18.084,0,0,1-7.555-1.55,17.481,17.481,0,0,1-5.832-4.219,19.555,19.555,0,0,1-3.764-6.2,20.947,20.947,0,0,1-1.35-7.548v-7.807Zm102.505,32.261V113.5q0-11.766-4.941-17.795t-14.766-6.027q-12.872,0-19.765,11.538h-0.23v-38.4h-7.354v87.024h7.354V116.94a25.054,25.054,0,0,1,1.437-8.755,20.34,20.34,0,0,1,3.849-6.572,16.51,16.51,0,0,1,12.411-5.568q7.525,0,11.089,4.678t3.562,14.552v34.557h7.354Zm51.37-22.617a40.439,40.439,0,0,1-7.987,12.887,14.527,14.527,0,0,1-17.38,2.956,15.5,15.5,0,0,1-5.228-4.65,22.556,22.556,0,0,1-3.333-7.175,34.1,34.1,0,0,1-1.177-9.242,38.74,38.74,0,0,1,1.321-10.39,26.12,26.12,0,0,1,3.792-8.237,17.9,17.9,0,0,1,6.033-5.425,16.344,16.344,0,0,1,7.986-1.952,12.464,12.464,0,0,1,6.78,1.808,17.174,17.174,0,0,1,5.056,5.052,34.849,34.849,0,0,1,3.792,7.749,101.18,101.18,0,0,1,2.93,9.9Zm18.989,22.99q1.062-.2,2.384-0.545v-6.487q-0.633.173-1.293,0.287a8.171,8.171,0,0,1-1.407.115,4.053,4.053,0,0,1-2.471-.8,8.223,8.223,0,0,1-2.183-3.3,49.048,49.048,0,0,1-2.27-7.06q-1.177-4.565-2.729-12.026L503.694,91.05h-7.929l-6.32,18.714h-0.172A54.807,54.807,0,0,0,486,102.043a27.076,27.076,0,0,0-4.568-6.4,20.347,20.347,0,0,0-6.177-4.363,18.961,18.961,0,0,0-7.986-1.607,25.155,25.155,0,0,0-11.232,2.44,23.782,23.782,0,0,0-8.36,6.774,31.172,31.172,0,0,0-5.2,10.361,45.78,45.78,0,0,0-1.81,13.2A39.2,39.2,0,0,0,442.3,134.1a27.434,27.434,0,0,0,4.654,9.07,21.447,21.447,0,0,0,7.268,5.913,20.8,20.8,0,0,0,9.423,2.123,22.806,22.806,0,0,0,7.411-1.176,20.69,20.69,0,0,0,6.435-3.617,29.477,29.477,0,0,0,5.573-6.2,55.7,55.7,0,0,0,4.884-8.927h0.23q1.034,4.881,2.154,8.5a29.909,29.909,0,0,0,2.471,5.97,10.626,10.626,0,0,0,2.988,3.5,6.393,6.393,0,0,0,3.763,1.148A15.575,15.575,0,0,0,502.344,150.205Z"}),T.jsx("path",{className:lG,d:"M560.53,74.518v-7H505.373v7H529.1v75.314h7.642V74.518H560.53Zm36.431,75.314V111.6q0-10.906-5.027-16.418t-14.852-5.511a34.089,34.089,0,0,0-5.315.431,40.4,40.4,0,0,0-5.314,1.206,38.371,38.371,0,0,0-4.913,1.837,24.746,24.746,0,0,0-4.165,2.382v8.036q8.79-7.519,19.075-7.519,13.156,0,13.157,16.934l-17.868,2.583q-10,1.436-14.939,6.171t-4.941,12.715a17.574,17.574,0,0,0,1.293,6.831,15.016,15.016,0,0,0,3.677,5.309,16.459,16.459,0,0,0,5.8,3.416,22.943,22.943,0,0,0,7.67,1.205,20.793,20.793,0,0,0,11.233-3.1,21.592,21.592,0,0,0,7.842-8.726h0.23v10.448h7.354Zm-7.354-30.654v5.8a22.984,22.984,0,0,1-1.35,7.979,19.184,19.184,0,0,1-3.735,6.315,16.964,16.964,0,0,1-12.841,5.625,15.311,15.311,0,0,1-5.142-.8,10.944,10.944,0,0,1-3.85-2.267,9.77,9.77,0,0,1-2.413-3.473,11.263,11.263,0,0,1-.833-4.363,14.329,14.329,0,0,1,.862-5.309,8.663,8.663,0,0,1,2.7-3.617,13.944,13.944,0,0,1,4.654-2.325,46.1,46.1,0,0,1,6.78-1.435Zm27.928,21.182q6.09,10.849,18.558,10.849a24.891,24.891,0,0,0,11-2.382,23.994,23.994,0,0,0,8.359-6.687,31.049,31.049,0,0,0,5.315-10.3,44.6,44.6,0,0,0,1.867-13.289A40.411,40.411,0,0,0,661,106.664a26.788,26.788,0,0,0-4.711-9.127,20.619,20.619,0,0,0-7.527-5.826A25.565,25.565,0,0,0,626.3,92.916a23.365,23.365,0,0,0-8.762,9.386H617.3V62.808h-7.354v87.024H617.3V140.36h0.23Zm-0.23-22.789a25.064,25.064,0,0,1,1.379-8.352,20.486,20.486,0,0,1,3.964-6.86,18.656,18.656,0,0,1,6.263-4.621,19.561,19.561,0,0,1,8.274-1.693,17.175,17.175,0,0,1,7.383,1.55,15.551,15.551,0,0,1,5.63,4.478,21.124,21.124,0,0,1,3.591,7.089,32.071,32.071,0,0,1,1.264,9.328A40.881,40.881,0,0,1,653.7,129.4a25.723,25.723,0,0,1-3.849,8.324,17.429,17.429,0,0,1-6.062,5.309,16.936,16.936,0,0,1-7.986,1.866,18.092,18.092,0,0,1-7.556-1.55,17.477,17.477,0,0,1-5.831-4.219,19.555,19.555,0,0,1-3.764-6.2,20.947,20.947,0,0,1-1.35-7.548v-7.807Z"}),T.jsx("path",{className:uG,d:"M169.275,36.386V142.305c-2.905-3.491-7.753-5.425-14.038-5.425-14.459,0-27.1,11.607-27.1,24.378,0,9.766,6.728,14.635,17.088,14.635,15.636,0,27.031-11.977,27.1-24.3V65.77c15.4,7.886,26.484,15.751,32.457,27.168C210.83,104.5,207,120.5,190.548,135.122c-0.421,1.521.258,2.306,1.447,2.254,29.206-24.517,24.482-55.245-2.072-76.383-8.654-6.888-14.95-16.1-17.6-24.608h-3.05Z"})]})]})},fG=R`
  padding: 0px 40px;
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  align-items: center;
  height: 160px;
  width: 100%;
  background-color: #ffffff15;
`,pG=R`
  display: flex;
  flex-direction: column;
  gap: 10px;
  justify-self: start;
`,gG=R`
  display: flex;
  flex-direction: column;
  gap: 10px;
  align-items: center;
  justify-content: center;
`,mG=R`
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: center;
  justify-self: center;
  gap: 10px;
`,yG=R`
  justify-self: end;
`,bG=({isPlaying:i,isLooping:e,bassVolume:t,metronomeVolume:r,chordsVolume:n,onPlayPause:s,onLoop:a,onStop:o,onBassVolumeChange:l,onChordsVolumeChange:u,onMetronomeVolumeChange:c})=>T.jsxs("div",{className:fG,children:[T.jsxs("div",{className:pG,children:[T.jsx(zg,{Icon:p4,value:r,onChange:c,"data-tooltip":"Tooltips.Score.MetronomeVolume"}),T.jsx(zg,{Icon:TN,value:t,onChange:l,"data-tooltip":"Tooltips.Score.BassVolume"}),T.jsx(zg,{Icon:eG,value:n,onChange:u,"data-tooltip":"Tooltips.Score.ChordsVolume"})]}),T.jsx("div",{className:gG,children:T.jsxs("div",{className:mG,children:[T.jsx(aG,{onClick:o,"data-tooltip":"Tooltips.Score.Stop"}),T.jsx(nG,{onClick:s,isToggled:i,"data-tooltip":"Tooltips.Score.PlayPause"}),T.jsx(sG,{onClick:a,isToggled:e,"data-tooltip":"Tooltips.Score.Loop"})]})}),T.jsx(dG,{className:yG})]}),vG=R`
  //.at-wrap
  width: 100vw;
  height: calc(100vh - 100px);
  margin: 0 auto;
  border: 1px solid rgba(0, 0, 0, 0.12);
  display: flex;
  flex-direction: column;
  overflow: hidden;
  position: relative;
`,wG=R`
  // .at-content
  position: relative;
  overflow: hidden;
  flex: 1 1 auto;
`,SG=R`
  // .at-viewport
  overflow-y: auto;
  position: absolute;
  top: 0px;
  left: 0px;
  right: 0px;
  bottom: 0px;
  padding: 20px;
`,xG=()=>{const[i,e]=S.useState(),[t,r]=S.useState(),n=S.useCallback(B=>{e(B??void 0)},[]),s=S.useCallback(B=>{r(B??void 0)},[]),a=es(),o=(a==null?void 0:a.bpm)??120,{isLooping:l,bassVolume:u,metronomeVolume:c,chordsVolume:h}=l1(),d=T6(a==null?void 0:a.id),f=On(),p=()=>x==null?void 0:x.playPause(),g=()=>f(Ra.actions.updateConfig({isLooping:!l})),y=()=>x==null?void 0:x.stop(),b=B=>f(Ra.actions.updateConfig({bassVolume:B})),m=B=>f(Ra.actions.updateConfig({chordsVolume:B})),v=B=>f(Ra.actions.updateConfig({metronomeVolume:B})),k=B=>{f(Vi.actions.updateProgression({progressionId:a==null?void 0:a.id,updates:{bpm:B}}))},{api:x,isPlaying:C,isLoading:N}=KW({tex:d,bassVolume:u,chordsVolume:h,isLooping:l,metronomeVolume:c,root:t,scrollArea:i,bpm:o});return T.jsxs("div",{className:vG,children:[T.jsx(Wz,{isVisible:N}),T.jsx("div",{className:wG,children:T.jsx("div",{className:SG,ref:n,children:T.jsx("div",{className:"at-main",ref:s})})}),T.jsx(bG,{bpm:o,isPlaying:C,isLooping:l,bassVolume:u,chordsVolume:h,metronomeVolume:c,onLoop:g,onStop:y,onPlayPause:p,onTempoChange:k,onBassVolumeChange:b,onChordsVolumeChange:m,onMetronomeVolumeChange:v})]})},kG=R`
  display: flex;
  flex-direction: column;
  color: #fff;
  align-items: center;
  justify-content: center;
  height: calc(100vh - 200px);
`,TG=R`
  font-size: 8em;
`,CG=R`
  font-size: 2.6em;
  font-weight: bold;
`,NG=R`
  display: flex;
  flex-direction: column;
  gap: 6px;
  background-color: #ffffff20;
  border-radius: 10px;
  padding: 12px 20px;
  font-size: 1.1em;
  margin-top: 20px;
`,BG=R`
  font-size: 1.2em;
  font-weight: bold;
`,_G=R`
  display: block;
  list-style-position: inside;
`,PG=()=>{const{t:i}=vt();return T.jsxs("div",{className:kG,children:[T.jsx(yN,{className:TG}),T.jsx("span",{className:CG,children:i("Errors.ScoreCannotBeGenerated")}),T.jsxs("div",{className:NG,children:[T.jsx("span",{className:BG,children:i("Errors.WhatsMissing")}),T.jsxs("ul",{className:_G,children:[T.jsx("li",{children:i("Errors.AtLeast2Bars")}),T.jsx("li",{children:i("Errors.AtLeast1Chord")}),T.jsx("li",{children:i("Errors.NeedsTransitions")})]})]})]})},RG=R`
  height: 100%;
  width: 100%;
  display: flex;
  flex-direction: column;
`,EG=()=>{const i=es(),{canGenerateScore:e}=Vr(t=>n2(t,i.id));return T.jsxs(T.Fragment,{children:[T.jsxs(mc,{children:[T.jsx(oB,{}),T.jsx(yc,{})]}),T.jsxs("div",{className:RG,children:[e?null:T.jsx(PG,{}),e?T.jsx(xG,{}):null]})]})};var qB={exports:{}};(function(i){(function(e){let t;function r(c,h){const d=c.charCodeAt(h);if(isNaN(d))throw new RangeError("Index "+h+' out of range for string "'+c+'"; please open an issue at https://github.com/Trott/slug/issues/new');if(d<55296||d>57343)return[c.charAt(h),h];if(d>=55296&&d<=56319){if(c.length<=h+1)return[" ",h];const p=c.charCodeAt(h+1);return p<56320||p>57343?[" ",h]:[c.charAt(h)+c.charAt(h+1),h+1]}if(h===0)return[" ",h];const f=c.charCodeAt(h-1);if(f<55296||f>56319)return[" ",h];throw new Error('String "'+c+'" reaches code believed to be unreachable; please open an issue at https://github.com/Trott/slug/issues/new')}typeof window<"u"?window.btoa?t=function(c){return btoa(unescape(encodeURIComponent(c)))}:t=function(c){const h=unescape(encodeURIComponent(c+""));let d="";for(let f,p,g=0,y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";h.charAt(g|0)||(y="=",g%1);d+=y.charAt(63&f>>8-g%1*8)){if(p=h.charCodeAt(g+=3/4),p>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");f=f<<8|p}return d}:t=function(c){return Buffer.from(c).toString("base64")};function n(c,h){let d=o(c,h);if((h&&h.fallback!==void 0?h.fallback:n.defaults.fallback)===!0&&d===""){let p="";for(let g=0;g<c.length;g++){const y=r(c,g);g=y[1],p+=y[0]}d=o(t(p),h)}return d}const s={bg:{Й:"Y",й:"y",X:"H",x:"h",Ц:"Ts",ц:"ts",Щ:"Sht",щ:"sht",Ъ:"A",ъ:"a",Ь:"Y",ь:"y"},de:{Ä:"AE",ä:"ae",Ö:"OE",ö:"oe",Ü:"UE",ü:"ue"},sr:{đ:"dj",Đ:"DJ"},uk:{И:"Y",и:"y",Й:"Y",й:"y",Ц:"Ts",ц:"ts",Х:"Kh",х:"kh",Щ:"Shch",щ:"shch",Г:"H",г:"h"}};let a={};function o(c,h){if(typeof c!="string")throw new Error("slug() requires a string argument, received "+typeof c);typeof h=="string"&&(h={replacement:h}),h=h?Object.assign({},h):{},h.mode=h.mode||n.defaults.mode;const d=n.defaults.modes[h.mode],f=["replacement","multicharmap","charmap","remove","lower","trim"];for(let m,v=0,k=f.length;v<k;v++)m=f[v],h[m]=m in h?h[m]:d[m];const p=s[h.locale]||a;let g=[];for(const m in h.multicharmap){if(!Object.prototype.hasOwnProperty.call(h.multicharmap,m))continue;const v=m.length;g.indexOf(v)===-1&&g.push(v)}g=g.sort(function(m,v){return v-m});const y=h.mode==="rfc3986"?/[^\w\s\-.~]/:/[^A-Za-z0-9\s]/;let b="";for(let m,v=0,k=c.length;v<k;v++){m=c[v];let x=!1;for(let C=0;C<g.length;C++){const N=g[C],B=c.substr(v,N);if(h.multicharmap[B]){v+=N-1,m=h.multicharmap[B],x=!0;break}}x||(p[m]?m=p[m]:h.charmap[m]?m=h.charmap[m].replace(h.replacement," "):m.includes(h.replacement)?m=m.replace(h.replacement," "):m=m.replace(y,"")),b+=m}return h.remove&&(b=b.replace(h.remove,"")),h.trim&&(b=b.trim()),b=b.replace(/\s+/g,h.replacement),h.lower&&(b=b.toLowerCase()),b}const l={फ़:"Fi",ग़:"Ghi",ख़:"Khi",क़:"Qi",ड़:"ugDha",ढ़:"ugDhha",य़:"Yi",ज़:"Za",בִי:"i",בֵ:"e",בֵי:"e",בֶ:"e",בַ:"a",בָ:"a",בֹ:"o",וֹ:"o",בֻ:"u",וּ:"u",בּ:"b",כּ:"k",ךּ:"k",פּ:"p",שׁ:"sh",שׂ:"s",בְ:"e",חֱ:"e",חֲ:"a",חֳ:"o",בִ:"i"},u={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",Æ:"AE",Ç:"C",È:"E",É:"E",Ê:"E",Ë:"E",Ì:"I",Í:"I",Î:"I",Ï:"I",Ð:"D",Ñ:"N",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ő:"O",Ø:"O",Ō:"O",Ù:"U",Ú:"U",Û:"U",Ü:"U",Ű:"U",Ý:"Y",Þ:"TH",ß:"ss",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",æ:"ae",ç:"c",è:"e",é:"e",ê:"e",ë:"e",ì:"i",í:"i",î:"i",ï:"i",ð:"d",ñ:"n",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ő:"o",ø:"o",ō:"o",Œ:"OE",œ:"oe",ù:"u",ú:"u",û:"u",ü:"u",ű:"u",ý:"y",þ:"th",ÿ:"y","ẞ":"SS",α:"a",β:"b",γ:"g",δ:"d",ε:"e",ζ:"z",η:"h",θ:"th",ι:"i",κ:"k",λ:"l",μ:"m",ν:"n",ξ:"3",ο:"o",π:"p",ρ:"r",σ:"s",τ:"t",υ:"y",φ:"f",χ:"x",ψ:"ps",ω:"w",ά:"a",έ:"e",ί:"i",ό:"o",ύ:"y",ή:"h",ώ:"w",ς:"s",ϊ:"i",ΰ:"y",ϋ:"y",ΐ:"i",Α:"A",Β:"B",Γ:"G",Δ:"D",Ε:"E",Ζ:"Z",Η:"H",Θ:"Th",Ι:"I",Κ:"K",Λ:"L",Μ:"M",Ν:"N",Ξ:"3",Ο:"O",Π:"P",Ρ:"R",Σ:"S",Τ:"T",Υ:"Y",Φ:"F",Χ:"X",Ψ:"PS",Ω:"W",Ά:"A",Έ:"E",Ί:"I",Ό:"O",Ύ:"Y",Ή:"H",Ώ:"W",Ϊ:"I",Ϋ:"Y",ş:"s",Ş:"S",ı:"i",İ:"I",ğ:"g",Ğ:"G",а:"a",б:"b",в:"v",г:"g",д:"d",е:"e",ё:"yo",ж:"zh",з:"z",и:"i",й:"j",к:"k",л:"l",м:"m",н:"n",о:"o",п:"p",р:"r",с:"s",т:"t",у:"u",ф:"f",х:"h",ц:"c",ч:"ch",ш:"sh",щ:"sh",ъ:"u",ы:"y",ь:"",э:"e",ю:"yu",я:"ya",А:"A",Б:"B",В:"V",Г:"G",Д:"D",Е:"E",Ё:"Yo",Ж:"Zh",З:"Z",И:"I",Й:"J",К:"K",Л:"L",М:"M",Н:"N",О:"O",П:"P",Р:"R",С:"S",Т:"T",У:"U",Ф:"F",Х:"H",Ц:"C",Ч:"Ch",Ш:"Sh",Щ:"Sh",Ъ:"U",Ы:"Y",Ь:"",Э:"E",Ю:"Yu",Я:"Ya",Є:"Ye",І:"I",Ї:"Yi",Ґ:"G",є:"ye",і:"i",ї:"yi",ґ:"g",č:"c",ď:"d",ě:"e",ň:"n",ř:"r",š:"s",ť:"t",ů:"u",ž:"z",Č:"C",Ď:"D",Ě:"E",Ň:"N",Ř:"R",Š:"S",Ť:"T",Ů:"U",Ž:"Z",ľ:"l",ĺ:"l",ŕ:"r",Ľ:"L",Ĺ:"L",Ŕ:"R",ą:"a",ć:"c",ę:"e",ł:"l",ń:"n",ś:"s",ź:"z",ż:"z",Ą:"A",Ć:"C",Ę:"E",Ł:"L",Ń:"N",Ś:"S",Ź:"Z",Ż:"Z",ā:"a",ē:"e",ģ:"g",ī:"i",ķ:"k",ļ:"l",ņ:"n",ū:"u",Ā:"A",Ē:"E",Ģ:"G",Ī:"I",Ķ:"K",Ļ:"L",Ņ:"N",Ū:"U",أ:"a",إ:"i",ب:"b",ت:"t",ث:"th",ج:"g",ح:"h",خ:"kh",د:"d",ذ:"th",ر:"r",ز:"z",س:"s",ش:"sh",ص:"s",ض:"d",ط:"t",ظ:"th",ع:"aa",غ:"gh",ف:"f",ق:"k",ك:"k",ل:"l",م:"m",ن:"n",ه:"h",و:"o",ي:"y",ء:"aa",ة:"a",آ:"a",ا:"a",پ:"p",ژ:"zh",گ:"g",چ:"ch",ک:"k",ی:"i",ė:"e",į:"i",ų:"u",Ė:"E",Į:"I",Ų:"U",ț:"t",Ț:"T",ţ:"t",Ţ:"T",ș:"s",Ș:"S",ă:"a",Ă:"A",Ạ:"A",Ả:"A",Ầ:"A",Ấ:"A",Ậ:"A",Ẩ:"A",Ẫ:"A",Ằ:"A",Ắ:"A",Ặ:"A",Ẳ:"A",Ẵ:"A",Ẹ:"E",Ẻ:"E",Ẽ:"E",Ề:"E",Ế:"E",Ệ:"E",Ể:"E",Ễ:"E",Ị:"I",Ỉ:"I",Ĩ:"I",Ọ:"O",Ỏ:"O",Ồ:"O",Ố:"O",Ộ:"O",Ổ:"O",Ỗ:"O",Ơ:"O",Ờ:"O",Ớ:"O",Ợ:"O",Ở:"O",Ỡ:"O",Ụ:"U",Ủ:"U",Ũ:"U",Ư:"U",Ừ:"U",Ứ:"U",Ự:"U",Ử:"U",Ữ:"U",Ỳ:"Y",Ỵ:"Y",Ỷ:"Y",Ỹ:"Y",Đ:"D",ạ:"a",ả:"a",ầ:"a",ấ:"a",ậ:"a",ẩ:"a",ẫ:"a",ằ:"a",ắ:"a",ặ:"a",ẳ:"a",ẵ:"a",ẹ:"e",ẻ:"e",ẽ:"e",ề:"e",ế:"e",ệ:"e",ể:"e",ễ:"e",ị:"i",ỉ:"i",ĩ:"i",ọ:"o",ỏ:"o",ồ:"o",ố:"o",ộ:"o",ổ:"o",ỗ:"o",ơ:"o",ờ:"o",ớ:"o",ợ:"o",ở:"o",ỡ:"o",ụ:"u",ủ:"u",ũ:"u",ư:"u",ừ:"u",ứ:"u",ự:"u",ử:"u",ữ:"u",ỳ:"y",ỵ:"y",ỷ:"y",ỹ:"y",đ:"d",Ә:"AE",ә:"ae",Ғ:"GH",ғ:"gh",Қ:"KH",қ:"kh",Ң:"NG",ң:"ng",Ү:"UE",ү:"ue",Ұ:"U",ұ:"u",Һ:"H",һ:"h",Ө:"OE",ө:"oe",ђ:"dj",ј:"j",љ:"lj",њ:"nj",ћ:"c",џ:"dz",Ђ:"Dj",Ј:"j",Љ:"Lj",Њ:"Nj",Ћ:"C",Џ:"Dz",ǌ:"nj",ǉ:"lj",ǋ:"NJ",ǈ:"LJ",अ:"a",आ:"aa",ए:"e",ई:"ii",ऍ:"ei",ऎ:"ae",ऐ:"ai",इ:"i",ओ:"o",ऑ:"oi",ऒ:"oii",ऊ:"uu",औ:"ou",उ:"u",ब:"B",भ:"Bha",च:"Ca",छ:"Chha",ड:"Da",ढ:"Dha",फ:"Fa",ग:"Ga",घ:"Gha",ग़:"Ghi",ह:"Ha",ज:"Ja",झ:"Jha",क:"Ka",ख:"Kha",ख़:"Khi",ल:"L",ळ:"Li",ऌ:"Li",ऴ:"Lii",ॡ:"Lii",म:"Ma",न:"Na",ङ:"Na",ञ:"Nia",ण:"Nae",ऩ:"Ni",ॐ:"oms",प:"Pa",क़:"Qi",र:"Ra",ऋ:"Ri",ॠ:"Ri",ऱ:"Ri",स:"Sa",श:"Sha",ष:"Shha",ट:"Ta",त:"Ta",ठ:"Tha",द:"Tha",थ:"Tha",ध:"Thha",ड़:"ugDha",ढ़:"ugDhha",व:"Va",य:"Ya",य़:"Yi",ज़:"Za",ə:"e",Ə:"E",ა:"a",ბ:"b",გ:"g",დ:"d",ე:"e",ვ:"v",ზ:"z",თ:"t",ი:"i",კ:"k",ლ:"l",მ:"m",ნ:"n",ო:"o",პ:"p",ჟ:"zh",რ:"r",ს:"s",ტ:"t",უ:"u",ფ:"p",ქ:"k",ღ:"gh",ყ:"q",შ:"sh",ჩ:"ch",ც:"ts",ძ:"dz",წ:"ts",ჭ:"ch",ხ:"kh",ჯ:"j",ჰ:"h",ב:"v",גּ:"g",ג:"g",ד:"d",דּ:"d",ה:"h",ו:"v",ז:"z",ח:"h",ט:"t",י:"y",כ:"kh",ך:"kh",ל:"l",מ:"m",ם:"m",נ:"n",ן:"n",ס:"s",פ:"f",ף:"f",ץ:"ts",צ:"ts",ק:"k",ר:"r",תּ:"t",ת:"t"};n.charmap=Object.assign({},u),n.multicharmap=Object.assign({},l),n.defaults={charmap:n.charmap,mode:"pretty",modes:{rfc3986:{replacement:"-",remove:null,lower:!0,charmap:n.charmap,multicharmap:n.multicharmap,trim:!0},pretty:{replacement:"-",remove:null,lower:!0,charmap:n.charmap,multicharmap:n.multicharmap,trim:!0}},multicharmap:n.multicharmap,fallback:!0},n.reset=function(){n.defaults.modes.rfc3986.charmap=n.defaults.modes.pretty.charmap=n.charmap=n.defaults.charmap=Object.assign({},u),n.defaults.modes.rfc3986.multicharmap=n.defaults.modes.pretty.multicharmap=n.multicharmap=n.defaults.multicharmap=Object.assign({},l),a=""},n.extend=function(c){const h=Object.keys(c),d={},f={};for(let p=0;p<h.length;p++)h[p].length>1?d[h[p]]=c[h[p]]:f[h[p]]=c[h[p]];Object.assign(n.charmap,f),Object.assign(n.multicharmap,d)},n.setLocale=function(c){a=s[c]||{}},i.exports?i.exports=n:e.slug=n})(gs)})(qB);var MG=qB.exports;const JB=ec(MG);function po(i,e,t){if(t.has(i))return t.get(i);const r=`${e}-${Ir()}`;return t.set(i,r),r}function OG(i,e){const{progressions:t}=i;let r=JB(e,{replacement:"-"});return IC(r,new Set(Object.keys(t)))}function ph(i,e,t){const r=OG(i,t),n=new Map,s=Object.fromEntries(Object.entries(e.chords).map(([l,u])=>[po(l,r,n),{...u,id:po(l,r,n)}])),a=Object.fromEntries(Object.entries(e.bars).map(([l,u])=>[po(l,r,n),{...u,id:po(l,r,n),chords:u.chords.map(c=>po(c,r,n))}])),o={...e.progression,id:r,name:t,bars:e.progression.bars.map(l=>po(l,r,n))};return{chords:s,bars:a,progression:o}}const IG={progression:{id:"a-minor-blues",noteCount:4,tuning:["G2","D2","A1","E1"],name:"A Minor Blues",bars:["a-minor-blues-bar-0","a-minor-blues-bar-1","a-minor-blues-bar-2","a-minor-blues-bar-3","a-minor-blues-bar-4","a-minor-blues-bar-5","a-minor-blues-bar-6","a-minor-blues-bar-7","a-minor-blues-bar-8","a-minor-blues-bar-9","a-minor-blues-bar-10","a-minor-blues-bar-11","a-minor-blues-bar-12"]},bars:{"a-minor-blues-bar-0":{id:"a-minor-blues-bar-0",chords:["a-minor-blues-chord-am-0"]},"a-minor-blues-bar-1":{id:"a-minor-blues-bar-1",chords:["a-minor-blues-chord-am-1"]},"a-minor-blues-bar-2":{id:"a-minor-blues-bar-2",chords:["a-minor-blues-chord-am-2"]},"a-minor-blues-bar-3":{id:"a-minor-blues-bar-3",chords:["a-minor-blues-chord-am-3"]},"a-minor-blues-bar-4":{id:"a-minor-blues-bar-4",chords:["a-minor-blues-chord-dm-4"]},"a-minor-blues-bar-5":{id:"a-minor-blues-bar-5",chords:["a-minor-blues-chord-dm-5"]},"a-minor-blues-bar-6":{id:"a-minor-blues-bar-6",chords:["a-minor-blues-chord-am-6"]},"a-minor-blues-bar-7":{id:"a-minor-blues-bar-7",chords:["a-minor-blues-chord-am-7"]},"a-minor-blues-bar-8":{id:"a-minor-blues-bar-8",chords:["a-minor-blues-chord-em-8"]},"a-minor-blues-bar-9":{id:"a-minor-blues-bar-9",chords:["a-minor-blues-chord-dm-9"]},"a-minor-blues-bar-10":{id:"a-minor-blues-bar-10",chords:["a-minor-blues-chord-am-10"]},"a-minor-blues-bar-11":{id:"a-minor-blues-bar-11",chords:["a-minor-blues-chord-e7-11"]},"a-minor-blues-bar-12":{id:"a-minor-blues-bar-12",chords:["a-minor-blues-chord-am-12"]}},chords:{"a-minor-blues-chord-am-0":{id:"a-minor-blues-chord-am-0",name:"A",type:"MINOR",root:"A1"},"a-minor-blues-chord-am-1":{id:"a-minor-blues-chord-am-1",name:"A",type:"MINOR",root:"A1"},"a-minor-blues-chord-am-2":{id:"a-minor-blues-chord-am-2",name:"A",type:"MINOR",root:"A1"},"a-minor-blues-chord-am-3":{id:"a-minor-blues-chord-am-3",name:"A",type:"MINOR",root:"A1"},"a-minor-blues-chord-dm-4":{id:"a-minor-blues-chord-dm-4",name:"D",type:"MINOR",root:"D2"},"a-minor-blues-chord-dm-5":{id:"a-minor-blues-chord-dm-5",name:"D",type:"MINOR",root:"D2"},"a-minor-blues-chord-am-6":{id:"a-minor-blues-chord-am-6",name:"A",type:"MINOR",root:"A1"},"a-minor-blues-chord-am-7":{id:"a-minor-blues-chord-am-7",name:"A",type:"MINOR",root:"A1"},"a-minor-blues-chord-em-8":{id:"a-minor-blues-chord-em-8",name:"E",type:"MINOR",root:"E1"},"a-minor-blues-chord-dm-9":{id:"a-minor-blues-chord-dm-9",name:"D",type:"MINOR",root:"D2"},"a-minor-blues-chord-am-10":{id:"a-minor-blues-chord-am-10",name:"A",type:"MINOR",root:"A1"},"a-minor-blues-chord-e7-11":{id:"a-minor-blues-chord-e7-11",name:"E",type:"DOMINANT-SEVENTH",root:"E1"},"a-minor-blues-chord-am-12":{id:"a-minor-blues-chord-am-12",name:"A",type:"MINOR",root:"A1"}}},LG={chords:{},bars:{},progression:{id:"empty",noteCount:4,tuning:["G2","D2","A1","E1"],name:"Empty",bars:[]}},DG={progression:{id:"autumn-leaves",tuning:["G2","D2","A1","E1"],noteCount:4,name:"Autumn Leaves",bars:["autumn-leaves-bar-0","autumn-leaves-bar-1","autumn-leaves-bar-2","autumn-leaves-bar-3","autumn-leaves-bar-4","autumn-leaves-bar-5","autumn-leaves-bar-6","autumn-leaves-bar-7","autumn-leaves-bar-8","autumn-leaves-bar-9","autumn-leaves-bar-10","autumn-leaves-bar-11","autumn-leaves-bar-12","autumn-leaves-bar-13","autumn-leaves-bar-14","autumn-leaves-bar-15","autumn-leaves-bar-16","autumn-leaves-bar-17","autumn-leaves-bar-18","autumn-leaves-bar-19","autumn-leaves-bar-20","autumn-leaves-bar-21","autumn-leaves-bar-22","autumn-leaves-bar-23","autumn-leaves-bar-24","autumn-leaves-bar-25","autumn-leaves-bar-26","autumn-leaves-bar-27","autumn-leaves-bar-28","autumn-leaves-bar-29","autumn-leaves-bar-30","autumn-leaves-bar-31","autumn-leaves-bar-32"]},bars:{"autumn-leaves-bar-0":{id:"autumn-leaves-bar-0",chords:["autumn-leaves-chord-cm7-0"]},"autumn-leaves-bar-1":{id:"autumn-leaves-bar-1",chords:["autumn-leaves-chord-f7-1"]},"autumn-leaves-bar-2":{id:"autumn-leaves-bar-2",chords:["autumn-leaves-chord-bbmaj7-2"]},"autumn-leaves-bar-3":{id:"autumn-leaves-bar-3",chords:["autumn-leaves-chord-ebmaj7-3"]},"autumn-leaves-bar-4":{id:"autumn-leaves-bar-4",chords:["autumn-leaves-chord-adim-4"]},"autumn-leaves-bar-5":{id:"autumn-leaves-bar-5",chords:["autumn-leaves-chord-d7-5"]},"autumn-leaves-bar-6":{id:"autumn-leaves-bar-6",chords:["autumn-leaves-chord-gm7-6"]},"autumn-leaves-bar-7":{id:"autumn-leaves-bar-7",chords:["autumn-leaves-chord-gm7-7"]},"autumn-leaves-bar-8":{id:"autumn-leaves-bar-8",chords:["autumn-leaves-chord-cm7-8"]},"autumn-leaves-bar-9":{id:"autumn-leaves-bar-9",chords:["autumn-leaves-chord-f7-9"]},"autumn-leaves-bar-10":{id:"autumn-leaves-bar-10",chords:["autumn-leaves-chord-bbmaj7-10"]},"autumn-leaves-bar-11":{id:"autumn-leaves-bar-11",chords:["autumn-leaves-chord-ebmaj7-11"]},"autumn-leaves-bar-12":{id:"autumn-leaves-bar-12",chords:["autumn-leaves-chord-adim-12"]},"autumn-leaves-bar-13":{id:"autumn-leaves-bar-13",chords:["autumn-leaves-chord-d7-13"]},"autumn-leaves-bar-14":{id:"autumn-leaves-bar-14",chords:["autumn-leaves-chord-gm7-14"]},"autumn-leaves-bar-15":{id:"autumn-leaves-bar-15",chords:["autumn-leaves-chord-gm7-15"]},"autumn-leaves-bar-16":{id:"autumn-leaves-bar-16",chords:["autumn-leaves-chord-adim-16"]},"autumn-leaves-bar-17":{id:"autumn-leaves-bar-17",chords:["autumn-leaves-chord-d7-17"]},"autumn-leaves-bar-18":{id:"autumn-leaves-bar-18",chords:["autumn-leaves-chord-gm7-18"]},"autumn-leaves-bar-19":{id:"autumn-leaves-bar-19",chords:["autumn-leaves-chord-gm7-19"]},"autumn-leaves-bar-20":{id:"autumn-leaves-bar-20",chords:["autumn-leaves-chord-cm7-20"]},"autumn-leaves-bar-21":{id:"autumn-leaves-bar-21",chords:["autumn-leaves-chord-f7-21"]},"autumn-leaves-bar-22":{id:"autumn-leaves-bar-22",chords:["autumn-leaves-chord-bbmaj7-22"]},"autumn-leaves-bar-23":{id:"autumn-leaves-bar-23",chords:["autumn-leaves-chord-bbmaj7-23"]},"autumn-leaves-bar-24":{id:"autumn-leaves-bar-24",chords:["autumn-leaves-chord-adim-24"]},"autumn-leaves-bar-25":{id:"autumn-leaves-bar-25",chords:["autumn-leaves-chord-d7-25"]},"autumn-leaves-bar-26":{id:"autumn-leaves-bar-26",chords:["autumn-leaves-chord-gm7-26","autumn-leaves-chord-gb7-27"]},"autumn-leaves-bar-27":{id:"autumn-leaves-bar-27",chords:["autumn-leaves-chord-fm7-28","autumn-leaves-chord-e7-29"]},"autumn-leaves-bar-28":{id:"autumn-leaves-bar-28",chords:["autumn-leaves-chord-ebmaj7-30"]},"autumn-leaves-bar-29":{id:"autumn-leaves-bar-29",chords:["autumn-leaves-chord-d7-31"]},"autumn-leaves-bar-30":{id:"autumn-leaves-bar-30",chords:["autumn-leaves-chord-gm7-32"]},"autumn-leaves-bar-31":{id:"autumn-leaves-bar-31",chords:["autumn-leaves-chord-gm7-33"]},"autumn-leaves-bar-32":{id:"autumn-leaves-bar-32",chords:["autumn-leaves-chord-cm7-34"]}},chords:{"autumn-leaves-chord-cm7-0":{id:"autumn-leaves-chord-cm7-0",name:"C",type:"MINOR-SEVENTH",root:"C2"},"autumn-leaves-chord-f7-1":{id:"autumn-leaves-chord-f7-1",name:"F",type:"DOMINANT-SEVENTH",root:"F1"},"autumn-leaves-chord-bbmaj7-2":{id:"autumn-leaves-chord-bbmaj7-2",name:"Bb",type:"MAJOR-SEVENTH",root:"Bb1"},"autumn-leaves-chord-ebmaj7-3":{id:"autumn-leaves-chord-ebmaj7-3",name:"Eb",type:"MAJOR-SEVENTH",root:"Eb2"},"autumn-leaves-chord-adim-4":{id:"autumn-leaves-chord-adim-4",name:"A",type:"DIMINISHED",root:"A1"},"autumn-leaves-chord-d7-5":{id:"autumn-leaves-chord-d7-5",name:"D",type:"DOMINANT-SEVENTH",root:"D2"},"autumn-leaves-chord-gm7-6":{id:"autumn-leaves-chord-gm7-6",name:"G",type:"MINOR-SEVENTH",root:"G1"},"autumn-leaves-chord-gm7-7":{id:"autumn-leaves-chord-gm7-7",name:"G",type:"MINOR-SEVENTH",root:"G1"},"autumn-leaves-chord-cm7-8":{id:"autumn-leaves-chord-cm7-8",name:"C",type:"MINOR-SEVENTH",root:"C2"},"autumn-leaves-chord-f7-9":{id:"autumn-leaves-chord-f7-9",name:"F",type:"DOMINANT-SEVENTH",root:"F1"},"autumn-leaves-chord-bbmaj7-10":{id:"autumn-leaves-chord-bbmaj7-10",name:"Bb",type:"MAJOR-SEVENTH",root:"Bb1"},"autumn-leaves-chord-ebmaj7-11":{id:"autumn-leaves-chord-ebmaj7-11",name:"Eb",type:"MAJOR-SEVENTH",root:"Eb2"},"autumn-leaves-chord-adim-12":{id:"autumn-leaves-chord-adim-12",name:"A",type:"DIMINISHED",root:"A1"},"autumn-leaves-chord-d7-13":{id:"autumn-leaves-chord-d7-13",name:"D",type:"DOMINANT-SEVENTH",root:"D2"},"autumn-leaves-chord-gm7-14":{id:"autumn-leaves-chord-gm7-14",name:"G",type:"MINOR-SEVENTH",root:"G1"},"autumn-leaves-chord-gm7-15":{id:"autumn-leaves-chord-gm7-15",name:"G",type:"MINOR-SEVENTH",root:"G1"},"autumn-leaves-chord-adim-16":{id:"autumn-leaves-chord-adim-16",name:"A",type:"DIMINISHED",root:"A1"},"autumn-leaves-chord-d7-17":{id:"autumn-leaves-chord-d7-17",name:"D",type:"DOMINANT-SEVENTH",root:"D2"},"autumn-leaves-chord-gm7-18":{id:"autumn-leaves-chord-gm7-18",name:"G",type:"MINOR-SEVENTH",root:"G1"},"autumn-leaves-chord-gm7-19":{id:"autumn-leaves-chord-gm7-19",name:"G",type:"MINOR-SEVENTH",root:"G1"},"autumn-leaves-chord-cm7-20":{id:"autumn-leaves-chord-cm7-20",name:"C",type:"MINOR-SEVENTH",root:"C2"},"autumn-leaves-chord-f7-21":{id:"autumn-leaves-chord-f7-21",name:"F",type:"DOMINANT-SEVENTH",root:"F1"},"autumn-leaves-chord-bbmaj7-22":{id:"autumn-leaves-chord-bbmaj7-22",name:"Bb",type:"MAJOR-SEVENTH",root:"Bb1"},"autumn-leaves-chord-bbmaj7-23":{id:"autumn-leaves-chord-bbmaj7-23",name:"Bb",type:"MAJOR-SEVENTH",root:"Bb1"},"autumn-leaves-chord-adim-24":{id:"autumn-leaves-chord-adim-24",name:"A",type:"DIMINISHED",root:"A1",tags:[]},"autumn-leaves-chord-d7-25":{id:"autumn-leaves-chord-d7-25",name:"D",type:"DOMINANT-SEVENTH",root:"D2",tags:[]},"autumn-leaves-chord-gm7-26":{id:"autumn-leaves-chord-gm7-26",name:"G",type:"MINOR-SEVENTH",root:"G1",noteCount:2},"autumn-leaves-chord-gb7-27":{id:"autumn-leaves-chord-gb7-27",name:"Gb",type:"DOMINANT-SEVENTH",root:"Gb1",noteCount:2},"autumn-leaves-chord-fm7-28":{id:"autumn-leaves-chord-fm7-28",name:"F",type:"MINOR-SEVENTH",root:"F1",noteCount:2},"autumn-leaves-chord-e7-29":{id:"autumn-leaves-chord-e7-29",name:"E",type:"DOMINANT-SEVENTH",root:"E1",noteCount:2},"autumn-leaves-chord-ebmaj7-30":{id:"autumn-leaves-chord-ebmaj7-30",name:"Eb",type:"MAJOR-SEVENTH",root:"Eb2"},"autumn-leaves-chord-d7-31":{id:"autumn-leaves-chord-d7-31",name:"D",type:"DOMINANT-SEVENTH",root:"D2"},"autumn-leaves-chord-gm7-32":{id:"autumn-leaves-chord-gm7-32",name:"G",type:"MINOR-SEVENTH",root:"G1"},"autumn-leaves-chord-gm7-33":{id:"autumn-leaves-chord-gm7-33",name:"G",type:"MINOR-SEVENTH",root:"G1"},"autumn-leaves-chord-cm7-34":{id:"autumn-leaves-chord-cm7-34",name:"C",type:"MINOR-SEVENTH",root:"C2"}}},FG={progression:{id:"all-my-loving",noteCount:4,bpm:155,tuning:["G2","D2","A1","E1"],name:"All My Loving",bars:["all-my-loving-bar-0","all-my-loving-bar-1","all-my-loving-bar-2","all-my-loving-bar-3","all-my-loving-bar-4","all-my-loving-bar-5","all-my-loving-bar-6","all-my-loving-bar-7","all-my-loving-bar-8","all-my-loving-bar-9","all-my-loving-bar-10","all-my-loving-bar-11","all-my-loving-bar-12","all-my-loving-bar-13","all-my-loving-bar-14","all-my-loving-bar-15"]},bars:{"all-my-loving-bar-0":{id:"all-my-loving-bar-0",chords:["all-my-loving-chord-f#m-0"]},"all-my-loving-bar-1":{id:"all-my-loving-bar-1",chords:["all-my-loving-chord-b7-1"]},"all-my-loving-bar-2":{id:"all-my-loving-bar-2",chords:["all-my-loving-chord-e-2"]},"all-my-loving-bar-3":{id:"all-my-loving-bar-3",chords:["all-my-loving-chord-c#m-3"]},"all-my-loving-bar-4":{id:"all-my-loving-bar-4",chords:["all-my-loving-chord-a-4"]},"all-my-loving-bar-5":{id:"all-my-loving-bar-5",chords:["all-my-loving-chord-f#m-5"]},"all-my-loving-bar-6":{id:"all-my-loving-bar-6",chords:["all-my-loving-chord-d-6"]},"all-my-loving-bar-7":{id:"all-my-loving-bar-7",chords:["all-my-loving-chord-b7-7"]},"all-my-loving-bar-8":{id:"all-my-loving-bar-8",chords:["all-my-loving-chord-f#m-8"]},"all-my-loving-bar-9":{id:"all-my-loving-bar-9",chords:["all-my-loving-chord-b7-9"]},"all-my-loving-bar-10":{id:"all-my-loving-bar-10",chords:["all-my-loving-chord-e-10"]},"all-my-loving-bar-11":{id:"all-my-loving-bar-11",chords:["all-my-loving-chord-c#m-11"]},"all-my-loving-bar-12":{id:"all-my-loving-bar-12",chords:["all-my-loving-chord-a-12"]},"all-my-loving-bar-13":{id:"all-my-loving-bar-13",chords:["all-my-loving-chord-b7-13"]},"all-my-loving-bar-14":{id:"all-my-loving-bar-14",chords:["all-my-loving-chord-e-14"]},"all-my-loving-bar-15":{id:"all-my-loving-bar-15",chords:["all-my-loving-chord-e-15"]}},chords:{"all-my-loving-chord-f#m-0":{id:"all-my-loving-chord-f#m-0",name:"F#",type:"MINOR",root:"F#1"},"all-my-loving-chord-b7-1":{id:"all-my-loving-chord-b7-1",name:"B",type:"DOMINANT-SEVENTH",root:"B1"},"all-my-loving-chord-e-2":{id:"all-my-loving-chord-e-2",name:"E",type:"MAJOR",root:"E1"},"all-my-loving-chord-c#m-3":{id:"all-my-loving-chord-c#m-3",name:"C#",type:"MINOR",root:"C#2"},"all-my-loving-chord-a-4":{id:"all-my-loving-chord-a-4",name:"A",type:"MAJOR",root:"A1"},"all-my-loving-chord-f#m-5":{id:"all-my-loving-chord-f#m-5",name:"F#",type:"MINOR",root:"F#1"},"all-my-loving-chord-d-6":{id:"all-my-loving-chord-d-6",name:"D",type:"MAJOR",root:"D2"},"all-my-loving-chord-b7-7":{id:"all-my-loving-chord-b7-7",name:"B",type:"DOMINANT-SEVENTH",root:"B1"},"all-my-loving-chord-f#m-8":{id:"all-my-loving-chord-f#m-8",name:"F#",type:"MINOR",root:"F#1"},"all-my-loving-chord-b7-9":{id:"all-my-loving-chord-b7-9",name:"B",type:"DOMINANT-SEVENTH",root:"B1"},"all-my-loving-chord-e-10":{id:"all-my-loving-chord-e-10",name:"E",type:"MAJOR",root:"E1"},"all-my-loving-chord-c#m-11":{id:"all-my-loving-chord-c#m-11",name:"C#",type:"MINOR",root:"C#2"},"all-my-loving-chord-a-12":{id:"all-my-loving-chord-a-12",name:"A",type:"MAJOR",root:"A1"},"all-my-loving-chord-b7-13":{id:"all-my-loving-chord-b7-13",name:"B",type:"DOMINANT-SEVENTH",root:"B1"},"all-my-loving-chord-e-14":{id:"all-my-loving-chord-e-14",name:"E",type:"MAJOR",root:"E1"},"all-my-loving-chord-e-15":{id:"all-my-loving-chord-e-15",name:"E",type:"MAJOR",root:"E1",noteCount:1}}};function AG(){const{t:i,i18n:e}=vt();return S.useMemo(()=>[{name:i("Templates.EmptyName"),Icon:m4,description:i("Templates.EmptyDescription"),factory:(r,n)=>ph(n,LG,r)},{name:i("Templates.AMinorBluesName"),Icon:Oh,description:i("Templates.AMinorBluesDescription"),factory:(r,n)=>ph(n,IG,r)},{name:i("Templates.AutumnLeavesName"),Icon:Oh,description:i("Templates.AutumnLeavesDescription"),factory:(r,n)=>ph(n,DG,r)},{name:i("Templates.AllMyLovingName"),Icon:Oh,description:i("Templates.AllMyLovingDescription"),factory:(r,n)=>ph(n,FG,r)}],[i,e.language])}const QB=R`
  display: flex;
  flex-direction: column;
  justify-content: center;
  gap: 10px;
  border-radius: 10px;
  background-color: #ffffff15;
`,ZB=R`
  display: flex;
  flex-direction: column;
  justify-content: center;
  gap: 10px;
`,VG=mi(ZB,R`
    padding: 12px 20px 20px 20px;
  `),HG=mi(ZB,R`
    padding: 12px 20px 0px 20px;
  `),e_=R`
  font-size: 1.6em;
  color: #fff;
  font-weight: normal;
`,t_=R`
  display: flex;
  flex-direction: row;
  align-items: center;
  border-radius: 10px;
  padding: 10px 14px;
  cursor: pointer;
  gap: 10px;
  width: 100%;
  &:hover {
    background-color: #ffffff30;
  }
`,zG=R`
  outline: 2px solid #ffffff50;
  background-color: #ffffff30;
  color: #ffffff;
  &:hover {
    outline: 2px solid #ffffff50;
    background-color: #ffffff30;
    color: #ffffff;
  }
`,i_=R`
  font-size: 2em;
  color: #ffffff;
`,r_=R`
  display: flex;
  flex-direction: column;
  flex: 1;
`,n_=R`
  color: #ffffff;
`,s_=R`
  color: #ffffff88;
`,UG=R`
  display: flex;
  flex-direction: row;
  gap: 10px;
  background-color: #ffffff10;
  padding: 20px;
`,WG=R`
  border-radius: 6px;
  background-color: #ffffff20;
  flex: 1;
  color: #ffffff;
  border: none;
  outline: none;
  padding: 10px 14px;
  font-size: 1em;
  &:hover {
    background-color: #ffffff30;
  }

  &:focus {
    background-color: #ffffff40;
  }

  &:disabled {
    background-color: #ffffff08;
    color: #ffffff50;
    cursor: not-allowed;
  }
`,GG=R`
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: center;
  border: none;
  color: #ffffffdd;
  padding: 8px 16px;
  gap: 6px;
  cursor: pointer;
  font-size: 1em;
  border-radius: 6px;
  background-color: transparent;
  background-color: #ffffff20;
  &:hover {
    color: #fff;
    background-color: #ffffff30;
  }
  &:disabled {
    background-color: transparent;
    color: #ffffff50;
    cursor: not-allowed;
  }
`,$G=()=>{const{t:i}=vt(),e=Vr(Vi.selectors.getProgressions);return e.length===0?null:T.jsx("div",{className:QB,children:T.jsxs("div",{className:VG,children:[T.jsx("h2",{className:e_,children:i("Home.RecentProgressions")}),e.map(t=>T.jsxs(ua,{to:xs.editor(t.id),className:t_,children:[T.jsx(Oh,{className:i_}),T.jsxs("div",{className:r_,children:[T.jsx("span",{className:n_,children:t.name}),T.jsxs("span",{className:s_,children:[t.bars.length," ",i("Home.Bars")]})]})]},t.id))]})})},jG=()=>{const i=S.useRef(null),{t:e}=vt(),t=AG(),[r,n]=S.useState(""),[s,a]=S.useState(!1),[o,l]=S.useState(),[u,c]=S.useState(!0),h=Vr(x=>x),d=Af(),f=Vr(Vi.selectors.getProgressions),p=A(o),g=On(),y=S.useMemo(()=>{const x=A(o)?"":o.name;return IC(x,new Set(f.map(({name:C})=>C))," ")},[o,f]);S.useEffect(()=>{if(s){const{current:x}=i;A(x)||(x.select(),x.focus()),a(!1)}},[s]);const b=()=>{if(A(o))return;const x=r.length===0||u?y:r,C=o.factory(x,h);g(R6({template:C})),d(xs.editor(C.progression.id))},m=x=>{n(x.target.value),c(!1)},v=()=>{r.length===0&&c(!0)},k=x=>()=>{l(x),a(!0)};return T.jsxs("div",{className:QB,children:[T.jsxs("div",{className:HG,children:[T.jsx("h2",{className:e_,children:e("Home.NewProgression")}),t.map(x=>{const C=mi(t_,x===o?zG:null);return T.jsxs("div",{className:C,onClick:k(x),children:[T.jsx(x.Icon,{className:i_}),T.jsxs("div",{className:r_,children:[T.jsx("span",{className:n_,children:x.name}),T.jsx("span",{className:s_,children:x.description})]})]},x.name)})]}),T.jsxs("div",{className:UG,children:[T.jsx("input",{ref:i,type:"text",placeholder:e("Home.ProgressionName"),className:WG,disabled:p,value:u?y:r,onChange:m,onBlur:v,onKeyDown:x=>{x.key==="Enter"&&b()}}),T.jsxs("button",{type:"button",className:GG,disabled:p,onClick:b,children:[T.jsx(Qy,{})," ",e("Home.Create")]})]})]})},YG=R`
  display: flex;
  flex-direction: column;
  gap: 20px;
  padding: 20px 60px;
  overflow: auto;
  height: calc(100vh - 100px);
`,XG=()=>T.jsxs(T.Fragment,{children:[T.jsxs(mc,{children:[T.jsx(L1,{}),T.jsx(yc,{})]}),T.jsxs("div",{className:YG,children:[T.jsx($G,{}),T.jsx(jG,{})]})]});function KG(i){return i.endsWith("/")?i.slice(0,-1):i}const qG=()=>{const{progressionId:i}=lN(),e=io(),t=Vr(r=>Vi.selectors.getProgression(r,i));return A(t)?T.jsx(qv,{to:`/${i}/404`,replace:!0}):KG(e.pathname)===`/${i}`?T.jsx(qv,{to:`/${i}/editor`,replace:!0}):T.jsx(Y5,{})},a_=R`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: calc(100vh - 100px);
  gap: 20px;
`,o_=R`
  color: #fff;
  font-size: 4em;
`,l_=R`
  text-align: center;
  font-size: 1em;
  color: #fff;
`,JG=()=>{const{t:i}=vt();return T.jsxs(T.Fragment,{children:[T.jsxs(mc,{children:[T.jsx(L1,{}),T.jsx(yc,{})]}),T.jsxs("div",{className:a_,children:[T.jsx(Vf,{className:o_}),T.jsx("span",{className:l_,children:i("404.MissingProgression")}),T.jsx(ua,{to:xs.home(),className:gc,children:i("404.GoBack")})]})]})},QG=()=>{const{t:i}=vt();return T.jsxs(T.Fragment,{children:[T.jsxs(mc,{children:[T.jsx(L1,{}),T.jsx(yc,{})]}),T.jsxs("div",{className:a_,children:[T.jsx(Vf,{className:o_}),T.jsx("span",{className:l_,children:i("404.404")}),T.jsx(ua,{to:xs.home(),className:gc,children:i("404.GoBack")})]})]})},Wl="#111",u_=8,gh=u_*2-2,ZG=R`
  position: fixed;
  max-width: 400px;
  background-color: ${Wl};
  color: #ffffff;
  padding: 5px 10px;
  border-radius: 6px;
  pointer-events: none;
  z-index: 1000;
  visibility: hidden;
  opacity: 0;
  transition: opacity 0.1s ease, visibility 0.1s ease;
`,e$=R`
  position: absolute;
  width: 0;
  height: 0;
  border-style: solid;
  border-width: ${u_}px;
  border-color: transparent;
`,t$={top:R`
    transform: translate(-50%, -100%);
  `,bottom:R`
    transform: translate(-50%, 10px);
  `,left:R`
    transform: translate(-100%, -50%);
  `,right:R`
    transform: translate(10px, -50%);
  `},i$={top:R`
    bottom: -${gh}px;
    left: 50%;
    transform: translateX(-50%);
    border-top-color: ${Wl} !important;
  `,bottom:R`
    top: -${gh}px;
    left: 50%;
    transform: translateX(-50%);
    border-bottom-color: ${Wl} !important;
  `,left:R`
    right: -${gh}px;
    top: 50%;
    transform: translateY(-50%);
    border-left-color: ${Wl} !important;
  `,right:R`
    left: -${gh}px;
    top: 50%;
    transform: translateY(-50%);
    border-right-color: ${Wl} !important;
  `},rx=S.forwardRef(({messageKey:i,x:e,y:t,width:r,height:n,visible:s,position:a},o)=>{const l={top:t,left:e,visibility:s?"visible":"hidden",opacity:s?1:0};!A(r)&&r>0&&(l.width=r),!A(n)&&n>0&&(l.height=n);const u=mi(ZG,A(a)?void 0:t$[a]),c=mi(e$,A(a)?void 0:i$[a]);return T.jsxs("div",{ref:o,className:u,style:l,children:[T.jsx("div",{className:c}),T.jsx(U4,{i18nKey:i})]})}),r$=(i="data-tooltip")=>{const[e,t]=S.useState();return S.useEffect(()=>{const r=a=>{let o=a.target;for(;o&&o!==document.body;){if(o.hasAttribute(i)){t(o);return}o=o.parentElement}t(void 0)},n=a=>{let o=a.relatedTarget;for(;o&&o!==document.body;){if(o.hasAttribute(i))return;o=o.parentElement}t(void 0)},s=()=>{t(void 0)};return document.addEventListener("mouseover",r),document.addEventListener("mouseout",n),document.addEventListener("wheel",s),document.addEventListener("keydown",s),()=>{document.removeEventListener("mouseover",r),document.removeEventListener("mouseout",n),document.removeEventListener("wheel",s),document.removeEventListener("keydown",s)}},[]),e},Xr=10,n$={top:(i,{spaceAbove:e,spaceLeft:t,spaceRight:r})=>e>i.height+Xr&&t>i.width/2+Xr&&r>i.width/2+Xr,bottom:(i,{spaceBelow:e,spaceLeft:t,spaceRight:r})=>e>i.height+Xr&&t>i.width/2+Xr&&r>i.width/2+Xr,left:(i,{spaceLeft:e,spaceAbove:t,spaceBelow:r})=>e>i.width+Xr&&t>i.height/2+Xr&&r>i.height/2+Xr,right:(i,{spaceRight:e,spaceAbove:t,spaceBelow:r})=>e>i.width+Xr&&t>i.height/2+Xr&&r>i.height/2+Xr},s$=["top","bottom","left","right"];function a$(i,e,t=s$){const r=window.innerWidth,n=window.innerHeight,s={spaceAbove:i.top,spaceBelow:n-i.bottom,spaceLeft:i.left,spaceRight:r-i.right},a=t.find(o=>n$[o](e,s));return A(a)?(console.error("Can't fit tooltip properly",i),"bottom"):a}function o$(i,e,t){let r=0,n=0;switch(i){case"top":{r=e.left+e.width/2,n=e.top-10;break}case"bottom":{r=e.left+e.width/2,n=e.bottom;break}case"left":{r=e.left-10,n=e.top+e.height/2;break}case"right":{r=e.right,n=e.top+e.height/2;break}}return[r,n]}const l$=document.getElementById("tooltip"),u$=800,c$=({disabled:i})=>{const e=S.useRef(null),t=r$(),[r,n]=S.useState(),[s,a]=S.useState(!1),[{position:o,x:l,y:u,width:c,height:h},d]=S.useState({position:"bottom",x:0,y:0,width:0,height:0});return S.useEffect(()=>{let f;return!A(t)&&!i?(n(t.getAttribute("data-tooltip")),f=setTimeout(()=>a(!0),u$),()=>clearTimeout(f)):(a(!1),LC)},[t]),S.useLayoutEffect(()=>{if(A(e.current)||A(t)||i)return;const f=e.current.getBoundingClientRect(),p=t.getBoundingClientRect(),g=a$(p,f),[y,b]=o$(g,p);d({position:g,x:y,y:b,width:f.width,height:f.height})},[t,r]),wn.createPortal(T.jsxs(T.Fragment,{children:[T.jsx(rx,{messageKey:r,visible:s,position:o,x:l,y:u,width:c,height:h}),T.jsx(rx,{ref:e,messageKey:r,visible:!1,x:1,y:1})]}),l$)},h$=R`
  width: 100%;
  display: flex;
  flex-direction: column;
`,d$=()=>{const{showTooltips:i=!0}=l1();return T.jsxs("div",{className:h$,children:[T.jsx(c$,{disabled:!i}),T.jsxs(K5,{children:[T.jsx(Ta,{path:"/",Component:XG}),T.jsx(Ta,{path:"/:progressionId/404",Component:JG}),T.jsxs(Ta,{path:"/:progressionId",Component:qG,children:[T.jsx(Ta,{path:"score",Component:EG}),T.jsx(Ta,{path:"editor",Component:Fz})]}),T.jsx(Ta,{path:"*",Component:QG})]})]})};function nx(i){return i.reduce((e,t)=>(e[t.id]=t,e),{})}const f$=i=>({getOrCreate:(e,t,r,n)=>{if(i.has(e))return i.get(e);const s=`${t}-${r}-${n}`;return i.set(e,s),s},get:e=>{if(i.has(e))return i.get(e)}});function p$(i){const e=JB(i.progression.name,{replacement:"-"}),t=f$(new Map),r=Object.fromEntries(Object.entries(i.chords).map(([a,o],l)=>{const u=t.getOrCreate(a,e,`chord-${il(o).toLowerCase()}`,l);return[u,{...o,id:u}]})),n=Object.fromEntries(Object.entries(i.bars).map(([a,o],l)=>{const u=t.getOrCreate(a,e,"bar",l);return[u,{...o,id:u,chords:o.chords.map(c=>t.get(c)).filter(c=>!A(c))}]}));return{progression:{...i.progression,id:e,bars:i.progression.bars.map(a=>t.get(a)).filter(a=>!A(a))},bars:n,chords:r}}const g$=()=>{const i=Na.getState(),e=window.location.hash.split("/")[1],t=i.progressions[e];if(A(t))throw new TypeError(`Progression "${e}" doesn't exist.`);const r=t.bars.map(l=>i.bars[l]).filter(l=>!A(l)),n=r.flatMap(l=>l.chords).map(l=>i.chords[l]).filter(l=>!A(l)),s={progression:t,bars:nx(r),chords:nx(n)},a=p$(s),o=JSON.stringify(a);navigator.clipboard.writeText(o),console.log(JSON.stringify(a))},m$=window;m$.printTemplate=g$;const y$={type:"logger",log(i){this.output("log",i)},warn(i){this.output("warn",i)},error(i){this.output("error",i)},output(i,e){console&&console[i]&&console[i].apply(console,e)}};class $d{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(e,t)}init(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=t.prefix||"i18next:",this.logger=e||y$,this.options=t,this.debug=t.debug}log(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.forward(t,"log","",!0)}warn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.forward(t,"warn","",!0)}error(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.forward(t,"error","")}deprecate(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}forward(e,t,r,n){return n&&!this.debug?null:(typeof e[0]=="string"&&(e[0]=`${r}${this.prefix} ${e[0]}`),this.logger[t](e))}create(e){return new $d(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new $d(this.logger,e)}}var Yn=new $d;class vp{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach(r=>{this.observers[r]||(this.observers[r]=new Map);const n=this.observers[r].get(t)||0;this.observers[r].set(t,n+1)}),this}off(e,t){if(this.observers[e]){if(!t){delete this.observers[e];return}this.observers[e].delete(t)}}emit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];this.observers[e]&&Array.from(this.observers[e].entries()).forEach(a=>{let[o,l]=a;for(let u=0;u<l;u++)o(...r)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(a=>{let[o,l]=a;for(let u=0;u<l;u++)o.apply(o,[e,...r])})}}const Il=()=>{let i,e;const t=new Promise((r,n)=>{i=r,e=n});return t.resolve=i,t.reject=e,t},sx=i=>i==null?"":""+i,b$=(i,e,t)=>{i.forEach(r=>{e[r]&&(t[r]=e[r])})},v$=/###/g,ax=i=>i&&i.indexOf("###")>-1?i.replace(v$,"."):i,ox=i=>!i||typeof i=="string",uu=(i,e,t)=>{const r=typeof e!="string"?e:e.split(".");let n=0;for(;n<r.length-1;){if(ox(i))return{};const s=ax(r[n]);!i[s]&&t&&(i[s]=new t),Object.prototype.hasOwnProperty.call(i,s)?i=i[s]:i={},++n}return ox(i)?{}:{obj:i,k:ax(r[n])}},lx=(i,e,t)=>{const{obj:r,k:n}=uu(i,e,Object);if(r!==void 0||e.length===1){r[n]=t;return}let s=e[e.length-1],a=e.slice(0,e.length-1),o=uu(i,a,Object);for(;o.obj===void 0&&a.length;)s=`${a[a.length-1]}.${s}`,a=a.slice(0,a.length-1),o=uu(i,a,Object),o&&o.obj&&typeof o.obj[`${o.k}.${s}`]<"u"&&(o.obj=void 0);o.obj[`${o.k}.${s}`]=t},w$=(i,e,t,r)=>{const{obj:n,k:s}=uu(i,e,Object);n[s]=n[s]||[],n[s].push(t)},jd=(i,e)=>{const{obj:t,k:r}=uu(i,e);if(t)return t[r]},S$=(i,e,t)=>{const r=jd(i,t);return r!==void 0?r:jd(e,t)},c_=(i,e,t)=>{for(const r in e)r!=="__proto__"&&r!=="constructor"&&(r in i?typeof i[r]=="string"||i[r]instanceof String||typeof e[r]=="string"||e[r]instanceof String?t&&(i[r]=e[r]):c_(i[r],e[r],t):i[r]=e[r]);return i},go=i=>i.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var x$={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const k$=i=>typeof i=="string"?i.replace(/[&<>"'\/]/g,e=>x$[e]):i;class T${constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const t=this.regExpMap.get(e);if(t!==void 0)return t;const r=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,r),this.regExpQueue.push(e),r}}const C$=[" ",",","?","!",";"],N$=new T$(20),B$=(i,e,t)=>{e=e||"",t=t||"";const r=C$.filter(a=>e.indexOf(a)<0&&t.indexOf(a)<0);if(r.length===0)return!0;const n=N$.getRegExp(`(${r.map(a=>a==="?"?"\\?":a).join("|")})`);let s=!n.test(i);if(!s){const a=i.indexOf(t);a>0&&!n.test(i.substring(0,a))&&(s=!0)}return s},C0=function(i,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!i)return;if(i[e])return i[e];const r=e.split(t);let n=i;for(let s=0;s<r.length;){if(!n||typeof n!="object")return;let a,o="";for(let l=s;l<r.length;++l)if(l!==s&&(o+=t),o+=r[l],a=n[o],a!==void 0){if(["string","number","boolean"].indexOf(typeof a)>-1&&l<r.length-1)continue;s+=l-s+1;break}n=a}return n},Yd=i=>i&&i.indexOf("_")>0?i.replace("_","-"):i;class ux extends vp{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=e||{},this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,t,r){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const s=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator,a=n.ignoreJSONStructure!==void 0?n.ignoreJSONStructure:this.options.ignoreJSONStructure;let o;e.indexOf(".")>-1?o=e.split("."):(o=[e,t],r&&(Array.isArray(r)?o.push(...r):typeof r=="string"&&s?o.push(...r.split(s)):o.push(r)));const l=jd(this.data,o);return!l&&!t&&!r&&e.indexOf(".")>-1&&(e=o[0],t=o[1],r=o.slice(2).join(".")),l||!a||typeof r!="string"?l:C0(this.data&&this.data[e]&&this.data[e][t],r,s)}addResource(e,t,r,n){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1};const a=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator;let o=[e,t];r&&(o=o.concat(a?r.split(a):r)),e.indexOf(".")>-1&&(o=e.split("."),n=t,t=o[1]),this.addNamespaces(t),lx(this.data,o,n),s.silent||this.emit("added",e,t,r,n)}addResources(e,t,r){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(const s in r)(typeof r[s]=="string"||Array.isArray(r[s]))&&this.addResource(e,t,s,r[s],{silent:!0});n.silent||this.emit("added",e,t,r)}addResourceBundle(e,t,r,n,s){let a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1,skipCopy:!1},o=[e,t];e.indexOf(".")>-1&&(o=e.split("."),n=r,r=t,t=o[1]),this.addNamespaces(t);let l=jd(this.data,o)||{};a.skipCopy||(r=JSON.parse(JSON.stringify(r))),n?c_(l,r,s):l={...l,...r},lx(this.data,o,l),a.silent||this.emit("added",e,t,r)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return this.getResource(e,t)!==void 0}getResourceBundle(e,t){return t||(t=this.options.defaultNS),this.options.compatibilityAPI==="v1"?{...this.getResource(e,t)}:this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find(n=>t[n]&&Object.keys(t[n]).length>0)}toJSON(){return this.data}}var h_={processors:{},addPostProcessor(i){this.processors[i.name]=i},handle(i,e,t,r,n){return i.forEach(s=>{this.processors[s]&&(e=this.processors[s].process(e,t,r,n))}),e}};const cx={};class Xd extends vp{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),b$(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=Yn.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(e==null)return!1;const r=this.resolve(e,t);return r&&r.res!==void 0}extractFromKey(e,t){let r=t.nsSeparator!==void 0?t.nsSeparator:this.options.nsSeparator;r===void 0&&(r=":");const n=t.keySeparator!==void 0?t.keySeparator:this.options.keySeparator;let s=t.ns||this.options.defaultNS||[];const a=r&&e.indexOf(r)>-1,o=!this.options.userDefinedKeySeparator&&!t.keySeparator&&!this.options.userDefinedNsSeparator&&!t.nsSeparator&&!B$(e,r,n);if(a&&!o){const l=e.match(this.interpolator.nestingRegexp);if(l&&l.length>0)return{key:e,namespaces:s};const u=e.split(r);(r!==n||r===n&&this.options.ns.indexOf(u[0])>-1)&&(s=u.shift()),e=u.join(n)}return typeof s=="string"&&(s=[s]),{key:e,namespaces:s}}translate(e,t,r){if(typeof t!="object"&&this.options.overloadTranslationOptionHandler&&(t=this.options.overloadTranslationOptionHandler(arguments)),typeof t=="object"&&(t={...t}),t||(t={}),e==null)return"";Array.isArray(e)||(e=[String(e)]);const n=t.returnDetails!==void 0?t.returnDetails:this.options.returnDetails,s=t.keySeparator!==void 0?t.keySeparator:this.options.keySeparator,{key:a,namespaces:o}=this.extractFromKey(e[e.length-1],t),l=o[o.length-1],u=t.lng||this.language,c=t.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(u&&u.toLowerCase()==="cimode"){if(c){const k=t.nsSeparator||this.options.nsSeparator;return n?{res:`${l}${k}${a}`,usedKey:a,exactUsedKey:a,usedLng:u,usedNS:l,usedParams:this.getUsedParamsDetails(t)}:`${l}${k}${a}`}return n?{res:a,usedKey:a,exactUsedKey:a,usedLng:u,usedNS:l,usedParams:this.getUsedParamsDetails(t)}:a}const h=this.resolve(e,t);let d=h&&h.res;const f=h&&h.usedKey||a,p=h&&h.exactUsedKey||a,g=Object.prototype.toString.apply(d),y=["[object Number]","[object Function]","[object RegExp]"],b=t.joinArrays!==void 0?t.joinArrays:this.options.joinArrays,m=!this.i18nFormat||this.i18nFormat.handleAsObject;if(m&&d&&(typeof d!="string"&&typeof d!="boolean"&&typeof d!="number")&&y.indexOf(g)<0&&!(typeof b=="string"&&Array.isArray(d))){if(!t.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const k=this.options.returnedObjectHandler?this.options.returnedObjectHandler(f,d,{...t,ns:o}):`key '${a} (${this.language})' returned an object instead of string.`;return n?(h.res=k,h.usedParams=this.getUsedParamsDetails(t),h):k}if(s){const k=Array.isArray(d),x=k?[]:{},C=k?p:f;for(const N in d)if(Object.prototype.hasOwnProperty.call(d,N)){const B=`${C}${s}${N}`;x[N]=this.translate(B,{...t,joinArrays:!1,ns:o}),x[N]===B&&(x[N]=d[N])}d=x}}else if(m&&typeof b=="string"&&Array.isArray(d))d=d.join(b),d&&(d=this.extendTranslation(d,e,t,r));else{let k=!1,x=!1;const C=t.count!==void 0&&typeof t.count!="string",N=Xd.hasDefaultValue(t),B=C?this.pluralResolver.getSuffix(u,t.count,t):"",E=t.ordinal&&C?this.pluralResolver.getSuffix(u,t.count,{ordinal:!1}):"",O=C&&!t.ordinal&&t.count===0&&this.pluralResolver.shouldUseIntlApi(),z=O&&t[`defaultValue${this.options.pluralSeparator}zero`]||t[`defaultValue${B}`]||t[`defaultValue${E}`]||t.defaultValue;!this.isValidLookup(d)&&N&&(k=!0,d=z),this.isValidLookup(d)||(x=!0,d=a);const he=(t.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&x?void 0:d,oe=N&&z!==d&&this.options.updateMissing;if(x||k||oe){if(this.logger.log(oe?"updateKey":"missingKey",u,l,a,oe?z:d),s){const U=this.resolve(a,{...t,keySeparator:!1});U&&U.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let ye=[];const se=this.languageUtils.getFallbackCodes(this.options.fallbackLng,t.lng||this.language);if(this.options.saveMissingTo==="fallback"&&se&&se[0])for(let U=0;U<se.length;U++)ye.push(se[U]);else this.options.saveMissingTo==="all"?ye=this.languageUtils.toResolveHierarchy(t.lng||this.language):ye.push(t.lng||this.language);const K=(U,Z,re)=>{const ge=N&&re!==d?re:he;this.options.missingKeyHandler?this.options.missingKeyHandler(U,l,Z,ge,oe,t):this.backendConnector&&this.backendConnector.saveMissing&&this.backendConnector.saveMissing(U,l,Z,ge,oe,t),this.emit("missingKey",U,l,Z,d)};this.options.saveMissing&&(this.options.saveMissingPlurals&&C?ye.forEach(U=>{const Z=this.pluralResolver.getSuffixes(U,t);O&&t[`defaultValue${this.options.pluralSeparator}zero`]&&Z.indexOf(`${this.options.pluralSeparator}zero`)<0&&Z.push(`${this.options.pluralSeparator}zero`),Z.forEach(re=>{K([U],a+re,t[`defaultValue${re}`]||z)})}):K(ye,a,z))}d=this.extendTranslation(d,e,t,h,r),x&&d===a&&this.options.appendNamespaceToMissingKey&&(d=`${l}:${a}`),(x||k)&&this.options.parseMissingKeyHandler&&(this.options.compatibilityAPI!=="v1"?d=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${l}:${a}`:a,k?d:void 0):d=this.options.parseMissingKeyHandler(d))}return n?(h.res=d,h.usedParams=this.getUsedParamsDetails(t),h):d}extendTranslation(e,t,r,n,s){var a=this;if(this.i18nFormat&&this.i18nFormat.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...r},r.lng||this.language||n.usedLng,n.usedNS,n.usedKey,{resolved:n});else if(!r.skipInterpolation){r.interpolation&&this.interpolator.init({...r,interpolation:{...this.options.interpolation,...r.interpolation}});const u=typeof e=="string"&&(r&&r.interpolation&&r.interpolation.skipOnVariables!==void 0?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let c;if(u){const d=e.match(this.interpolator.nestingRegexp);c=d&&d.length}let h=r.replace&&typeof r.replace!="string"?r.replace:r;if(this.options.interpolation.defaultVariables&&(h={...this.options.interpolation.defaultVariables,...h}),e=this.interpolator.interpolate(e,h,r.lng||this.language||n.usedLng,r),u){const d=e.match(this.interpolator.nestingRegexp),f=d&&d.length;c<f&&(r.nest=!1)}!r.lng&&this.options.compatibilityAPI!=="v1"&&n&&n.res&&(r.lng=this.language||n.usedLng),r.nest!==!1&&(e=this.interpolator.nest(e,function(){for(var d=arguments.length,f=new Array(d),p=0;p<d;p++)f[p]=arguments[p];return s&&s[0]===f[0]&&!r.context?(a.logger.warn(`It seems you are nesting recursively key: ${f[0]} in key: ${t[0]}`),null):a.translate(...f,t)},r)),r.interpolation&&this.interpolator.reset()}const o=r.postProcess||this.options.postProcess,l=typeof o=="string"?[o]:o;return e!=null&&l&&l.length&&r.applyPostProcessor!==!1&&(e=h_.handle(l,e,t,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...n,usedParams:this.getUsedParamsDetails(r)},...r}:r,this)),e}resolve(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r,n,s,a,o;return typeof e=="string"&&(e=[e]),e.forEach(l=>{if(this.isValidLookup(r))return;const u=this.extractFromKey(l,t),c=u.key;n=c;let h=u.namespaces;this.options.fallbackNS&&(h=h.concat(this.options.fallbackNS));const d=t.count!==void 0&&typeof t.count!="string",f=d&&!t.ordinal&&t.count===0&&this.pluralResolver.shouldUseIntlApi(),p=t.context!==void 0&&(typeof t.context=="string"||typeof t.context=="number")&&t.context!=="",g=t.lngs?t.lngs:this.languageUtils.toResolveHierarchy(t.lng||this.language,t.fallbackLng);h.forEach(y=>{this.isValidLookup(r)||(o=y,!cx[`${g[0]}-${y}`]&&this.utils&&this.utils.hasLoadedNamespace&&!this.utils.hasLoadedNamespace(o)&&(cx[`${g[0]}-${y}`]=!0,this.logger.warn(`key "${n}" for languages "${g.join(", ")}" won't get resolved as namespace "${o}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),g.forEach(b=>{if(this.isValidLookup(r))return;a=b;const m=[c];if(this.i18nFormat&&this.i18nFormat.addLookupKeys)this.i18nFormat.addLookupKeys(m,c,b,y,t);else{let k;d&&(k=this.pluralResolver.getSuffix(b,t.count,t));const x=`${this.options.pluralSeparator}zero`,C=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(d&&(m.push(c+k),t.ordinal&&k.indexOf(C)===0&&m.push(c+k.replace(C,this.options.pluralSeparator)),f&&m.push(c+x)),p){const N=`${c}${this.options.contextSeparator}${t.context}`;m.push(N),d&&(m.push(N+k),t.ordinal&&k.indexOf(C)===0&&m.push(N+k.replace(C,this.options.pluralSeparator)),f&&m.push(N+x))}}let v;for(;v=m.pop();)this.isValidLookup(r)||(s=v,r=this.getResource(b,y,v,t))}))})}),{res:r,usedKey:n,exactUsedKey:s,usedLng:a,usedNS:o}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,t,r){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(e,t,r,n):this.resourceStore.getResource(e,t,r,n)}getUsedParamsDetails(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],r=e.replace&&typeof e.replace!="string";let n=r?e.replace:e;if(r&&typeof e.count<"u"&&(n.count=e.count),this.options.interpolation.defaultVariables&&(n={...this.options.interpolation.defaultVariables,...n}),!r){n={...n};for(const s of t)delete n[s]}return n}static hasDefaultValue(e){const t="defaultValue";for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t===r.substring(0,t.length)&&e[r]!==void 0)return!0;return!1}}const Ug=i=>i.charAt(0).toUpperCase()+i.slice(1);class hx{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=Yn.create("languageUtils")}getScriptPartFromCode(e){if(e=Yd(e),!e||e.indexOf("-")<0)return null;const t=e.split("-");return t.length===2||(t.pop(),t[t.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(t.join("-"))}getLanguagePartFromCode(e){if(e=Yd(e),!e||e.indexOf("-")<0)return e;const t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if(typeof e=="string"&&e.indexOf("-")>-1){const t=["hans","hant","latn","cyrl","cans","mong","arab"];let r=e.split("-");return this.options.lowerCaseLng?r=r.map(n=>n.toLowerCase()):r.length===2?(r[0]=r[0].toLowerCase(),r[1]=r[1].toUpperCase(),t.indexOf(r[1].toLowerCase())>-1&&(r[1]=Ug(r[1].toLowerCase()))):r.length===3&&(r[0]=r[0].toLowerCase(),r[1].length===2&&(r[1]=r[1].toUpperCase()),r[0]!=="sgn"&&r[2].length===2&&(r[2]=r[2].toUpperCase()),t.indexOf(r[1].toLowerCase())>-1&&(r[1]=Ug(r[1].toLowerCase())),t.indexOf(r[2].toLowerCase())>-1&&(r[2]=Ug(r[2].toLowerCase()))),r.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let t;return e.forEach(r=>{if(t)return;const n=this.formatLanguageCode(r);(!this.options.supportedLngs||this.isSupportedCode(n))&&(t=n)}),!t&&this.options.supportedLngs&&e.forEach(r=>{if(t)return;const n=this.getLanguagePartFromCode(r);if(this.isSupportedCode(n))return t=n;t=this.options.supportedLngs.find(s=>{if(s===n)return s;if(!(s.indexOf("-")<0&&n.indexOf("-")<0)&&(s.indexOf("-")>0&&n.indexOf("-")<0&&s.substring(0,s.indexOf("-"))===n||s.indexOf(n)===0&&n.length>1))return s})}),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t}getFallbackCodes(e,t){if(!e)return[];if(typeof e=="function"&&(e=e(t)),typeof e=="string"&&(e=[e]),Array.isArray(e))return e;if(!t)return e.default||[];let r=e[t];return r||(r=e[this.getScriptPartFromCode(t)]),r||(r=e[this.formatLanguageCode(t)]),r||(r=e[this.getLanguagePartFromCode(t)]),r||(r=e.default),r||[]}toResolveHierarchy(e,t){const r=this.getFallbackCodes(t||this.options.fallbackLng||[],e),n=[],s=a=>{a&&(this.isSupportedCode(a)?n.push(a):this.logger.warn(`rejecting language code not found in supportedLngs: ${a}`))};return typeof e=="string"&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&s(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&s(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&s(this.getLanguagePartFromCode(e))):typeof e=="string"&&s(this.formatLanguageCode(e)),r.forEach(a=>{n.indexOf(a)<0&&s(this.formatLanguageCode(a))}),n}}let _$=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],P$={1:i=>+(i>1),2:i=>+(i!=1),3:i=>0,4:i=>i%10==1&&i%100!=11?0:i%10>=2&&i%10<=4&&(i%100<10||i%100>=20)?1:2,5:i=>i==0?0:i==1?1:i==2?2:i%100>=3&&i%100<=10?3:i%100>=11?4:5,6:i=>i==1?0:i>=2&&i<=4?1:2,7:i=>i==1?0:i%10>=2&&i%10<=4&&(i%100<10||i%100>=20)?1:2,8:i=>i==1?0:i==2?1:i!=8&&i!=11?2:3,9:i=>+(i>=2),10:i=>i==1?0:i==2?1:i<7?2:i<11?3:4,11:i=>i==1||i==11?0:i==2||i==12?1:i>2&&i<20?2:3,12:i=>+(i%10!=1||i%100==11),13:i=>+(i!==0),14:i=>i==1?0:i==2?1:i==3?2:3,15:i=>i%10==1&&i%100!=11?0:i%10>=2&&(i%100<10||i%100>=20)?1:2,16:i=>i%10==1&&i%100!=11?0:i!==0?1:2,17:i=>i==1||i%10==1&&i%100!=11?0:1,18:i=>i==0?0:i==1?1:2,19:i=>i==1?0:i==0||i%100>1&&i%100<11?1:i%100>10&&i%100<20?2:3,20:i=>i==1?0:i==0||i%100>0&&i%100<20?1:2,21:i=>i%100==1?1:i%100==2?2:i%100==3||i%100==4?3:0,22:i=>i==1?0:i==2?1:(i<0||i>10)&&i%10==0?2:3};const R$=["v1","v2","v3"],E$=["v4"],dx={zero:0,one:1,two:2,few:3,many:4,other:5},M$=()=>{const i={};return _$.forEach(e=>{e.lngs.forEach(t=>{i[t]={numbers:e.nr,plurals:P$[e.fc]}})}),i};class O${constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=e,this.options=t,this.logger=Yn.create("pluralResolver"),(!this.options.compatibilityJSON||E$.includes(this.options.compatibilityJSON))&&(typeof Intl>"u"||!Intl.PluralRules)&&(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=M$()}addRule(e,t){this.rules[e]=t}getRule(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.shouldUseIntlApi())try{return new Intl.PluralRules(Yd(e==="dev"?"en":e),{type:t.ordinal?"ordinal":"cardinal"})}catch{return}return this.rules[e]||this.rules[this.languageUtils.getLanguagePartFromCode(e)]}needsPlural(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=this.getRule(e,t);return this.shouldUseIntlApi()?r&&r.resolvedOptions().pluralCategories.length>1:r&&r.numbers.length>1}getPluralFormsOfKey(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(e,r).map(n=>`${t}${n}`)}getSuffixes(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=this.getRule(e,t);return r?this.shouldUseIntlApi()?r.resolvedOptions().pluralCategories.sort((n,s)=>dx[n]-dx[s]).map(n=>`${this.options.prepend}${t.ordinal?`ordinal${this.options.prepend}`:""}${n}`):r.numbers.map(n=>this.getSuffix(e,n,t)):[]}getSuffix(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=this.getRule(e,r);return n?this.shouldUseIntlApi()?`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${n.select(t)}`:this.getSuffixRetroCompatible(n,t):(this.logger.warn(`no plural rule found for: ${e}`),"")}getSuffixRetroCompatible(e,t){const r=e.noAbs?e.plurals(t):e.plurals(Math.abs(t));let n=e.numbers[r];this.options.simplifyPluralSuffix&&e.numbers.length===2&&e.numbers[0]===1&&(n===2?n="plural":n===1&&(n=""));const s=()=>this.options.prepend&&n.toString()?this.options.prepend+n.toString():n.toString();return this.options.compatibilityJSON==="v1"?n===1?"":typeof n=="number"?`_plural_${n.toString()}`:s():this.options.compatibilityJSON==="v2"||this.options.simplifyPluralSuffix&&e.numbers.length===2&&e.numbers[0]===1?s():this.options.prepend&&r.toString()?this.options.prepend+r.toString():r.toString()}shouldUseIntlApi(){return!R$.includes(this.options.compatibilityJSON)}}const fx=function(i,e,t){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=S$(i,e,t);return!s&&n&&typeof t=="string"&&(s=C0(i,t,r),s===void 0&&(s=C0(e,t,r))),s},Wg=i=>i.replace(/\$/g,"$$$$");class I${constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=Yn.create("interpolator"),this.options=e,this.format=e.interpolation&&e.interpolation.format||(t=>t),this.init(e)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});const{escape:t,escapeValue:r,useRawValueToEscape:n,prefix:s,prefixEscaped:a,suffix:o,suffixEscaped:l,formatSeparator:u,unescapeSuffix:c,unescapePrefix:h,nestingPrefix:d,nestingPrefixEscaped:f,nestingSuffix:p,nestingSuffixEscaped:g,nestingOptionsSeparator:y,maxReplaces:b,alwaysFormat:m}=e.interpolation;this.escape=t!==void 0?t:k$,this.escapeValue=r!==void 0?r:!0,this.useRawValueToEscape=n!==void 0?n:!1,this.prefix=s?go(s):a||"{{",this.suffix=o?go(o):l||"}}",this.formatSeparator=u||",",this.unescapePrefix=c?"":h||"-",this.unescapeSuffix=this.unescapePrefix?"":c||"",this.nestingPrefix=d?go(d):f||go("$t("),this.nestingSuffix=p?go(p):g||go(")"),this.nestingOptionsSeparator=y||",",this.maxReplaces=b||1e3,this.alwaysFormat=m!==void 0?m:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(t,r)=>t&&t.source===r?(t.lastIndex=0,t):new RegExp(r,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(e,t,r,n){let s,a,o;const l=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},u=f=>{if(f.indexOf(this.formatSeparator)<0){const b=fx(t,l,f,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(b,void 0,r,{...n,...t,interpolationkey:f}):b}const p=f.split(this.formatSeparator),g=p.shift().trim(),y=p.join(this.formatSeparator).trim();return this.format(fx(t,l,g,this.options.keySeparator,this.options.ignoreJSONStructure),y,r,{...n,...t,interpolationkey:g})};this.resetRegExp();const c=n&&n.missingInterpolationHandler||this.options.missingInterpolationHandler,h=n&&n.interpolation&&n.interpolation.skipOnVariables!==void 0?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:f=>Wg(f)},{regex:this.regexp,safeValue:f=>this.escapeValue?Wg(this.escape(f)):Wg(f)}].forEach(f=>{for(o=0;s=f.regex.exec(e);){const p=s[1].trim();if(a=u(p),a===void 0)if(typeof c=="function"){const y=c(e,s,n);a=typeof y=="string"?y:""}else if(n&&Object.prototype.hasOwnProperty.call(n,p))a="";else if(h){a=s[0];continue}else this.logger.warn(`missed to pass in variable ${p} for interpolating ${e}`),a="";else typeof a!="string"&&!this.useRawValueToEscape&&(a=sx(a));const g=f.safeValue(a);if(e=e.replace(s[0],g),h?(f.regex.lastIndex+=a.length,f.regex.lastIndex-=s[0].length):f.regex.lastIndex=0,o++,o>=this.maxReplaces)break}}),e}nest(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n,s,a;const o=(l,u)=>{const c=this.nestingOptionsSeparator;if(l.indexOf(c)<0)return l;const h=l.split(new RegExp(`${c}[ ]*{`));let d=`{${h[1]}`;l=h[0],d=this.interpolate(d,a);const f=d.match(/'/g),p=d.match(/"/g);(f&&f.length%2===0&&!p||p.length%2!==0)&&(d=d.replace(/'/g,'"'));try{a=JSON.parse(d),u&&(a={...u,...a})}catch(g){return this.logger.warn(`failed parsing options string in nesting for key ${l}`,g),`${l}${c}${d}`}return a.defaultValue&&a.defaultValue.indexOf(this.prefix)>-1&&delete a.defaultValue,l};for(;n=this.nestingRegexp.exec(e);){let l=[];a={...r},a=a.replace&&typeof a.replace!="string"?a.replace:a,a.applyPostProcessor=!1,delete a.defaultValue;let u=!1;if(n[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(n[1])){const c=n[1].split(this.formatSeparator).map(h=>h.trim());n[1]=c.shift(),l=c,u=!0}if(s=t(o.call(this,n[1].trim(),a),a),s&&n[0]===e&&typeof s!="string")return s;typeof s!="string"&&(s=sx(s)),s||(this.logger.warn(`missed to resolve ${n[1]} for nesting ${e}`),s=""),u&&(s=l.reduce((c,h)=>this.format(c,h,r.lng,{...r,interpolationkey:n[1].trim()}),s.trim())),e=e.replace(n[0],s),this.regexp.lastIndex=0}return e}}const L$=i=>{let e=i.toLowerCase().trim();const t={};if(i.indexOf("(")>-1){const r=i.split("(");e=r[0].toLowerCase().trim();const n=r[1].substring(0,r[1].length-1);e==="currency"&&n.indexOf(":")<0?t.currency||(t.currency=n.trim()):e==="relativetime"&&n.indexOf(":")<0?t.range||(t.range=n.trim()):n.split(";").forEach(a=>{if(a){const[o,...l]=a.split(":"),u=l.join(":").trim().replace(/^'+|'+$/g,""),c=o.trim();t[c]||(t[c]=u),u==="false"&&(t[c]=!1),u==="true"&&(t[c]=!0),isNaN(u)||(t[c]=parseInt(u,10))}})}return{formatName:e,formatOptions:t}},mo=i=>{const e={};return(t,r,n)=>{const s=r+JSON.stringify(n);let a=e[s];return a||(a=i(Yd(r),n),e[s]=a),a(t)}};class D${constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=Yn.create("formatter"),this.options=e,this.formats={number:mo((t,r)=>{const n=new Intl.NumberFormat(t,{...r});return s=>n.format(s)}),currency:mo((t,r)=>{const n=new Intl.NumberFormat(t,{...r,style:"currency"});return s=>n.format(s)}),datetime:mo((t,r)=>{const n=new Intl.DateTimeFormat(t,{...r});return s=>n.format(s)}),relativetime:mo((t,r)=>{const n=new Intl.RelativeTimeFormat(t,{...r});return s=>n.format(s,r.range||"day")}),list:mo((t,r)=>{const n=new Intl.ListFormat(t,{...r});return s=>n.format(s)})},this.init(e)}init(e){const r=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}}).interpolation;this.formatSeparator=r.formatSeparator?r.formatSeparator:r.formatSeparator||","}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=mo(t)}format(e,t,r){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const s=t.split(this.formatSeparator);if(s.length>1&&s[0].indexOf("(")>1&&s[0].indexOf(")")<0&&s.find(o=>o.indexOf(")")>-1)){const o=s.findIndex(l=>l.indexOf(")")>-1);s[0]=[s[0],...s.splice(1,o)].join(this.formatSeparator)}return s.reduce((o,l)=>{const{formatName:u,formatOptions:c}=L$(l);if(this.formats[u]){let h=o;try{const d=n&&n.formatParams&&n.formatParams[n.interpolationkey]||{},f=d.locale||d.lng||n.locale||n.lng||r;h=this.formats[u](o,f,{...c,...n,...d})}catch(d){this.logger.warn(d)}return h}else this.logger.warn(`there was no format function for ${u}`);return o},e)}}const F$=(i,e)=>{i.pending[e]!==void 0&&(delete i.pending[e],i.pendingCount--)};class A$ extends vp{constructor(e,t,r){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=e,this.store=t,this.services=r,this.languageUtils=r.languageUtils,this.options=n,this.logger=Yn.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=n.maxParallelReads||10,this.readingCalls=0,this.maxRetries=n.maxRetries>=0?n.maxRetries:5,this.retryTimeout=n.retryTimeout>=1?n.retryTimeout:350,this.state={},this.queue=[],this.backend&&this.backend.init&&this.backend.init(r,n.backend,n)}queueLoad(e,t,r,n){const s={},a={},o={},l={};return e.forEach(u=>{let c=!0;t.forEach(h=>{const d=`${u}|${h}`;!r.reload&&this.store.hasResourceBundle(u,h)?this.state[d]=2:this.state[d]<0||(this.state[d]===1?a[d]===void 0&&(a[d]=!0):(this.state[d]=1,c=!1,a[d]===void 0&&(a[d]=!0),s[d]===void 0&&(s[d]=!0),l[h]===void 0&&(l[h]=!0)))}),c||(o[u]=!0)}),(Object.keys(s).length||Object.keys(a).length)&&this.queue.push({pending:a,pendingCount:Object.keys(a).length,loaded:{},errors:[],callback:n}),{toLoad:Object.keys(s),pending:Object.keys(a),toLoadLanguages:Object.keys(o),toLoadNamespaces:Object.keys(l)}}loaded(e,t,r){const n=e.split("|"),s=n[0],a=n[1];t&&this.emit("failedLoading",s,a,t),r&&this.store.addResourceBundle(s,a,r,void 0,void 0,{skipCopy:!0}),this.state[e]=t?-1:2;const o={};this.queue.forEach(l=>{w$(l.loaded,[s],a),F$(l,e),t&&l.errors.push(t),l.pendingCount===0&&!l.done&&(Object.keys(l.loaded).forEach(u=>{o[u]||(o[u]={});const c=l.loaded[u];c.length&&c.forEach(h=>{o[u][h]===void 0&&(o[u][h]=!0)})}),l.done=!0,l.errors.length?l.callback(l.errors):l.callback())}),this.emit("loaded",o),this.queue=this.queue.filter(l=>!l.done)}read(e,t,r){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,a=arguments.length>5?arguments[5]:void 0;if(!e.length)return a(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:t,fcName:r,tried:n,wait:s,callback:a});return}this.readingCalls++;const o=(u,c)=>{if(this.readingCalls--,this.waitingReads.length>0){const h=this.waitingReads.shift();this.read(h.lng,h.ns,h.fcName,h.tried,h.wait,h.callback)}if(u&&c&&n<this.maxRetries){setTimeout(()=>{this.read.call(this,e,t,r,n+1,s*2,a)},s);return}a(u,c)},l=this.backend[r].bind(this.backend);if(l.length===2){try{const u=l(e,t);u&&typeof u.then=="function"?u.then(c=>o(null,c)).catch(o):o(null,u)}catch(u){o(u)}return}return l(e,t,o)}prepareLoading(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),n&&n();typeof e=="string"&&(e=this.languageUtils.toResolveHierarchy(e)),typeof t=="string"&&(t=[t]);const s=this.queueLoad(e,t,r,n);if(!s.toLoad.length)return s.pending.length||n(),null;s.toLoad.forEach(a=>{this.loadOne(a)})}load(e,t,r){this.prepareLoading(e,t,{},r)}reload(e,t,r){this.prepareLoading(e,t,{reload:!0},r)}loadOne(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=e.split("|"),n=r[0],s=r[1];this.read(n,s,"read",void 0,void 0,(a,o)=>{a&&this.logger.warn(`${t}loading namespace ${s} for language ${n} failed`,a),!a&&o&&this.logger.log(`${t}loaded namespace ${s} for language ${n}`,o),this.loaded(e,a,o)})}saveMissing(e,t,r,n,s){let a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(t)){this.logger.warn(`did not save key "${r}" as the namespace "${t}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(r==null||r==="")){if(this.backend&&this.backend.create){const l={...a,isUpdate:s},u=this.backend.create.bind(this.backend);if(u.length<6)try{let c;u.length===5?c=u(e,t,r,n,l):c=u(e,t,r,n),c&&typeof c.then=="function"?c.then(h=>o(null,h)).catch(o):o(null,c)}catch(c){o(c)}else u(e,t,r,n,o,l)}!e||!e[0]||this.store.addResource(e[0],t,r,n)}}}const px=()=>({debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:i=>{let e={};if(typeof i[1]=="object"&&(e=i[1]),typeof i[1]=="string"&&(e.defaultValue=i[1]),typeof i[2]=="string"&&(e.tDescription=i[2]),typeof i[2]=="object"||typeof i[3]=="object"){const t=i[3]||i[2];Object.keys(t).forEach(r=>{e[r]=t[r]})}return e},interpolation:{escapeValue:!0,format:i=>i,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),gx=i=>(typeof i.ns=="string"&&(i.ns=[i.ns]),typeof i.fallbackLng=="string"&&(i.fallbackLng=[i.fallbackLng]),typeof i.fallbackNS=="string"&&(i.fallbackNS=[i.fallbackNS]),i.supportedLngs&&i.supportedLngs.indexOf("cimode")<0&&(i.supportedLngs=i.supportedLngs.concat(["cimode"])),i),mh=()=>{},V$=i=>{Object.getOwnPropertyNames(Object.getPrototypeOf(i)).forEach(t=>{typeof i[t]=="function"&&(i[t]=i[t].bind(i))})};class Zu extends vp{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(super(),this.options=gx(e),this.services={},this.logger=Yn,this.modules={external:[]},V$(this),t&&!this.isInitialized&&!e.isClone){if(!this.options.initImmediate)return this.init(e,t),this;setTimeout(()=>{this.init(e,t)},0)}}init(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,typeof t=="function"&&(r=t,t={}),!t.defaultNS&&t.defaultNS!==!1&&t.ns&&(typeof t.ns=="string"?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));const n=px();this.options={...n,...this.options,...gx(t)},this.options.compatibilityAPI!=="v1"&&(this.options.interpolation={...n.interpolation,...this.options.interpolation}),t.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=t.keySeparator),t.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=t.nsSeparator);const s=c=>c?typeof c=="function"?new c:c:null;if(!this.options.isClone){this.modules.logger?Yn.init(s(this.modules.logger),this.options):Yn.init(null,this.options);let c;this.modules.formatter?c=this.modules.formatter:typeof Intl<"u"&&(c=D$);const h=new hx(this.options);this.store=new ux(this.options.resources,this.options);const d=this.services;d.logger=Yn,d.resourceStore=this.store,d.languageUtils=h,d.pluralResolver=new O$(h,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),c&&(!this.options.interpolation.format||this.options.interpolation.format===n.interpolation.format)&&(d.formatter=s(c),d.formatter.init(d,this.options),this.options.interpolation.format=d.formatter.format.bind(d.formatter)),d.interpolator=new I$(this.options),d.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},d.backendConnector=new A$(s(this.modules.backend),d.resourceStore,d,this.options),d.backendConnector.on("*",function(f){for(var p=arguments.length,g=new Array(p>1?p-1:0),y=1;y<p;y++)g[y-1]=arguments[y];e.emit(f,...g)}),this.modules.languageDetector&&(d.languageDetector=s(this.modules.languageDetector),d.languageDetector.init&&d.languageDetector.init(d,this.options.detection,this.options)),this.modules.i18nFormat&&(d.i18nFormat=s(this.modules.i18nFormat),d.i18nFormat.init&&d.i18nFormat.init(this)),this.translator=new Xd(this.services,this.options),this.translator.on("*",function(f){for(var p=arguments.length,g=new Array(p>1?p-1:0),y=1;y<p;y++)g[y-1]=arguments[y];e.emit(f,...g)}),this.modules.external.forEach(f=>{f.init&&f.init(this)})}if(this.format=this.options.interpolation.format,r||(r=mh),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const c=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);c.length>0&&c[0]!=="dev"&&(this.options.lng=c[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(c=>{this[c]=function(){return e.store[c](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(c=>{this[c]=function(){return e.store[c](...arguments),e}});const l=Il(),u=()=>{const c=(h,d)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),l.resolve(d),r(h,d)};if(this.languages&&this.options.compatibilityAPI!=="v1"&&!this.isInitialized)return c(null,this.t.bind(this));this.changeLanguage(this.options.lng,c)};return this.options.resources||!this.options.initImmediate?u():setTimeout(u,0),l}loadResources(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:mh;const n=typeof e=="string"?e:this.language;if(typeof e=="function"&&(r=e),!this.options.resources||this.options.partialBundledLanguages){if(n&&n.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return r();const s=[],a=o=>{if(!o||o==="cimode")return;this.services.languageUtils.toResolveHierarchy(o).forEach(u=>{u!=="cimode"&&s.indexOf(u)<0&&s.push(u)})};n?a(n):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(l=>a(l)),this.options.preload&&this.options.preload.forEach(o=>a(o)),this.services.backendConnector.load(s,this.options.ns,o=>{!o&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),r(o)})}else r(null)}reloadResources(e,t,r){const n=Il();return e||(e=this.languages),t||(t=this.options.ns),r||(r=mh),this.services.backendConnector.reload(e,t,s=>{n.resolve(),r(s)}),n}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&h_.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1))for(let t=0;t<this.languages.length;t++){const r=this.languages[t];if(!(["cimode","dev"].indexOf(r)>-1)&&this.store.hasLanguageSomeTranslations(r)){this.resolvedLanguage=r;break}}}changeLanguage(e,t){var r=this;this.isLanguageChangingTo=e;const n=Il();this.emit("languageChanging",e);const s=l=>{this.language=l,this.languages=this.services.languageUtils.toResolveHierarchy(l),this.resolvedLanguage=void 0,this.setResolvedLanguage(l)},a=(l,u)=>{u?(s(u),this.translator.changeLanguage(u),this.isLanguageChangingTo=void 0,this.emit("languageChanged",u),this.logger.log("languageChanged",u)):this.isLanguageChangingTo=void 0,n.resolve(function(){return r.t(...arguments)}),t&&t(l,function(){return r.t(...arguments)})},o=l=>{!e&&!l&&this.services.languageDetector&&(l=[]);const u=typeof l=="string"?l:this.services.languageUtils.getBestMatchFromCodes(l);u&&(this.language||s(u),this.translator.language||this.translator.changeLanguage(u),this.services.languageDetector&&this.services.languageDetector.cacheUserLanguage&&this.services.languageDetector.cacheUserLanguage(u)),this.loadResources(u,c=>{a(c,u)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?o(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(o):this.services.languageDetector.detect(o):o(e),n}getFixedT(e,t,r){var n=this;const s=function(a,o){let l;if(typeof o!="object"){for(var u=arguments.length,c=new Array(u>2?u-2:0),h=2;h<u;h++)c[h-2]=arguments[h];l=n.options.overloadTranslationOptionHandler([a,o].concat(c))}else l={...o};l.lng=l.lng||s.lng,l.lngs=l.lngs||s.lngs,l.ns=l.ns||s.ns,l.keyPrefix!==""&&(l.keyPrefix=l.keyPrefix||r||s.keyPrefix);const d=n.options.keySeparator||".";let f;return l.keyPrefix&&Array.isArray(a)?f=a.map(p=>`${l.keyPrefix}${d}${p}`):f=l.keyPrefix?`${l.keyPrefix}${d}${a}`:a,n.t(f,l)};return typeof e=="string"?s.lng=e:s.lngs=e,s.ns=t,s.keyPrefix=r,s}t(){return this.translator&&this.translator.translate(...arguments)}exists(){return this.translator&&this.translator.exists(...arguments)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const r=t.lng||this.resolvedLanguage||this.languages[0],n=this.options?this.options.fallbackLng:!1,s=this.languages[this.languages.length-1];if(r.toLowerCase()==="cimode")return!0;const a=(o,l)=>{const u=this.services.backendConnector.state[`${o}|${l}`];return u===-1||u===2};if(t.precheck){const o=t.precheck(this,a);if(o!==void 0)return o}return!!(this.hasResourceBundle(r,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||a(r,e)&&(!n||a(s,e)))}loadNamespaces(e,t){const r=Il();return this.options.ns?(typeof e=="string"&&(e=[e]),e.forEach(n=>{this.options.ns.indexOf(n)<0&&this.options.ns.push(n)}),this.loadResources(n=>{r.resolve(),t&&t(n)}),r):(t&&t(),Promise.resolve())}loadLanguages(e,t){const r=Il();typeof e=="string"&&(e=[e]);const n=this.options.preload||[],s=e.filter(a=>n.indexOf(a)<0&&this.services.languageUtils.isSupportedCode(a));return s.length?(this.options.preload=n.concat(s),this.loadResources(a=>{r.resolve(),t&&t(a)}),r):(t&&t(),Promise.resolve())}dir(e){if(e||(e=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!e)return"rtl";const t=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],r=this.services&&this.services.languageUtils||new hx(px());return t.indexOf(r.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return new Zu(e,t)}cloneInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:mh;const r=e.forkResourceStore;r&&delete e.forkResourceStore;const n={...this.options,...e,isClone:!0},s=new Zu(n);return(e.debug!==void 0||e.prefix!==void 0)&&(s.logger=s.logger.clone(e)),["store","services","language"].forEach(o=>{s[o]=this[o]}),s.services={...this.services},s.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},r&&(s.store=new ux(this.store.data,n),s.services.resourceStore=s.store),s.translator=new Xd(s.services,n),s.translator.on("*",function(o){for(var l=arguments.length,u=new Array(l>1?l-1:0),c=1;c<l;c++)u[c-1]=arguments[c];s.emit(o,...u)}),s.init(n,t),s.translator.options=n,s.translator.backendConnector.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},s}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Hi=Zu.createInstance();Hi.createInstance=Zu.createInstance;Hi.createInstance;Hi.dir;Hi.init;Hi.loadResources;Hi.reloadResources;Hi.use;Hi.changeLanguage;Hi.getFixedT;Hi.t;Hi.exists;Hi.setDefaultNamespace;Hi.hasLoadedNamespace;Hi.loadNamespaces;Hi.loadLanguages;const H$={Language:"Language",Home:{RecentProgressions:"Recent Progressions",NewProgression:"New Progression",ProgressionName:"Progression name...",Bars:"Bars",Create:"Create"},Progression:{Bar:"Bar",Chord:"Chord",Root:"Root",Notes:"Notes",Transition:"Transition",Default:"Default",Search:"Search...",SelectNoteCount:"Select note count",SelectRootNote:"Select root note"},EditorNavigation:{FillTransitions:"Fill transitions",ClearTransitions:"Clear transitions",Settings:"Settings"},Navigation:{Editor:"Editor",Score:"Score"},Settings:{Settings:"Settings",General:"General",Progression:"Progression",Tuning:"Tuning",DangerZone:"Danger Zone",ShowTooltipsName:"Show Tooltips",ShowTooltipsDescription:"Turn on or off tooltips appearing on controls in the application.",TempoName:"Tempo",TempoDescription:"Tempo of the project in BPM (beats per minute)",NotesInABarName:"Notes in a bar",NotesInABarDescription:"Preferred amount of notes in a bar.",TuningName:"Tuning",TuningDescription:"You can change the tuning here to the exact tuning you are using.",TuningAddString:"Add String",DeleteProgressionName:"Delete chord progression",DeleteProgressionDescription:"Pressing this button will permanently delete this chord progression.",DeleteProgressionButton:"Permanently delete progression"},Score:{AlphaTabRenderedBy:"Tabs & score rendered by:"},Errors:{ScoreCannotBeGenerated:"Score cannot be generated!",WhatsMissing:"What's missing?",AtLeast2Bars:"You should have at least 2 bars.",AtLeast1Chord:"Each bar should have at least 1 chord in it.",NeedsTransitions:"Each chord should have a transition defined to the next chord.",MissingChord:"This chord is missing! This is most likely the result of a bug.",MissingBar:"This bar is missing! This is most likely the result of a bug.",Delete:"Delete",InvalidChord:"Invalid chord",NoTransitionsMessage:"No transitions found! Consider changing the root notes, your preferences, or search criteria"},404:{MissingProgression:"The progression you are looking for doesn't exist!",GoBack:"Go back",404:"404 - this page doesn't do anything."},Templates:{EmptyName:"New Progression",EmptyDescription:"Create your own progression from scratch.",AMinorBluesName:"A Minor Blues",AMinorBluesDescription:"Simple minor blues progression, focusing on i, iv and v chords.",AutumnLeavesName:"Autumn Leaves",AutumnLeavesDescription:"Autumn Leaves in G minor. For practicing both the major and minor ii V I.",AllMyLovingName:"All My Loving",AllMyLovingDescription:'The verse of the Beatles song "All My Loving" which features a walking bassline.'},Tooltips:{Progression:{FillTransitions:"Click to automatically fill transitions. For this to work, you need at least 2 bars and each should have at least 1 chord in it. <br/><br/><strong>This will leave existing transitions intact.</strong>",ClearTransitions:"Click to clear all transitions. Great for experimenting a new set of transitions between chords.",AddBar:"Click to add a new bar. You can add up to two chords to each bar.",AddChord:"Click to add a chord to this bar.",SelectRoot:"Select the root note of this chord. Each note of this chords transition will be selected relative to this root note.",SelectNoteCount:"Select how many notes you want to generate for the duration of this chord. By default each chord will be using the progression's preferred note count",Transition:`Pick a transition to the next chord from the appropriate transitons.<br/>
      <br/><strong>R</strong> = Current chords root note
      <br/><strong>3</strong> = Third of the current chord
      <br/><strong>5</strong> = Fifth of the current chord
      <br/><strong>NR</strong> = Next chords root note
      <br/><br/><strong>↑</strong> means up and <strong>↓</strong> means down from the current chords root. Numeric modifiers like +1 or -2 mean the given chord tone shifted with that amount of semitones.`,DeleteBar:"Click to delete this bar.",DeleteChord:"Click to delete this chord.",DeleteTransition:"Click to delete this transition.",SplitBar:"Click to add a second chord to this bar.",CloneBar:"Click to clone this bar.",DragBar:"Grab to move this bar."},Score:{Stop:"Click to stop playback and reset playhead",PlayPause:"Click to play or pause",Loop:"Click to turn on or off looping selection",MetronomeVolume:"Metronome volume",BassVolume:"Bass volume",ChordsVolume:"Chords volume"}}},z$={Language:"Nyelv",Home:{RecentProgressions:"Akkordköreid",NewProgression:"Új Akkordkör",ProgressionName:"Akkordkör neve...",Create:"Létrehozás",Bars:"Ütem"},Progression:{Bar:"Ütem",Chord:"Akkord",Root:"Alaphang",Notes:"Hang",Transition:"Átmenet",Default:"Alapért.",Search:"Keresés...",SelectNoteCount:"Hangok száma",SelectRootNote:"Alaphang"},EditorNavigation:{FillTransitions:"Átmenetek kitöltése",ClearTransitions:"Átmenetek törlése",Settings:"Beállítások"},Navigation:{Editor:"Szerkesztő",Score:"Kotta és Tab"},Settings:{Settings:"Beállítások",General:"Általános",Progression:"Akkordkör",Tuning:"Hangolás",DangerZone:"Veszély Zóna",TempoName:"Tempó",TempoDescription:"Az akkordkör tempója BPM-ben.",ShowTooltipsName:"Súgó (Tooltip-ek) engedélyezése",ShowTooltipsDescription:"Itt ki és bekapcsolhatod a Súgót (Tooltip-eket)",NotesInABarName:"Hangok egy ütemben",NotesInABarDescription:"Alapértelmezett hangmennyiség egy ütemben.",TuningName:"Hangolás",TuningDescription:"Itt beállíthatod a hangszered hangolását, illetve húrjait.",TuningAddString:"Húr hozzáadása",DeleteProgressionName:"Akkordkör törlése",DeleteProgressionDescription:"Ennek a gombnak a megnyomásával véglegesen törlöd ezt az akkordkört.",DeleteProgressionButton:"Véglegesen törlöm ezt az akkordkört"},Score:{AlphaTabRenderedBy:"Tabot és kottát generálta:"},Templates:{EmptyName:"Új Akkordkör",EmptyDescription:"Teljesen üres, új akkordkör.",AMinorBluesName:"A Moll Blues",AMinorBluesDescription:"Egyszerű moll blues az i, iv és v akkordok gyakorlására.",AutumnLeavesName:"Autumn Leaves",AutumnLeavesDescription:"Autumn Leaves G mollban. A dúr és moll ii-V-I-ek gyakorlására.",AllMyLovingName:"All My Loving",AllMyLovingDescription:'A versszak a Beatles "All My Loving" című számából.'},Errors:{ScoreCannotBeGenerated:"Kotta/Tab nem generálható!",WhatsMissing:"Mi hiányzik?",AtLeast2Bars:"Legyen legalább 2 ütemed.",AtLeast1Chord:"Minden ütemben legyen legalább 1 akkord.",NeedsTransitions:"Minden akkordban legyen beállítva az átmenet a következő akkordba.",MissingChord:"Hiányzó akkord! Ez valószínűleg egy szoftverhiba eredménye.",MissingBar:"Hiányzó ütem! Ez valószínűleg egy szoftverhiba eredménye.",Delete:"Törlés",InvalidChord:"Ismeretlen akkord",NoTransitionsMessage:"Nincs ilyen átmenet! Változtass az alaphangon, a beállításokon, vagy a keresett szövegen!"},404:{MissingProgression:"Ez az akkordkör nem létezik!",GoBack:"Vissza a főoldalra",404:"404 - Ez az oldal nem csinál semmit."},Tooltips:{Progression:{FillTransitions:"Az akkordok közötti átmenetek automatikus kitöltése. Ahhoz hogy ez működjön legyen legalább 2 ütemed, és minden ütemben legyen legalább 1 akkord. <br/><br/><strong>Ez a funkció a kitöltött átmeneteket nem változtatja meg.</strong>",ClearTransitions:"Az összes átmenet törlése. <strong>Ez az akció nem vonható vissza.</strong><br/><br>Ideális, ha új átmenetekkel akarsz kísérletezni.",AddBar:"Új ütem hozzáadása az akkordkörhöz.",AddChord:"Új akkord hozzáadása az ütemhez.",SelectRoot:"Válaszd ki az akkord alaphangját. Az akkord átmenetének hangjai ehhez a hanghoz képest lesznek számítva.",SelectNoteCount:"Válaszd ki hány hangból álló átmenetet szeretnél használni ehhez az akkordhoz. Alapértelmezetten az akkordkörben definiált mennyiségű hang lesz használva.",Transition:`Válasz egy átmenetet a következő akkordhoz.<br/>
      <br/><strong>R</strong> = Az akkord alpahangja
      <br/><strong>3</strong> = Az akkord terce
      <br/><strong>5</strong> = Az akkord kvintje
      <br/><strong>NR</strong> = A következő akkord alpahangja
      <br/><br/><strong>↑</strong> - az alaphanghoz képes magasabb <strong>↓</strong> - illetve az alaphanghoz képest mélyebb akkordhangot jelent. +x vagy -x az akkordhangtól x félhang távolságra levő hangot jelent.`,DeleteBar:"Az ütem törlése.",DeleteChord:"Az akkord törlése.",DeleteTransition:"Az átmenet törlése.",SplitBar:"Új akkord hozzáadása az ütemhez.",CloneBar:"Az ütem duplikálása.",DragBar:"Az ütem mozgatása."},Score:{Stop:"Lejátszás megállítása, és ugrás az elejére",PlayPause:"Lejátszás vagy a lejátszás szüneteltetése",Loop:"A kijelölt szakasz ismétlésének ki és bekapcsolása",MetronomeVolume:"Metronóm hangereje",BassVolume:"Basszus hangereje",ChordsVolume:"Akkordok/kíséret hangereje"}}};var mx,yx,bx;const U$=(bx=(yx=(mx=Na==null?void 0:Na.getState)==null?void 0:mx.call(Na))==null?void 0:yx.config)==null?void 0:bx.language;Hi.init({interpolation:{escapeValue:!1},debug:!0,lng:U$??window.navigator.language,fallbackLng:"en",resources:{en:{translation:H$},hu:{translation:z$}},react:{transSupportBasicHtmlNodes:!0,transKeepBasicHtmlNodesFor:["br","strong","i"]}});const W$=Hi;MT(document.getElementById("root")).render(T.jsx(uE,{store:Na,children:T.jsxs(R7,{children:[T.jsx(Z3,{styles:t5}),T.jsx($4,{i18n:W$,children:T.jsx(d$,{})})]})}));
